(()=>{var e={95482:(e,t,n)=>{"use strict";n(752),n(73964),n(60429),n(36409);var l,a=n(49963),o=n(69876),i=n(50124),r=n(48534),u=(n(69358),n(70560),n(48324),n(66252)),c=n(2262),s=(n(38077),n(60228),n(76801),n(43843),n(25728),n(53416));(function(e){e["SYMBOL"]="symbol",e["EL_ANIMATION"]="elAnimation",e["EL_STYLE"]="elStyle",e["EL_POSITION"]="elPosition",e["SLIDE_DESIGN"]="slideDesign",e["SLIDE_ANIMATION"]="slideAnimation",e["MULTI_POSITION"]="multiPosition"})(l||(l={}));var d,f,v,p,h,m,g=n(95082),y=n(66347),w=(n(63975),n(97195),n(34284),n(82954),n(32320),n(25804)),x=function(e){var t=e.state.selection.empty;t&&(0,w.td)(e.state,e.dispatch)},b=function(e,t,n){if(n)e.dispatch(e.state.tr.addMark(n.from,n.to,t));else{var l=e.state.selection,a=l.$from,o=l.$to;e.dispatch(e.state.tr.addMark(a.pos,o.pos,t))}},k=function(e,t,n,l){var a=t,o=function(e){return e.type===l},i=null,r=null,u=null;while(a<=n){var c=e.nodeAt(a);if(!c||!c.marks)return null;var s=c.marks.find(o);if(!s)return null;if(i&&s!==i)return null;r=r||c,i=i||s,u=c,a++}var d=t,f=n,v=0;a=t-1;while(a>v){var p=e.nodeAt(a),h=p&&p.marks.find(o);if(!h||h!==i)break;d=a,r=p,a--}a=n+1,v=e.nodeSize-2;while(a<v){var m=e.nodeAt(a),g=m&&m.marks.find(o);if(!g||g!==i)break;f=a,u=m,a++}return{mark:i,from:{node:r,pos:d},to:{node:u,pos:f}}},_=function(e,t){return Array.isArray(e)&&e.indexOf(t.type)>-1||t.type===e},I=function(e,t){for(var n=e.depth;n>0;n--){var l=e.node(n);if(t(l))return{pos:n>0?e.before(n):0,start:e.start(n),depth:n,node:l}}},S=function(e){return function(t){return I(t.$from,e)}},C=function(e){return function(t){return S((function(t){return _(e,t)}))(t)}},L=function(e,t){var n=t.schema.nodes[e];return!!C(n)(t.selection)},E=function(e){var t,n,l=e.state,a=l.selection,o=l.doc,i=a.from,r=o.nodeAt(i)||o.nodeAt(i-1);return null!==(t=r)&&void 0!==t&&t.lastChild&&(r=r.lastChild),(null===(n=r)||void 0===n?void 0:n.marks)||[]},Z=function(e,t,n){var l,a=(0,y.Z)(e);try{for(a.s();!(l=a.n()).done;){var o=l.value;if(o.type.name===t&&o.attrs[n])return o.attrs[n]}}catch(i){a.e(i)}finally{a.f()}return null},T=function(e,t){var n,l=(0,y.Z)(e);try{for(l.s();!(n=l.n()).done;){var a=n.value;if(a.type.name===t)return!0}}catch(o){l.e(o)}finally{l.f()}return!1},M=function(e,t){var n=e.selection,l=n.from,a=n.$from,o=n.to,i=n.empty;return i?t.isInSet(e.storedMarks||a.marks()):e.doc.rangeHasMark(l,o,t)},U=function(e,t){var n=e.state,l=n.selection,a=n.doc,o=l.from,i=l.to,r=!0,u="";return a.nodesBetween(o,i,(function(e){return r&&e.attrs[t]&&(r=!1,u=e.attrs[t]),r})),u},W={color:"#000",backcolor:"",fontsize:"20px",fontname:"微软雅黑",align:"left"},D=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=(0,g.Z)((0,g.Z)({},W),t),l=E(e),a=T(l,"strong"),o=T(l,"em"),i=T(l,"underline"),r=T(l,"strikethrough"),u=T(l,"superscript"),c=T(l,"subscript"),s=T(l,"code"),d=Z(l,"forecolor","color")||n.color,f=Z(l,"backcolor","backcolor")||n.backcolor,v=Z(l,"fontsize","fontsize")||n.fontsize,p=Z(l,"fontname","fontname")||n.fontname,h=Z(l,"link","href")||"",m=U(e,"align")||n.align,y=L("bullet_list",e.state),w=L("ordered_list",e.state),x=L("blockquote",e.state);return{bold:a,em:o,underline:i,strikethrough:r,superscript:u,subscript:c,code:s,color:d,backcolor:f,fontsize:v,fontname:p,link:h,align:m,bulletList:y,orderedList:w,blockquote:x}},H=function(e){var t=E(e),n=Z(t,"fontsize","fontsize")||W.fontsize;return parseInt(n)},F={bold:!1,em:!1,underline:!1,strikethrough:!1,superscript:!1,subscript:!1,code:!1,color:"#000",backcolor:"",fontsize:"20px",fontname:"微软雅黑",link:"",align:"left",bulletList:!1,orderedList:!1,blockquote:!1},A=[{label:"Arial",value:"Arial"},{label:"Microsoft Yahei",value:"Microsoft Yahei"},{label:"Song Dynasty",value:"SimSun"},{label:"black body",value:"SimHei"},{label:"Kaiti",value:"KaiTi"},{label:"New Song Dynasty",value:"NSimSun"},{label:"FangSong",value:"FangSong"},{label:"square",value:"PingFang SC"},{label:"Chinese bold",value:"STHeiti"},{label:"Chinese regular script",value:"STKaiti"},{label:"Chinese Songti",value:"STSong"},{label:"Chinese imitation Song",value:"STFangSong"},{label:"Chinese Song Dynasty",value:"STZhongSong"},{label:"Chinese Amber",value:"STHupo"},{label:"huawenxinwei",value:"STXinwei"},{label:"Chinese official script",value:"STLiti"},{label:"Chinese regular script",value:"STXingkai"},{label:"Holly Blackbody",value:"Hiragino Sans GB"},{label:"Lantinghei SC",value:"Lantinghei SC"},{label:"Hanzipen SC",value:"Hanzipen SC"},{label:"Hannotate SC",value:"Hannotate SC"},{label:"Song Dynasty",value:"Songti SC"},{label:"Doll body",value:"Wawati SC"},{label:"Xingkai",value:"Xingkai SC"},{label:"Yuan body",value:"Yuanti SC"},{label:"Chinese silk black",value:"STXihei"},{label:"YouYuan",value:"YouYuan"},{label:"official script",value:"LiSu"}],O=[{label:"Deyihei",value:"Deyihei"},{label:"Cang'er small balls",value:"Cang'er small balls"},{label:"Youshe title black",value:"Youshe title black"},{label:"Feng Guang Ming Rui Body",value:"Feng Guang Ming Rui Body"},{label:"Photography Modern Small Cube",value:"Photography Modern Small Cube"},{label:"station cool happy body",value:"station cool happy body"},{label:"Zhimai District Ximai Style",value:"Zhimai District Ximai Style"},{label:"Material Market Kangkangti",value:"Material Market Kangkangti"},{label:"Material Market Cool Cube",value:"Material Market Cool Cube"},{label:"Tuniu-like round body",value:"Tuniu-like round body"},{label:"Rui Zi Zhen Yan Ti",value:"Rui Zi Zhen Yan Ti"}],P=(n(34338),n(89730),n(6203),function(e){if("string"!==typeof e)return!1;var t="Arial";if(e.toLowerCase()===t.toLowerCase())return!0;var n=100,l=100,a=100,o="a",i=document.createElement("canvas"),r=i.getContext("2d",{willReadFrequently:!0});if(!r)return!1;i.width=l,i.height=a,r.textAlign="center",r.fillStyle="black",r.textBaseline="middle";var u=function(e){r.clearRect(0,0,l,a),r.font="".concat(n,"px ").concat(e,", ").concat(t),r.fillText(o,l/2,a/2);var i=r.getImageData(0,0,l,a).data;return[].slice.call(i).filter((function(e){return 0!==e}))};return u(t).join("")!==u(e).join("")}),R=n(89584),B=(n(50886),n(64043),n(57267),n(56532),n(62506),n(39772),n(97234)),z=n(96486),N=[{id:"test-slide-1",elements:[{type:"shape",id:"4cbRxp",left:0,top:200,width:546,height:362.5,viewBox:[200,200],path:"M 0 0 L 0 200 L 200 200 Z",fill:"#fffff",fixedRatio:!1,opacity:.7,rotate:0}],background:{type:"solid",color:"#ffffff"}}],j={themeColor:"#5b9bd5",fontColor:"#333",fontName:"Microsoft Yahei",backgroundColor:"#fff",shadow:{h:3,v:3,blur:2,color:"#808080"},outline:{width:2,color:"#525252",style:"solid"}},Y=[{id:"template",elements:[{type:"shape",id:"4cbRxp",left:0,top:200,width:546,height:362.5,viewBox:[200,200],path:"M 0 0 L 0 200 L 200 200 Z",fill:"{{themeColor}}",fixedRatio:!1,opacity:.7,rotate:0},{type:"shape",id:"ookHrf",left:0,top:0,width:300,height:320,viewBox:[200,200],path:"M 0 0 L 0 200 L 200 200 Z",fill:"{{themeColor}}",fixedRatio:!1,flipV:!0,rotate:0},{type:"text",id:"AkIh3E",left:355,top:95.11111111111111,width:585,height:116,lineHeight:1.2,content:"<p style=''><strong><span style='font-size: 80px'>Enter title</span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",wordSpace:6},{type:"text",id:"7stmVP",left:355,top:253.25,width:585,height:56,content:"<p><span style='font-size:  24px'>Please enter subtitle here</span></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}"},{type:"line",id:"FnpZs4",left:361,top:238,start:[0,0],end:[549,0],points:["",""],color:"{{themeColor}}",style:"solid",width:2}],background:{type:"solid",color:"{{backgroundColor}}"}},{id:"template",elements:[{type:"text",id:"ptNnUJ",left:145,top:148,width:711,height:77,lineHeight:1.2,content:"<p style='text-align: center;'><strong><span style='font-size: 48px'>add title here</span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}"},{type:"text",id:"mRHvQN",left:207.50000000000003,top:249.84259259259264,width:585,height:56,content:"<p style='text-align: center;'><span style='font-size: 24px'>Add subtitle here</span></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}"},{type:"line",id:"7CQDwc",left:323.09259259259267,top:238.33333333333334,start:[0,0],end:[354.8148148148148,0],points:["",""],color:"{{themeColor}}",style:"solid",width:4},{type:"shape",id:"09wqWw",left:-27.648148148148138,top:432.73148148148147,width:1056.2962962962963,height:162.96296296296296,viewBox:[200,200],path:"M 0 20 C 40 -40 60 60 100 20 C 140 -40 160 60 200 20 L 200 180 C 140 240 160 140 100 180 C 40 240 60 140 0 180 L 0 20 Z",fill:"{{themeColor}}",fixedRatio:!1,rotate:0}],background:{type:"solid",color:"{{backgroundColor}}"}},{id:"template",elements:[{type:"shape",id:"vSheCJ",left:183.5185185185185,top:175.5092592592593,width:605.1851851851851,height:185.18518518518516,viewBox:[200,200],path:"M 0 0 L 200 0 L 200 200 L 0 200 Z",fill:"{{themeColor}}",fixedRatio:!1,rotate:0},{type:"shape",id:"Mpwv7x",left:211.29629629629628,top:201.80555555555557,width:605.1851851851851,height:185.18518518518516,viewBox:[200,200],path:"M 0 0 L 200 0 L 200 200 L 0 200 Z",fill:"{{themeColor}}",fixedRatio:!1,rotate:0,opacity:.7},{type:"text",id:"WQOTAp",left:304.9074074074074,top:198.10185185185182,width:417.9629629629629,height:140,content:"<p style='text-align: center;'><strong><span style='color: #ffffff;'><span style='font-size: 80px'>thanks for watching</span></span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",wordSpace:5}],background:{type:"solid",color:"{{backgroundColor}}"}},{id:"MZVO1kkj",elements:[{type:"shape",id:"cql0h8",left:0,top:0,width:352.59259259259255,height:562.5,viewBox:[200,200],path:"M 0 0 L 200 0 L 200 200 L 0 200 Z",fill:"{{themeColor}}",fixedRatio:!1,rotate:0},{type:"shape",id:"_RTaF4",left:171.4814814814814,top:100.13888888888887,width:362.22222222222223,height:362.22222222222223,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"rgba(255,255,255,0)",fixedRatio:!1,rotate:0,outline:{width:10,color:"{{backgroundColor}}",style:"solid"}},{type:"shape",id:"UZfo8N",left:216.66666666666663,top:145.32407407407408,width:271.85185185185185,height:271.85185185185185,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{backgroundColor}}",fixedRatio:!1,rotate:0,text:{content:"<p style='text-align: center;'><span style='font-size: 80px'>01</span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"text",id:"ysqtBg",left:561.4814814814814,top:100.1388888888889,width:359.25925925925924,height:80,content:"<p style=''><strong><span style='font-size: 40px'>enter title here</span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}"},{type:"text",id:"lXsoHa",left:572.5925925925925,top:202.3611111111111,width:257.77777777777777,height:260,content:"<ol><li><p style=''>Enter content here</p></li><li><p style=''>Enter your content here</p></li><li><p style=''>Enter your content here</p></li><li><p style=''> Enter your content here</p></li><li><p style=''>Enter your content here</p></li><li><p style=''> Enter content here</p></li></ol>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",lineHeight:2,fill:"{{subColor}}"}],background:{type:"solid",color:"{{backgroundColor}}"}},{id:"template",elements:[{type:"shape",id:"EBBnTr",left:360.5996472663139,top:141.8496472663139,width:278.80070546737215,height:278.80070546737215,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!0,rotate:0,outline:{width:0,color:"{{backgroundColor}}",style:"solid"}},{type:"shape",id:"gDIWDH",left:456.4373897707231,top:98.287037037037,width:87.12522045855381,height:87.12522045855381,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!0,rotate:0,outline:{width:4,color:"{{backgroundColor}}",style:"solid"},text:{content:"<p style='text-align: center;'><span style='color: #ffffff;'>1</span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"shape",id:"DUWT7E",left:317.037037037037,top:237.68738977072314,width:87.12522045855381,height:87.12522045855381,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!0,rotate:0,outline:{width:4,color:"{{backgroundColor}}",style:"solid"},text:{content:"<p style='text-align: center;'><span style='color: #ffffff;'>4</span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"shape",id:"pbhn38",left:456.43738977072303,top:377.08774250440916,width:87.12522045855381,height:87.12522045855381,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!0,rotate:0,outline:{width:4,color:"{{backgroundColor}}",style:"solid"},text:{content:"<p style='text-align: center;'><span style='color: #ffffff;'>3</span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"shape",id:"CvMKrO",left:595.8377425044091,top:237.6873897707231,width:87.12522045855381,height:87.12522045855381,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!0,rotate:0,outline:{width:4,color:"{{backgroundColor}}",style:"solid"},text:{content:"<p style='text-align: center;'><span style='color: #ffffff;'>2</span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"text",id:"adudHB",left:402.962962962963,top:39.39814814814815,width:194.07407407407408,height:50,content:"<p style='text-align: center;'>Enter content here</p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}"},{type:"text",id:"9UpDwg",left:402.962962962963,top:473.1018518518518,width:194.07407407407408,height:50,content:"<p style='text-align: center;'>Enter content here</p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}"},{type:"text",id:"GERdpB",left:111.48148148148151,top:256.25,width:194.07407407407408,height:50,content:"<p style='text-align: center;'>Enter content here</p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}"},{type:"text",id:"G5qoho",left:691.1111111111111,top:256.25,width:194.07407407407408,height:50,content:"<p style='text-align: center;'>Enter content here</p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}"},{type:"shape",id:"vdZcI6",left:415.18518518518516,top:196.4351851851852,width:169.62962962962962,height:169.62962962962962,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{backgroundColor}}",fixedRatio:!1,rotate:0}],background:{type:"solid",color:"{{backgroundColor}}"}},{id:"template",elements:[{type:"shape",id:"tYUmrx",left:156.66666666666683,top:149.02777777777771,width:264.4444444444445,height:264.4444444444445,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!1,rotate:0,text:{content:"<p style='text-align: center;'><span style='color: #ffffff;'><span style='font-size: 60px'>01</span></span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"shape",id:"0GVHf8",left:342.2222222222223,top:217.17592592592587,width:128.14814814814812,height:128.14814814814812,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{backgroundColor}}",fixedRatio:!1,rotate:0},{type:"text",id:"BO33Sv",left:378.8888888888889,top:235.24999999999994,width:464.4444444444444,height:92,content:"<p style=''><strong><span style='font-size: 48px'>add title here</span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}"}],background:{type:"solid",color:"{{backgroundColor}}"}},{id:"template",elements:[{type:"text",id:"Hj7ttp",left:69.35185185185185,top:49.21759259259262,width:420,height:63,lineHeight:1.2,content:"<p style='text-align: center;'><strong><span style='color: #ffffff;'><span style='font-size: 36px'>1.Please enter a title</span></span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{themeColor}}"},{type:"text",id:"FmKMNB",left:69.35185185185185,top:129.28240740740745,width:420,height:384,content:"<p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span></p ><p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span></p><p style='text-align: center; '><span style='font-size: 24px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 24px '>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span>< /p><p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size : 24px'>Enter content here</span></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"text",id:"rI7ZeO",left:510.64814814814815,top:49.21759259259262,width:420,height:63,lineHeight:1.2,content:"<p style='text-align: center;'><strong><span style='color: #ffffff;'><span style='font-size: 36px'>2.Please enter a title</span></span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{themeColor}}"},{type:"text",id:"KspwGc",left:510.64814814814815,top:129.28240740740745,width:420,height:384,content:"<p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span></p ><p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span></p><p style='text-align: center; '><span style='font-size: 24px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 24px '>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span>< /p><p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 24px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size : 24px'>Enter content here</span></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"}],background:{type:"solid",color:"{{backgroundColor}}"}},{id:"template",elements:[{type:"text",id:"Rx63Jo",left:69.35185185185179,top:51.71759259259262,width:420,height:58,lineHeight:1.2,content:"<p style='text-align: center;'><strong><span style='color: #ffffff;'><span style='font-size: 32px'>1.Please enter a title</span></span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{themeColor}}"},{type:"text",id:"ulyuzE",left:69.35185185185179,top:131.78240740740745,width:420,height:129,content:"<p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p ><p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"text",id:"kr35Ca",left:510.6481481481481,top:51.71759259259262,width:420,height:58,lineHeight:1.2,content:"<p style='text-align: center;'><strong><span style='color: #ffffff;'><span style='font-size: 32px'>2.Please enter a title</span></span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{themeColor}}"},{type:"text",id:"BNQSpC",left:510.6481481481481,top:131.78240740740745,width:420,height:129,content:"<p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p ><p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"text",id:"Vr38Nu",left:69.35185185185185,top:301.71759259259255,width:420,height:58,lineHeight:1.2,content:"<p style='text-align: center;'><strong><span style='color: #ffffff;'><span style='font-size: 32px'>3.Please enter a title</span></span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{themeColor}}"},{type:"text",id:"IwKRSu",left:69.35185185185185,top:381.7824074074074,width:420,height:129,content:"<p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p ><p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"text",id:"0Opr1v",left:510.64814814814815,top:301.71759259259255,width:420,height:58,lineHeight:1.2,content:"<p style='text-align: center;'><strong><span style='color: #ffffff;'><span style='font-size: 32px'>4.Please enter a title</span></span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{themeColor}}"},{type:"text",id:"4L9Uzz",left:510.64814814814815,top:381.7824074074074,width:420,height:129,content:"<p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p><p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p ><p style='text-align: center;'><span style='font-size: 22px'>Enter content here</span></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"}],background:{type:"solid",color:"{{backgroundColor}}"}},{id:"template",elements:[{type:"text",id:"GdEGxg",left:134.53703703703704,top:127.25,width:152.77777777777777,height:308,lineHeight:1.8,content:"<p style='text-align: center;'><strong><span style='color: #ffffff;'><span style='font-size: 40px'>Please enter title here</span></span></strong></p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",wordSpace:8,fill:"{{themeColor}}"},{type:"text",id:"y5sAfw",left:332.8703703703704,top:127.25,width:532.5925925925926,height:50,content:"<blockquote><p style=''>Please enter content here1</p></blockquote>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"text",id:"VeuocM",left:332.8703703703704,top:212.0648148148148,width:532.5925925925926,height:50,content:"<blockquote><p style=''>Please enter content here 2</p></blockquote>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"text",id:"RyFWQe",left:332.8703703703704,top:296.8796296296296,width:532.5925925925926,height:50,content:"<blockquote><p style=''>Please enter content here 3</p></blockquote>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"text",id:"Q56viI",left:332.8703703703704,top:381.69444444444446,width:532.5925925925926,height:50,content:"<blockquote><p style=''>Please enter content here 4</p></blockquote>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"}],background:{type:"solid",color:"{{backgroundColor}}"}},{id:"template",elements:[{type:"shape",id:"SUWirT",left:73.8888888888889,top:64.21296296296302,width:49.629629629629626,height:49.629629629629626,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!1,rotate:0,text:{content:"<p style='text-align: center;'><span style='color: #ffffff;'>1</span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"text",id:"YjzN1M",left:148.70370370370372,top:64.21296296296302,width:323.7037037037037,height:120,content:"<p style=''>Enter content here</p><p style=''>Enter content here</p><p style=''>Enter content here</p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"shape",id:"fS09I7",left:527.5925925925926,top:64.21296296296302,width:49.629629629629626,height:49.629629629629626,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!1,rotate:0,text:{content:"<p style='text-align: center;'><span style='color: #ffffff;'>2</span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"text",id:"qCnfB1",left:602.4074074074074,top:64.21296296296302,width:323.7037037037037,height:120,content:"<p style=''>在此输入内容</p><p style=''>Enter content here</p><p style=''>Enter content here</p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"shape",id:"difAAT",left:73.8888888888889,top:221.25000000000003,width:49.629629629629626,height:49.629629629629626,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!1,rotate:0,text:{content:"<p style='text-align: center;'><span style='color: #ffffff;'>3</span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"text",id:"EUlvMo",left:148.70370370370372,top:221.25000000000003,width:323.7037037037037,height:120,content:"<p style=''>Enter content here</p><p style=''>Enter content here</p><p style=''>Enter content here</p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"shape",id:"US_9jB",left:527.5925925925926,top:221.25000000000003,width:49.629629629629626,height:49.629629629629626,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!1,rotate:0,text:{content:"<p style='text-align: center;'><span style='color: #ffffff;'>4</span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"text",id:"243MnQ",left:602.4074074074074,top:221.25000000000003,width:323.7037037037037,height:120,content:"<p style=''>Enter content here</p><p style=''>Enter content here</p><p style=''>Enter content here</p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"shape",id:"Y_KUj0",left:73.8888888888889,top:378.287037037037,width:49.629629629629626,height:49.629629629629626,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!1,rotate:0,text:{content:"<p style='text-align: center;'><span style='color: #ffffff;'>5</span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"text",id:"9GglMe",left:148.70370370370372,top:378.287037037037,width:323.7037037037037,height:120,content:"<p style=''>Enter content here</p><p style=''>Enter content here</p><p style=''>Enter content here</p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"},{type:"shape",id:"eSInje",left:527.5925925925926,top:378.287037037037,width:49.629629629629626,height:49.629629629629626,viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",fill:"{{themeColor}}",fixedRatio:!1,rotate:0,text:{content:"<p style='text-align: center;'><span style='color: #ffffff;'>6</span></p>",defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",align:"middle"}},{type:"text",id:"0S3yUg",left:602.4074074074074,top:378.287037037037,width:323.7037037037037,height:120,content:"<p style=''>Enter content here</p><p style=''>Enter content here</p><p style=''>Enter content here</p>",rotate:0,defaultFontName:"{{fontName}}",defaultColor:"{{fontColor}}",fill:"{{subColor}}"}],background:{type:"solid",color:"{{backgroundColor}}"}}],V=(0,o.Q_)("slides",{state:function(){return{title:"Unnamed presentation",theme:j,slides:N,slideIndex:0,viewportRatio:.5625}},getters:{currentSlide:function(e){return e.slides[e.slideIndex]},currentSlideAnimations:function(e){var t=e.slides[e.slideIndex];if(null===t||void 0===t||!t.animations)return[];var n=t.elements,l=n.map((function(e){return e.id}));return t.animations.filter((function(e){return l.includes(e.elId)}))},formatedAnimations:function(e){var t=e.slides[e.slideIndex];if(null===t||void 0===t||!t.animations)return[];var n,l=t.elements,a=l.map((function(e){return e.id})),o=t.animations.filter((function(e){return a.includes(e.elId)})),i=[],r=(0,y.Z)(o);try{var u=function(){var e=n.value;if("click"!==e.trigger&&i.length){if("meantime"===e.trigger){var t=i[i.length-1];t.animations=t.animations.filter((function(t){return t.elId!==e.elId})),t.animations.push(e),i[i.length-1]=t}else if("auto"===e.trigger){var l=i[i.length-1];l.autoNext=!0,i[i.length-1]=l,i.push({animations:[e],autoNext:!1})}}else i.push({animations:[e],autoNext:!1})};for(r.s();!(n=r.n()).done;)u()}catch(c){r.e(c)}finally{r.f()}return i},layouts:function(e){var t=e.theme,n=t.themeColor,l=t.fontColor,a=t.fontName,o=t.backgroundColor,i=(0,B.Z)(l).isDark()?"rgba(230, 230, 230, 0.5)":"rgba(180, 180, 180, 0.5)",r=JSON.stringify(Y).replaceAll("{{themeColor}}",n).replaceAll("{{fontColor}}",l).replaceAll("{{fontName}}",a).replaceAll("{{backgroundColor}}",o).replaceAll("{{subColor}}",i);return JSON.parse(r)}},actions:{setTitle:function(e){this.title=e||"未命名演示文稿"},setTheme:function(e){this.theme=(0,g.Z)((0,g.Z)({},this.theme),e)},setViewportRatio:function(e){this.viewportRatio=e},setSlides:function(e){this.slides=e},addSlide:function(e){var t,n=Array.isArray(e)?e:[e],l=this.slideIndex+1;(t=this.slides).splice.apply(t,[l,0].concat((0,R.Z)(n))),this.slideIndex=l},updateSlide:function(e){var t=this.slideIndex;this.slides[t]=(0,g.Z)((0,g.Z)({},this.slides[t]),e)},deleteSlide:function(e){for(var t=this,n=Array.isArray(e)?e:[e],l=[],a=function(e){var a=t.slides.findIndex((function(t){return t.id===n[e]}));l.push(a)},o=0;o<n.length;o++)a(o);var i=Math.min.apply(Math,l),r=this.slides.length-n.length-1;i>r&&(i=r),this.slideIndex=i,this.slides=this.slides.filter((function(e){return!n.includes(e.id)}))},updateSlideIndex:function(e){this.slideIndex=e},addElement:function(e){var t=Array.isArray(e)?e:[e],n=this.slides[this.slideIndex].elements,l=[].concat((0,R.Z)(n),(0,R.Z)(t));this.slides[this.slideIndex].elements=l},deleteElement:function(e){var t=Array.isArray(e)?e:[e],n=this.slides[this.slideIndex].elements,l=n.filter((function(e){return!t.includes(e.id)}));this.slides[this.slideIndex].elements=l},updateElement:function(e){var t=e.id,n=e.props,l=e.slideId,a="string"===typeof t?[t]:t,o=l?this.slides.findIndex((function(e){return e.id===l})):this.slideIndex,i=this.slides[o],r=i.elements.map((function(e){return a.includes(e.id)?(0,g.Z)((0,g.Z)({},e),n):e}));this.slides[o].elements=r},removeElementProps:function(e){var t=e.id,n=e.propName,l="string"===typeof n?[n]:n,a=this.slideIndex,o=this.slides[a],i=o.elements.map((function(e){return e.id===t?(0,z.omit)(e,l):e}));this.slides[a].elements=i}}}),J=(0,s.kP)("0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz"),q=J(10),X=(0,o.Q_)("main",{state:function(){return{activeElementIdList:[],handleElementId:"",activeGroupElementId:"",hiddenElementIdList:[],canvasPercentage:90,canvasScale:1,canvasDragged:!1,thumbnailsFocus:!1,editorAreaFocus:!1,disableHotkeys:!1,gridLineSize:0,showRuler:!1,creatingElement:null,creatingCustomShape:!1,availableFonts:A,toolbarState:l.SLIDE_DESIGN,clipingImageElementId:"",richTextAttrs:F,selectedTableCells:[],isScaling:!1,selectedSlidesIndex:[],dialogForExport:"",databaseId:q,textFormatPainter:null,shapeFormatPainter:null,showSelectPanel:!1,showSearchPanel:!1}},getters:{activeElementList:function(e){var t=V(),n=t.currentSlide;return n&&n.elements?n.elements.filter((function(t){return e.activeElementIdList.includes(t.id)})):[]},handleElement:function(e){var t=V(),n=t.currentSlide;return n&&n.elements&&n.elements.find((function(t){return e.handleElementId===t.id}))||null}},actions:{setActiveElementIdList:function(e){1===e.length?this.handleElementId=e[0]:this.handleElementId="",this.activeElementIdList=e},setHandleElementId:function(e){this.handleElementId=e},setActiveGroupElementId:function(e){this.activeGroupElementId=e},setHiddenElementIdList:function(e){this.hiddenElementIdList=e},setCanvasPercentage:function(e){this.canvasPercentage=e},setCanvasScale:function(e){this.canvasScale=e},setCanvasDragged:function(e){this.canvasDragged=e},setThumbnailsFocus:function(e){this.thumbnailsFocus=e},setEditorareaFocus:function(e){this.editorAreaFocus=e},setDisableHotkeysState:function(e){this.disableHotkeys=e},setGridLineSize:function(e){this.gridLineSize=e},setRulerState:function(e){this.showRuler=e},setCreatingElement:function(e){this.creatingElement=e},setCreatingCustomShapeState:function(e){this.creatingCustomShape=e},setAvailableFonts:function(){this.availableFonts=A.filter((function(e){return P(e.value)}))},setToolbarState:function(e){this.toolbarState=e},setClipingImageElementId:function(e){this.clipingImageElementId=e},setRichtextAttrs:function(e){this.richTextAttrs=e},setSelectedTableCells:function(e){this.selectedTableCells=e},setScalingState:function(e){this.isScaling=e},updateSelectedSlidesIndex:function(e){this.selectedSlidesIndex=e},setDialogForExport:function(e){this.dialogForExport=e},setTextFormatPainter:function(e){this.textFormatPainter=e},setShapeFormatPainter:function(e){this.shapeFormatPainter=e},setSelectPanelState:function(e){this.showSelectPanel=e},setSearchPanelState:function(e){this.showSearchPanel=e}}}),G=(n(76265),n(62833)),K=n(13087),Q=n(52417),$=n(93806),ee=n(25744),te=n(82482),ne=n(56084),le=(n(30024),n(78134)),ae="Paperport_DISCARDED_DB",oe="Paperport",ie=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){var t,n,l,a,o,r,u,c;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=(new Date).getTime(),n=localStorage.getItem(ae),l=n?JSON.parse(n):[],e.next=5,le.Z.getDatabaseNames();case 5:a=e.sent,o=a.filter((function(e){if(-1===e.indexOf(oe))return!1;var n=e.split("_"),a=(0,ne.Z)(n,3),o=a[0],i=a[1],r=a[2];return o!==oe||!i||!r||(!!l.includes(i)||t-+r>=432e5)})),r=(0,y.Z)(o);try{for(r.s();!(u=r.n()).done;)c=u.value,le.Z["delete"](c)}catch(i){r.e(i)}finally{r.f()}localStorage.removeItem(ae);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),re=function(e){(0,$.Z)(n,e);var t=(0,ee.Z)(n);function n(){var e;return(0,K.Z)(this,n),e=t.call(this,"".concat(oe,"_").concat(q,"_").concat((new Date).getTime())),(0,te.Z)((0,Q.Z)(e),"snapshots",void 0),(0,te.Z)((0,Q.Z)(e),"writingBoardImgs",void 0),e.version(1).stores({snapshots:"++id",writingBoardImgs:"++id"}),e.snapshots=e.table("snapshots"),e.writingBoardImgs=e.table("writingBoardImgs"),e}return(0,G.Z)(n)}(le.Z),ue=new re,ce=(0,o.Q_)("snapshot",{state:function(){return{snapshotCursor:-1,snapshotLength:0}},getters:{canUndo:function(e){return e.snapshotCursor>0},canRedo:function(e){return e.snapshotCursor<e.snapshotLength-1}},actions:{setSnapshotCursor:function(e){this.snapshotCursor=e},setSnapshotLength:function(e){this.snapshotLength=e},initSnapshotDatabase:function(){var e=this;return(0,r.Z)((0,i.Z)().mark((function t(){var n,l;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=V(),l={index:n.slideIndex,slides:n.slides},t.next=4,ue.snapshots.add(l);case 4:e.setSnapshotCursor(0),e.setSnapshotLength(1);case 6:case"end":return t.stop()}}),t)})))()},addSnapshot:function(){var e=this;return(0,r.Z)((0,i.Z)().mark((function t(){var n,l,a,o,r,u;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=V(),t.next=3,ue.snapshots.orderBy("id").keys();case 3:return l=t.sent,a=[],e.snapshotCursor>=0&&e.snapshotCursor<l.length-1&&(a=l.slice(e.snapshotCursor+1)),o={index:n.slideIndex,slides:n.slides},t.next=9,ue.snapshots.add(o);case 9:return r=l.length-a.length+1,u=20,r>u&&(a.push(l[0]),r--),r>=2&&ue.snapshots.update(l[r-2],{index:n.slideIndex}),t.next=15,ue.snapshots.bulkDelete(a);case 15:e.setSnapshotCursor(r-1),e.setSnapshotLength(r);case 17:case"end":return t.stop()}}),t)})))()},unDo:function(){var e=this;return(0,r.Z)((0,i.Z)().mark((function t(){var n,l,a,o,r,u,c,s;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.snapshotCursor<=0)){t.next=2;break}return t.abrupt("return");case 2:return n=V(),l=X(),a=e.snapshotCursor-1,t.next=7,ue.snapshots.orderBy("id").toArray();case 7:o=t.sent,r=o[a],u=r.index,c=r.slides,s=u>c.length-1?c.length-1:u,n.setSlides(c),n.updateSlideIndex(s),e.setSnapshotCursor(a),l.setActiveElementIdList([]);case 15:case"end":return t.stop()}}),t)})))()},reDo:function(){var e=this;return(0,r.Z)((0,i.Z)().mark((function t(){var n,l,a,o,r,u,c,s;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!(e.snapshotCursor>=e.snapshotLength-1)){t.next=2;break}return t.abrupt("return");case 2:return n=V(),l=X(),a=e.snapshotCursor+1,t.next=7,ue.snapshots.orderBy("id").toArray();case 7:o=t.sent,r=o[a],u=r.index,c=r.slides,s=u>c.length-1?c.length-1:u,n.setSlides(c),n.updateSlideIndex(s),e.setSnapshotCursor(a),l.setActiveElementIdList([]);case 15:case"end":return t.stop()}}),t)})))()}}}),se=(0,o.Q_)("keyboard",{state:function(){return{ctrlKeyState:!1,shiftKeyState:!1,spaceKeyState:!1}},getters:{ctrlOrShiftKeyActive:function(e){return e.ctrlKeyState||e.shiftKeyState}},actions:{setCtrlKeyState:function(e){this.ctrlKeyState=e},setShiftKeyState:function(e){this.shiftKeyState=e},setSpaceKeyState:function(e){this.spaceKeyState=e}}}),de=(0,o.Q_)("screen",{state:function(){return{screening:!1}},actions:{setScreening:function(e){this.screening=e}}}),fe=(n(22462),function(e,t){return(0,z.padStart)(""+e,t,"0")}),ve=function(){return!navigator.userAgent.match(/(iPhone|iPod|iPad|Android|Mobile|BlackBerry|Symbian|Windows Phone)/i)},pe=(n(79288),n(3577));(function(e){e["UP"]="up",e["DOWN"]="down",e["TOP"]="top",e["BOTTOM"]="bottom"})(d||(d={})),function(e){e["TOP"]="top",e["BOTTOM"]="bottom",e["LEFT"]="left",e["RIGHT"]="right",e["VERTICAL"]="vertical",e["HORIZONTAL"]="horizontal",e["CENTER"]="center"}(f||(f={})),function(e){e["T"]="top",e["B"]="bottom",e["L"]="left",e["R"]="right"}(v||(v={})),function(e){e["LEFT_TOP"]="left-top",e["TOP"]="top",e["RIGHT_TOP"]="right-top",e["LEFT"]="left",e["RIGHT"]="right",e["LEFT_BOTTOM"]="left-bottom",e["BOTTOM"]="bottom",e["RIGHT_BOTTOM"]="right-bottom"}(p||(p={})),function(e){e["START"]="start",e["END"]="end",e["C"]="ctrl",e["C1"]="ctrl1",e["C2"]="ctrl2"}(h||(h={})),function(e){e["C"]="C",e["X"]="X",e["Z"]="Z",e["Y"]="Y",e["A"]="A",e["G"]="G",e["L"]="L",e["F"]="F",e["D"]="D",e["B"]="B",e["P"]="P",e["MINUS"]="-",e["EQUAL"]="=",e["DIGIT_0"]="0",e["DELETE"]="DELETE",e["UP"]="ARROWUP",e["DOWN"]="ARROWDOWN",e["LEFT"]="ARROWLEFT",e["RIGHT"]="ARROWRIGHT",e["ENTER"]="ENTER",e["SPACE"]=" ",e["TAB"]="TAB",e["BACKSPACE"]="BACKSPACE",e["ESC"]="ESCAPE",e["PAGEUP"]="PAGEUP",e["PAGEDOWN"]="PAGEDOWN",e["F5"]="F5"}(m||(m={}));var he=[{type:"universal",children:[{label:"Cut",value:"Ctrl + X"},{label:"Copy",value:"Ctrl + C"},{label:"Paste",value:"Ctrl + V"},{label:"Paste as plain text",value:"Ctrl + Shift + V"},{label:"Quick copy and paste",value:"Ctrl + D"},{label:"Select All",value:"Ctrl + A"},{label:"Undo",value:"Ctrl + Z"},{label:"Restore",value:"Ctrl + Y"},{label:"Delete",value:"Delete / Backspace"},{label:"Multiple selection",value:"Hold down Ctrl or Shift"},{label:"Turn on search and replace",value:"Ctrl + F"},{label:"Print",value:"Ctrl + P"},{label:"Close pop-up window",value:"ESC"}]},{type:"slide show",children:[{label:"Show slide show from the beginning",value:"F5"},{label:"Show slideshow starting from current moment",value:"Shift + F5"},{label:"Switch to previous page",value:"↑ / ← / PgUp"},{label:"Switch to next page",value:"↓ / → / PgDown"},{label:"Switch to next page",value:"Enter / Space"},{label:"Exit show",value:"ESC"}]},{type:"Slide Edit",children:[{label:"New Slide",value:"Enter"},{label:"Move canvas",value:"Space + mouse drag"},{label:"Zoom canvas",value:"Ctrl + mouse wheel"},{label:"Enlarge canvas",value:"Ctrl + ="},{label:"Reduce canvas",value:"Ctrl + -"},{label:"Adapt canvas to current screen",value:"Ctrl + 0"},{label:"Previous page (unselected element)",value:"↑ / ←"},{label:"Next page (unselected element)",value:"↓ / →"},{label:"Previous page",value:"Mouse scroll up / PgUp"},{label:"Next page",value:"Mouse scroll down / PgDown"}]},{type:"Element operation",children:[{label:"Move",value:"↑ / ← / ↓ / →"},{label:"Lock",value:"Ctrl + L"},{label:"combination",value:"Ctrl + G"},{label:"Ungroup",value:"Ctrl + Shift + G"},{label:"Bring to top",value:"Alt + F"},{label:"Set to bottom",value:"Alt + B"},{label:"Lock aspect ratio",value:"Hold down Ctrl or Shift"},{label:"Create horizontal/vertical lines",value:"Hold Ctrl or Shift"},{label:"Switch focus element",value:"Tab"},{label:"Confirm image cropping",value:"Enter"}]},{type:"Table editing",children:[{label:"Focus on next cell",value:"Tab"},{label:"Insert a line above",value:"Ctrl + ↑"},{label:"Insert a line below",value:"Ctrl + ↓"},{label:"Insert a column on the left",value:"Ctrl + ←"},{label:"Insert a column on the right",value:"Ctrl + →"}]},{type:"Chart data editing",children:[{label:"Focus on the next line",value:"Enter"}]},{type:"TextEdit",children:[{label:"Bold",value:"Ctrl + B"},{label:"italic",value:"Ctrl + I"},{label:"underline",value:"Ctrl + U"},{label:"inline code",value:"Ctrl + E"},{label:"Superscript",value:"Ctrl + ;"},{label:"subscript",value:"Ctrl + '"},{label:"Selected paragraph",value:"ESC"}]}],me=(n(77049),n(21694),n(42152)),ge=n.n(me),ye=(n(68932),n(12826),n(81354)),we=n.n(ye),xe="ppt",be=function(e){return we().AES.encrypt(e,xe).toString()},ke=function(e){var t=we().AES.decrypt(e,xe);return t.toString(we().enc.Utf8)},_e=function(e){return new Promise((function(t,n){var l=document.createElement("button"),a=new(ge())(l,{text:function(){return e},action:function(){return"copy"},container:document.body});a.on("success",(function(e){a.destroy(),t(e)})),a.on("error",(function(e){a.destroy(),n(e)})),document.body.appendChild(l),l.click(),document.body.removeChild(l)}))},Ie=function(){return new Promise((function(e,t){var n;null!==(n=navigator.clipboard)&&void 0!==n&&n.readText?navigator.clipboard.readText().then((function(n){return n||t("Clipboard is empty or contains no text"),e(n)})):t("The browser does not support or prohibits access to the clipboard, please use the shortcut key Ctrl + V")}))},Se=function(e){var t;try{t=JSON.parse(ke(e))}catch(n){t=e}return t},Ce=function(e){var t=e.split("\r\n");""===t[t.length-1]&&t.pop();var n=-1,l=[];for(var a in t){if(l[a]=t[a].split("\t"),1===l[a].length)return null;if(-1===n)n=l[a].length;else if(n!==l[a].length)return null}return l},Le=(n(49693),n(47522),function(e){var t=e.left,n=e.top,l=e.width,a=e.height,o=e.rotate,i=void 0===o?0:o,r=Math.sqrt(Math.pow(l,2)+Math.pow(a,2))/2,u=180*Math.atan(a/l)/Math.PI,c=(180-i-u)*Math.PI/180,s=(u-i)*Math.PI/180,d=t+l/2,f=n+a/2,v=[d+r*Math.cos(c),d+r*Math.cos(s),d-r*Math.cos(c),d-r*Math.cos(s)],p=[f-r*Math.sin(c),f-r*Math.sin(s),f+r*Math.sin(c),f+r*Math.sin(s)];return{xRange:[Math.min.apply(Math,v),Math.max.apply(Math,v)],yRange:[Math.min.apply(Math,p),Math.max.apply(Math,p)]}}),Ee=function(e){var t=Le({left:e.left,top:e.top,width:e.width,height:e.height,rotate:0}),n=t.xRange,l=t.yRange,a=Le({left:e.left,top:e.top,width:e.width,height:e.height,rotate:e.rotate}),o=a.xRange,i=a.yRange;return{offsetX:o[0]-n[0],offsetY:i[0]-l[0]}},Ze=function(e){var t,n,l,a;if("line"===e.type)t=e.left,n=e.left+Math.max(e.start[0],e.end[0]),l=e.top,a=e.top+Math.max(e.start[1],e.end[1]);else if("rotate"in e&&e.rotate){var o=e.left,i=e.top,r=e.width,u=e.height,c=e.rotate,s=Le({left:o,top:i,width:r,height:u,rotate:c}),d=s.xRange,f=s.yRange;t=d[0],n=d[1],l=f[0],a=f[1]}else t=e.left,n=e.left+e.width,l=e.top,a=e.top+e.height;return{minX:t,maxX:n,minY:l,maxY:a}},Te=function(e){var t=[],n=[],l=[],a=[];e.forEach((function(e){var o=Ze(e),i=o.minX,r=o.maxX,u=o.minY,c=o.maxY;t.push(i),n.push(u),l.push(r),a.push(c)}));var o=Math.min.apply(Math,t),i=Math.max.apply(Math,l),r=Math.min.apply(Math,n),u=Math.max.apply(Math,a);return{minX:o,maxX:i,minY:r,maxY:u}},Me=function(e){var t=[];return e.forEach((function(e){var n=t.findIndex((function(t){return t.value===e.value}));if(-1===n)t.push(e);else{var l=t[n],a=Math.min(l.range[0],e.range[0]),o=Math.max(l.range[1],e.range[1]),i=[a,o],r={value:e.value,range:i};t[n]=r}})),t},Ue=function(e){var t,n={},l=(0,y.Z)(e);try{for(l.s();!(t=l.n()).done;){var a=t.value;n[a.id]=(0,s.x0)(10)}}catch(o){l.e(o)}finally{l.f()}return n},We=function(e){var t,n={},l={},a=(0,y.Z)(e);try{for(a.s();!(t=a.n()).done;){var o=t.value,i=o.groupId;i&&!n[i]&&(n[i]=(0,s.x0)(10)),l[o.id]=(0,s.x0)(10)}}catch(r){a.e(r)}finally{a.f()}return{groupIdMap:n,elIdMap:l}},De=function(e){var t=(0,B.Z)(e);return[t.setAlpha(.3).toRgbString(),t.setAlpha(.1).toRgbString()]},He=function(e){var t=e.start.join(","),n=e.end.join(",");if(e.broken){var l=e.broken.join(",");return"M".concat(t," L").concat(l," L").concat(n)}if(e.curve){var a=e.curve.join(",");return"M".concat(t," Q").concat(a," ").concat(n)}if(e.cubic){var o=(0,ne.Z)(e.cubic,2),i=o[0],r=o[1],u=i.join(","),c=r.join(",");return"M".concat(t," C").concat(u," ").concat(c," ").concat(n)}return"M".concat(t," L").concat(n)},Fe=function(e,t){var n=e.getBoundingClientRect(),l=t.getBoundingClientRect();return n.top>=l.top&&n.bottom<=l.bottom},Ae=(n(96869),n(46108)),Oe=n(71061),Pe=n(68261),Re=n(19512),Be=n(92025),ze=n(29872),Ne=n(61321),je=n(82696),Ye=n(63271),Ve=n(99015),Je=n(95761),qe=n(57559),Xe=n(94023),Ge=n(64141),Ke=n(65010),Qe=n(76492),$e=n(51094),et=n(12677),tt=n(10683),nt=n(67259),lt=n(31258),at=n(49978),ot=n(30597),it=n(70085),rt=n(6071),ut=n(22489),ct=n(49925),st=n(35361),dt=n(73185),ft=n(50139),vt=n(28461),pt=n(22882),ht=n(53862),mt=n(23764),gt=n(9371),yt=n(89912),wt=n(23935),xt=n(3735),bt=n(83542),kt=n(77537),_t=n(75314),It=n(13325),St=n(73275),Ct=n(13317),Lt=n(47712),Et=n(89370),Zt=n(32778),Tt=n(64422),Mt=n(44957),Ut=n(87872),Wt=n(95356),Dt=n(78684),Ht=n(29577),Ft=n(887),At=n(6866),Ot=n(19527),Pt=n(37606),Rt=n(34412),Bt=n(98814),zt=n(42057),Nt=n(6048),jt=n(25114),Yt=n(19917),Vt=n(87747),Jt=n(47425),qt=n(16717),Xt=n(76302),Gt=n(53060),Kt=n(67107),Qt=n(52100),$t=n(25460),en=n(15268),tn=n(71432),nn=n(25193),ln=n(14566),an=n(7091),on=n(19602),rn=n(74891),un=n(74012),cn=n(33681),sn=n(11440),dn=n(33482),fn=n(80646),vn=n(38e3),pn=n(74628),hn=n(29141),mn=n(71060),gn=n(48389),yn=n(3467),wn=n(66935),xn=n(43590),bn=n(26453),kn=n(5957),_n=n(94705),In=n(85547),Sn=n(75650),Cn=n(92790),Ln=n(75620),En=n(33339),Zn=n(74666),Tn=n(75215),Mn=n(90904),Un=n(83650),Wn=n(4296),Dn=n(66519),Hn=n(44790),Fn=n(63260),An=n(22146),On=n(26755),Pn=n(72849),Rn=n(26940),Bn=n(76116),zn=n(25741),Nn=n(12939),jn=n(79524),Yn=n(66135),Vn=n(76821),Jn=n(6149),qn={IconPlayOne:Jn.Z,IconFullScreenPlay:Vn.Z,IconLock:Yn.Z,IconUnlock:jn.Z,IconPpt:Nn.Z,IconFormat:zn.Z,IconPicture:Bn.Z,IconFullScreen:Rn.Z,IconList:Pn.Z,IconOrderedList:On.Z,IconFlipVertically:An.Z,IconFlipHorizontally:Fn.Z,IconFontSize:Hn.Z,IconCode:Dn.Z,IconTextBold:Wn.Z,IconTextItalic:Un.Z,IconTextUnderline:Mn.Z,IconStrikethrough:Tn.Z,IconEdit:Zn.Z,IconQuote:En.Z,IconBackgroundColor:Ln.Z,IconGroup:Cn.Z,IconUngroup:Sn.Z,IconBack:In.Z,IconNext:_n.Z,IconFullwidth:kn.Z,IconAlignTop:bn.Z,IconAlignLeft:xn.Z,IconAlignRight:wn.Z,IconAlignBottom:yn.Z,IconAlignVertically:gn.Z,IconAlignHorizontally:mn.Z,IconBringToFront:hn.Z,IconSendToBack:pn.Z,IconAlignTextLeft:vn.Z,IconAlignTextRight:fn.Z,IconAlignTextCenter:dn.Z,IconAlignTextBoth:sn.Z,IconRowHeight:cn.Z,IconWrite:un.Z,IconInsertTable:rn.Z,IconAddText:on.Z,IconFill:an.Z,IconTailoring:ln.Z,IconEffects:nn.Z,IconColorFilter:tn.Z,IconUp:en.Z,IconDown:$t.Z,IconPlus:Qt.Z,IconMinus:Kt.Z,IconConnection:Gt.Z,IconBringToFrontOne:Xt.Z,IconSentToBack:qt.Z,IconGithub:Jt.Z,IconChartProportion:Vt.Z,IconChartHistogram:Yt.Z,IconChartHistogramOne:jt.Z,IconChartLineArea:Nt.Z,IconChartRing:zt.Z,IconChartScatter:Bt.Z,IconChartLine:Rt.Z,IconChartPie:Pt.Z,IconText:Ot.Z,IconRotate:At.Z,IconLeftTwo:Ft.Z,IconRightTwo:Ht.Z,IconPlatte:Dt.Z,IconClose:Wt.Z,IconCloseSmall:Ut.Z,IconUndo:Mt.Z,IconTransform:Tt.Z,IconClick:Zt.Z,IconTheme:Et.Z,IconArrowCircleLeft:Lt.Z,IconGraphicDesign:Ct.Z,IconLogout:St.Z,IconErase:It.Z,IconClear:_t.Z,IconAlignTextTopOne:kt.Z,IconAlignTextBottomOne:bt.Z,IconAlignTextMiddleOne:xt.Z,IconPause:wt.Z,IconVolumeMute:yt.Z,IconVolumeNotice:gt.Z,IconVolumeSmall:mt.Z,IconVideoTwo:ht.Z,IconFormula:pt.Z,IconLinkOne:vt.Z,IconFullScreenOne:ft.Z,IconOffScreenOne:dt.Z,IconPower:st.Z,IconListView:ct.Z,IconMagic:ut.Z,IconHighLight:rt.Z,IconDownload:it.Z,IconIndentLeft:ot.Z,IconIndentRight:at.Z,IconVerticalSpacingBetweenItems:lt.Z,IconCopy:nt.Z,IconDelete:tt.Z,IconSquare:et.Z,IconRound:$e.Z,IconNeedle:Qe.Z,IconTextRotationNone:Ke.Z,IconTextRotationDown:Ge.Z,IconFormatBrush:Xe.Z,IconPreviewOpen:qe.Z,IconPreviewClose:Je.Z,IconStopwatchStart:Ve.Z,IconSearch:Ye.Z,IconLeft:je.Z,IconRight:Ne.Z,IconMoveOne:ze.Z,IconHamburgerButton:Be.Z,IconAttention:Re.Z,IconCheckOne:Pe.Z,IconCloseOne:Oe.Z,IconInfo:Ae.Z};const Xn={install:function(e){for(var t=0,n=Object.keys(qn);t<n.length;t++){var l=n[t];e.component(l,qn[l])}}};var Gn=["id"],Kn={class:"icons"},Qn={class:"content"},$n={key:0,class:"title"},el={class:"description"},tl={key:0,class:"control"};const nl=(0,u.aZ)({__name:"Message",props:{id:{},message:{},type:{default:"success"},title:{default:""},duration:{default:3e3},closable:{type:Boolean,default:!1}},emits:["close","destroy"],setup:function(e,t){var n=t.expose,l=t.emit,o=qn.IconAttention,i=qn.IconCheckOne,r=qn.IconCloseOne,s=qn.IconInfo,d=qn.IconCloseSmall,f=e,v=l,p=(0,c.iH)(!0),h=(0,c.iH)(null),m=function(){f.duration<=0||(h.value=setTimeout(y,f.duration))},g=function(){h.value&&clearTimeout(h.value)},y=function(){return p.value=!1};return(0,u.wF)((function(){g()})),(0,u.bv)((function(){m()})),n({close:y}),function(e,t){return(0,u.wg)(),(0,u.j4)(a.uT,{name:"message-fade",appear:"",mode:"in-out",onBeforeLeave:t[3]||(t[3]=function(e){return v("close")}),onAfterLeave:t[4]||(t[4]=function(e){return v("destroy")})},{default:(0,u.w5)((function(){return[p.value?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"message",id:e.id},[(0,u._)("div",{class:"message-container",onMouseenter:t[1]||(t[1]=function(e){return g()}),onMouseleave:t[2]||(t[2]=function(e){return m()})},[(0,u._)("div",Kn,["warning"===e.type?((0,u.wg)(),(0,u.j4)((0,c.SU)(o),{key:0,theme:"filled",size:"18",fill:"#faad14"})):(0,u.kq)("",!0),"success"===e.type?((0,u.wg)(),(0,u.j4)((0,c.SU)(i),{key:1,theme:"filled",size:"18",fill:"#52c41a"})):(0,u.kq)("",!0),"error"===e.type?((0,u.wg)(),(0,u.j4)((0,c.SU)(r),{key:2,theme:"filled",size:"18",fill:"#ff4d4f"})):(0,u.kq)("",!0),"info"===e.type?((0,u.wg)(),(0,u.j4)((0,c.SU)(s),{key:3,theme:"filled",size:"18",fill:"#1677ff"})):(0,u.kq)("",!0)]),(0,u._)("div",Qn,[e.title?((0,u.wg)(),(0,u.iD)("div",$n,(0,pe.zw)(e.title),1)):(0,u.kq)("",!0),(0,u._)("div",el,(0,pe.zw)(e.message),1)]),e.closable?((0,u.wg)(),(0,u.iD)("div",tl,[(0,u._)("span",{class:"close-btn",onClick:t[0]||(t[0]=function(e){return y()})},[(0,u.Wm)((0,c.SU)(d))])])):(0,u.kq)("",!0)],32)],8,Gn)):(0,u.kq)("",!0)]})),_:1})}}});var ll=n(83744);const al=(0,ll.Z)(nl,[["__scopeId","data-v-2231702e"]]),ol=al;var il=[],rl=null,ul=0,cl={duration:3e3},sl=function e(t){var n="message-"+ul++,l=(0,g.Z)((0,g.Z)((0,g.Z)({},cl),t),{},{id:n});rl||(rl=document.createElement("div"),rl.className="message-wrap",rl.style.cssText="\n      width: 100%;\n      position: fixed;\n      top: 0;\n      left: 0;\n      z-index: 6000;\n      pointer-events: none;\n      display: flex;\n      flex-direction: column;\n      box-sizing: border-box;\n      padding: 15px;\n      background-color: rgba(255, 255, 255, 0);\n      transition: all 1s ease-in-out;\n      align-items: center;\n    ",document.body.appendChild(rl));var o=(0,u.Wm)(ol,l,null),i=document.createElement("div");o.appContext=t.ctx||e._context||null,o.props.onClose=t.onClose,o.props.onDestroy=function(){rl&&rl.childNodes.length<=1&&(rl.remove(),rl=null),(0,a.sY)(null,i)},(0,a.sY)(o,i),rl.appendChild(i.firstElementChild);var r={id:n,close:function(){var e;return null===o||void 0===o||null===(e=o.component)||void 0===e||null===(e=e.exposed)||void 0===e?void 0:e.close()}};return il.push(r),r};sl.success=function(e,t){return sl((0,g.Z)((0,g.Z)({},t),{},{type:"success",message:e}))},sl.info=function(e,t){return sl((0,g.Z)((0,g.Z)({},t),{},{type:"info",message:e}))},sl.warning=function(e,t){return sl((0,g.Z)((0,g.Z)({},t),{},{type:"warning",message:e}))},sl.error=function(e,t){return sl((0,g.Z)((0,g.Z)({},t),{},{type:"error",message:e}))},sl.closeAll=function(){for(var e=il.length-1;e>=0;e--)il[e].close()};const dl=sl;var fl,vl,pl,hl=n(3336),ml=function(e){var t,n=e.replace(/[\n\r]+/g,"<br>"),l=n.split("<br>"),a="",o=(0,y.Z)(l);try{for(o.s();!(t=o.n()).done;){var i=t.value;i&&(a+="<div>".concat(i,"</div>"))}}catch(r){o.e(r)}finally{o.f()}return a},gl=(n(97895),function(e){return new Promise((function(t){var n=document.createElement("img");n.src=e,n.style.opacity="0",document.body.appendChild(n),n.onload=function(){var e=n.clientWidth,l=n.clientHeight;n.onload=null,n.onerror=null,document.body.removeChild(n),t({width:e,height:l})},n.onerror=function(){n.onload=null,n.onerror=null}}))}),yl=function(e){return new Promise((function(t){var n=new FileReader;n.addEventListener("load",(function(){t(n.result)})),n.readAsDataURL(e)}))},wl=1e3;(function(e){e["ROUND_RECT"]="roundRect",e["ROUND_RECT_DIAGONAL"]="roundRectDiagonal",e["ROUND_RECT_SINGLE"]="roundRectSingle",e["ROUND_RECT_SAMESIDE"]="roundRectSameSide",e["CUT_RECT_DIAGONAL"]="cutRectDiagonal",e["CUT_RECT_SINGLE"]="cutRectSingle",e["CUT_RECT_SAMESIDE"]="cutRectSameSide",e["CUT_ROUND_RECT"]="cutRoundRect",e["MESSAGE"]="message",e["ROUND_MESSAGE"]="roundMessage",e["L"]="L",e["RING_RECT"]="ringRect",e["PLUS"]="plus",e["TRIANGLE"]="triangle",e["PARALLELOGRAM_LEFT"]="parallelogramLeft",e["PARALLELOGRAM_RIGHT"]="parallelogramRight",e["TRAPEZOID"]="trapezoid",e["BULLET"]="bullet",e["INDICATOR"]="indicator"})(fl||(fl={})),function(e){e["TEXT"]="text",e["IMAGE"]="image",e["SHAPE"]="shape",e["LINE"]="line",e["CHART"]="chart",e["TABLE"]="table",e["LATEX"]="latex",e["VIDEO"]="video",e["AUDIO"]="audio"}(vl||(vl={}));var xl=(pl={},(0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)(pl,fl.ROUND_RECT,{editable:!0,defaultValue:.125,range:[0,.5],relative:"left",getBaseSize:function(e,t){return Math.min(e,t)},formula:function(e,t,n){var l=Math.min(e,t)*n;return"M ".concat(l," 0 L ").concat(e-l," 0 Q ").concat(e," 0 ").concat(e," ").concat(l," L ").concat(e," ").concat(t-l," Q ").concat(e," ").concat(t," ").concat(e-l," ").concat(t," L ").concat(l," ").concat(t," Q 0 ").concat(t," 0 ").concat(t-l," L 0 ").concat(l," Q 0 0 ").concat(l," 0 Z")}}),fl.CUT_RECT_DIAGONAL,{editable:!0,defaultValue:.2,range:[0,.9],relative:"right",getBaseSize:function(e,t){return Math.min(e,t)},formula:function(e,t,n){var l=Math.min(e,t)*n;return"M 0 ".concat(t-l," L 0 0 L ").concat(e-l," 0 L ").concat(e," ").concat(l," L ").concat(e," ").concat(t," L ").concat(l," ").concat(t," Z")}}),fl.CUT_RECT_SINGLE,{editable:!0,defaultValue:.2,range:[0,.9],relative:"right",getBaseSize:function(e,t){return Math.min(e,t)},formula:function(e,t,n){var l=Math.min(e,t)*n;return"M 0 ".concat(t," L 0 0 L ").concat(e-l," 0 L ").concat(e," ").concat(l," L ").concat(e," ").concat(t," Z")}}),fl.CUT_RECT_SAMESIDE,{editable:!0,defaultValue:.2,range:[0,.5],relative:"left",getBaseSize:function(e,t){return Math.min(e,t)},formula:function(e,t,n){var l=Math.min(e,t)*n;return"M 0 ".concat(l," L ").concat(l," 0 L ").concat(e-l," 0 L ").concat(e," ").concat(l," L ").concat(e," ").concat(t," L 0 ").concat(t," Z")}}),fl.ROUND_RECT_DIAGONAL,{editable:!0,defaultValue:.125,range:[0,1],relative:"left",getBaseSize:function(e,t){return Math.min(e,t)},formula:function(e,t,n){var l=Math.min(e,t)*n;return"M ".concat(l," 0 L ").concat(e," 0 L ").concat(e," ").concat(t-l," Q ").concat(e," ").concat(t," ").concat(e-l," ").concat(t," L 0 ").concat(t," L 0 ").concat(l," Q 0 0 ").concat(l," 0 Z")}}),fl.ROUND_RECT_SINGLE,{editable:!0,defaultValue:.125,range:[0,1],relative:"right",getBaseSize:function(e,t){return Math.min(e,t)},formula:function(e,t,n){var l=Math.min(e,t)*n;return"M 0 0 L ".concat(e-l," 0 Q ").concat(e," 0 ").concat(e," ").concat(l," L ").concat(e," ").concat(t," L 0 ").concat(t," L 0 0 Z")}}),fl.ROUND_RECT_SAMESIDE,{editable:!0,defaultValue:.125,range:[0,.5],relative:"left",getBaseSize:function(e,t){return Math.min(e,t)},formula:function(e,t,n){var l=Math.min(e,t)*n;return"M 0 ".concat(l," Q 0 0 ").concat(l," 0 L ").concat(e-l," 0 Q ").concat(e," 0 ").concat(e," ").concat(l," L ").concat(e," ").concat(t," L 0 ").concat(t," Z")}}),fl.CUT_ROUND_RECT,{editable:!0,defaultValue:.125,range:[0,.5],relative:"left",getBaseSize:function(e,t){return Math.min(e,t)},formula:function(e,t,n){var l=Math.min(e,t)*n;return"M ".concat(l," 0 L ").concat(e-l," 0 L ").concat(e," ").concat(l," L ").concat(e," ").concat(t," L 0 ").concat(t," L 0 ").concat(l," Q 0 0 ").concat(l," 0 Z")}}),fl.MESSAGE,{formula:function(e,t){var n=.2*e,l=.2*t;return"M 0 0 L ".concat(e," 0 L ").concat(e," ").concat(t-l," L ").concat(e/2," ").concat(t-l," L ").concat(e/2-n," ").concat(t," L ").concat(e/2-n," ").concat(t-l," L 0 ").concat(t-l," Z")}}),fl.ROUND_MESSAGE,{formula:function(e,t){var n=.125*Math.min(e,t),l=.2*e,a=.2*t;return"M 0 ".concat(n," Q 0 0 ").concat(n," 0 L ").concat(e-n," 0 Q ").concat(e," 0 ").concat(e," ").concat(n," L ").concat(e," ").concat(t-n-a," Q ").concat(e," ").concat(t-a," ").concat(e-n," ").concat(t-a," L ").concat(e/2," ").concat(t-a," L ").concat(e/2-l," ").concat(t," L ").concat(e/2-l," ").concat(t-a," L ").concat(n," ").concat(t-a," Q 0 ").concat(t-a," 0 ").concat(t-n-a," L 0 ").concat(n," Z")}}),(0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)(pl,fl.L,{editable:!0,defaultValue:.25,range:[.1,.9],relative:"left",getBaseSize:function(e,t){return Math.min(e,t)},formula:function(e,t,n){var l=Math.min(e,t)*n;return"M 0 0 L 0 ".concat(t," L ").concat(e," ").concat(t," L ").concat(e," ").concat(t-l," L ").concat(l," ").concat(t-l," L ").concat(l," 0 Z")}}),fl.RING_RECT,{editable:!0,defaultValue:.25,range:[.1,.45],relative:"left",getBaseSize:function(e,t){return Math.min(e,t)},formula:function(e,t,n){var l=Math.min(e,t)*n;return"M 0 0 ".concat(e," 0 ").concat(e," ").concat(t," L 0 ").concat(t," L 0 0 Z M ").concat(l," ").concat(l," L ").concat(l," ").concat(t-l," L ").concat(e-l," ").concat(t-l," L ").concat(e-l," ").concat(l," Z")}}),fl.PLUS,{editable:!0,defaultValue:.25,range:[.1,.9],relative:"center",getBaseSize:function(e,t){return Math.min(e,t)},formula:function(e,t,n){var l=Math.min(e,t)*n;return"M ".concat(e/2-l/2," 0 L ").concat(e/2-l/2," ").concat(t/2-l/2," L 0 ").concat(t/2-l/2," L 0 ").concat(t/2+l/2," L ").concat(e/2-l/2," ").concat(t/2+l/2," L ").concat(e/2-l/2," ").concat(t," L ").concat(e/2+l/2," ").concat(t," L ").concat(e/2+l/2," ").concat(t/2+l/2," L ").concat(e," ").concat(t/2+l/2," L ").concat(e," ").concat(t/2-l/2," L ").concat(e/2+l/2," ").concat(t/2-l/2," L ").concat(e/2+l/2," 0 Z")}}),fl.TRIANGLE,{editable:!0,defaultValue:.5,range:[0,1],relative:"left",getBaseSize:function(e){return e},formula:function(e,t,n){var l=e*n;return"M ".concat(l," 0 L 0 ").concat(t," L ").concat(e," ").concat(t," Z")}}),fl.PARALLELOGRAM_LEFT,{editable:!0,defaultValue:.25,range:[0,.9],relative:"left",getBaseSize:function(e){return e},formula:function(e,t,n){var l=e*n;return"M ".concat(l," 0 L ").concat(e," 0 L ").concat(e-l," ").concat(t," L 0 ").concat(t," Z")}}),fl.PARALLELOGRAM_RIGHT,{editable:!0,defaultValue:.25,range:[0,.9],relative:"right",getBaseSize:function(e){return e},formula:function(e,t,n){var l=e*n;return"M 0 0 L ".concat(e-l," 0 L ").concat(e," ").concat(t," L ").concat(l," ").concat(t," Z")}}),fl.TRAPEZOID,{editable:!0,defaultValue:.25,range:[0,.5],relative:"left",getBaseSize:function(e){return e},formula:function(e,t,n){var l=e*n;return"M ".concat(l," 0 L ").concat(e-l," 0 L ").concat(e," ").concat(t," L 0 ").concat(t," Z")}}),fl.BULLET,{editable:!0,defaultValue:.2,range:[0,1],relative:"top",getBaseSize:function(e,t){return t},formula:function(e,t,n){var l=t*n;return"M ".concat(e/2," 0 L 0 ").concat(l," L 0 ").concat(t," L ").concat(e," ").concat(t," L ").concat(e," ").concat(l," Z")}}),fl.INDICATOR,{editable:!0,defaultValue:.2,range:[0,.9],relative:"right",getBaseSize:function(e){return e},formula:function(e,t,n){var l=e*n;return"M ".concat(e," ").concat(t/2," L ").concat(e-l," 0 L 0 0 L ").concat(l," ").concat(t/2," L 0 ").concat(t," L ").concat(e-l," ").concat(t," Z")}})),bl=[{type:"rectangle",children:[{viewBox:[200,200],path:"M 0 0 L 200 0 L 200 200 L 0 200 Z",pptxShapeType:"rect"},{viewBox:[200,200],path:"M 50 0 L 150 0 Q 200 0 200 50 L 200 150 Q 200 200 150 200 L 50 200 Q 0 200 0 150 L 0 50 Q 0 0 50 0 Z",pathFormula:fl.ROUND_RECT,pptxShapeType:"roundRect"},{viewBox:[200,200],path:"M 0 200 L 0 0 L 150 0 L 200 50 L 200 200 Z",pathFormula:fl.CUT_RECT_SINGLE,pptxShapeType:"snip1Rect"},{viewBox:[200,200],path:"M 0 50 L 50 0 L 150 0 L 200 50 L 200 200 L 0 200 Z",pathFormula:fl.CUT_RECT_SAMESIDE,pptxShapeType:"snip2SameRect"},{viewBox:[200,200],path:"M 0 150 L 0 0 L 150 0 L 200 50 L 200 200 L 50 200 Z",pathFormula:fl.CUT_RECT_DIAGONAL,pptxShapeType:"snip2DiagRect"},{viewBox:[200,200],path:"M 50 0 L 150 0 L 200 50 L 200 200 L 0 200 L 0 50 Q 0 0 50 0 Z",pathFormula:fl.CUT_ROUND_RECT,pptxShapeType:"snipRoundRect"},{viewBox:[200,200],path:"M 0 0 L 150 0 Q 200 0 200 50 L 200 200 L 0 200 L 0 0 Z",pathFormula:fl.ROUND_RECT_SINGLE,pptxShapeType:"round1Rect"},{viewBox:[200,200],path:"M 0 50 Q 0 0 50 0 L 150 0 Q 200 0 200 50 L 200 200 L 0 200 Z",pathFormula:fl.ROUND_RECT_SAMESIDE,pptxShapeType:"round2SameRect"},{viewBox:[200,200],path:"M 50 0 L 200 0 L 200 150 Q 200 200 150 200 L 0 200 L 0 50 Q 0 0 50 0 Z",pathFormula:fl.ROUND_RECT_DIAGONAL,pptxShapeType:"round2DiagRect"},{viewBox:[200,200],path:"M 0 80 L 60 0 L 100 40 L 180 20 L 200 120 L 160 200 L 0 200 L 60 140 Z",title:"arbitrary polygon"}]},{type:"Common shapes",children:[{viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z",pptxShapeType:"ellipse"},{viewBox:[200,200],path:"M 100 0 L 0 200 L 200 200 L 100 0 Z",pathFormula:fl.TRIANGLE,pptxShapeType:"triangle"},{viewBox:[200,200],path:"M 0 0 L 0 200 L 200 200 Z"},{viewBox:[200,200],path:"M 70 20 L 0 160 Q 0 200 40 200 L 160 200 Q 200 200 200 160 L 130 20 Q 100 -20 70 20 Z"},{viewBox:[200,200],path:"M 50 0 L 200 0 L 150 200 L 0 200 L 50 0 Z",pathFormula:fl.PARALLELOGRAM_LEFT,pptxShapeType:"parallelogram"},{viewBox:[200,200],path:"M 0 0 L 150 0 L 200 200 L 50 200 L 0 0 Z",pathFormula:fl.PARALLELOGRAM_RIGHT},{viewBox:[200,200],path:"M 50 0 L 150 0 L 200 200 L 0 200 L 50 0 Z",pathFormula:fl.TRAPEZOID,pptxShapeType:"trapezoid"},{viewBox:[200,200],path:"M 100 0 L 0 100 L 100 200 L 200 100 L 100 0 Z",pptxShapeType:"diamond"},{viewBox:[200,200],path:"M 100 0 L 0 50 L 0 200 L 200 200 L 200 50 L 100 0 Z",pathFormula:fl.BULLET},{viewBox:[200,200],path:"M 200 100 L 150 0 L 0 0 L 50 100 L 0 200 L 150 200 L 200 100 Z",pathFormula:fl.INDICATOR},{viewBox:[200,200],path:"M 0 0 C 80 20 120 20 200 0 C 180 80 180 120 200 200 C 80 180 120 180 0 200 C 20 120 20 80 0 0 Z"},{viewBox:[200,200],path:"M 10 10 C 60 0 140 0 190 10 C 200 60 200 140 190 190 C 140 200 60 200 10 190 C 0 140 0 60 10 10 Z"},{viewBox:[200,200],path:"M 0 200 A 50 100 0 1 1 200 200 L 0 200 Z"},{viewBox:[200,200],path:"M 40 20 A 100 100 0 1 0 200 100 L 100 100 L 40 20 Z"},{viewBox:[200,200],path:"M 100 0 A 100 100 102 1 0 200 100 L 100 100 L 100 0 Z",pptxShapeType:"pie"},{viewBox:[200,200],path:"M 160 20 A 100 100 0 1 0 200 100 L 100 100 L 160 20 Z"},{viewBox:[200,200],path:"M 100 0 A 100 100 102 1 0 200 100 L 100 0 Z",pptxShapeType:"chord"},{viewBox:[200,200],path:"M 100 0 A 100 100 102 1 0 200 100 L 200 0 L 100 0 Z",pptxShapeType:"teardrop"},{viewBox:[200,200],path:"M 0 0 L 200 0 Q 200 200 0 200 L 0 0 Z"},{viewBox:[200,200],path:"M 100 0 L 0 90 L 50 200 L 150 200 L 200 90 L 100 0 Z",pptxShapeType:"pentagon"},{viewBox:[200,200],path:"M 40 0 L 160 0 L 200 100 L 160 200 L 40 200 L 0 100 Z",pptxShapeType:"hexagon"},{viewBox:[200,200],path:"M 100 0 L 0 60 L 0 140 L 100 200 L 200 140 L 200 60 L 100 0 Z"},{viewBox:[200,200],path:"M 60 0 L 140 0 L 200 60 L 200 140 L 140 200 L 60 200 L 0 140 L 0 60 L 60 0 Z",pptxShapeType:"octagon"},{viewBox:[200,200],path:"M 75 0 L 125 0 L 175 25 L 200 75 L 200 125 L 175 175 L 125 200 L 75 200 L 25 175 L 0 125 L 0 75 L 25 25 L 75 0 Z"},{viewBox:[200,200],path:"M 150 0 A 50 100 0 1 1 150 200 L 0 200 L 0 0 L 150 0 Z"},{viewBox:[200,200],path:"M 50 0 A 25 50 0 1 0 50 200 L 150 200 A 25 50 0 1 0 150 0 L 50 0 Z"},{viewBox:[200,200],path:"M 150 0 A 50 100 0 1 1 150 200 L 0 200 A 50 100 0 0 0 0 0 L 150 0 Z"},{viewBox:[200,200],path:"M 200 0 L 200 200 L 0 200 L 0 100 L 200 0 Z"},{viewBox:[200,200],path:"M 0 0 L 200 100 L 200 200 L 0 200 L 0 0 Z"},{viewBox:[200,200],path:"M 200 0 L 100 0 L 0 100 L 0 200 L 200 0 Z"},{viewBox:[200,200],path:"M 50 0 L 150 0 L 150 50 L 200 50 L 200 150 L 150 150 L 150 200 L 50 200 L 50 150 L 0 150 L 0 50 L 50 50 L 50 0 Z"},{viewBox:[200,200],path:"M 0 0 L 0 200 L 200 200 L 200 140 L 60 140 L 60 0 L 0 0 Z",pathFormula:fl.L},{viewBox:[200,200],path:"M0 0 L200 0 L200 200 L0 200 L0 0 Z M50 50 L50 150 L150 150 L150 50 Z",pathFormula:fl.RING_RECT},{viewBox:[200,200],path:"M0 100 A100 100 0 1 1 0 101 Z M150 100 A50 50 0 1 0 150 101 Z"},{viewBox:[200,200],path:"M 70 0 L 70 70 L 0 70 L 0 130 L 70 130 L 70 200 L 130 200 L 130 130 L 200 130 L 200 70 L 130 70 L 130 0 L 70 0 Z",pathFormula:fl.PLUS},{viewBox:[200,200],path:"M 40 0 L 0 40 L 60 100 L 0 160 L 40 200 L 100 140 L 160 200 L 200 160 L 140 100 L 200 40 L 160 0 L 100 60 L 40 0 Z"},{viewBox:[200,200],path:"M 0 0 L 200 0 L 200 160 L 100 160 L 60 200 L 60 160 L 0 160 Z",pathFormula:fl.MESSAGE},{viewBox:[200,200],path:"M 0 40 Q 0 0 40 0 L 160 0 Q 200 0 200 40 L 200 120 Q 200 160 160 160 L 100 160 L 60 200 L 60 160 L 40 160 Q 0 160 0 120 L 0 40 Z",pathFormula:fl.ROUND_MESSAGE},{viewBox:[200,200],path:"M 180 160 A 100 100 0 1 0 100 200 L 200 200 L 200 160 L 180 160 Z"},{viewBox:[200,200],path:"M 200 0 L 0 0 L 200 200 L 0 200 L 200 0 Z"},{viewBox:[200,200],path:"M 0 20 C 60 60 140 -40 200 20 L 200 180 C 140 140 60 240 0 180 L 0 20 Z"},{viewBox:[200,200],path:"M 0 20 C 40 -40 60 60 100 20 C 140 -40 160 60 200 20 L 200 180 C 140 240 160 140 100 180 C 40 240 60 140 0 180 L 0 20 Z"},{viewBox:[200,200],path:"M 100 0 Q 0 50 0 175 Q 100 225 200 175 Q 200 50 100 0 Z"},{viewBox:[200,200],path:"M 0 100 A 50 50 0 1 1 200 100 L 100 200 L 0 100 Z"},{viewBox:[200,200],path:"M 100 0 L 120 80 L 200 100 L 120 120 L 100 200 L 80 120 L 0 100 L 80 80 L 100 0 Z",pptxShapeType:"star4"},{viewBox:[1024,1024],path:"M1018.67652554 400.05983681l-382.95318779-5.89158658L512 34.78141155 388.27666225 394.16825023l-382.95318779 5.89158658L311.68602415 629.83174977l-117.83174978 365.27842665 312.25413766-223.88032637 312.25413904 223.88032637-117.83175116-365.27842665 318.14572563-229.77191296z",pptxShapeType:"star5",special:!0},{viewBox:[200,200],path:"M 100 0 L 60 60 L 0 100 L 60 140 L 100 200 L 140 140 L 200 100 L 140 60 L 100 0 Z"},{viewBox:[200,200],path:"M 100 0 L 140 60 L 200 60 L 160 100 L 200 140 L 140 140 L 100 200 L 60 140 L 0 140 L 40 100 L 0 60 L 60 60 L 100 0 Z",pptxShapeType:"star6"},{viewBox:[200,200],path:"M 100 0 L 80 40 L 20 20 L 40 80 L 0 100 L 40 120 L 20 180 L 80 160 L 100 200 L 120 160 L 180 180 L 160 120 L 200 100 L 160 80 L 180 20 L 120 40 L 100 0 Z"},{viewBox:[200,200],path:"M 200 0 C 80 40 80 160 200 200 C -60 200 -60 0 200 0 Z"}]},{type:"arrow",children:[{viewBox:[200,200],path:"M 100 0 L 0 100 L 50 100 L 50 200 L 150 200 L 150 100 L 200 100 L 100 0 Z",pptxShapeType:"upArrow"},{viewBox:[200,200],path:"M 100 200 L 200 100 L 150 100 L 150 0 L 50 0 L 50 100 L 0 100 L 100 200 Z",pptxShapeType:"downArrow"},{viewBox:[200,200],path:"M 0 100 L 100 0 L 100 50 L 200 50 L 200 150 L 100 150 L 100 200 L 0 100 Z",pptxShapeType:"leftArrow"},{viewBox:[200,200],path:"M 200 100 L 100 0 L 100 50 L 0 50 L 0 150 L 100 150 L 100 200 L 200 100 Z",pptxShapeType:"rightArrow"},{viewBox:[200,200],path:"M 100 0 L 0 60 L 60 60 L 60 140 L 0 140 L 100 200 L 200 140 L 140 140 L 140 60 L 200 60 L 100 0 Z",pptxShapeType:"upDownArrow"},{viewBox:[200,200],path:"M 0 100 L 60 0 L 60 60 L 140 60 L 140 0 L 200 100 L 140 200 L 140 140 L 60 140 L 60 200 L 0 100 Z",pptxShapeType:"leftRightArrow"},{viewBox:[200,200],path:"M 100 0 L 60 40 L 80 40 L 80 80 L 40 80 L 40 60 L 0 100 L 40 140 L 40 120 L 80 120 L 80 160 L 60 160 L 100 200 L 140 160 L 120 160 L 120 120 L 160 120 L 160 140 L 200 100 L 160 60 L 160 80 L 120 80 L 120 40 L 140 40 L 100 0 Z"},{viewBox:[200,200],path:"M 0 100 L 100 0 L 100 50 L 200 50 L 150 100 L 200 150 L 100 150 L 100 200 L 0 100 Z"},{viewBox:[200,200],path:"M 200 100 L 100 0 L 100 50 L 0 50 L 50 100 L 0 150 L 100 150 L 100 200 L 200 100 Z",pptxShapeType:"notchedRightArrow"},{viewBox:[200,200],path:"M 0 100 L 80 20 L 80 80 L 120 80 L 120 0 L 200 0 L 200 200 L 120 200 L 120 120 L 80 120 L 80 180 L 0 100 Z"},{viewBox:[200,200],path:"M 200 100 L 120 20 L 120 80 L 80 80 L 80 0 L 0 0 L 0 200 L 80 200 L 80 120 L 120 120 L 120 180 L 200 100 Z"},{viewBox:[200,200],path:"M 0 0 L 120 0 L 200 100 L 120 200 L 0 200 L 80 100 L 0 0 Z",pptxShapeType:"chevron"},{viewBox:[200,200],path:"M 80 0 L 200 0 L 120 100 L 200 200 L 80 200 L 0 100 L 80 0 Z"},{viewBox:[200,200],path:"M 0 0 L 140 0 L 200 100 L 140 200 L 0 200 L 0 100 L 0 0 Z",pptxShapeType:"homePlate"},{viewBox:[200,200],path:"M 60 0 L 200 0 L 200 100 L 200 200 L 60 200 L 0 100 L 60 0 Z"},{viewBox:[200,200],path:"M 0 0 L 200 100 L 0 200 L 60 100 L 0 0 Z"},{viewBox:[200,200],path:"M 200 0 L 0 100 L 200 200 L 140 100 L 200 0 Z"},{viewBox:[200,200],path:"M 0 0 L 80 0 L 200 100 L 80 200 L 0 200 L 120 100 L 0 0 Z"},{viewBox:[200,200],path:"M 200 0 L 120 0 L 0 100 L 120 200 L 200 200 L 80 100 L 200 0 Z"},{viewBox:[200,200],path:"M 0 200 L 180 200 L 180 40 L 200 40 L 160 0 L 120 40 L 140 40 L 140 160 L 0 160 L 0 200 Z"},{viewBox:[200,200],path:"M 0 200 L 0 20 L 160 20 L 160 0 L 200 40 L 160 80 L 160 60 L 40 60 L 40 200 L 0 200 Z"},{viewBox:[200,200],path:"M 40 180 L 180 180 L 180 40 L 200 40 L 160 0 L 120 40 L 140 40 L 140 140 L 40 140 L 40 120 L 0 160 L 40 200 L 40 180 Z"},{viewBox:[1024,1024],path:"M398.208 302.912V64L0 482.112l398.208 418.176V655.36c284.48 0 483.584 95.552 625.792 304.64-56.896-298.688-227.584-597.312-625.792-657.088z",special:!0},{viewBox:[1024,1024],path:"M625.792 302.912V64L1024 482.112l-398.208 418.176V655.36C341.312 655.36 142.208 750.912 0 960c56.896-298.688 227.584-597.312 625.792-657.088z",special:!0}]},{type:"other shapes",children:[{viewBox:[1024,1024],path:"M995.336 243.4016c-15.7584-36.5736-38.3376-69.26639999-66.91440001-97.37280001-28.5768-27.98879999-61.73999999-49.8624-98.78399999-65.26799998-38.22-15.876-78.6744-23.8728-120.4224-23.87280001-57.97680001 0-114.5424 15.876-163.69919999 45.864-11.76 7.17360001-22.932 15.05279999-33.51600001 23.63760001-10.584-8.5848-21.75600001-16.46400001-33.51600001-23.63760001-49.1568-29.98799999-105.7224-45.86399999-163.69919999-45.864-41.74799999 0-82.2024 7.9968-120.4224 23.87280001-36.9264 15.28799999-70.2072 37.27919999-98.78399999 65.26799998-28.6944 28.10640001-51.156 60.79919999-66.91440001 97.37280001-16.34639999 37.9848-24.696 78.3216-24.696 119.83439999 0 39.1608 7.9968 79.96800001 23.8728 121.48080001 13.28880001 34.692 32.34000001 70.67760001 56.6832 107.016 38.57279999 57.5064 91.61040001 117.4824 157.4664 178.28160001 109.1328 100.78319999 217.2072 170.4024 221.79359999 173.22479998l27.87120001 17.8752c12.348 7.8792 28.224 7.8792 40.572 0l27.87119999-17.8752c4.58639999-2.94 112.54319999-72.44159999 221.79360001-173.22479998 65.85599999-60.79919999 118.89359999-120.7752 157.4664-178.28160001 24.3432-36.33839999 43.512-72.324 56.68319999-107.016 15.876-41.5128 23.8728-82.32 23.87280001-121.48080001 0.1176-41.5128-8.232-81.8496-24.5784-119.83439999z",special:!0},{viewBox:[1024,1024],path:"M985.20746667 343.50079998l-303.32586667-44.08319999L546.28693333 24.5248c-3.70346666-7.5264-9.79626667-13.6192-17.32266665-17.32266668-18.87573334-9.3184-41.81333333-1.55306667-51.25120001 17.32266668L342.1184 299.41759999l-303.32586667 44.08319999c-8.36266667 1.19466667-16.00853333 5.13706667-21.8624 11.11040001-14.69440001 15.17226667-14.45546667 39.30453334 0.71679999 54.1184l219.46026668 213.9648-51.84853333 302.1312c-1.43359999 8.24320001-0.11946667 16.8448 3.82293333 24.25173333 9.79626667 18.6368 32.9728 25.92426667 51.6096 16.00853334L512 822.44266665l271.3088 142.64320001c7.40693333 3.9424 16.00853333 5.25653333 24.25173333 3.82293333 20.78719999-3.584 34.7648-23.296 31.1808-44.0832l-51.84853333-302.1312 219.46026668-213.9648c5.97333334-5.85386666 9.91573333-13.49973334 11.11039999-21.8624 3.2256-20.90666667-11.34933333-40.26026667-32.256-43.36640001z",special:!0},{viewBox:[1024,1024],path:"M852.65066667 405.84533333C800.54044445 268.40177778 667.76177778 170.66666667 512.22755555 170.66666667S223.91466667 268.288 171.80444445 405.73155555C74.29688889 431.33155555 2.27555555 520.07822222 2.27555555 625.77777778c0 125.72444445 101.83111111 227.55555555 227.44177778 227.55555555h564.56533334C919.89333333 853.33333333 1021.72444445 751.50222222 1021.72444445 625.77777778c0-105.472-71.79377778-194.21866667-169.07377778-219.93244445z",special:!0},{viewBox:[1024,1024],path:"M926.25224691 323.7371485H654.6457886L898.88200917 15.14388241c5.05486373-6.53433603 0.49315743-16.02761669-7.76722963-16.02761668H418.30008701c-3.45210206 0-6.78091476 1.84934039-8.50696579 4.93157436L90.35039154 555.76772251c-3.82197013 6.53433603 0.86302552 14.7947231 8.50696578 14.79472311h215.01664245l-110.22068713 440.88274851c-2.34249783 9.61657002 9.24670194 16.39748478 16.39748477 9.49328065L933.03316167 340.62779071c6.41104668-6.0411786 2.09591911-16.8906422-6.78091476-16.89064221z",special:!0},{viewBox:[1024,1024],path:"M878.47822222 463.30311111c-22.18666667-49.83466667-53.93066667-93.98044445-94.32177777-131.072l-33.10933334-30.37866666c-4.89244445-4.32355555-12.62933333-2.38933333-14.79111111 3.75466666l-14.79111111 42.43911111c-9.216 26.624-26.16888889 53.81688889-50.176 80.55466667-1.59288889 1.70666667-3.41333333 2.16177778-4.66488889 2.27555556-1.25155555 0.11377778-3.18577778-0.11377778-4.89244445-1.70666667-1.59288889-1.36533333-2.38933333-3.41333333-2.27555555-5.46133333 4.20977778-68.49422222-16.27022222-145.74933333-61.09866667-229.83111112C561.26577778 124.01777778 509.72444445 69.51822222 445.32622222 31.51644445l-46.99022222-27.648c-6.144-3.64088889-13.99466667 1.13777778-13.65333333 8.30577777l2.50311111 54.61333333c1.70666667 37.31911111-2.61688889 70.31466667-12.85688889 97.73511112-12.51555555 33.56444445-30.49244445 64.73955555-53.47555556 92.72888888-16.15644445 19.56977778-34.24711111 37.20533333-54.04444444 52.45155556-47.90044445 36.75022222-87.38133333 84.65066667-114.11911111 138.24C125.72444445 502.10133333 111.50222222 562.74488889 111.50222222 623.50222222c0 53.70311111 10.58133333 105.69955555 31.51644445 154.73777778 20.25244445 47.21777778 49.152 89.77066667 85.90222222 126.17955555 36.864 36.40888889 79.64444445 65.08088889 127.31733333 84.992C405.61777778 1010.11911111 457.95555555 1020.58666667 512 1020.58666667s106.38222222-10.46755555 155.76177778-31.06133334c47.67288889-19.91111111 90.56711111-48.46933333 127.31733333-84.992 36.864-36.40888889 65.76355555-78.96177778 85.90222222-126.17955555 20.93511111-49.03822222 31.51644445-101.03466667 31.51644445-154.73777778 0-55.52355555-11.37777778-109.45422222-34.01955556-160.31288889z",special:!0},{viewBox:[1024,1024],path:"M968.20337778 20.11591112H705.44042667c-22.17301333 0-41.92483556 15.16430222-47.14951111 37.33731555C642.36202666 124.73685332 582.08711111 173.03324444 512 173.03324444s-130.36202666-48.29639112-146.29091556-115.58001777c-5.22467555-22.17301333-24.84906667-37.33731556-47.14951111-37.33731555H55.79662222c-30.96576 0-56.06968889 25.10392889-56.06968888 56.06968888v321.12639999c0 30.96576 25.10392889 56.06968889 56.06968888 56.06968889h95.57333334v494.43271112c0 30.96576 25.10392889 56.06968889 56.06968889 56.06968888h609.1207111c30.96576 0 56.06968889-25.10392889 56.06968889-56.06968888V453.38168888h95.57333334c30.96576 0 56.06968889-25.10392889 56.06968888-56.06968889V76.1856c0-30.96576-25.10392889-56.06968889-56.06968888-56.06968888z",special:!0},{viewBox:[1024,1024],path:"M980.94648889 239.80714666H523.46880001L373.99210666 96.82944c-1.91146667-1.78403556-4.46008889-2.80348444-7.00871111-2.80348445H43.05351111c-22.55530667 0-40.77795555 18.22264888-40.77795555 40.77795557v754.39217776c0 22.55530667 18.22264888 40.77795555 40.77795555 40.77795557h937.89297778c22.55530667 0 40.77795555-18.22264888 40.77795555-40.77795557V280.58510222c0-22.55530667-18.22264888-40.77795555-40.77795555-40.77795556z",special:!0},{viewBox:[1024,1024],path:"M972.60904597 164.57058577L841.30587843 33.39070759c-18.86327195-18.86327195-44.1375906-29.34286748-70.64480282-29.3428675-26.75379095 0-51.90482023 10.47959553-70.76809219 29.3428675L558.60337778 174.68031322c-18.86327195 18.86327195-29.34286748 44.1375906-29.34286749 70.64480283 0 26.75379095 10.47959553 51.90482023 29.34286749 70.76809218l103.31648301 103.31648302c-24.28800376 53.50758189-57.69942011 101.59043198-99.24793416 143.13894603-41.42522469 41.67180341-89.63136414 75.08321976-143.13894603 99.61780223L316.21649759 558.84995649c-18.86327195-18.86327195-44.1375906-29.34286748-70.64480283-29.34286747-26.75379095 0-51.90482023 10.47959553-70.76809217 29.34286747L33.39070759 700.01627278c-18.86327195 18.86327195-29.34286748 44.1375906-29.3428675 70.76809217 0 26.75379095 10.47959553 51.90482023 29.3428675 70.76809219l131.05658883 131.05658883c30.08260365 30.205893 71.63111769 47.34311394 114.28923598 47.34311394 9.00012323 0 17.63037836-0.73973616 26.13734414-2.21920846 166.19405621-27.37023774 331.03192945-115.76870829 464.06114804-248.67463751C901.84095379 636.27567408 990.11613498 471.56109018 1017.85624079 304.87387654c8.38367642-50.91850535-8.50696579-103.31648302-45.24719482-140.30329077z",special:!0},{viewBox:[1024,1024],path:"M910.60451556 640.96028445c-20.38897778-65.49959112-43.83630221-120.54983112-79.89930667-210.64362666C836.31217778 193.67708444 737.93535999 2.27555556 511.36284444 2.27555556 282.24170667 2.27555556 186.03121778 197.50001778 192.14791111 430.31665779c-36.19043555 90.22122667-59.51032888 144.88917333-79.89930667 210.64362666-43.32657778 139.53706668-29.30915556 197.26336001-18.60494222 198.53767111 22.9376 2.80348444 89.32920888-105.00323556 89.32920889-105.00323556 0 62.44124445 32.11264001 143.86972444 101.69002667 202.61546667-33.64181333 10.32192-109.20846222 38.10190221-91.24067556 68.55793777 14.52714667 24.59420444 250.01984 15.67402668 317.94062222 8.02816 67.92078222 7.64586667 303.41347556 16.56604444 317.94062223-8.02816 17.96778667-30.32860444-57.72629333-58.23601779-91.24067555-68.55793777 69.57738667-58.87317334 101.69002667-140.30165333 101.69002667-202.61546667 0 0 66.39160889 107.80672 89.32920888 105.00323556 10.83164445-1.40174222 24.84906667-59.12803556-18.47751111-198.53767111z",special:!0},{viewBox:[1024,1024],path:"M1016.86992592 199.24764445c-37.13706667 16.01991111-77.55093333 27.54939259-119.17842962 32.03982222 42.96248889-25.60758518 75.60912592-66.02145185 91.02222222-114.08118519-39.68568889 23.66577778-84.58998518 41.02068148-131.31472593 50.00154074C819.53374815 126.79395555 765.76995555 101.79318518 706.18074075 101.79318518c-114.688 0-206.92385185 92.96402963-206.92385186 207.04521482 0 16.01991111 1.94180741 32.03982222 5.09724444 47.45291852-171.72859259-8.98085925-324.88865185-91.02222222-426.71217778-216.63288889-17.96171852 30.82619259-28.15620741 66.02145185-28.1562074 104.49351112 0 71.84687408 36.53025185 135.19834075 92.23585185 172.45677036-33.98162963-1.33499259-66.02145185-10.92266667-93.57084445-26.33576296v2.54862222c0 100.6098963 71.1186963 183.98625185 165.90317037 203.1616-17.3549037 4.49042963-35.92343703 7.03905185-54.49197037 7.03905185-13.47128889 0-26.2144-1.33499259-39.07887407-3.15543704C146.69748148 681.90814815 223.03478518 741.49736297 313.93564445 743.43917037c-71.1186963 55.7056-160.19911111 88.4736-256.9253926 88.4736-17.3549037 0-33.37481482-0.60681482-50.00154074-2.54862222C98.75911111 888.22518518 207.62168889 922.20681482 324.85831111 922.20681482 705.45256297 922.20681482 913.71140741 606.90583703 913.71140741 333.23235555c0-8.98085925 0-17.96171852-0.60681482-26.94257777 40.2925037-29.4912 75.60912592-66.02145185 103.76533333-107.04213333z",special:!0},{viewBox:[1024,1024],path:"M917.96720197 1.08889505H106.03279803C53.56084718 1.08889505 9.37393998 45.27580225 9.37393998 97.74775309v5.52336372c0 19.33177108 8.28504494 41.42522469 22.0934536 55.23363205l331.40179753 392.15879462v325.87843379c0 16.57008987 8.28504494 30.37849854 22.09345359 35.90186098l209.88780469 104.94390299 2.76168121 2.76168121c27.61681602 11.04672615 55.23363335-8.28504494 55.23363335-38.66354218V550.66354348l331.40179753-392.15879462c35.90186097-41.42522469 30.37849854-102.18222047-11.04672616-135.32240022-11.04672615-13.80840865-33.14017975-22.0934536-55.23363335-22.09345359z",special:!0},{viewBox:[1024,1024],path:"M491.70164031 97.48884502a25.89076502 25.89076502 0 0 1 40.59671938 0L745.66415762 367.01171317a25.89076502 25.89076502 0 0 0 30.49932208 7.72839349l208.00640948-89.14190458a25.89076502 25.89076502 0 0 1 35.56096592 29.06238339l-115.18801541 554.96855704A103.56306132 103.56306132 0 0 1 803.14165689 952.14301275H220.85834311a103.56306132 103.56306132 0 0 1-101.4011828-82.51387024l-115.18801541-554.96855704a25.89076502 25.89076502 0 0 1 35.54802012-29.06238339l208.01935528 89.14190458a25.89076502 25.89076502 0 0 0 30.49932208-7.72839349l213.36579793-269.52286815z",special:!0},{viewBox:[1024,1024],path:"M643.02466884 387.7801525c19.85376751-88.69205333 33.718272-152.84087467 41.61900049-192.57389433C704.52292267 95.17283515 652.90057916 2.27555515 550.58614084 2.27555515c-92.26012484 0-138.59407685 45.84971417-165.91530666 137.49816969l-0.70087152 2.67605334c-16.40038399 74.13942085-41.47882668 131.61085116-74.6746315 172.73287031a189.06953915 189.06953915 0 0 1-143.04142182 70.44391902l-26.17434983 0.5606965C77.66380049 387.52529067 27.76177817 438.90551468 27.76177817 501.84374084V881.55022182c0 77.4144 62.25009818 140.17422182 139.05282766 140.17422303h492.82707951c101.23127467 0 191.59267516-63.995904 225.93535999-159.98976l102.37815468-286.22301868c26.04691951-72.82688-11.39234134-153.15945284-83.63303784-179.42300483a138.04612267 138.04612267 0 0 0-47.17499733-8.30850884H643.02466884z",special:!0},{viewBox:[1024,1024],path:"M512 512c140.82958222 0 254.86222222-114.03264 254.86222222-254.86222222S652.82958222 2.27555555 512 2.27555555a254.78940445 254.78940445 0 0 0-254.86222222 254.86222223C257.13777778 397.96736 371.17041778 512 512 512z m0 72.81777778c-170.10232889 0-509.72444445 97.57582222-509.72444445 291.27111111v145.63555556h1019.4488889v-145.63555556c0-193.69528889-339.62211555-291.27111111-509.72444445-291.27111111z",special:!0},{viewBox:[1024,1024],path:"M1019.81297778 564.50161779l-138.89991111-472.51456c-8.66531556-25.99594668-29.43658667-43.45400889-57.21656889-43.45400891s-50.33528889 15.67402668-59.00060446 41.66997334l-92.00526221 274.48661334H351.69166222L259.6864 90.33045333c-8.66531556-25.99594668-31.22062222-41.66997333-59.00060444-41.66997332s-50.33528889 17.33063112-57.2165689 43.45400887L4.69674667 564.50161779c-5.22467555 17.33063112 1.78403556 36.44529778 15.67402667 46.89464887l491.11950221 368.27591113 492.77610666-368.27591113c13.76256-10.32192 20.77127111-29.43658667 15.54659557-46.89464887z",special:!0},{viewBox:[1024,1024],path:"M927.78951111 340.39277037c-12.01493333-47.81700741 12.01493333-124.03294815 89.08041481-150.97552592l-82.40545184-4.36906667s-31.19028148-109.22666667-174.27721483-118.9357037c-143.08693333-9.8304-236.65777778-3.64088889-236.65777777-3.6408889s106.07122963 67.47780741 63.5941926 187.74850371c-31.06891852 63.71555555-79.85682963 116.02299259-132.04290371 175.61220741-1.57771852 1.57771852-3.03407408 3.15543703-4.2477037 4.49042962C278.25493333 624.86755555 7.13007408 934.34311111 7.13007408 934.34311111c298.43152592 78.15774815 498.43768889-7.64586667 616.76657777-110.56165926 24.87940741-0.24272592 43.5693037-0.36408889 56.19105185-0.36408888 164.8109037 0 304.13558518-142.72284445 298.43152593-301.4656-3.88361482-109.1053037-38.71478518-133.74198518-50.72971852-181.5589926z",special:!0},{viewBox:[1024,1024],path:"M997.8886764 504.17210418L537.2729208 43.89182982c-13.97838539-13.97838539-36.56745619-13.97838539-50.5458416 0L26.1113236 504.17210418c-13.41924998 13.41924998-21.02349164 31.64706454-21.02349163 50.65766867 0 39.47496036 32.09437288 71.56933323 71.56933324 71.56933323h48.53295408V954.83524937c0 19.79339373 15.99127289 35.78466661 35.78466663 35.78466662H440.43066677V740.12724968h125.24633315v250.49266631h297.34821416c19.79339373 0 35.78466661-15.99127289 35.78466663-35.78466662V626.39910608h48.53295408c19.01060414 0 37.23841869-7.49241457 50.65766869-21.02349163 27.84494371-27.95677079 27.84494371-73.24673948-0.11182708-101.20351027z",special:!0},{viewBox:[1024,1024],path:"M1009.13013121 349.27572283L674.72427717 14.86986879c-8.82158299-8.82158299-20.35749924-13.16451618-31.89341544-13.16451618s-23.07183245 4.34293316-31.89341547 13.16451618L392.29790453 233.6451272c-16.5574327-1.90003326-33.25058207-2.71433322-49.94373146-2.71433324-99.34459624 0-198.68919249 32.70771543-280.25490606 98.12314628-20.90036589 16.69314938-22.52896582 48.04369819-3.66434987 67.04403081l246.59717401 246.59717401-292.33368895 292.06225564c-3.52863319 3.52863319-5.83581644 8.27871636-6.24296642 13.30023282l-4.61436649 50.48659809c-1.22144996 12.75736619 8.95729967 23.6146991 21.57894918 23.6146991 0.6785833 0 1.35716662 0 2.03574992-0.13571666l50.48659809-4.61436649c5.02151649-0.40714999 9.77159962-2.71433322 13.30023282-6.24296643l292.33368896-292.33368896 246.59717402 246.59717401c8.82158299 8.82158299 20.35749924 13.16451618 31.89341544 13.16451618 13.16451618 0 26.19331567-5.70009979 35.15061536-16.82886604 76.40848044-95.40881307 108.16617924-214.83947521 95.27309638-330.33435417l218.63954175-218.63954173c17.50744934-17.37173267 17.50744934-45.8722316 0-63.51539759z",special:!0},{viewBox:[1024,1024],path:"M976.62005979 160.47737905c-0.39452595-0.39452595-80.35178503 78.64217259-239.47725131 237.50462156l-111.6508437-111.65084369 237.89914752-237.89914752c-125.19623464-75.35445635-286.03131335-56.02268482-390.31767264 48.26367449-81.92988882 81.92988882-112.57140424 200.15616502-83.37648398 310.09739626l2.36715569 8.81107954-372.82702222 372.69551356c-8.15353628 8.15353628-8.15353628 21.56741857 0 29.72095487l185.95323084 185.95323084c8.15353628 8.15353628 21.56741857 8.15353628 29.72095485 0l372.56400493-372.56400493 8.81107953 2.3671557c110.07273989 29.32642892 228.29901608-1.18357785 310.36041356-83.24497533 104.41786795-104.2863593 123.74963948-265.12143802 49.97328693-390.05465535z",special:!0},{viewBox:[1024,1024],path:"M512 2.27555555C230.51377778 2.27555555 2.27555555 230.51377778 2.27555555 512s228.23822222 509.72444445 509.72444445 509.72444445 509.72444445-228.23822222 509.72444445-509.72444445S793.48622222 2.27555555 512 2.27555555z m220.16 343.26755556l-239.616 332.23111111c-14.44977778 20.13866667-44.37333333 20.13866667-58.82311111 0L291.84 481.16622222c-4.32355555-6.03022222 0-14.44977778 7.39555555-14.44977777h53.36177778c11.60533333 0 22.64177778 5.57511111 29.46844445 15.13244444l81.00977777 112.41244444 178.85866667-248.03555555c6.82666667-9.44355555 17.74933333-15.13244445 29.46844445-15.13244445H724.76444445c7.39555555 0 11.71911111 8.41955555 7.39555555 14.44977778z",special:!0},{viewBox:[1024,1024],path:"M512 2.27555555C230.51377778 2.27555555 2.27555555 230.51377778 2.27555555 512s228.23822222 509.72444445 509.72444445 509.72444445 509.72444445-228.23822222 509.72444445-509.72444445S793.48622222 2.27555555 512 2.27555555z m218.45333333 537.03111112c0 5.00622222-4.096 9.10222222-9.10222222 9.10222222H302.64888889c-5.00622222 0-9.10222222-4.096-9.10222222-9.10222222v-54.61333334c0-5.00622222 4.096-9.10222222 9.10222222-9.10222222h418.70222222c5.00622222 0 9.10222222 4.096 9.10222222 9.10222222v54.61333334z",special:!0},{viewBox:[1024,1024],path:"M512 2.27555555C230.51377778 2.27555555 2.27555555 230.51377778 2.27555555 512s228.23822222 509.72444445 509.72444445 509.72444445 509.72444445-228.23822222 509.72444445-509.72444445S793.48622222 2.27555555 512 2.27555555z m188.18844445 703.37422223l-75.09333334-0.34133333L512 570.48177778l-112.98133333 134.71288889-75.20711112 0.34133333c-5.00622222 0-9.10222222-3.98222222-9.10222222-9.10222222 0-2.16177778 0.79644445-4.20977778 2.16177778-5.91644445l148.02488889-176.35555555L316.87111111 337.92c-1.36533333-1.70666667-2.16177778-3.75466667-2.16177778-5.91644445 0-5.00622222 4.096-9.10222222 9.10222222-9.10222222l75.20711112 0.34133334L512 458.06933333l112.98133333-134.71288888 75.09333334-0.34133334c5.00622222 0 9.10222222 3.98222222 9.10222222 9.10222222 0 2.16177778-0.79644445 4.20977778-2.16177778 5.91644445L559.21777778 514.27555555l147.91111111 176.35555556c1.36533333 1.70666667 2.16177778 3.75466667 2.16177778 5.91644444 0 5.00622222-4.096 9.10222222-9.10222222 9.10222223z",special:!0},{viewBox:[1024,1024],path:"M512 2.27555555C230.51377778 2.27555555 2.27555555 230.51377778 2.27555555 512s228.23822222 509.72444445 509.72444445 509.72444445 509.72444445-228.23822222 509.72444445-509.72444445S793.48622222 2.27555555 512 2.27555555z m218.45333333 537.03111112c0 5.00622222-4.096 9.10222222-9.10222222 9.10222222H548.40888889v172.94222222c0 5.00622222-4.096 9.10222222-9.10222222 9.10222222h-54.61333334c-5.00622222 0-9.10222222-4.096-9.10222222-9.10222222V548.40888889H302.64888889c-5.00622222 0-9.10222222-4.096-9.10222222-9.10222222v-54.61333334c0-5.00622222 4.096-9.10222222 9.10222222-9.10222222h172.94222222V302.64888889c0-5.00622222 4.096-9.10222222 9.10222222-9.10222222h54.61333334c5.00622222 0 9.10222222 4.096 9.10222222 9.10222222v172.94222222h172.94222222c5.00622222 0 9.10222222 4.096 9.10222222 9.10222222v54.61333334z",special:!0},{viewBox:[1024,1024],path:"M512 2.27555555C230.51377778 2.27555555 2.27555555 230.51377778 2.27555555 512s228.23822222 509.72444445 509.72444445 509.72444445 509.72444445-228.23822222 509.72444445-509.72444445S793.48622222 2.27555555 512 2.27555555z m163.95377778 517.57511112L427.46311111 700.64355555c-1.59288889 1.13777778-3.41333333 1.70666667-5.34755556 1.70666667-5.00622222 0-9.10222222-4.096-9.10222222-9.10222222V331.88977778c0-1.93422222 0.56888889-3.75466667 1.70666667-5.34755556 2.95822222-4.096 8.64711111-5.00622222 12.74311111-2.048L675.95377778 505.17333333c0.79644445 0.56888889 1.47911111 1.25155555 2.048 2.048 2.95822222 3.98222222 2.048 9.67111111-2.048 12.62933334z",special:!0},{viewBox:[1024,1024],path:"M512 2.27555555C230.51377778 2.27555555 2.27555555 230.51377778 2.27555555 512s228.23822222 509.72444445 509.72444445 509.72444445 509.72444445-228.23822222 509.72444445-509.72444445S793.48622222 2.27555555 512 2.27555555z m200.81777778 666.39644445l-32.54044445 44.37333333c-2.95822222 4.096-8.64711111 4.89244445-12.74311111 1.93422222L479.34577778 577.76355555c-2.38933333-1.70666667-3.75466667-4.43733333-3.75466667-7.39555555V257.13777778c0-5.00622222 4.096-9.10222222 9.10222222-9.10222223h54.72711112c5.00622222 0 9.10222222 4.096 9.10222222 9.10222223v281.6l162.24711111 117.30488889c4.096 2.84444445 5.00622222 8.53333333 2.048 12.62933333z",special:!0},{viewBox:[1024,1024],path:"M981.10577778 314.48177778c-25.6-61.09866667-62.464-115.93955555-109.34044445-163.04355556-46.87644445-46.99022222-101.60355555-83.968-162.70222222-109.568C646.59911111 15.58755555 580.38044445 2.27555555 512 2.27555555h-2.27555555c-68.83555555 0.34133333-135.39555555 13.99466667-198.08711112 40.84622223-60.52977778 25.94133333-114.80177778 62.80533333-161.22311111 109.79555555-46.42133333 46.99022222-82.83022222 101.60355555-108.08888889 162.47466667C16.27022222 378.42488889 3.072 445.44 3.41333333 514.38933333c0.34133333 78.96177778 19.22844445 157.35466667 54.49955556 227.44177778v172.94222222c0 28.89955555 23.43822222 52.33777778 52.224 52.33777778h172.71466666c69.97333333 35.38488889 148.13866667 54.272 226.98666667 54.61333334h2.38933333c68.03911111 0 133.91644445-13.19822222 196.03911112-39.02577778 60.75733333-25.37244445 115.37066667-61.78133333 162.13333333-108.31644445 46.87644445-46.53511111 83.74044445-100.92088889 109.568-161.56444444 26.73777778-62.80533333 40.39111111-129.59288889 40.73244445-198.54222223 0.22755555-69.29066667-13.19822222-136.53333333-39.59466667-199.79377777zM284.89955555 566.61333333c-30.03733333 0-54.49955555-24.46222222-54.49955555-54.61333333s24.46222222-54.61333333 54.49955555-54.61333333 54.49955555 24.46222222 54.49955556 54.61333333-24.34844445 54.61333333-54.49955556 54.61333333z m227.10044445 0c-30.03733333 0-54.49955555-24.46222222-54.49955555-54.61333333s24.46222222-54.61333333 54.49955555-54.61333333 54.49955555 24.46222222 54.49955555 54.61333333-24.46222222 54.61333333-54.49955555 54.61333333z m227.10044445 0c-30.03733333 0-54.49955555-24.46222222-54.49955556-54.61333333s24.46222222-54.61333333 54.49955556-54.61333333 54.49955555 24.46222222 54.49955555 54.61333333-24.46222222 54.61333333-54.49955555 54.61333333z",special:!0},{viewBox:[1024,1024],path:"M980.2224823 3.06251924H43.7775177c-22.52048353 0-40.71499847 18.19451494-40.71499846 40.71499846v936.4449646c0 22.52048353 18.19451494 40.71499847 40.71499846 40.71499846h936.4449646c22.52048353 0 40.71499847-18.19451494 40.71499846-40.71499846V43.7775177c0-22.52048353-18.19451494-40.71499847-40.71499846-40.71499846zM745.4750693 325.8561164l-267.95558363 371.52436096c-16.15876501 22.52048353-49.62140436 22.52048353-65.78016939 0L253.07805667 477.51948567c-4.83490607-6.74342161 0-16.15876501 8.27023406-16.15876499h59.67291961c12.97790576 0 25.31963967 6.23448413 32.95370188 16.92217123l90.59087157 125.70755774 200.01242995-277.37092701c7.63406221-10.56045272 19.84856175-16.92217125 32.95370189-16.92217124H737.20483524c8.27023407 0 13.10514012 9.41534338 8.27023406 16.158765z",special:!0},{viewBox:[1024,1024],path:"M980.2224823 3.06251924H43.7775177c-22.52048353 0-40.71499847 18.19451494-40.71499846 40.71499846v936.4449646c0 22.52048353 18.19451494 40.71499847 40.71499846 40.71499846h936.4449646c22.52048353 0 40.71499847-18.19451494 40.71499846-40.71499846V43.7775177c0-22.52048353-18.19451494-40.71499847-40.71499846-40.71499846zM756.28999077 542.53624885c0 5.59831228-4.58043732 10.17874961-10.17874962 10.17874962H277.88875885c-5.59831228 0-10.17874961-4.58043732-10.17874962-10.17874962v-61.0724977c0-5.59831228 4.58043732-10.17874961 10.17874962-10.17874962h468.2224823c5.59831228 0 10.17874961 4.58043732 10.17874962 10.17874962v61.0724977z",special:!0},{viewBox:[1024,1024],path:"M980.2224823 3.06251924H43.7775177c-22.52048353 0-40.71499847 18.19451494-40.71499846 40.71499846v936.4449646c0 22.52048353 18.19451494 40.71499847 40.71499846 40.71499846h936.4449646c22.52048353 0 40.71499847-18.19451494 40.71499846-40.71499846V43.7775177c0-22.52048353-18.19451494-40.71499847-40.71499846-40.71499846zM720.79160148 697.63494611c5.59831228 6.61618726 0.8906406 16.6677025-7.76129658 16.66770249h-74.94104404c-5.98001539 0-11.70556205-2.67192177-15.64982754-7.25235911L512 575.36271635l-110.43943332 131.68757314c-3.81703111 4.58043732-9.54257777 7.25235911-15.64982754 7.25235911H310.9696951c-8.65193717 0-13.35960887-10.05151525-7.76129658-16.66770249L458.81603326 512 303.20839852 326.36505389c-5.59831228-6.61618726-0.8906406-16.6677025 7.76129658-16.66770249h74.94104404c5.98001539 0 11.70556205 2.67192177 15.64982754 7.25235911L512 448.63728365l110.43943332-131.68757314c3.81703111-4.58043732 9.54257777-7.25235911 15.64982754-7.25235911H713.0303049c8.65193717 0 13.35960887 10.05151525 7.76129658 16.66770249L565.18396674 512l155.60763474 185.63494611z",special:!0},{viewBox:[1024,1024],path:"M980.2224823 3.06251924H43.7775177c-22.52048353 0-40.71499847 18.19451494-40.71499846 40.71499846v936.4449646c0 22.52048353 18.19451494 40.71499847 40.71499846 40.71499846h936.4449646c22.52048353 0 40.71499847-18.19451494 40.71499846-40.71499846V43.7775177c0-22.52048353-18.19451494-40.71499847-40.71499846-40.71499846zM677.02297814 523.19662459L423.31764398 722.70011704c-9.41534338 7.37959347-23.28388974 0.76340622-23.28388975-11.19662459V312.62374191c0-11.9600308 13.86854636-18.70345241 23.28388975-11.19662457l253.70533416 199.37625807c7.25235911 5.72554666 7.25235911 16.6677025 0 22.39324918z",special:!0},{viewBox:[1024,1024],path:"M980.2224823 3.06251924H43.7775177c-22.52048353 0-40.71499847 18.19451494-40.71499846 40.71499846v936.4449646c0 22.52048353 18.19451494 40.71499847 40.71499846 40.71499846h936.4449646c22.52048353 0 40.71499847-18.19451494 40.71499846-40.71499846V43.7775177c0-22.52048353-18.19451494-40.71499847-40.71499846-40.71499846zM756.28999077 542.53624885c0 5.59831228-4.58043732 10.17874961-10.17874962 10.17874962H552.71499847v193.39624268c0 5.59831228-4.58043732 10.17874961-10.17874962 10.17874962h-61.0724977c-5.59831228 0-10.17874961-4.58043732-10.17874962-10.17874962V552.71499847H277.88875885c-5.59831228 0-10.17874961-4.58043732-10.17874962-10.17874962v-61.0724977c0-5.59831228 4.58043732-10.17874961 10.17874962-10.17874962h193.39624268V277.88875885c0-5.59831228 4.58043732-10.17874961 10.17874962-10.17874962h61.0724977c5.59831228 0 10.17874961 4.58043732 10.17874962 10.17874962v193.39624268h193.39624268c5.59831228 0 10.17874961 4.58043732 10.17874962 10.17874962v61.0724977z",special:!0},{viewBox:[1024,1024],path:"M902.67315697 135.41705551L528.62204754 7.94466448C524.10877635 6.40354749 518.05438818 5.63298899 512 5.63298899s-12.10877635 0.7705585-16.62204754 2.31167549L121.32684303 135.41705551c-9.13662215 3.08223399-16.62204754 13.64989334-16.62204753 23.33691443v531.02488283c0 9.68702108 6.27454775 22.45627614 13.87005291 28.51066431L498.0198673 1013.9638196c3.85279247 2.9721542 8.8063828 4.51327118 13.87005291 4.51327118s10.12734022-1.54111698 13.87005291-4.51327118l379.4450189-295.67430252c7.59550517-5.94430839 13.87005291-18.71356345 13.87005291-28.51066431V158.75396994c0.22015956-9.68702108-7.26526581-20.14460066-16.40188796-23.33691443zM712.89560763 323.43332829L478.86598471 645.63685899c-7.04510625 9.68702108-21.57563786 9.68702108-28.6207441 0l-139.14084824-191.5388259c-4.18303182-5.8342286 0-13.9801327 7.15518603-13.9801327h60.76404132c5.61406904 0 11.0079785 2.75199463 14.31037204 7.26526582l71.22162091 97.97100864 166.11039557-228.74579323c3.30239355-4.51327118 8.58622323-7.26526581 14.31037204-7.26526581H705.7404216c7.15518602 0.11007979 11.33821785 8.25598388 7.15518603 14.09021248z",special:!0},{viewBox:[1024,1024],path:"M959.86498307 186.28001231H797.00498922v-101.78749614c0-44.91373267-36.51626425-81.42999692-81.42999691-81.42999693H308.42500769c-44.91373267 0-81.42999692 36.51626425-81.42999691 81.42999693v101.78749614H64.13501693c-22.52048353 0-40.71499847 18.19451494-40.71499846 40.71499847v40.71499845c0 5.59831228 4.58043732 10.17874961 10.17874961 10.17874962h76.8495596l31.42688945 665.43575611c2.03574992 43.38692024 37.91584233 77.61296581 81.30276254 77.6129658h577.64404066c43.5141546 0 79.26701262-34.09881122 81.30276254-77.6129658l31.42688945-665.43575611H990.40123192c5.59831228 0 10.17874961-4.58043732 10.17874961-10.17874962v-40.71499845c0-22.52048353-18.19451494-40.71499847-40.71499846-40.71499847z m-254.46874039 0H318.60375732v-91.60874653h386.79248536v91.60874653z",special:!0},{viewBox:[1024,1024],path:"M980.2224823 248.62485371H654.50249462V104.85001539c0-22.52048353-18.19451494-40.71499847-40.71499847-40.71499846H94.67126578v-50.89374808c0-5.59831228-4.58043732-10.17874961-10.17874961-10.17874961h-71.25124732c-5.59831228 0-10.17874961 4.58043732-10.17874961 10.17874961v997.5174623c0 5.59831228 4.58043732 10.17874961 10.17874961 10.17874961h71.25124732c5.59831228 0 10.17874961-4.58043732 10.17874961-10.17874961V674.85999383h315.54123807v143.77483833c0 22.52048353 18.19451494 40.71499847 40.71499846 40.71499846h529.29497999c22.52048353 0 40.71499847-18.19451494 40.71499846-40.71499846V289.33985217c0-22.52048353-18.19451494-40.71499847-40.71499846-40.71499846z",special:!0},{viewBox:[1024,1024],path:"M804.63905145 265.16532183V94.67126578h109.42155836c5.59831228 0 10.17874961-4.58043732 10.17874961-10.17874961v-71.25124732c0-5.59831228-4.58043732-10.17874961-10.17874961-10.17874961H109.93939019c-5.59831228 0-10.17874961 4.58043732-10.17874961 10.17874961v71.25124732c0 5.59831228 4.58043732 10.17874961 10.17874961 10.17874961h109.42155836v170.49405605c0 103.6960117 53.94737296 194.92305513 135.3773699 246.83467817-81.42999692 51.91162303-135.37736988 143.13866646-135.3773699 246.83467817v170.49405605h-109.42155836c-5.59831228 0-10.17874961 4.58043732-10.17874961 10.17874961v71.25124732c0 5.59831228 4.58043732 10.17874961 10.17874961 10.17874961h804.12121962c5.59831228 0 10.17874961-4.58043732 10.17874961-10.17874961v-71.25124732c0-5.59831228-4.58043732-10.17874961-10.17874961-10.17874961h-109.42155836V758.83467817c0-103.6960117-53.94737296-194.92305513-135.3773699-246.83467817 81.42999692-51.91162303 135.37736988-143.13866646 135.3773699-246.83467817z",special:!0},{viewBox:[1024,1024],path:"M1020.928 448.44373333l-35.36213334-373.4528c-1.79200001-19.3536-17.2032-34.64533332-36.55679999-36.55679999L575.55626667 3.072h-0.47786666c-3.82293334 0-6.8096 1.19466667-9.07946669 3.46453333L6.53653333 565.99893332c-4.65919999 4.65919999-4.65919999 12.1856 0 16.84480001l434.61973334 434.61973334c2.26986667 2.26986667 5.25653333 3.46453333 8.48213333 3.46453333s6.21226667-1.19466667 8.48213333-3.46453333l559.46239999-559.46239999c2.38933332-2.5088 3.584-5.97333334 3.34506668-9.55733335zM735.40266668 362.66666667c-42.17173333 0-76.45866667-34.28693333-76.45866667-76.45866667s34.28693333-76.45866667 76.45866667-76.45866667 76.45866667 34.28693333 76.45866665 76.45866667-34.28693333 76.45866667-76.45866665 76.45866667z",special:!0}]},{type:"Linear",children:[{viewBox:[1024,1024],path:"M1009.55537674 75.96950982l-61.38012212-61.38012214c-4.48769762-4.48769762-11.870684-4.48769762-16.3583816 0L14.44462326 931.67210859c-4.48769762 4.48769762-4.48769762 11.870684 0 16.35838159l61.38012212 61.38012214c4.48769762 4.48769762 11.870684 4.48769762 16.3583816 0L1009.41061232 92.18312698c4.63246205-4.34293316 4.63246205-11.72591956 0.14476442-16.21361716zM210.88996692 419.35075905c114.94296453 0 208.46079213-93.51782759 208.46079213-208.46079213s-93.51782759-208.46079213-208.46079213-208.4607921-208.46079213 93.51782759-208.4607921 208.4607921 93.51782759 208.46079213 208.4607921 208.46079213z m0-312.69118816c57.47148228 0 104.23039605 46.75891379 104.23039607 104.23039603s-46.75891379 104.23039605-104.23039607 104.23039607-104.23039605-46.75891379-104.23039603-104.23039607 46.75891379-104.23039605 104.23039603-104.23039603zM813.11003308 604.64924095c-114.94296453 0-208.46079213 93.51782759-208.46079213 208.46079213s93.51782759 208.46079213 208.46079213 208.4607921 208.46079213-93.51782759 208.4607921-208.4607921-93.51782759-208.46079213-208.4607921-208.46079213z m0 312.69118816c-57.47148228 0-104.23039605-46.75891379-104.23039607-104.23039603s46.75891379-104.23039605 104.23039607-104.23039607 104.23039605 46.75891379 104.23039603 104.23039607-46.75891379 104.23039605-104.23039603 104.23039603z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M1004.96017383 478.58365209L483.27851088 25.80594621c-4.00443838-3.45210207-9.11354943-5.3852792-14.49882864-5.38527921h-122.20441284c-10.21822208 0-14.91308089 12.70373557-7.18037228 19.33177152l483.57045622 419.77561022H14.8973037c-6.07569962 0-11.04672658 4.97102697-11.04672658 11.04672657v82.85044938c0 6.07569962 4.97102697 11.04672658 11.04672658 11.04672657h807.92996557L339.25681303 984.24756148c-7.7327086 6.76612003-3.0378498 19.33177153 7.18037229 19.33177152h126.34693531c2.62359757 0 5.24719513-0.96658859 7.18037228-2.76168164L1004.96017383 545.41634791c20.2983601-17.67476253 20.2983601-49.1579333 0-66.83269582z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M1011.38217956 558.9924242L545.80649025 22.43713295c-17.81503843-20.62055629-49.79794206-20.62055629-67.75325638 0L12.61782044 558.9924242c-6.31241519 7.29434645-1.12220714 18.51641789 8.41655359 18.51641789h113.62347344c6.45269109 0 12.62483038-2.80551785 16.97338308-7.71517411L458.69516062 215.87758959V1005.77114384c0 6.1721393 5.04993216 11.22207145 11.22207144 11.22207145h84.16553588c6.1721393 0 11.22207145-5.04993216 11.22207144-11.22207145V215.87758959l307.06393007 353.91607839c4.20827679 4.90965626 10.38041608 7.71517413 16.97338308 7.71517411h113.62347344c9.53876074 0 14.72896878-11.22207145 8.41655359-18.51641789z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M1009.1026963 459.52804874H201.17273073l483.57045624-419.77561022c7.7327086-6.76612003 3.0378498-19.33177153-7.18037229-19.33177152h-122.20441283c-5.3852792 0-10.49439025 1.93317715-14.49882866 5.38527921L19.03982617 478.58365209c-20.2983601 17.67476253-20.2983601 49.1579333 0 66.69461175L543.89742302 1000.81765136c2.07126124 1.79509307 4.55677472 2.76168163 7.18037228 2.76168164h126.3469353c10.21822208 0 14.91308089-12.70373557 7.18037228-19.33177152L201.17273073 564.47195126H1009.1026963c6.07569962 0 11.04672658-4.97102697 11.04672658-11.04672657v-82.85044938c0-6.07569962-4.97102697-11.04672658-11.04672658-11.04672657z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M1002.96562597 446.49115791h-113.62347344c-6.45269109 0-12.62483038 2.80551785-16.97338308 7.71517411L565.30483938 808.12241041V18.22885616c0-6.1721393-5.04993216-11.22207145-11.22207144-11.22207145h-84.16553588c-6.1721393 0-11.22207145 5.04993216-11.22207144 11.22207145v789.89355425L151.63123055 454.20633202c-4.20827679-4.90965626-10.38041608-7.71517413-16.97338308-7.71517411h-113.62347344c-9.53876074 0-14.72896878 11.36234735-8.41655359 18.51641789L478.19350975 1001.56286705c17.81503843 20.62055629 49.79794206 20.62055629 67.75325638 0L1011.38217956 465.0075758c6.31241519-7.29434645 1.12220714-18.51641789-8.41655359-18.51641789z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M975.82443246 622.46726585H14.8973037c-6.07569962 0-11.04672658 4.97102697-11.04672658 11.04672658v82.85044937c0 6.07569962 4.97102697 11.04672658 11.04672658 11.04672659h835.6848661L651.32683905 980.10503902c-5.66144737 7.18037229-0.55233633 17.9509307 8.69929718 17.9509307h100.11095967c6.76612003 0 13.11798782-3.0378498 17.39859437-8.42312903l233.08593092-295.63802022c22.78387358-28.99765728 2.20934532-71.52755463-34.79718873-71.52755462zM1009.1026963 296.58883161H173.4178302l199.25533075-252.69387063c5.66144737-7.18037229 0.55233633-17.9509307-8.69929718-17.9509307h-100.11095967c-6.76612003 0-13.11798782 3.0378498-17.39859437 8.42312903L13.37837881 330.00517953c-22.78387358 28.99765728-2.20934532 71.52755463 34.65910466 71.52755462h961.06521283c6.07569962 0 11.04672658-4.97102697 11.04672658-11.04672658v-82.85044937c0-6.07569962-4.97102697-11.04672658-11.04672658-11.04672659z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M1010.75873115 64.13501693H13.24126885c-5.59831228 0-10.17874961 4.58043732-10.17874961 10.17874961v81.42999691c0 5.59831228 4.58043732 10.17874961 10.17874961 10.17874964h997.5174623c5.59831228 0 10.17874961-4.58043732 10.17874961-10.17874964v-81.42999691c0-5.59831228-4.58043732-10.17874961-10.17874961-10.17874961zM1010.75873115 858.07748691H13.24126885c-5.59831228 0-10.17874961 4.58043732-10.17874961 10.17874964v81.42999691c0 5.59831228 4.58043732 10.17874961 10.17874961 10.17874961h997.5174623c5.59831228 0 10.17874961-4.58043732 10.17874961-10.17874961v-81.42999691c0-5.59831228-4.58043732-10.17874961-10.17874961-10.17874964zM1010.75873115 461.10625194H13.24126885c-5.59831228 0-10.17874961 4.58043732-10.17874961 10.17874959v81.42999694c0 5.59831228 4.58043732 10.17874961 10.17874961 10.17874959h997.5174623c5.59831228 0 10.17874961-4.58043732 10.17874961-10.17874959v-81.42999694c0-5.59831228-4.58043732-10.17874961-10.17874961-10.17874959z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M591.98717801 512l405.34042913-483.16579151c6.79427767-8.02960089 1.08090782-20.22841761-9.41933951-20.2284176h-123.22349044c-7.25752386 0-14.20621693 3.24272343-18.99309439 8.80167789L511.38233839 415.95362022 177.07299399 17.40746878c-4.63246205-5.55895447-11.58115512-8.80167789-18.99309439-8.80167789H34.85640916c-10.50024731 0-16.21361717 12.19881672-9.41933952 20.2284176L430.77749876 512 25.43706964 995.16579151c-6.79427767 8.02960089-1.08090782 20.22841761 9.41933952 20.2284176h123.22349044c7.25752386 0 14.20621693-3.24272343 18.99309439-8.80167789l334.3093444-398.54615144 334.30934441 398.54615144c4.63246205 5.55895447 11.58115512 8.80167789 18.99309439 8.80167789h123.22349044c10.50024731 0 16.21361717-12.19881672 9.41933951-20.2284176L591.98717801 512z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M953.5488 832.61667556c-24.08448-57.08913778-58.74574221-108.31644445-102.70947556-152.28017777-43.96373333-43.96373333-95.19104-78.49756444-152.28017777-102.70947558-0.50972445-0.25486222-1.01944888-0.38229333-1.52917334-0.63715555C776.41955556 519.64586667 828.02915556 426.23886221 828.02915556 320.85333332c0-174.58062221-141.44853334-316.02915556-316.02915556-316.02915554S195.97084444 146.27271111 195.97084444 320.85333332c0 105.38552889 51.6096 198.79253333 130.99918223 256.26396447-0.50972445 0.25486222-1.01944888 0.38229333-1.52917334 0.63715555-57.08913778 24.08448-108.31644445 58.61831112-152.28017777 102.70947554-43.96373333 43.96373333-78.49756444 95.19104-102.70947556 152.28017779C46.74901333 888.55893332 34.13333334 947.8144 32.85902222 1008.72647111c-0.12743111 5.7344 4.46008889 10.44935111 10.19448889 10.44935111h76.45866667c5.60696888 0 10.06705778-4.46008889 10.19448889-9.93962666 2.54862221-98.37681778 42.05226667-190.50951112 111.88451555-260.34176001 72.25344-72.25344 168.20906666-112.01194667 270.40881778-112.01194667s198.15537778 39.75850667 270.40881778 112.01194667C852.24106667 818.72668444 891.74471111 910.85937779 894.29333333 1009.23619556c0.12743111 5.60696888 4.58752 9.93962667 10.19448889 9.93962666h76.45866667c5.7344 0 10.32192-4.71495112 10.19448889-10.44935111-1.27431111-60.91207112-13.88999112-120.16753779-37.59217778-176.10979555zM512 540.03484444c-58.49088 0-113.54112-22.81016889-154.95623111-64.22527999S292.81848888 379.34421333 292.81848888 320.85333332c0-58.49088 22.81016889-113.54112 64.22528001-154.9562311S453.50912 101.67182221 512 101.67182221s113.54112 22.81016889 154.95623111 64.22528001S731.18151112 262.36245333 731.18151112 320.85333332c0 58.49088-22.81016889 113.54112-64.22528001 154.95623113S570.49088 540.03484444 512 540.03484444z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M985.31555555 111.50222222H38.68444445c-20.13866667 0-36.40888889 16.27022222-36.4088889 36.40888889v728.17777778c0 20.13866667 16.27022222 36.40888889 36.4088889 36.40888889h946.6311111c20.13866667 0 36.40888889-16.27022222 36.4088889-36.40888889V147.91111111c0-20.13866667-16.27022222-36.40888889-36.4088889-36.40888889z m-45.5111111 126.06577778V830.57777778H84.19555555V237.568l-31.40266666-24.46222222 44.71466666-57.45777778 48.6968889 37.888h731.70488888l48.69688889-37.888 44.71466667 57.45777778-31.51644444 24.46222222z M877.90933333 193.42222222L512 477.86666667 146.09066667 193.42222222l-48.69688889-37.888-44.71466667 57.45777778 31.40266667 24.46222222 388.66488889 302.19377778c22.98311111 17.86311111 55.18222222 17.86311111 78.16533333 0L939.80444445 237.568l31.40266666-24.46222222-44.71466666-57.45777778-48.58311112 37.77422222z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M985.31555555 88.74666667H38.68444445c-20.13866667 0-36.40888889 16.27022222-36.4088889 36.40888888v564.33777778c0 20.13866667 16.27022222 36.40888889 36.4088889 36.40888889h432.35555555v127.43111111H275.34222222c-10.01244445 0-18.20444445 8.192-18.20444444 18.20444445v54.61333333c0 5.00622222 4.096 9.10222222 9.10222222 9.10222222h491.52c5.00622222 0 9.10222222-4.096 9.10222222-9.10222222v-54.61333333c0-10.01244445-8.192-18.20444445-18.20444444-18.20444445H552.96V725.90222222h432.35555555c20.13866667 0 36.40888889-16.27022222 36.4088889-36.40888889V125.15555555c0-20.13866667-16.27022222-36.40888889-36.4088889-36.40888888z m-45.5111111 555.23555555H84.19555555V170.66666667h855.6088889v473.31555555z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M512 2.27555555C230.51377778 2.27555555 2.27555555 230.51377778 2.27555555 512s228.23822222 509.72444445 509.72444445 509.72444445 509.72444445-228.23822222 509.72444445-509.72444445S793.48622222 2.27555555 512 2.27555555z m0 932.97777778c-233.69955555 0-423.25333333-189.55377778-423.25333333-423.25333333 0-101.26222222 35.61244445-194.33244445 95.00444444-267.15022222l595.39911111 595.39911111C706.33244445 899.64088889 613.26222222 935.25333333 512 935.25333333z m328.24888889-156.10311111L244.84977778 183.75111111C317.66755555 124.35911111 410.73777778 88.74666667 512 88.74666667c233.69955555 0 423.25333333 189.55377778 423.25333333 423.25333333 0 101.26222222-35.61244445 194.33244445-95.00444444 267.15022222z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M901.80266667 257.82044445L656.95288889 12.97066667c-6.82666667-6.82666667-16.04266667-10.69511111-25.71377778-10.69511112H147.91111111c-20.13866667 0-36.40888889 16.27022222-36.40888889 36.4088889v946.6311111c0 20.13866667 16.27022222 36.40888889 36.40888889 36.4088889h728.17777778c20.13866667 0 36.40888889-16.27022222 36.40888889-36.4088889V283.648c0-9.67111111-3.86844445-19.00088889-10.69511111-25.82755555zM828.52977778 300.37333333H614.4V86.24355555L828.52977778 300.37333333z m2.048 639.43111112H193.42222222V84.19555555h343.60888889v245.76c0 26.39644445 21.39022222 47.78666667 47.78666667 47.78666667h245.76v562.06222223z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M981.07392 55.79662222H42.92608c-31.22062222 0-50.71758221 34.02410666-35.04355556 61.16693334L304.28728889 620.82616888V927.42542221c0 22.55530667 18.09521779 40.77795555 40.52309333 40.77795557h334.37923556c22.42787556 0 40.52309333-18.22264888 40.52309333-40.77795557V620.82616888L1016.24490667 116.96355556c15.54659555-27.14282666-3.95036444-61.16693333-35.17098667-61.16693334zM628.47203556 876.45297779H395.52796444V677.66044445h233.07150222v198.79253334z m12.23338666-301.50200891l-12.10595556 21.15356445h-233.19893332l-12.10595556-21.15356445L130.59868445 147.54702221h762.8026311L640.70542222 574.95096888z",special:!0,outlined:!0},{viewBox:[1024,1024],path:"M980.62285431 4.54099753H654.39920987c-4.2719763 0-7.76722963 3.49525333-7.76722962 7.76722964v72.4941432c0 4.2719763 3.49525333 7.76722963 7.76722962 7.76722963h207.64393877L604.04167111 350.57107753c-64.72691358-49.83972347-143.69374815-76.7661195-226.67365136-76.7661195-99.54999309 0-193.27456395 38.83614815-263.5679921 109.25903012S4.54099753 547.08198717 4.54099753 646.63198025s38.83614815 193.27456395 109.25903012 263.5679921C184.09345581 980.62285431 277.81802667 1019.45900247 377.36801975 1019.45900247s193.27456395-38.83614815 263.5679921-109.25903012C711.35889383 839.90654419 750.19504197 746.18197333 750.19504197 646.63198025c0-82.9799032-26.92639605-161.68783013-76.63666567-226.41474372L931.4304 162.34521283V369.60079013c0 4.2719763 3.49525333 7.76722963 7.76722963 7.76722962h72.4941432c4.2719763 0 7.76722963-3.49525333 7.76722964-7.76722962V43.37714569c0-21.35988148-17.47626667-38.83614815-38.83614816-38.83614816zM377.36801975 921.07409383c-151.33152395 0-274.44211358-123.11058963-274.44211358-274.44211358s123.11058963-274.44211358 274.44211358-274.44211358 274.44211358 123.11058963 274.44211358 274.44211358-123.11058963 274.44211358-274.44211358 274.44211358z",special:!0,outlined:!0}]}],kl={bar:"bar",horizontalBar:"bar",line:"line",area:"line",scatter:"line",pie:"pie",ring:"pie"};const _l=function(){var e=ce(),t=(0,z.debounce)((function(){e.addSnapshot()}),300,{trailing:!0}),n=(0,z.throttle)((function(){e.reDo()}),100,{leading:!0,trailing:!1}),l=(0,z.throttle)((function(){e.unDo()}),100,{leading:!0,trailing:!1});return{addHistorySnapshot:t,redo:n,undo:l}},Il=function(){var e=X(),t=V(),n=(0,o.Jk)(e),l=n.creatingElement,a=(0,o.Jk)(t),i=a.theme,r=a.viewportRatio,u=_l(),c=u.addHistorySnapshot,d=function(n,a){t.addElement(n),e.setActiveElementIdList([n.id]),l.value&&e.setCreatingElement(null),setTimeout((function(){e.setEditorareaFocus(!0)}),0),a&&a(),c()},f=function(e){gl(e).then((function(t){var n=t.width,l=t.height,a=l/n;a<r.value&&n>wl?(n=wl,l=n*a):l>wl*r.value&&(l=wl*r.value,n=l/a),d({type:"image",id:(0,s.x0)(10),src:e,width:n,height:l,left:(wl-n)/2,top:(wl*r.value-l)/2,fixedRatio:!0,rotate:0})}))},v=function(e){var t={type:"chart",id:(0,s.x0)(10),chartType:kl[e],left:300,top:81.25,width:400,height:400,rotate:0,themeColor:[i.value.themeColor],gridColor:i.value.fontColor,data:{labels:["类别1","类别2","类别3","类别4","类别5"],legends:["系列1"],series:[[12,19,5,2,18]]}},n=(0,g.Z)((0,g.Z)((0,g.Z)((0,g.Z)((0,g.Z)((0,g.Z)((0,g.Z)({},"bar"===e?{horizontalBars:!1,stackBars:!1}:{}),"horizontalBar"===e?{horizontalBars:!0,stackBars:!1}:{}),"line"===e?{showLine:!0,lineSmooth:!0,showArea:!1}:{}),"area"===e?{showLine:!0,lineSmooth:!0,showArea:!0}:{}),"scatter"===e?{showLine:!1,lineSmooth:!0,showArea:!1}:{}),"pie"===e?{donut:!1}:{}),"ring"===e?{donut:!0}:{});d((0,g.Z)((0,g.Z)({},t),{},{options:n}))},p=function(e,t){for(var n={fontname:i.value.fontName,color:i.value.fontColor},l=[],a=0;a<e;a++){for(var o=[],u=0;u<t;u++)o.push({id:(0,s.x0)(10),colspan:1,rowspan:1,text:"",style:n});l.push(o)}var c=100,f=36,v=new Array(t).fill(1/t),p=t*c,h=e*f;d({type:"table",id:(0,s.x0)(10),width:p,height:h,colWidths:v,rotate:0,data:l,left:(wl-p)/2,top:(wl*r.value-h)/2,outline:{width:2,style:"solid",color:"#eeece1"},theme:{color:i.value.themeColor,rowHeader:!0,rowFooter:!1,colHeader:!1,colFooter:!1},cellMinHeight:36})},h=function(e,t){var n=e.left,l=e.top,a=e.width,o=e.height,r=(null===t||void 0===t?void 0:t.content)||"",u=(null===t||void 0===t?void 0:t.vertical)||!1,c=(0,s.x0)(10);d({type:"text",id:c,left:n,top:l,width:a,height:o,content:r,rotate:0,defaultFontName:i.value.fontName,defaultColor:i.value.fontColor,vertical:u},(function(){setTimeout((function(){var e=document.querySelector("#editable-element-".concat(c," .ProseMirror"));e&&e.focus()}),0)}))},m=function(e,t){var n=e.left,l=e.top,a=e.width,o=e.height,r={type:"shape",id:(0,s.x0)(10),left:n,top:l,width:a,height:o,viewBox:t.viewBox,path:t.path,fill:i.value.themeColor,fixedRatio:!1,rotate:0};if(t.special&&(r.special=!0),t.pathFormula){r.pathFormula=t.pathFormula,r.viewBox=[a,o];var u=xl[t.pathFormula];"editable"in u?(r.path=u.formula(a,o,u.defaultValue),r.keypoint=u.defaultValue):r.path=u.formula(a,o)}d(r)},y=function(e,t){var n=e.left,l=e.top,a=e.start,o=e.end,r={type:"line",id:(0,s.x0)(10),left:n,top:l,start:a,end:o,points:t.points,color:i.value.themeColor,style:t.style,width:2};t.isBroken&&(r.broken=[(a[0]+o[0])/2,(a[1]+o[1])/2]),t.isCurve&&(r.curve=[(a[0]+o[0])/2,(a[1]+o[1])/2]),t.isCubic&&(r.cubic=[[(a[0]+o[0])/2,(a[1]+o[1])/2],[(a[0]+o[0])/2,(a[1]+o[1])/2]]),d(r)},w=function(e){d({type:"latex",id:(0,s.x0)(10),width:e.w,height:e.h,rotate:0,left:(wl-e.w)/2,top:(wl*r.value-e.h)/2,path:e.path,latex:e.latex,color:i.value.fontColor,strokeWidth:2,viewBox:[e.w,e.h],fixedRatio:!0})},x=function(e){d({type:"video",id:(0,s.x0)(10),width:500,height:300,rotate:0,left:(wl-500)/2,top:(wl*r.value-300)/2,src:e,autoplay:!1})},b=function(e){d({type:"audio",id:(0,s.x0)(10),width:50,height:50,rotate:0,left:(wl-50)/2,top:(wl*r.value-50)/2,loop:!1,autoplay:!1,fixedRatio:!0,color:i.value.themeColor,src:e})};return{createImageElement:f,createChartElement:v,createTableElement:p,createTextElement:h,createShapeElement:m,createLineElement:y,createLatexElement:w,createVideoElement:x,createAudioElement:b}};n(86466),n(37960);const Sl=function(){var e=X(),t=V(),n=(0,o.Jk)(t),l=n.currentSlide,a=n.slides,i=_l(),r=i.addHistorySnapshot,c=function(n){var a,o=We(n),i=o.groupIdMap,u=o.elIdMap,c=n[0],s=0;do{a=l.value.elements.find((function(e){if(e.type!==c.type)return!1;var t=Ze(e),n=t.minX,l=t.maxX,a=t.minY,o=t.maxY,i=Ze((0,g.Z)((0,g.Z)({},c),{},{left:c.left+s,top:c.top+s})),r=i.minX,u=i.maxX,d=i.minY,f=i.maxY;return n===r&&l===u&&a===d&&o===f})),a&&(s+=10)}while(a);var d,f=(0,y.Z)(n);try{for(f.s();!(d=f.n()).done;){var v=d.value;v.id=u[v.id],v.left=v.left+s,v.top=v.top+s,v.groupId&&(v.groupId=i[v.groupId])}}catch(p){f.e(p)}finally{f.f()}t.addElement(n),e.setActiveElementIdList(Object.values(u)),r()},d=function(e){var n=Ue(e),l=e.map((function(e){var t,l=We(e.elements),a=l.groupIdMap,o=l.elIdMap,i=(0,y.Z)(e.elements);try{for(i.s();!(t=i.n()).done;){var r=t.value;r.id=o[r.id],r.groupId&&(r.groupId=a[r.groupId]),r.link&&"slide"===r.link.type&&(n[r.link.target]?r.link.target=n[r.link.target]:delete r.link)}}catch(f){i.e(f)}finally{i.f()}if(e.animations){var u,c=(0,y.Z)(e.animations);try{for(c.s();!(u=c.n()).done;){var d=u.value;d.id=(0,s.x0)(10),d.elId=o[d.elId]}}catch(f){c.e(f)}finally{c.f()}}return(0,g.Z)((0,g.Z)({},e),{},{id:n[e.id]})}));t.addSlide(l),r()},f=(0,u.Fl)((function(){return!(a.value.length>1)&&!(a.value[0].elements.length>0)}));return{addElementsFromData:c,addSlidesFromData:d,isEmptySlide:f}},Cl=function(){var e=Il(),t=e.createTextElement,n=Sl(),l=n.addElementsFromData,a=n.addSlidesFromData,o=function(e){t({left:0,top:0,width:600,height:50},{content:e})},i=function(e,t){var n=(null===t||void 0===t?void 0:t.onlySlide)||!1,i=(null===t||void 0===t?void 0:t.onlyElements)||!1,r=Se(e);if("object"===(0,hl.Z)(r)){var u=r.type,c=r.data;"elements"!==u||n?"slides"!==u||i||a(c):l(c)}else if(!i&&!n){var s=ml(r);o(s)}};return{pasteTextClipboardData:i}},Ll=function(){var e=X(),t=V(),n=(0,o.Jk)(e),l=n.selectedSlidesIndex,a=n.activeElementIdList,i=(0,o.Jk)(t),r=i.currentSlide,c=i.slides,d=i.theme,f=i.slideIndex,v=(0,u.Fl)((function(){return[].concat((0,R.Z)(l.value),[f.value])})),p=(0,u.Fl)((function(){return c.value.filter((function(e,t){return v.value.includes(t)}))})),h=(0,u.Fl)((function(){return p.value.map((function(e){return e.id}))})),w=Cl(),x=w.pasteTextClipboardData,b=Sl(),k=b.addSlidesFromData,_=_l(),I=_.addHistorySnapshot,S=function(){var n={id:(0,s.x0)(10),elements:[],background:{type:"solid",color:d.value.backgroundColor}};t.updateSlideIndex(0),e.setActiveElementIdList([]),t.setSlides([n])},C=function(n){n===m.UP&&f.value>0?(a.value.length&&e.setActiveElementIdList([]),t.updateSlideIndex(f.value-1)):n===m.DOWN&&f.value<c.value.length-1&&(a.value.length&&e.setActiveElementIdList([]),t.updateSlideIndex(f.value+1))},L=function(){var t=be(JSON.stringify({type:"slides",data:p.value}));_e(t).then((function(){e.setThumbnailsFocus(!0)}))},E=function(){Ie().then((function(e){x(e,{onlySlide:!0})}))["catch"]((function(e){return dl.warning(e)}))},Z=function(){var n={id:(0,s.x0)(10),elements:[],background:{type:"solid",color:d.value.backgroundColor}};e.setActiveElementIdList([]),t.addSlide(n),I()},T=function(n){var l,a=We(n.elements),o=a.groupIdMap,i=a.elIdMap,r=(0,y.Z)(n.elements);try{for(r.s();!(l=r.n()).done;){var u=l.value;u.id=i[u.id],u.groupId&&(u.groupId=o[u.groupId])}}catch(d){r.e(d)}finally{r.f()}var c=(0,g.Z)((0,g.Z)({},n),{},{id:(0,s.x0)(10)});e.setActiveElementIdList([]),t.addSlide(c),I()},M=function(){var e=JSON.parse(JSON.stringify(r.value));k([e])},U=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h.value;c.value.length===n.length?S():t.deleteSlide(n),e.updateSelectedSlidesIndex([]),I()},W=function(){var e=(0,R.Z)(h.value);L(),U(e)},D=function(){var t=Array.from(Array(c.value.length),(function(e,t){return t}));e.setActiveElementIdList([]),e.updateSelectedSlidesIndex(t)},H=function(e,n){if(n!==e){var l=JSON.parse(JSON.stringify(c.value)),a=l[n];l.splice(n,1),l.splice(e,0,a),t.setSlides(l),t.updateSlideIndex(e)}};return{resetSlides:S,updateSlideIndex:C,copySlide:L,pasteSlide:E,createSlide:Z,createSlideByTemplate:T,copyAndPasteSlide:M,deleteSlide:U,cutSlide:W,selectAllSlide:D,sortSlides:H}},El=function(){var e=X(),t=V(),n=(0,o.Jk)(e),l=n.activeElementIdList,a=(0,o.Jk)(t),i=a.currentSlide,r=_l(),u=r.addHistorySnapshot,c=function(){var n,a=JSON.parse(JSON.stringify(i.value.elements)),o=(0,y.Z)(a);try{for(o.s();!(n=o.n()).done;){var r=n.value;l.value.includes(r.id)&&(r.lock=!0)}}catch(c){o.e(c)}finally{o.f()}t.updateSlide({elements:a}),e.setActiveElementIdList([]),u()},s=function(n){var l=JSON.parse(JSON.stringify(i.value.elements));if(n.groupId){var a,o=[],r=(0,y.Z)(l);try{for(r.s();!(a=r.n()).done;){var c=a.value;c.groupId===n.groupId&&(c.lock=!1,o.push(c.id))}}catch(v){r.e(v)}finally{r.f()}t.updateSlide({elements:l}),e.setActiveElementIdList(o)}else{var s,d=(0,y.Z)(l);try{for(d.s();!(s=d.n()).done;){var f=s.value;if(f.id===n.id){f.lock=!1;break}}}catch(v){d.e(v)}finally{d.f()}t.updateSlide({elements:l}),e.setActiveElementIdList([n.id])}u()};return{lockElement:c,unlockElement:s}},Zl=function(){var e=X(),t=V(),n=(0,o.Jk)(e),l=n.activeElementIdList,a=n.activeGroupElementId,i=(0,o.Jk)(t),r=i.currentSlide,u=_l(),c=u.addHistorySnapshot,s=function(){if(l.value.length){var n=[];n=a.value?r.value.elements.filter((function(e){return e.id!==a.value})):r.value.elements.filter((function(e){return!l.value.includes(e.id)})),e.setActiveElementIdList([]),t.updateSlide({elements:n}),c()}},d=function(){r.value.elements.length&&(e.setActiveElementIdList([]),t.updateSlide({elements:[]}),c())};return{deleteElement:s,deleteAllElements:d}};n(55791),n(98742);const Tl=function(){var e=X(),t=V(),n=(0,o.Jk)(e),l=n.activeElementIdList,a=n.activeElementList,i=n.handleElementId,r=(0,o.Jk)(t),c=r.currentSlide,d=_l(),f=d.addHistorySnapshot,v=(0,u.Fl)((function(){if(a.value.length<2)return!1;var e=a.value[0].groupId;if(!e)return!0;var t=a.value.every((function(t){return(t.groupId&&t.groupId)===e}));return!t})),p=function(){var e;if(a.value.length){var n,o=JSON.parse(JSON.stringify(c.value.elements)),i=(0,s.x0)(10),r=[],u=(0,y.Z)(o);try{for(u.s();!(n=u.n()).done;){var d=n.value;l.value.includes(d.id)&&(d.groupId=i,r.push(d))}}catch(m){u.e(m)}finally{u.f()}var v=o.findIndex((function(e){return e.id===r[r.length-1].id})),p=r.map((function(e){return e.id}));o=o.filter((function(e){return!p.includes(e.id)}));var h=v-r.length+1;(e=o).splice.apply(e,[h,0].concat(r)),t.updateSlide({elements:o}),f()}},h=function(){if(a.value.length){var n=a.value.some((function(e){return e.groupId}));if(n){var o,r=JSON.parse(JSON.stringify(c.value.elements)),u=(0,y.Z)(r);try{for(u.s();!(o=u.n()).done;){var s=o.value;l.value.includes(s.id)&&s.groupId&&delete s.groupId}}catch(v){u.e(v)}finally{u.f()}t.updateSlide({elements:r});var d=i.value?[i.value]:[];e.setActiveElementIdList(d),f()}}};return{canCombine:v,combineElements:p,uncombineElements:h}},Ml=function(){var e=X(),t=(0,o.Jk)(e),n=t.activeElementIdList,l=t.activeElementList,a=Cl(),i=a.pasteTextClipboardData,r=Zl(),u=r.deleteElement,c=function(){if(n.value.length){var t=be(JSON.stringify({type:"elements",data:l.value}));_e(t).then((function(){e.setEditorareaFocus(!0)}))}},s=function(){c(),u()},d=function(){Ie().then((function(e){i(e)}))["catch"]((function(e){return dl.warning(e)}))},f=function(){c(),d()};return{copyElement:c,cutElement:s,pasteElement:d,quickCopyElement:f}},Ul=function(){var e=X(),t=(0,o.Jk)(V()),n=t.currentSlide,l=(0,o.Jk)(e),a=l.hiddenElementIdList,i=function(){var t=n.value.elements.filter((function(e){return!e.lock&&!a.value.includes(e.id)})),l=t.map((function(e){return e.id}));e.setActiveElementIdList(l)};return{selectAllElement:i}},Wl=function(){var e=V(),t=(0,o.Jk)(X()),n=t.activeElementIdList,l=t.activeGroupElementId,a=(0,o.Jk)(e),i=a.currentSlide,r=_l(),u=r.addHistorySnapshot,c=function(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,o=[],r=function(e){var n=e.left,l=e.top;switch(t){case m.LEFT:n-=a;break;case m.RIGHT:n+=a;break;case m.UP:l-=a;break;case m.DOWN:l+=a;break;default:break}return(0,g.Z)((0,g.Z)({},e),{},{left:n,top:l})};o=l.value?i.value.elements.map((function(e){return l.value===e.id?r(e):e})):i.value.elements.map((function(e){return n.value.includes(e.id)?r(e):e})),e.updateSlide({elements:o}),u()};return{moveElement:c}};n(91719);const Dl=function(){var e=V(),t=(0,o.Jk)(e),n=t.currentSlide,l=_l(),a=l.addHistorySnapshot,i=function(e,t){return{minLevel:e.findIndex((function(e){return e.id===t[0].id})),maxLevel:e.findIndex((function(e){return e.id===t[t.length-1].id}))}},r=function(e,t){var n=JSON.parse(JSON.stringify(e));if(t.groupId){var l=n.filter((function(e){return e.groupId===t.groupId})),a=i(e,l),o=a.minLevel,r=a.maxLevel;if(r===e.length-1)return;var u=n[r+1],c=n.splice(o,l.length);if(u.groupId){var s=n.filter((function(e){return e.groupId===u.groupId}));n.splice.apply(n,[o+s.length,0].concat((0,R.Z)(c)))}else n.splice.apply(n,[o+1,0].concat((0,R.Z)(c)))}else{var d=e.findIndex((function(e){return e.id===t.id}));if(d===e.length-1)return;var f=n[d+1],v=n.splice(d,1)[0];if(f.groupId){var p=n.filter((function(e){return e.groupId===f.groupId}));n.splice(d+p.length,0,v)}else n.splice(d+1,0,v)}return n},u=function(e,t){var n=JSON.parse(JSON.stringify(e));if(t.groupId){var l=n.filter((function(e){return e.groupId===t.groupId})),a=i(e,l),o=a.minLevel;if(0===o)return;var r=n[o-1],u=n.splice(o,l.length);if(r.groupId){var c=n.filter((function(e){return e.groupId===r.groupId}));n.splice.apply(n,[o-c.length,0].concat((0,R.Z)(u)))}else n.splice.apply(n,[o-1,0].concat((0,R.Z)(u)))}else{var s=e.findIndex((function(e){return e.id===t.id}));if(0===s)return;var d=n[s-1],f=n.splice(s,1)[0];if(d.groupId){var v=n.filter((function(e){return e.groupId===d.groupId}));n.splice(s-v.length,0,f)}else n.splice(s-1,0,f)}return n},c=function(e,t){var n=JSON.parse(JSON.stringify(e));if(t.groupId){var l=n.filter((function(e){return e.groupId===t.groupId})),a=i(e,l),o=a.minLevel,r=a.maxLevel;if(r===e.length-1)return null;var u=n.splice(o,l.length);n.push.apply(n,(0,R.Z)(u))}else{var c=e.findIndex((function(e){return e.id===t.id}));if(c===e.length-1)return null;n.splice(c,1),n.push(t)}return n},s=function(e,t){var n=JSON.parse(JSON.stringify(e));if(t.groupId){var l=n.filter((function(e){return e.groupId===t.groupId})),a=i(e,l),o=a.minLevel;if(0===o)return;var r=n.splice(o,l.length);n.unshift.apply(n,(0,R.Z)(r))}else{var u=e.findIndex((function(e){return e.id===t.id}));if(0===u)return;n.splice(u,1),n.unshift(t)}return n},f=function(t,l){var o;l===d.UP?o=r(n.value.elements,t):l===d.DOWN?o=u(n.value.elements,t):l===d.TOP?o=c(n.value.elements,t):l===d.BOTTOM&&(o=s(n.value.elements,t)),o&&(e.updateSlide({elements:o}),a())};return{orderElement:f}};var Hl=function(){var e=document.documentElement;e.requestFullscreen?e.requestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.webkitRequestFullScreen?e.webkitRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},Fl=function(){document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen&&document.msExitFullscreen()},Al=function(){var e=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement||document.msFullscreenElement||document.webkitCurrentFullScreenElement;return!!e};const Ol=function(){var e=de(),t=V(),n=function(){Hl(),e.setScreening(!0)},l=function(){t.updateSlideIndex(0),n()},a=function(){e.setScreening(!1),Al()&&Fl()};return{enterScreening:n,enterScreeningFromStart:l,exitScreening:a}},Pl=function(){var e=X(),t=(0,o.Jk)(e),n=t.canvasPercentage,l=t.canvasScale,a=t.canvasDragged,i=(0,u.Fl)((function(){return Math.round(100*l.value)+"%"})),r=function(t){var l=n.value,a=5,o=200,i=30;"+"===t&&l<=o&&(l+=a),"-"===t&&l>=i&&(l-=a),e.setCanvasPercentage(l)},c=function(t){var a=Math.round(t/l.value*n.value)/100;e.setCanvasPercentage(a)},s=function(){e.setCanvasPercentage(90),a&&e.setCanvasDragged(!1)};return{canvasScalePercentage:i,setCanvasScalePercentage:c,scaleCanvas:r,resetCanvas:s}},Rl=function(){var e=X(),t=se(),n=(0,o.Jk)(e),l=n.activeElementIdList,a=n.disableHotkeys,i=n.handleElement,r=n.handleElementId,c=n.editorAreaFocus,s=n.thumbnailsFocus,f=n.showSearchPanel,v=(0,o.Jk)(V()),p=v.currentSlide,h=(0,o.Jk)(t),g=h.ctrlKeyState,y=h.shiftKeyState,w=h.spaceKeyState,x=Ll(),b=x.updateSlideIndex,k=x.copySlide,_=x.createSlide,I=x.deleteSlide,S=x.cutSlide,C=x.copyAndPasteSlide,L=x.selectAllSlide,E=Tl(),Z=E.combineElements,T=E.uncombineElements,M=Zl(),U=M.deleteElement,W=El(),D=W.lockElement,H=Ml(),F=H.copyElement,A=H.cutElement,O=H.quickCopyElement,P=Ul(),R=P.selectAllElement,B=Wl(),z=B.moveElement,N=Dl(),j=N.orderElement,Y=_l(),J=Y.redo,q=Y.undo,G=Ol(),K=G.enterScreening,Q=G.enterScreeningFromStart,$=Pl(),ee=$.scaleCanvas,te=$.resetCanvas,ne=function(){l.value.length?F():s.value&&k()},le=function(){l.value.length?A():s.value&&S()},ae=function(){l.value.length?O():s.value&&C()},oe=function(){c.value&&R(),s.value&&L()},ie=function(){c.value&&D()},re=function(){c.value&&Z()},ue=function(){c.value&&T()},ce=function(){l.value.length?U():s.value&&I()},de=function(e){l.value.length?z(e):e!==m.UP&&e!==m.DOWN||b(e)},fe=function(e){e===m.PAGEUP?b(m.UP):e===m.PAGEDOWN&&b(m.DOWN)},ve=function(e){i.value&&j(i.value,e)},pe=function(){s.value&&_()},he=function(){if(p.value.elements.length)if(r.value){var t=p.value.elements.findIndex((function(e){return e.id===r.value})),n=t>=p.value.elements.length-1?0:t+1,l=p.value.elements[n].id;e.setActiveElementIdList([l])}else{var a=p.value.elements[0];e.setActiveElementIdList([a.id])}},me=function(n){var l=n.ctrlKey,o=n.shiftKey,i=n.altKey,r=n.metaKey,u=l||r,v=n.key.toUpperCase();if(u&&!g.value&&t.setCtrlKeyState(!0),o&&!y.value&&t.setShiftKeyState(!0),a.value||v!==m.SPACE||t.setSpaceKeyState(!0),u&&v===m.P)return n.preventDefault(),void e.setDialogForExport("pdf");if(o&&v===m.F5)return n.preventDefault(),K(),void t.setShiftKeyState(!1);if(v===m.F5)return n.preventDefault(),void Q();if(l&&v===m.F)return n.preventDefault(),void e.setSearchPanelState(!f.value);if(c.value||s.value){if(u&&v===m.C){if(a.value)return;n.preventDefault(),ne()}if(u&&v===m.X){if(a.value)return;n.preventDefault(),le()}if(u&&v===m.D){if(a.value)return;n.preventDefault(),ae()}if(u&&v===m.Z){if(a.value)return;n.preventDefault(),q()}if(u&&v===m.Y){if(a.value)return;n.preventDefault(),J()}if(u&&v===m.A){if(a.value)return;n.preventDefault(),oe()}if(u&&v===m.L){if(a.value)return;n.preventDefault(),ie()}if(!o&&u&&v===m.G){if(a.value)return;n.preventDefault(),re()}if(o&&u&&v===m.G){if(a.value)return;n.preventDefault(),ue()}if(i&&v===m.F){if(a.value)return;n.preventDefault(),ve(d.TOP)}if(i&&v===m.B){if(a.value)return;n.preventDefault(),ve(d.BOTTOM)}if(v===m.DELETE||v===m.BACKSPACE){if(a.value)return;n.preventDefault(),ce()}if(v===m.UP){if(a.value)return;n.preventDefault(),de(m.UP)}if(v===m.DOWN){if(a.value)return;n.preventDefault(),de(m.DOWN)}if(v===m.LEFT){if(a.value)return;n.preventDefault(),de(m.LEFT)}if(v===m.RIGHT){if(a.value)return;n.preventDefault(),de(m.RIGHT)}if(v===m.PAGEUP){if(a.value)return;n.preventDefault(),fe(m.PAGEUP)}if(v===m.PAGEDOWN){if(a.value)return;n.preventDefault(),fe(m.PAGEDOWN)}if(v===m.ENTER){if(a.value)return;n.preventDefault(),pe()}if(v===m.MINUS){if(a.value)return;n.preventDefault(),ee("-")}if(v===m.EQUAL){if(a.value)return;n.preventDefault(),ee("+")}if(v===m.DIGIT_0){if(a.value)return;n.preventDefault(),te()}if(v===m.TAB){if(a.value)return;n.preventDefault(),he()}}},ge=function(){g.value&&t.setCtrlKeyState(!1),y.value&&t.setShiftKeyState(!1),w.value&&t.setSpaceKeyState(!1)};(0,u.bv)((function(){document.addEventListener("keydown",me),document.addEventListener("keyup",ge),window.addEventListener("blur",ge)})),(0,u.Ah)((function(){document.removeEventListener("keydown",me),document.removeEventListener("keyup",ge),window.removeEventListener("blur",ge)}))},Bl=function(){var e=(0,o.Jk)(X()),t=e.editorAreaFocus,n=e.thumbnailsFocus,l=e.disableHotkeys,a=Cl(),i=a.pasteTextClipboardData,r=Il(),c=r.createImageElement,s=function(e){yl(e).then((function(e){return c(e)}))},d=function(e){if((t.value||n.value)&&!l.value&&e.clipboardData){var a=e.clipboardData.items,o=a[0];if(o){var r,u=(0,y.Z)(a);try{for(u.s();!(r=u.n()).done;){var c=r.value;if("file"===c.kind&&-1!==c.type.indexOf("image")){var d=c.getAsFile();return void(d&&s(d))}}}catch(f){u.e(f)}finally{u.f()}"string"===o.kind&&"text/plain"===o.type&&o.getAsString((function(e){return i(e)}))}}};(0,u.bv)((function(){document.addEventListener("paste",d)})),(0,u.Ah)((function(){document.removeEventListener("paste",d)}))};n(72410);var zl=n(27536);const Nl=function(){var e=V(),t=(0,o.Jk)(V()),n=t.theme,l=Sl(),a=l.addSlidesFromData,u=l.isEmptySlide,d=(0,c.iH)(!1),f=function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],l=t[0],o=new FileReader;o.addEventListener("load",(function(){try{var t=JSON.parse(ke(o.result));n||u.value?e.setSlides(t):a(t)}catch(l){dl.error("The file could not be read/parsed correctly")}})),o.readAsText(l)},v=function(e){var t=[0,0],n=[0,0];return e.isFlipV||e.isFlipH?e.isFlipV&&e.isFlipH?(t=[e.width,e.height],n=[0,0]):e.isFlipV&&!e.isFlipH?(t=[0,e.height],n=[e.width,0]):(t=[e.width,0],n=[0,e.height]):(t=[0,0],n=[e.width,e.height]),{type:"line",id:(0,s.x0)(10),width:e.borderWidth||1,left:e.left,top:e.top,start:t,end:n,style:e.borderType,color:e.borderColor,points:["","straightConnector1"===e.shapType?"arrow":""]}},p=function(t){try{var n=JSON.parse(ke(t));e.setSlides(n),a(n)}catch(l){dl.error("The file could not be read/parsed correctly")}},h=function(t){d.value=!0;var l,a=[],o=(0,y.Z)(bl);try{for(o.s();!(l=o.n()).done;){var u=l.value;a.push.apply(a,(0,R.Z)(u.children))}}catch(f){o.e(f)}finally{o.f()}var c=new FileReader;c.onload=function(){var t=(0,r.Z)((0,i.Z)().mark((function t(l){var o,r,u,c,p,h,m;return(0,i.Z)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,(0,zl.Q)(l.target.result);case 2:o=t.sent,r=o.size.width,u=wl/r,c=[],p=(0,y.Z)(o.slides),t.prev=7,m=(0,i.Z)().mark((function e(){var t,l,o,r,d,p,m;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:t=h.value,l=t.fill,o=l.type,r=l.value,d="image"===o?{type:"image",image:r.picBase64,imageSize:"cover"}:"gradient"===o?{type:"gradient",gradientType:"linear",gradientColor:[r.colors[0],r.colors[1]],gradientRotate:r.rot}:{type:"solid",color:r},p={id:(0,s.x0)(10),elements:[],background:d},m=function e(t){var l,o=(0,y.Z)(t);try{var i=function(){var t=l.value;if(t.width=t.width*u,t.height=t.height*u,t.left=t.left*u,t.top=t.top*u,"text"===t.type)p.elements.push({type:"text",id:(0,s.x0)(10),width:t.width,height:t.height,left:t.left,top:t.top,rotate:t.rotate,defaultFontName:n.value.fontName,defaultColor:n.value.fontColor,content:t.content,lineHeight:1,outline:{color:t.borderColor,width:t.borderWidth,style:t.borderType},fill:t.fillColor});else if("image"===t.type)p.elements.push({type:"image",id:(0,s.x0)(10),src:t.src,width:t.width,height:t.height,left:t.left,top:t.top,fixedRatio:!0,rotate:t.rotate});else if("shape"===t.type)if("line"===t.shapType||"straightConnector1"===t.shapType){var o=v(t);p.elements.push(o)}else{var i=a.find((function(e){return e.pptxShapeType===t.shapType})),r={type:"shape",id:(0,s.x0)(10),width:t.width,height:t.height,left:t.left,top:t.top,viewBox:[200,200],path:"M 0 0 L 200 0 L 200 200 L 0 200 Z",fill:t.fillColor||"none",fixedRatio:!1,rotate:t.rotate,outline:{color:t.borderColor,width:t.borderWidth,style:t.borderType},text:{content:t.content,defaultFontName:n.value.fontName,defaultColor:n.value.fontColor,align:"middle"}};if(i&&(r.path=i.path,r.viewBox=i.viewBox,i.pathFormula)){r.pathFormula=i.pathFormula,r.viewBox=[t.width,t.height];var c=xl[i.pathFormula];"editable"in c?(r.path=c.formula(t.width,t.height,c.defaultValue),r.keypoint=c.defaultValue):r.path=c.formula(t.width,t.height)}p.elements.push(r)}else if("table"===t.type){for(var d=t.data.length,f=t.data[0].length,h={fontname:n.value.fontName,color:n.value.fontColor},m=[],y=0;y<d;y++){for(var w=[],x=0;x<f;x++){var b=t.data[y][x];w.push({id:(0,s.x0)(10),colspan:1,rowspan:b.rowSpan||1,text:b.text,style:h})}m.push(w)}var k=new Array(f).fill(1/f);p.elements.push({type:"table",id:(0,s.x0)(10),width:t.width,height:t.height,left:t.left,top:t.top,colWidths:k,rotate:0,data:m,outline:{width:2,style:"solid",color:"#eeece1"},theme:{color:n.value.themeColor,rowHeader:!0,rowFooter:!1,colHeader:!1,colFooter:!1},cellMinHeight:36})}else if("chart"===t.type){var _,I,S;"scatterChart"===t.chartType?(_=t.data[0].map((function(e){return e+""})),I=["系列1"],S=[t.data[1]]):(_=Object.values(t.data[0].xlabels),I=t.data.map((function(e){return e.key})),S=t.data.map((function(e){return e.values.map((function(e){return e.y}))})));var C={},L="bar";"barChart"===t.chartType&&(L="bar"),"stackedBarChart"===t.chartType?(L="bar",C={stackBars:!0}):"lineChart"===t.chartType?L="line":"areaChart"===t.chartType?(L="line",C={showArea:!0}):"scatterChart"===t.chartType?(L="line",C={showLine:!1}):"pieChart"!==t.chartType&&"pie3DChart"!==t.chartType||(L="pie"),p.elements.push({type:"chart",id:(0,s.x0)(10),chartType:L,width:t.width,height:t.height,left:t.left,top:t.top,rotate:0,themeColor:[n.value.themeColor],gridColor:n.value.fontColor,data:{labels:_,legends:I,series:S},options:C})}else if("group"===t.type){var E=t.elements.map((function(e){return(0,g.Z)((0,g.Z)({},e),{},{left:e.left+t.left,top:e.top+t.top})}));e(E)}};for(o.s();!(l=o.n()).done;)i()}catch(f){o.e(f)}finally{o.f()}},m(t.elements),c.push(p);case 7:case"end":return e.stop()}}),e)})),p.s();case 10:if((h=p.n()).done){t.next=14;break}return t.delegateYield(m(),"t0",12);case 12:t.next=10;break;case 14:t.next=19;break;case 16:t.prev=16,t.t1=t["catch"](7),p.e(t.t1);case 19:return t.prev=19,p.f(),t.finish(19);case 22:e.setSlides(c),d.value=!1;case 24:case"end":return t.stop()}}),t,null,[[7,16,19,22]])})));return function(e){return t.apply(this,arguments)}}(),c.readAsArrayBuffer(t)};return{importSpecificFile:f,importPPTXFile:h,exporting:d,importPaper:p}};n(95682);var jl=n(93162),Yl=n(23907),Vl=n(46293),Jl=(n(7409),["style","script","template"]),ql=["html","head","body","p","dt","dd","li","option","thead","th","tbody","tr","td","tfoot","colgroup"],Xl={li:["ul","ol","menu"],dt:["dl"],dd:["dl"],tbody:["table"],thead:["table"],tfoot:["table"],tr:["table"],td:["table"]},Gl=["!doctype","area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],Kl=function(e,t){var n=t-e.position;Ql(e,n)},Ql=function(e,t){e.position=e.position+t},$l=function(e,t){var n=!1;while(!n){var l=e.indexOf("<",t);if(-1===l)return l;var a=e.charAt(l+1);if("/"===a||"!"===a||/[A-Za-z0-9]/.test(a))return l;t=l+1}return-1},ea=function(e){var t=e.str,n=$l(t,e.position);if(n!==e.position){-1===n&&(n=t.length);var l=t.slice(e.position,n);Kl(e,n),e.tokens.push({type:"text",content:l})}},ta=function(e){var t=e.str;Ql(e,4);var n=t.indexOf("--\x3e",e.position),l=n+3;-1===n&&(n=l=t.length);var a=t.slice(e.position,n);Kl(e,l),e.tokens.push({type:"comment",content:a})},na=function(e){var t=e.str,n=t.length,l=e.position;while(l<n){var a=t.charAt(l),o=!(/\s/.test(a)||"/"===a||">"===a);if(o)break;l++}var i=l+1;while(i<n){var r=t.charAt(i),u=!(/\s/.test(r)||"/"===r||">"===r);if(!u)break;i++}Kl(e,i);var c=t.slice(l,i);return e.tokens.push({type:"tag",content:c}),c},la=function(e){var t=e.str,n=e.tokens,l=e.position,a=null,o=l,i=[],r=t.length;while(l<r){var u=t.charAt(l);if(a){var c=u===a;c&&(a=null),l++}else{var s="/"===u||">"===u;if(s){l!==o&&i.push(t.slice(o,l));break}var d=/\s/.test(u);if(d)l!==o&&i.push(t.slice(o,l)),o=l+1,l++;else{var f="'"===u||'"'===u;f?(a=u,l++):l++}}}Kl(e,l);for(var v="attribute",p=0;p<i.length;p++){var h=i[p],m=-1===h.indexOf("=");if(m){var g=i[p+1];if(g&&(0,z.startsWith)(g,"=")){if(g.length>1){var y=h+g;n.push({type:v,content:y}),p+=1;continue}var w=i[p+2];if(p+=1,w){var x=h+"="+w;n.push({type:v,content:x}),p+=1;continue}}}if((0,z.endsWith)(h,"=")){var b=i[p+1];if(b&&-1===b.indexOf("=")){var k=h+b;n.push({type:v,content:k}),p+=1;continue}var _=h.slice(0,-1);n.push({type:v,content:_})}else n.push({type:v,content:h})}},aa=function(e,t){var n=t.str,l=t.tokens,a=e.toLowerCase(),o=n.length,i=t.position;while(i<o){var r=n.indexOf("</",i);if(-1===r){ea(t);break}var u={str:n,position:t.position,tokens:[]};Kl(u,r);var c=oa(u);if(a===c.toLowerCase()){if(r!==t.position){var s=t.position;Kl(t,r),l.push({type:"text",content:n.slice(s,r)})}l.push.apply(l,(0,R.Z)(u.tokens)),Kl(t,u.position);break}i=u.position}},oa=function(e){var t=e.str,n=t.charAt(e.position+1),l="/"===n;Ql(e,l?2:1),e.tokens.push({type:"tag-start",close:l});var a=na(e);la(e);var o=t.charAt(e.position),i="/"===o;return Ql(e,i?2:1),e.tokens.push({type:"tag-end",close:i}),a},ia=function(e){var t=e.str,n=t.length;while(e.position<n){var l=e.position;if(ea(e),e.position===l){var a=(0,z.startsWith)(t,"!--",l+1);if(a)ta(e);else{var o=oa(e),i=o.toLowerCase();Jl.includes(i)&&aa(o,e)}}}},ra=function(e){var t={str:e,position:0,tokens:[]};return ia(t),t.tokens},ua=function(e){var t={tagName:null,children:[]},n={tokens:e,cursor:0,stack:[t]};return da(n),t.children},ca=function(e,t){var n=Xl[e];if(n){var l=t.length-1;while(l>=0){var a=t[l].tagName;if(a===e)break;if(a&&n.includes(a))return!0;l--}}return!1},sa=function(e,t){e.splice(t)},da=function e(t){var n=t.stack,l=t.tokens,a=t.cursor,o=n[n.length-1].children,i=l.length;while(a<i){var r=l[a];if("tag-start"===r.type){var u=l[++a];a++;var c=u.content.toLowerCase();if(r.close){var s=n.length,d=!1;while(--s>-1)if(n[s].tagName===c){d=!0;break}while(a<i){if("tag-end"!==l[a].type)break;a++}if(d){sa(n,s);break}}else{var f=ql.includes(c),v=f;if(v&&(v=!ca(c,n)),v){var p=n.length-1;while(p>0){if(c===n[p].tagName){sa(n,p);var h=p-1;o=n[h].children;break}p-=1}}var m=[],g=void 0;while(a<i){var y=l[a];if("tag-end"===y.type){g=y;break}m.push(y.content),a++}if(!g)break;a++;var w=[],x={type:"element",tagName:u.content,attributes:m,children:w};o.push(x);var b=!(g.close||Gl.includes(c));if(b){n.push({tagName:c,children:w});var k={tokens:l,cursor:a,stack:n};e(k),a=k.cursor}}}else o.push(r),a++}t.cursor=a},fa=(n(28436),function(e,t){var n=e.indexOf(t);return-1===n?[e]:[e.slice(0,n),e.slice(n+t.length)]}),va=function(e){var t=e.charAt(0),n=e.length-1,l='"'===t||"'"===t;return l&&t===e.charAt(n)?e.slice(1,n):e},pa=function(e){return e.map((function(e){var t=fa(e.trim(),"="),n=t[0],l="string"===typeof t[1]?va(t[1]):null;return{key:n,value:l}}))},ha=function e(t){return t.map((function(t){if("element"===t.type){var n=e(t.children),l={type:"element",tagName:t.tagName.toLowerCase(),attributes:pa(t.attributes),children:n};return l}var a={type:t.type,content:t.content};return a}))},ma=(n(278),function(e){var t=ra(e),n=ua(t);return ha(n)}),ga=n(35851),ya=n(7943),wa={1:"Z",2:"M",4:"H",8:"V",16:"L",32:"C",64:"S",128:"Q",256:"T",512:"A"},xa=function(e){var t,n=new ga.OU(e),l=[],a=(0,y.Z)(n.commands);try{for(a.s();!(t=a.n()).done;){var o=t.value,i=wa[o.type];if(2!==o.type&&16!==o.type||l.push({x:o.x,y:o.y,relative:o.relative,type:i}),32===o.type)l.push({x:o.x,y:o.y,curve:{type:"cubic",x1:o.x1,y1:o.y1,x2:o.x2,y2:o.y2},relative:o.relative,type:i});else if(128===o.type)l.push({x:o.x,y:o.y,curve:{type:"quadratic",x1:o.x1,y1:o.y1},relative:o.relative,type:i});else if(512===o.type){var r=l[l.length-1];if(!["M","L","Q","C"].includes(r.type))continue;var u,c=(0,ya.Z)({px:r.x,py:r.y,cx:o.x,cy:o.y,rx:o.rX,ry:o.rY,xAxisRotation:o.xRot,largeArcFlag:o.lArcFlag,sweepFlag:o.sweepFlag}),s=(0,y.Z)(c);try{for(s.s();!(u=s.n()).done;){var d=u.value;l.push({x:d.x,y:d.y,curve:{type:"cubic",x1:d.x1,y1:d.y1,x2:d.x2,y2:d.y2},relative:!1,type:"C"})}}catch(f){s.e(f)}finally{s.f()}}else{if(1!==o.type)continue;l.push({close:!0,type:i})}}}catch(f){a.e(f)}finally{a.f()}return l},ba="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",ka="data:image/svg+xml;base64,",_a=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var l=e.charCodeAt(n);l<128?t+=String.fromCharCode(l):l>127&&l<2048?(t+=String.fromCharCode(l>>6|192),t+=String.fromCharCode(63&l|128)):(t+=String.fromCharCode(l>>12|224),t+=String.fromCharCode(l>>6&63|128),t+=String.fromCharCode(63&l|128))}return t},Ia=function(e){var t,n,l,a,o,i,r,u="",c=0;e=_a(e);while(c<e.length)t=e.charCodeAt(c++),n=e.charCodeAt(c++),l=e.charCodeAt(c++),a=t>>2,o=(3&t)<<4|n>>4,i=(15&n)<<2|l>>6,r=63&l,isNaN(n)?i=r=64:isNaN(l)&&(r=64),u=u+ba.charAt(a)+ba.charAt(o)+ba.charAt(i)+ba.charAt(r);return u},Sa=function(e){var t=new XMLSerializer,n=t.serializeToString(e);return ka+Ia(n)},Ca=100,La=.75;const Ea=function(){var e=V(),t=(0,o.Jk)(e),n=t.slides,l=t.theme,a=t.viewportRatio,u=t.title,s=(0,c.iH)(!1),d=function(e,t,n){var l=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];s.value=!0;var a="png"===t?Vl.YM:Vl.hi,o=e.querySelectorAll("foreignObject [xmlns]");o.forEach((function(e){return e.removeAttribute("xmlns")})),setTimeout((function(){var o={quality:n,width:1600};l&&(o.fontEmbedCSS=""),a(e,o).then((function(e){s.value=!1,(0,jl.saveAs)(e,"".concat(u.value,".").concat(t))}))["catch"]((function(){s.value=!1,dl.error("Failed to export image")}))}),200)},f=function(e){var t=new Blob([be(JSON.stringify(e))],{type:""});(0,jl.saveAs)(t,"".concat(u.value,".ppt"))},v=function(){var e=new Blob([JSON.stringify(n.value)],{type:""});(0,jl.saveAs)(e,"".concat(u.value,".json"))},p=function(e){var t=(0,B.Z)(e),n=t.getAlpha(),l=0===n?"#ffffff":t.setAlpha(1).toHexString();return{alpha:n,color:l}},h=function(e){var t=ma(e),n=!1,l=0,a=[],o=function e(t){var o,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=(0,y.Z)(t);try{for(r.s();!(o=r.n()).done;){var u=o.value,c="tagName"in u&&["div","li","p"].includes(u.tagName);if(c&&a.length){var s=a[a.length-1];s.options||(s.options={}),s.options.breakLine=!0}var d=(0,g.Z)({},i),f="attributes"in u?u.attributes.find((function(e){return"style"===e.key})):null;if(f&&f.value){var v,h=f.value.split(";"),m=(0,y.Z)(h);try{for(m.s();!(v=m.n()).done;){var w=v.value,x=w.split(": "),b=(0,ne.Z)(x,2),k=b[0],_=b[1],I=[(0,z.trim)(k),(0,z.trim)(_)],S=I[0],C=I[1];S&&C&&(d[S]=C)}}catch(M){m.e(M)}finally{m.f()}}if("tagName"in u){if("em"===u.tagName&&(d["font-style"]="italic"),"strong"===u.tagName&&(d["font-weight"]="bold"),"sup"===u.tagName&&(d["vertical-align"]="super"),"sub"===u.tagName&&(d["vertical-align"]="sub"),"a"===u.tagName){var L=u.attributes.find((function(e){return"href"===e.key}));d["href"]=(null===L||void 0===L?void 0:L.value)||""}if("ul"===u.tagName&&(d["list-type"]="ul"),"ol"===u.tagName&&(d["list-type"]="ol"),"li"===u.tagName&&(n=!0),"p"===u.tagName&&"attributes"in u){var E=u.attributes.find((function(e){return"data-indent"===e.key}));E&&E.value&&(l=+E.value)}}if("tagName"in u&&"br"===u.tagName)a.push({text:"",options:{breakLine:!0}});else if("content"in u){var Z=u.content.replace(/&nbsp;/g," ").replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&").replace(/\n/g,""),T={};d["font-size"]&&(T.fontSize=parseInt(d["font-size"])*La),d["color"]&&(T.color=p(d["color"]).color),d["background-color"]&&(T.highlight=p(d["background-color"]).color),d["text-decoration-line"]&&(-1!==d["text-decoration-line"].indexOf("underline")&&(T.underline={color:T.color||"#000000",style:"sng"}),-1!==d["text-decoration-line"].indexOf("line-through")&&(T.strike="sngStrike")),d["text-decoration"]&&(-1!==d["text-decoration"].indexOf("underline")&&(T.underline={color:T.color||"#000000",style:"sng"}),-1!==d["text-decoration"].indexOf("line-through")&&(T.strike="sngStrike")),d["vertical-align"]&&("super"===d["vertical-align"]&&(T.superscript=!0),"sub"===d["vertical-align"]&&(T.subscript=!0)),d["text-align"]&&(T.align=d["text-align"]),d["font-weight"]&&(T.bold="bold"===d["font-weight"]),d["font-style"]&&(T.italic="italic"===d["font-style"]),d["font-family"]&&(T.fontFace=d["font-family"]),d["href"]&&(T.hyperlink={url:d["href"]}),n&&"ol"===d["list-type"]&&(T.bullet={type:"number",indent:20*La},T.paraSpaceBefore=.1,n=!1),n&&"ul"===d["list-type"]&&(T.bullet={indent:20*La},T.paraSpaceBefore=.1,n=!1),l&&(T.indentLevel=l,l=0),a.push({text:Z,options:T})}else"children"in u&&e(u.children,d)}}catch(M){r.e(M)}finally{r.f()}};return o(t),a},m=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{x:1,y:1};return e.map((function(e){if(void 0!==e.close)return{close:!0};if("M"===e.type)return{x:e.x/Ca*t.x,y:e.y/Ca*t.y,moveTo:!0};if(e.curve){if("cubic"===e.curve.type)return{x:e.x/Ca*t.x,y:e.y/Ca*t.y,curve:{type:"cubic",x1:e.curve.x1/Ca*t.x,y1:e.curve.y1/Ca*t.y,x2:e.curve.x2/Ca*t.x,y2:e.curve.y2/Ca*t.y}};if("quadratic"===e.curve.type)return{x:e.x/Ca*t.x,y:e.y/Ca*t.y,curve:{type:"quadratic",x1:e.curve.x1/Ca*t.x,y1:e.curve.y1/Ca*t.y}}}return{x:e.x/Ca*t.x,y:e.y/Ca*t.y}}))},w=function(e){var t=p(e.color),n=e.h,l=e.v,a=4,o=45;return 0===n&&0===l?(a=4,o=45):0===n?l>0?(a=l,o=90):(a=-l,o=270):0===l?n>0?(a=n,o=1):(a=-n,o=180):n>0&&l>0?(a=Math.max(n,l),o=45):n>0&&l<0?(a=Math.max(n,-l),o=315):n<0&&l>0?(a=Math.max(-n,l),o=135):n<0&&l<0&&(a=Math.max(-n,-l),o=225),{type:"outer",color:t.color.replace("#",""),opacity:t.alpha,blur:e.blur*La,offset:a,angle:o}},x=function(e){var t=p((null===e||void 0===e?void 0:e.color)||"#000000");return{color:t.color,transparency:100*(1-t.alpha),width:(e.width||1)*La,dashType:"solid"===e.style?"solid":"dash"}},b=function(e){var t=e.type,l=e.target;if("web"===t)return{url:l};if("slide"===t){var a=n.value.findIndex((function(e){return e.id===l}));if(-1!==a)return{slide:a+1}}return null},k=function(e,t,n){s.value=!0;var o=new Yl.Z;if(.625===a.value?o.layout="LAYOUT_16x10":.75===a.value?o.layout="LAYOUT_4x3":.70710678===a.value?(o.defineLayout({name:"A3",width:10,height:7.0710678}),o.layout="A3"):o.layout="LAYOUT_16x9",t){var i=p(l.value.backgroundColor),r=i.color,c=i.alpha;o.defineSlideMaster({title:"Paperport_MASTER",background:{color:r,transparency:100*(1-c)}})}var d,f=(0,y.Z)(e);try{for(f.s();!(d=f.n()).done;){var v=d.value,g=o.addSlide();if(v.background){var k=v.background;if("image"===k.type&&k.image)g.background={data:k.image};else if("solid"===k.type&&k.color){var _=p(k.color);g.background={color:_.color,transparency:100*(1-_.alpha)}}else if("gradient"===k.type&&k.gradientColor){var I=(0,ne.Z)(k.gradientColor,2),S=I[0],C=I[1],L=B.Z.mix(S,C).toHexString(),E=p(L);g.background={color:E.color,transparency:100*(1-E.alpha)}}}if(v.remark&&g.addNotes(v.remark),v.elements){var Z,T=(0,y.Z)(v.elements);try{var M=function(){var e=Z.value;if("text"===e.type){var t,l=h(e.content),a={x:e.left/Ca,y:e.top/Ca,w:e.width/Ca,h:e.height/Ca,fontSize:20*La,fontFace:"Microsoft Yahei",color:"#000000",valign:"top",margin:10*La,paraSpaceBefore:5*La,lineSpacingMultiple:1.2,autoFit:!0};if(e.rotate&&(a.rotate=e.rotate),e.wordSpace&&(a.charSpacing=e.wordSpace*La),e.lineHeight&&(a.lineSpacingMultiple=e.lineHeight/1.25),e.fill){var i=p(e.fill),r=void 0===e.opacity?1:e.opacity;a.fill={color:i.color,transparency:100*(1-i.alpha*r)}}e.defaultColor&&(a.color=p(e.defaultColor).color),e.defaultFontName&&(a.fontFace=e.defaultFontName),e.shadow&&(a.shadow=w(e.shadow)),null!==(t=e.outline)&&void 0!==t&&t.width&&(a.line=x(e.outline)),void 0!==e.opacity&&(a.transparency=100*(1-e.opacity)),void 0!==e.paragraphSpace&&(a.paraSpaceBefore=e.paragraphSpace*La),e.vertical&&(a.vert="eaVert"),g.addText(l,a)}else if("image"===e.type){var u,c,s={path:e.src,x:e.left/Ca,y:e.top/Ca,w:e.width/Ca,h:e.height/Ca};if(e.flipH&&(s.flipH=e.flipH),e.flipV&&(s.flipV=e.flipV),e.rotate&&(s.rotate=e.rotate),e.link){var d=b(e.link);d&&(s.hyperlink=d)}if(null!==(u=e.filters)&&void 0!==u&&u.opacity&&(s.transparency=100-parseInt(null===(c=e.filters)||void 0===c?void 0:c.opacity)),e.clip){"ellipse"===e.clip.shape&&(s.rounding=!0);var f=(0,ne.Z)(e.clip.range,2),v=f[0],y=f[1],k=(0,ne.Z)(v,2),_=k[0],I=k[1],S=(0,ne.Z)(y,2),C=S[0],L=S[1],E=e.width/((C-_)/Ca),T=e.height/((L-I)/Ca);s.w=E/Ca,s.h=T/Ca,s.sizing={type:"crop",x:_/Ca*E/Ca,y:I/Ca*T/Ca,w:(C-_)/Ca*E/Ca,h:(L-I)/Ca*T/Ca}}g.addImage(s)}else if("shape"===e.type){if(e.special){var M=document.querySelector(".thumbnail-list .base-element-".concat(e.id," svg")),U=Sa(M),W={data:U,x:e.left/Ca,y:e.top/Ca,w:e.width/Ca,h:e.height/Ca};if(e.rotate&&(W.rotate=e.rotate),e.link){var D=b(e.link);D&&(W.hyperlink=D)}g.addImage(W)}else{var H,F={x:e.width/e.viewBox[0],y:e.height/e.viewBox[1]},A=m(xa(e.path),F),O=p(e.fill),P=void 0===e.opacity?1:e.opacity,z={x:e.left/Ca,y:e.top/Ca,w:e.width/Ca,h:e.height/Ca,fill:{color:O.color,transparency:100*(1-O.alpha*P)},points:A};if(e.flipH&&(z.flipH=e.flipH),e.flipV&&(z.flipV=e.flipV),e.shadow&&(z.shadow=w(e.shadow)),null!==(H=e.outline)&&void 0!==H&&H.width&&(z.line=x(e.outline)),e.rotate&&(z.rotate=e.rotate),e.link){var N=b(e.link);N&&(z.hyperlink=N)}g.addShape("custGeom",z)}if(e.text){var j=h(e.text.content),Y={x:e.left/Ca,y:e.top/Ca,w:e.width/Ca,h:e.height/Ca,fontSize:20*La,fontFace:"Microsoft Yahei",color:"#000000",paraSpaceBefore:5*La,valign:e.text.align};e.rotate&&(Y.rotate=e.rotate),e.text.defaultColor&&(Y.color=p(e.text.defaultColor).color),e.text.defaultFontName&&(Y.fontFace=e.text.defaultFontName),g.addText(j,Y)}}else if("line"===e.type){var V=He(e),J=m(xa(V)),q=Ze(e),X=q.minX,G=q.maxX,K=q.minY,Q=q.maxY,$=p(e.color),ee={x:e.left/Ca,y:e.top/Ca,w:(G-X)/Ca,h:(Q-K)/Ca,line:{color:$.color,transparency:100*(1-$.alpha),width:e.width*La,dashType:"solid"===e.style?"solid":"dash",beginArrowType:e.points[0]?"arrow":"none",endArrowType:e.points[1]?"arrow":"none"},points:J};e.shadow&&(ee.shadow=w(e.shadow)),g.addShape("custGeom",ee)}else if("chart"===e.type){for(var te=[],le=0;le<e.data.series.length;le++){var ae=e.data.series[le];te.push({name:"系列".concat(le+1),labels:e.data.labels,values:ae})}var oe=[];if(10===e.themeColor.length)oe=e.themeColor.map((function(e){return p(e).color}));else if(1===e.themeColor.length)oe=(0,B.Z)(e.themeColor[0]).analogous(10).map((function(e){return p(e.toHexString()).color}));else{var ie=e.themeColor.length,re=(0,B.Z)(e.themeColor[ie-1]).analogous(11-ie).map((function(e){return e.toHexString()}));oe=[].concat((0,R.Z)(e.themeColor.slice(0,ie-1)),(0,R.Z)(re)).map((function(e){return p(e).color}))}var ue={x:e.left/Ca,y:e.top/Ca,w:e.width/Ca,h:e.height/Ca,chartColors:"pie"===e.chartType?oe:oe.slice(0,e.data.series.length)};e.fill&&(ue.plotArea={fill:{color:p(e.fill).color}}),e.legend&&(ue.showLegend=!0,ue.legendPos="top"===e.legend?"t":"b",ue.legendColor=p(e.gridColor||"#000000").color,ue.legendFontSize=14*La);var ce,se=o.ChartType.bar;if("bar"===e.chartType)se=o.ChartType.bar,ue.barDir=null!==(ce=e.options)&&void 0!==ce&&ce.horizontalBars?"bar":"col";else if("line"===e.chartType){var de,fe,ve;null!==(de=e.options)&&void 0!==de&&de.showArea?se=o.ChartType.area:!1===(null===(fe=e.options)||void 0===fe?void 0:fe.showLine)?(se=o.ChartType.scatter,te.unshift({name:"X-Axis",values:Array(e.data.series[0].length).fill(0).map((function(e,t){return t}))}),ue.lineSize=0):se=o.ChartType.line,null!==(ve=e.options)&&void 0!==ve&&ve.lineSmooth&&(ue.lineSmooth=!0)}else if("pie"===e.chartType){var pe;null!==(pe=e.options)&&void 0!==pe&&pe.donut?(se=o.ChartType.doughnut,ue.holeSize=75):se=o.ChartType.pie}g.addChart(se,te,ue)}else if("table"===e.type){for(var he=[],me=0;me<e.data.length;me++)for(var ge=e.data[me],ye=0;ye<ge.length;ye++){var we=ge[ye];if(we.colspan>1||we.rowspan>1)for(var xe=me;xe<me+we.rowspan;xe++)for(var be=xe===me?ye+1:ye;be<ye+we.colspan;be++)he.push("".concat(xe,"_").concat(be))}var ke=[],_e=e.theme,Ie=null,Se=[];_e&&(Ie=p(_e.color),Se=De(_e.color).map((function(e){return p(e)})));for(var Ce=0;Ce<e.data.length;Ce++){for(var Le=e.data[Ce],Ee=[],Te=0;Te<Le.length;Te++){var Me,Ue,We,Fe,Ae,Oe,Pe,Re,Be,ze=Le[Te],Ne={colspan:ze.colspan,rowspan:ze.rowspan,bold:(null===(Me=ze.style)||void 0===Me?void 0:Me.bold)||!1,italic:(null===(Ue=ze.style)||void 0===Ue?void 0:Ue.em)||!1,underline:{style:null!==(We=ze.style)&&void 0!==We&&We.underline?"sng":"none"},align:(null===(Fe=ze.style)||void 0===Fe?void 0:Fe.align)||"left",valign:"middle",fontFace:(null===(Ae=ze.style)||void 0===Ae?void 0:Ae.fontname)||"微软雅黑",fontSize:(null!==(Oe=ze.style)&&void 0!==Oe&&Oe.fontsize?parseInt(null===(Pe=ze.style)||void 0===Pe?void 0:Pe.fontsize):14)*La};if(_e&&Ie){var je=void 0;je=Ce%2===0?Se[1]:Se[0],(_e.rowHeader&&0===Ce||_e.rowFooter&&Ce===e.data.length-1||_e.colHeader&&0===Te||_e.colFooter&&Te===Le.length-1)&&(je=Ie),Ne.fill={color:je.color,transparency:100*(1-je.alpha)}}if(null!==(Re=ze.style)&&void 0!==Re&&Re.backcolor){var Ye=p(ze.style.backcolor);Ne.fill={color:Ye.color,transparency:100*(1-Ye.alpha)}}null!==(Be=ze.style)&&void 0!==Be&&Be.color&&(Ne.color=p(ze.style.color).color),he.includes("".concat(Ce,"_").concat(Te))||Ee.push({text:ze.text,options:Ne})}Ee.length&&ke.push(Ee)}var Ve={x:e.left/Ca,y:e.top/Ca,w:e.width/Ca,h:e.height/Ca,colW:e.colWidths.map((function(t){return e.width*t/Ca}))};e.theme&&(Ve.fill={color:"#ffffff"}),e.outline.width&&e.outline.color&&(Ve.border={type:"solid"===e.outline.style?"solid":"dash",pt:e.outline.width*La,color:p(e.outline.color).color}),g.addTable(ke,Ve)}else if("latex"===e.type){var Je=document.querySelector(".thumbnail-list .base-element-".concat(e.id," svg")),qe=Sa(Je),Xe={data:qe,x:e.left/Ca,y:e.top/Ca,w:e.width/Ca,h:e.height/Ca};if(e.link){var Ge=b(e.link);Ge&&(Xe.hyperlink=Ge)}g.addImage(Xe)}else if(!n&&("video"===e.type||"audio"===e.type)){var Ke={x:e.left/Ca,y:e.top/Ca,w:e.width/Ca,h:e.height/Ca,path:e.src,type:e.type};"video"===e.type&&e.poster&&(Ke.cover=e.poster);var Qe=e.src.match(/\.([a-zA-Z0-9]+)(?:[\?#]|$)/);Qe&&Qe[1]?Ke.extn=Qe[1]:e.ext&&(Ke.extn=e.ext);var $e=["avi","mp4","m4v","mov","wmv"],et=["mp3","m4a","mp4","wav","wma"];Ke.extn&&[].concat($e,et).includes(Ke.extn)&&g.addMedia(Ke)}};for(T.s();!(Z=T.n()).done;)M()}catch(U){T.e(U)}finally{T.f()}}}}catch(U){f.e(U)}finally{f.f()}setTimeout((function(){o.writeFile({fileName:"".concat(u.value,".pptx")}).then((function(){return s.value=!1}))["catch"]((function(){s.value=!1,dl.error("Export failed")}))}),200)},_=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(t,n,o){var r,u,c,d,f,v,g,k,_,I,S,C,L,E,Z,T,M,U,W;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:s.value=!0,r=new Yl.Z,.625===a.value?r.layout="LAYOUT_16x10":.75===a.value?r.layout="LAYOUT_4x3":.70710678===a.value?(r.defineLayout({name:"A3",width:10,height:7.0710678}),r.layout="A3"):r.layout="LAYOUT_16x9",n&&(u=p(l.value.backgroundColor),c=u.color,d=u.alpha,r.defineSlideMaster({title:"Paperport_MASTER",background:{color:c,transparency:100*(1-d)}})),f=(0,y.Z)(t),e.prev=5,f.s();case 7:if((v=f.n()).done){e.next=32;break}if(g=v.value,k=r.addSlide(),g.background&&(_=g.background,"image"===_.type&&_.image?k.background={data:_.image}:"solid"===_.type&&_.color?(I=p(_.color),k.background={color:I.color,transparency:100*(1-I.alpha)}):"gradient"===_.type&&_.gradientColor&&(S=(0,ne.Z)(_.gradientColor,2),C=S[0],L=S[1],E=B.Z.mix(C,L).toHexString(),Z=p(E),k.background={color:Z.color,transparency:100*(1-Z.alpha)})),g.remark&&k.addNotes(g.remark),g.elements){e.next=14;break}return e.abrupt("continue",30);case 14:T=(0,y.Z)(g.elements),e.prev=15,U=(0,i.Z)().mark((function e(){var t,n,l,a,u,c,s,d,f,v,g,y,_,I,S,C,L,E,Z,T,U,W,D,H,F,A,O,P,z,N,j,Y,V,J,q,X,G,K,Q,$,ee,te,le,ae,oe,ie,re,ue,ce,se,de,fe,ve,pe,he,me,ge,ye,we,xe,be,ke,_e,Ie,Se,Ce,Le,Ee,Te,Me,Ue,We,Fe,Ae,Oe,Pe,Re,Be,ze,Ne,je,Ye,Ve,Je,qe,Xe,Ge,Ke,Qe,$e,et,tt,nt;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t=M.value,"text"===t.type)l=h(t.content),a={x:t.left/Ca,y:t.top/Ca,w:t.width/Ca,h:t.height/Ca,fontSize:20*La,fontFace:"Microsoft Yahei",color:"#000000",valign:"top",margin:10*La,paraSpaceBefore:5*La,lineSpacingMultiple:1.2,autoFit:!0},t.rotate&&(a.rotate=t.rotate),t.wordSpace&&(a.charSpacing=t.wordSpace*La),t.lineHeight&&(a.lineSpacingMultiple=t.lineHeight/1.25),t.fill&&(u=p(t.fill),c=void 0===t.opacity?1:t.opacity,a.fill={color:u.color,transparency:100*(1-u.alpha*c)}),t.defaultColor&&(a.color=p(t.defaultColor).color),t.defaultFontName&&(a.fontFace=t.defaultFontName),t.shadow&&(a.shadow=w(t.shadow)),null!==(n=t.outline)&&void 0!==n&&n.width&&(a.line=x(t.outline)),void 0!==t.opacity&&(a.transparency=100*(1-t.opacity)),void 0!==t.paragraphSpace&&(a.paraSpaceBefore=t.paragraphSpace*La),t.vertical&&(a.vert="eaVert"),k.addText(l,a);else if("image"===t.type)f={path:t.src,x:t.left/Ca,y:t.top/Ca,w:t.width/Ca,h:t.height/Ca},t.flipH&&(f.flipH=t.flipH),t.flipV&&(f.flipV=t.flipV),t.rotate&&(f.rotate=t.rotate),t.link&&(v=b(t.link),v&&(f.hyperlink=v)),null!==(s=t.filters)&&void 0!==s&&s.opacity&&(f.transparency=100-parseInt(null===(d=t.filters)||void 0===d?void 0:d.opacity)),t.clip&&("ellipse"===t.clip.shape&&(f.rounding=!0),g=(0,ne.Z)(t.clip.range,2),y=g[0],_=g[1],I=(0,ne.Z)(y,2),S=I[0],C=I[1],L=(0,ne.Z)(_,2),E=L[0],Z=L[1],T=t.width/((E-S)/Ca),U=t.height/((Z-C)/Ca),f.w=T/Ca,f.h=U/Ca,f.sizing={type:"crop",x:S/Ca*T/Ca,y:C/Ca*U/Ca,w:(E-S)/Ca*T/Ca,h:(Z-C)/Ca*U/Ca}),k.addImage(f);else if("shape"===t.type)t.special?(W=document.querySelector(".thumbnail-list .base-element-".concat(t.id," svg")),D=Sa(W),H={data:D,x:t.left/Ca,y:t.top/Ca,w:t.width/Ca,h:t.height/Ca},t.rotate&&(H.rotate=t.rotate),t.link&&(F=b(t.link),F&&(H.hyperlink=F)),k.addImage(H)):(O={x:t.width/t.viewBox[0],y:t.height/t.viewBox[1]},P=m(xa(t.path),O),z=p(t.fill),N=void 0===t.opacity?1:t.opacity,j={x:t.left/Ca,y:t.top/Ca,w:t.width/Ca,h:t.height/Ca,fill:{color:z.color,transparency:100*(1-z.alpha*N)},points:P},t.flipH&&(j.flipH=t.flipH),t.flipV&&(j.flipV=t.flipV),t.shadow&&(j.shadow=w(t.shadow)),null!==(A=t.outline)&&void 0!==A&&A.width&&(j.line=x(t.outline)),t.rotate&&(j.rotate=t.rotate),t.link&&(Y=b(t.link),Y&&(j.hyperlink=Y)),k.addShape("custGeom",j)),t.text&&(V=h(t.text.content),J={x:t.left/Ca,y:t.top/Ca,w:t.width/Ca,h:t.height/Ca,fontSize:20*La,fontFace:"Microsoft Yahei",color:"#000000",paraSpaceBefore:5*La,valign:t.text.align},t.rotate&&(J.rotate=t.rotate),t.text.defaultColor&&(J.color=p(t.text.defaultColor).color),t.text.defaultFontName&&(J.fontFace=t.text.defaultFontName),k.addText(V,J));else if("line"===t.type)q=He(t),X=m(xa(q)),G=Ze(t),K=G.minX,Q=G.maxX,$=G.minY,ee=G.maxY,te=p(t.color),le={x:t.left/Ca,y:t.top/Ca,w:(Q-K)/Ca,h:(ee-$)/Ca,line:{color:te.color,transparency:100*(1-te.alpha),width:t.width*La,dashType:"solid"===t.style?"solid":"dash",beginArrowType:t.points[0]?"arrow":"none",endArrowType:t.points[1]?"arrow":"none"},points:X},t.shadow&&(le.shadow=w(t.shadow)),k.addShape("custGeom",le);else if("chart"===t.type){for(ae=[],oe=0;oe<t.data.series.length;oe++)ie=t.data.series[oe],ae.push({name:"系列".concat(oe+1),labels:t.data.labels,values:ie});re=[],10===t.themeColor.length?re=t.themeColor.map((function(e){return p(e).color})):1===t.themeColor.length?re=(0,B.Z)(t.themeColor[0]).analogous(10).map((function(e){return p(e.toHexString()).color})):(ue=t.themeColor.length,ce=(0,B.Z)(t.themeColor[ue-1]).analogous(11-ue).map((function(e){return e.toHexString()})),re=[].concat((0,R.Z)(t.themeColor.slice(0,ue-1)),(0,R.Z)(ce)).map((function(e){return p(e).color}))),se={x:t.left/Ca,y:t.top/Ca,w:t.width/Ca,h:t.height/Ca,chartColors:"pie"===t.chartType?re:re.slice(0,t.data.series.length)},t.fill&&(se.plotArea={fill:{color:p(t.fill).color}}),t.legend&&(se.showLegend=!0,se.legendPos="top"===t.legend?"t":"b",se.legendColor=p(t.gridColor||"#000000").color,se.legendFontSize=14*La),de=r.ChartType.bar,"bar"===t.chartType?(de=r.ChartType.bar,se.barDir=null!==(fe=t.options)&&void 0!==fe&&fe.horizontalBars?"bar":"col"):"line"===t.chartType?(null!==(ve=t.options)&&void 0!==ve&&ve.showArea?de=r.ChartType.area:!1===(null===(pe=t.options)||void 0===pe?void 0:pe.showLine)?(de=r.ChartType.scatter,ae.unshift({name:"X-Axis",values:Array(t.data.series[0].length).fill(0).map((function(e,t){return t}))}),se.lineSize=0):de=r.ChartType.line,null!==(he=t.options)&&void 0!==he&&he.lineSmooth&&(se.lineSmooth=!0)):"pie"===t.chartType&&(null!==(me=t.options)&&void 0!==me&&me.donut?(de=r.ChartType.doughnut,se.holeSize=75):de=r.ChartType.pie),k.addChart(de,ae,se)}else if("table"===t.type){for(ge=[],ye=0;ye<t.data.length;ye++)for(we=t.data[ye],xe=0;xe<we.length;xe++)if(be=we[xe],be.colspan>1||be.rowspan>1)for(ke=ye;ke<ye+be.rowspan;ke++)for(_e=ke===ye?xe+1:xe;_e<xe+be.colspan;_e++)ge.push("".concat(ke,"_").concat(_e));for(Ie=[],Se=t.theme,Ce=null,Le=[],Se&&(Ce=p(Se.color),Le=De(Se.color).map((function(e){return p(e)}))),Ee=0;Ee<t.data.length;Ee++){for(Te=t.data[Ee],Me=[],Ue=0;Ue<Te.length;Ue++)je=Te[Ue],Ye={colspan:je.colspan,rowspan:je.rowspan,bold:(null===(We=je.style)||void 0===We?void 0:We.bold)||!1,italic:(null===(Fe=je.style)||void 0===Fe?void 0:Fe.em)||!1,underline:{style:null!==(Ae=je.style)&&void 0!==Ae&&Ae.underline?"sng":"none"},align:(null===(Oe=je.style)||void 0===Oe?void 0:Oe.align)||"left",valign:"middle",fontFace:(null===(Pe=je.style)||void 0===Pe?void 0:Pe.fontname)||"微软雅黑",fontSize:(null!==(Re=je.style)&&void 0!==Re&&Re.fontsize?parseInt(null===(Be=je.style)||void 0===Be?void 0:Be.fontsize):14)*La},Se&&Ce&&(Ve=void 0,Ve=Ee%2===0?Le[1]:Le[0],(Se.rowHeader&&0===Ee||Se.rowFooter&&Ee===t.data.length-1||Se.colHeader&&0===Ue||Se.colFooter&&Ue===Te.length-1)&&(Ve=Ce),Ye.fill={color:Ve.color,transparency:100*(1-Ve.alpha)}),null!==(ze=je.style)&&void 0!==ze&&ze.backcolor&&(Je=p(je.style.backcolor),Ye.fill={color:Je.color,transparency:100*(1-Je.alpha)}),null!==(Ne=je.style)&&void 0!==Ne&&Ne.color&&(Ye.color=p(je.style.color).color),ge.includes("".concat(Ee,"_").concat(Ue))||Me.push({text:je.text,options:Ye});Me.length&&Ie.push(Me)}qe={x:t.left/Ca,y:t.top/Ca,w:t.width/Ca,h:t.height/Ca,colW:t.colWidths.map((function(e){return t.width*e/Ca}))},t.theme&&(qe.fill={color:"#ffffff"}),t.outline.width&&t.outline.color&&(qe.border={type:"solid"===t.outline.style?"solid":"dash",pt:t.outline.width*La,color:p(t.outline.color).color}),k.addTable(Ie,qe)}else"latex"===t.type?(Xe=document.querySelector(".thumbnail-list .base-element-".concat(t.id," svg")),Ge=Sa(Xe),Ke={data:Ge,x:t.left/Ca,y:t.top/Ca,w:t.width/Ca,h:t.height/Ca},t.link&&(Qe=b(t.link),Qe&&(Ke.hyperlink=Qe)),k.addImage(Ke)):o||"video"!==t.type&&"audio"!==t.type||($e={x:t.left/Ca,y:t.top/Ca,w:t.width/Ca,h:t.height/Ca,path:t.src,type:t.type},"video"===t.type&&t.poster&&($e.cover=t.poster),et=t.src.match(/\.([a-zA-Z0-9]+)(?:[\?#]|$)/),et&&et[1]?$e.extn=et[1]:t.ext&&($e.extn=t.ext),tt=["avi","mp4","m4v","mov","wmv"],nt=["mp3","m4a","mp4","wav","wma"],$e.extn&&[].concat(tt,nt).includes($e.extn)&&k.addMedia($e));case 2:case"end":return e.stop()}}),e)})),T.s();case 18:if((M=T.n()).done){e.next=22;break}return e.delegateYield(U(),"t0",20);case 20:e.next=18;break;case 22:e.next=27;break;case 24:e.prev=24,e.t1=e["catch"](15),T.e(e.t1);case 27:return e.prev=27,T.f(),e.finish(27);case 30:e.next=7;break;case 32:e.next=37;break;case 34:e.prev=34,e.t2=e["catch"](5),f.e(e.t2);case 37:return e.prev=37,f.f(),e.finish(37);case 40:return e.next=42,r.write({outputType:"blob"});case 42:return W=e.sent,e.abrupt("return",W);case 44:case"end":return e.stop()}}),e,null,[[5,34,37,40],[15,24,27,30]])})));return function(t,n,l){return e.apply(this,arguments)}}();return{exporting:s,exportImage:d,exportJSON:v,exportSpecificFile:f,exportPPTX:k,savePPTX:_}};var Za={class:"hotkey-doc"},Ta={class:"title"},Ma={class:"label"},Ua={class:"value"};const Wa=(0,u.aZ)({__name:"HotkeyDoc",setup:function(e){return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Za,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(he),(function(e){return(0,u.wg)(),(0,u.iD)(u.HY,{key:e.type},[(0,u._)("div",Ta,(0,pe.zw)(e.type),1),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.children,(function(e){return(0,u.wg)(),(0,u.iD)("div",{class:"hotkey-item",key:e.label},[(0,u._)("div",Ma,(0,pe.zw)(e.label),1),(0,u._)("div",Ua,(0,pe.zw)(e.value),1)])})),128))],64)})),128))])}}}),Da=(0,ll.Z)(Wa,[["__scopeId","data-v-a0322054"]]),Ha=Da;var Fa=function(e){return(0,u.dD)("data-v-a5c6b41c"),e=e(),(0,u.Cn)(),e},Aa={key:0,class:"fullscreen-spin"},Oa={class:"spin"},Pa=Fa((function(){return(0,u._)("div",{class:"spinner"},null,-1)})),Ra={class:"text"};const Ba=(0,u.aZ)({__name:"FullscreenSpin",props:{loading:{type:Boolean,default:!1},tip:{default:""}},setup:function(e){return function(e,t){return e.loading?((0,u.wg)(),(0,u.iD)("div",Aa,[(0,u._)("div",Oa,[Pa,(0,u._)("div",Ra,(0,pe.zw)(e.tip),1)])])):(0,u.kq)("",!0)}}}),za=(0,ll.Z)(Ba,[["__scopeId","data-v-a5c6b41c"]]),Na=za;var ja={class:"header"};const Ya=(0,u.aZ)({__name:"Drawer",props:{visible:{type:Boolean},width:{default:320},contentStyle:{},placement:{default:"right"}},emits:["update:visible"],setup:function(e,t){var n=t.emit,l=e,o=n,i=(0,c.iH)(!1),r=(0,u.Fl)((function(){return(0,g.Z)({width:l.width+"px"},l.contentStyle||{})}));return function(e,t){var n=(0,u.up)("IconClose");return(0,u.wg)(),(0,u.j4)(u.lR,{to:"body"},[(0,u.Wm)(a.uT,{name:"drawer-slide-".concat(e.placement),onAfterLeave:t[1]||(t[1]=function(e){return i.value=!1}),onBeforeEnter:t[2]||(t[2]=function(e){return i.value=!0})},{default:(0,u.w5)((function(){return[(0,u.wy)((0,u._)("div",{class:(0,pe.C_)(["drawer",e.placement]),style:(0,pe.j5)({width:l.width+"px"})},[(0,u._)("div",ja,[(0,u.WI)(e.$slots,"title"),(0,u._)("span",{class:"close-btn",onClick:t[0]||(t[0]=function(e){return o("update:visible",!1)})},[(0,u.Wm)(n)])]),i.value?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"content",style:(0,pe.j5)(r.value)},[(0,u.WI)(e.$slots,"default")],4)):(0,u.kq)("",!0)],6),[[a.F8,e.visible]])]})),_:3},8,["name"])])}}}),Va=(0,ll.Z)(Ya,[["__scopeId","data-v-749dadac"]]),Ja=Va;var qa={class:"prefix"},Xa=["disabled","value","placeholder"],Ga={class:"suffix"};const Ka=(0,u.aZ)({__name:"Input",props:{value:{},disabled:{type:Boolean,default:!1},placeholder:{default:""}},emits:["update:value","input","change","blur","focus","enter"],setup:function(e,t){var n=t.expose,l=t.emit,o=l,i=(0,c.iH)(!1),r=function(e){o("update:value",e.target.value)},s=function(e){i.value=!1,o("blur",e)},d=function(e){i.value=!0,o("focus",e)},f=(0,c.iH)(),v=function(){f.value&&f.value.focus()};return n({focus:v}),function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["input",{disabled:e.disabled,focused:i.value}])},[(0,u._)("span",qa,[(0,u.WI)(e.$slots,"prefix")]),(0,u._)("input",{type:"text",ref_key:"inputRef",ref:f,disabled:e.disabled,value:e.value,placeholder:e.placeholder,onInput:t[0]||(t[0]=function(e){return r(e)}),onFocus:t[1]||(t[1]=function(e){return d(e)}),onBlur:t[2]||(t[2]=function(e){return s(e)}),onChange:t[3]||(t[3]=function(e){return o("change",e)}),onKeydown:t[4]||(t[4]=(0,a.D2)((function(e){return o("enter",e)}),["enter"]))},null,40,Xa),(0,u._)("span",Ga,[(0,u.WI)(e.$slots,"suffix")])],2)}}}),Qa=(0,ll.Z)(Ka,[["__scopeId","data-v-a97ba0dc"]]),$a=Qa;var eo=n(46488);n(18627);const to=(0,u.aZ)({__name:"Popover",props:{value:{type:Boolean,default:!1},trigger:{default:"click"},placement:{default:"bottom"},appendTo:{},contentStyle:{},center:{type:Boolean,default:!1}},emits:["update:value"],setup:function(e,t){var n=t.emit,l=e,a=n,o=(0,c.iH)(),i=(0,c.iH)(),r=(0,c.iH)(),s=(0,c.iH)(!1),d=(0,u.Fl)((function(){return l.contentStyle||{}}));return(0,u.YP)((function(){return l.value}),(function(){o.value&&(l.value?o.value.show():o.value.hide())})),(0,u.bv)((function(){o.value=(0,eo.ZP)(i.value,{content:r.value,allowHTML:!0,trigger:l.trigger,placement:l.placement,interactive:!0,appendTo:l.appendTo||document.body,maxWidth:"none",offset:[0,8],duration:200,animation:"scale",theme:"popover",onShow:function(){s.value=!0},onShown:function(){l.value||a("update:value",!0)},onHidden:function(){l.value&&a("update:value",!1),s.value=!1}})})),function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["popover",{center:e.center}]),ref_key:"triggerRef",ref:i},[(0,u._)("div",{class:"popover-content",style:(0,pe.j5)(d.value),ref_key:"contentRef",ref:r},[s.value?(0,u.WI)(e.$slots,"content",{key:0}):(0,u.kq)("",!0)],4),(0,u.WI)(e.$slots,"default")],2)}}}),no=(0,ll.Z)(to,[["__scopeId","data-v-70fabe9a"]]),lo=no,ao=(0,u.aZ)({__name:"PopoverMenuItem",props:{center:{type:Boolean,default:!1}},emits:["click"],setup:function(e,t){var n=t.emit,l=n;return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["popover-menu-item",{center:e.center}]),onClick:t[0]||(t[0]=function(e){return l("click")})},[(0,u.WI)(e.$slots,"default")],2)}}}),oo=(0,ll.Z)(ao,[["__scopeId","data-v-2f137c4f"]]),io=oo;var ro=n(5121),uo={class:"editor-header"},co={class:"left"},so={class:"menu-item"},fo={class:"title"},vo=["title"],po={class:"right"},ho={class:"group-menu-item"},mo={class:"arrow-btn"};const go=(0,u.aZ)({__name:"index",props:{ppt_url:String,pk:Number},setup:function(e){var t=X(),n=V(),l=(0,o.Jk)(n),a=l.title,s=Ol(),d=s.enterScreening,f=s.enterScreeningFromStart,v=Nl(),p=(v.importSpecificFile,v.importPPTXFile),h=(v.importPaper,v.exporting),m=Ll(),g=m.resetSlides,y=Ea(),w=y.savePPTX,x=(0,c.iH)(!1),b=(0,c.iH)(!1),k=(0,c.iH)(!1),_=(0,c.iH)(),I=(0,c.iH)(""),S=function(){I.value=a.value,k.value=!0,(0,u.Y3)((function(){var e;return null===(e=_.value)||void 0===e?void 0:e.focus()}))},C=function(){var e=(0,r.Z)((0,i.Z)().mark((function e(){var t,n,l,a,r,u;return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=(0,o.Jk)(V()),l=n.slides,n.currentSlide,e.next=3,w(l.value,!0,!1);case 3:a=e.sent,r=new File([a],null===(t=M.value)||void 0===t?void 0:t.substring(M.value.lastIndexOf("/")+1)),u=new FormData,u.append("ppt",r),u.append("pk",W.value),(0,ro.Z)({method:"post",url:"http://3.252.227.75:8005/updatePPTX/",data:u,headers:{"Content-Type":"multipart/form-data"}}).then((function(e){}))["catch"]((function(e){}));case 9:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),L=function(){n.setTitle(I.value),k.value=!1},E=function(e){t.setDialogForExport(e),x.value=!1},Z=e,T=(0,c.BK)(Z),M=T.ppt_url,U=(0,c.BK)(Z),W=U.pk;function D(){var e={responseType:"blob"};ro.Z.get(M.value,e).then((function(e){var t,l;n.setTitle(null===(t=M.value)||void 0===t?void 0:t.substring(M.value.lastIndexOf("/")+1));var a=new File([e.data],null===(l=M.value)||void 0===l?void 0:l.substring(M.value.lastIndexOf("/")+1));p(a)}))}return(0,u.wF)((function(){return D()})),function(e,t){var n=(0,u.up)("IconHamburgerButton"),l=(0,u.up)("IconPpt"),o=(0,u.up)("IconDown"),i=(0,u.up)("IconDownload"),r=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",uo,[(0,u._)("div",co,[(0,u.Wm)(lo,{trigger:"click",placement:"bottom-start",value:x.value,"onUpdate:value":t[3]||(t[3]=function(e){return x.value=e})},{content:(0,u.w5)((function(){return[(0,u.Wm)(io,{onClick:t[0]||(t[0]=function(e){return E("pptx")})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Export file")]})),_:1}),(0,u.Wm)(io,{onClick:t[1]||(t[1]=function(e){(0,c.SU)(g)(),x.value=!1})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Reset slideshow")]})),_:1}),(0,u.Wm)(io,{onClick:t[2]||(t[2]=function(e){x.value=!1,b.value=!0})},{default:(0,u.w5)((function(){return[(0,u.Uk)("shortcut key")]})),_:1})]})),default:(0,u.w5)((function(){return[(0,u._)("div",so,[(0,u.Wm)(n,{class:"icon"})])]})),_:1},8,["value"]),(0,u._)("div",fo,[k.value?((0,u.wg)(),(0,u.j4)($a,{key:0,disabled:"",class:"title-input",ref_key:"titleInputRef",ref:_,value:I.value,"onUpdate:value":t[4]||(t[4]=function(e){return I.value=e}),onBlur:t[5]||(t[5]=function(e){return L()})},null,8,["value"])):((0,u.wg)(),(0,u.iD)("div",{key:1,class:"title-text",onClick:t[6]||(t[6]=function(e){return S()}),title:(0,c.SU)(a)},(0,pe.zw)((0,c.SU)(a)),9,vo))]),(0,u._)("div",null,[(0,u._)("button",{class:"saveppt",onClick:t[7]||(t[7]=function(e){return C()})},"Save"),(0,u.Uk)(" >>>>>>> f8840d4ebc8e22df0108553cfbdf9ff29d328aaa ")])]),(0,u._)("div",po,[(0,u._)("div",ho,[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"menu-item",onClick:t[8]||(t[8]=function(e){return(0,c.SU)(d)()})},[(0,u.Wm)(l,{class:"icon"})])),[[r,"Slideshow"]]),(0,u.Wm)(lo,{trigger:"click",center:""},{content:(0,u.w5)((function(){return[(0,u.Wm)(io,{onClick:t[9]||(t[9]=function(e){return(0,c.SU)(f)()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Start from scratch")]})),_:1}),(0,u.Wm)(io,{onClick:t[10]||(t[10]=function(e){return(0,c.SU)(d)()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Start from current page")]})),_:1})]})),default:(0,u.w5)((function(){return[(0,u._)("div",mo,[(0,u.Wm)(o,{class:"arrow"})])]})),_:1})]),(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"menu-item",onClick:t[11]||(t[11]=function(e){return E("pptx")})},[(0,u.Wm)(i,{class:"icon"})])),[[r,"Export"]])]),(0,u.Wm)(Ja,{width:320,visible:b.value,"onUpdate:visible":t[12]||(t[12]=function(e){return b.value=e}),placement:"right"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Ha)]})),_:1},8,["visible"]),(0,u.Wm)(Na,{loading:(0,c.SU)(h),tip:"Exporting..."},null,8,["loading"])])}}}),yo=(0,ll.Z)(go,[["__scopeId","data-v-4b5ef9ab"]]),wo=yo;n(59749),n(86544);var xo=Symbol(),bo=Symbol(),ko=Symbol(),_o=function(){var e=window.getSelection();e&&e.removeAllRanges()};const Io=function(e){var t=(0,c.iH)(0),n=(0,c.iH)(0),l=X(),a=(0,o.Jk)(l),i=a.canvasPercentage,r=a.canvasDragged,s=(0,o.Jk)(V()),d=s.viewportRatio,f=function(){if(e.value){var a=e.value.clientWidth,o=e.value.clientHeight;if(o/a>d.value){var r=a*(i.value/100);l.setCanvasScale(r/wl),t.value=(a-r)/2,n.value=(o-r*d.value)/2}else{var u=o*(i.value/100);l.setCanvasScale(u/(wl*d.value)),t.value=(a-u/d.value)/2,n.value=(o-u)/2}}},v=function(a,o){if(e.value){var i=e.value.clientWidth,r=e.value.clientHeight,u=i*(a/100),c=i*(o/100),s=r*(a/100),f=r*(o/100);r/i>d.value?l.setCanvasScale(u/wl):l.setCanvasScale(s/(wl*d.value)),t.value=t.value-(u-c)/2,n.value=n.value-(s-f)/2}};(0,u.YP)(i,v),(0,u.YP)(d,f),(0,u.YP)(r,(function(){r.value||f()}));var p=(0,u.Fl)((function(){return{width:wl,height:wl*d.value,left:t.value,top:n.value}})),h=new ResizeObserver(f);(0,u.bv)((function(){e.value&&h.observe(e.value)})),(0,u.Ah)((function(){e.value&&h.unobserve(e.value)}));var m=function(e){var a=!0,o=e.pageX,i=e.pageY,r=t.value,u=n.value;document.onmousemove=function(e){if(a){var l=e.pageX,c=e.pageY;t.value=r+(l-o),n.value=u+(c-i)}},document.onmouseup=function(){a=!1,document.onmousemove=null,document.onmouseup=null,l.setCanvasDragged(!0)}};return{viewportStyles:p,dragViewport:m}},So=function(e,t){var n=X(),l=(0,o.Jk)(n),a=l.canvasScale,i=l.hiddenElementIdList,r=(0,c.iH)(!1),u=(0,c.iH)(1),s=(0,c.iH)({top:0,left:0,width:0,height:0}),d=function(l){if(t.value){var o=!0,c=t.value.getBoundingClientRect(),d=5,f=l.pageX,v=l.pageY,p=(f-c.x)/a.value,h=(v-c.y)/a.value;s.value={top:h,left:p,width:0,height:0},r.value=!1,u.value=4,document.onmousemove=function(e){if(o){var t=e.pageX,n=e.pageY,l=(t-f)/a.value,i=(n-v)/a.value,c=Math.abs(l),p=Math.abs(i);if(!(c<d||p<d)){var h=0;l>0&&i>0?h=4:l<0&&i<0?h=2:l>0&&i<0?h=1:l<0&&i>0&&(h=3),s.value=(0,g.Z)((0,g.Z)({},s.value),{},{width:c,height:p}),r.value=!0,u.value=h}}},document.onmouseup=function(){document.onmousemove=null,document.onmouseup=null,o=!1;for(var t=[],l=0;l<e.value.length;l++){var a=e.value[l],c=s.value.left,d=s.value.top,f=s.value.width,v=s.value.height,p=Ze(a),h=p.minX,m=p.maxX,g=p.minY,y=p.maxY,w=!1;4===u.value?w=h>c&&m<c+f&&g>d&&y<d+v:2===u.value?w=h>c-f&&m<c-f+f&&g>d-v&&y<d-v+v:1===u.value?w=h>c&&m<c+f&&g>d-v&&y<d-v+v:3===u.value&&(w=h>c-f&&m<c-f+f&&g>d&&y<d+v),!w||a.lock||i.value.includes(a.id)||t.push(a)}t=t.filter((function(n){if(n.groupId){var l=t.map((function(e){return e.id})),a=e.value.filter((function(e){return e.groupId===n.groupId}));return a.every((function(e){return l.includes(e.id)}))}return!0}));var x=t.map((function(e){return e.id}));n.setActiveElementIdList(x),r.value=!1}}};return{mouseSelection:s,mouseSelectionVisible:r,mouseSelectionQuadrant:u,updateMouseSelection:d}},Co=function(e){var t=(0,o.Jk)(X()),n=t.disableHotkeys,l=Il(),a=l.createImageElement,i=l.createTextElement,r=function(e){if(e.dataTransfer&&0!==e.dataTransfer.items.length){var t=e.dataTransfer.items[0];if("file"===t.kind&&-1!==t.type.indexOf("image")){var l=t.getAsFile();l&&yl(l).then((function(e){return a(e)}))}else"string"===t.kind&&"text/plain"===t.type&&t.getAsString((function(e){if(!n.value){var t=ml(e);i({left:0,top:0,width:600,height:50},{content:t})}}))}};(0,u.bv)((function(){e.value&&e.value.addEventListener("drop",r),document.ondragleave=function(e){return e.preventDefault()},document.ondrop=function(e){return e.preventDefault()},document.ondragenter=function(e){return e.preventDefault()},document.ondragover=function(e){return e.preventDefault()}})),(0,u.Ah)((function(){e.value&&e.value.removeEventListener("drop",r),document.ondragleave=null,document.ondrop=null,document.ondragenter=null,document.ondragover=null}))};var Lo=function(e,t){var n=Math.atan2(e,t),l=180/Math.PI*n;return l};const Eo=function(e,t,n){var l=V(),a=_l(),o=a.addHistorySnapshot,i=function(a,i){var r=!(a instanceof MouseEvent);if(!r||a.changedTouches&&a.changedTouches[0]){var u=!0,c=0,s=i.rotate||0,d=i.left,f=i.top,v=i.width,p=i.height,h=d+v/2,m=f+p/2;if(t.value){var y=t.value.getBoundingClientRect(),w=function(t){if(u){var l=t instanceof MouseEvent?t.pageX:t.changedTouches[0].pageX,a=t instanceof MouseEvent?t.pageY:t.changedTouches[0].pageY,o=(l-y.left)/n.value,r=(a-y.top)/n.value,s=o-h,d=m-r;c=Lo(s,d);var f=5;Math.abs(c)<=f?c=0:c>0&&Math.abs(c-45)<=f?c-=c-45:c<0&&Math.abs(c+45)<=f?c-=c+45:c>0&&Math.abs(c-90)<=f?c-=c-90:c<0&&Math.abs(c+90)<=f?c-=c+90:c>0&&Math.abs(c-135)<=f?c-=c-135:c<0&&Math.abs(c+135)<=f?c-=c+135:c>0&&Math.abs(c-180)<=f?c-=c-180:c<0&&Math.abs(c+180)<=f&&(c-=c+180),e.value=e.value.map((function(e){return i.id===e.id?(0,g.Z)((0,g.Z)({},e),{},{rotate:c}):e}))}},x=function(){u=!1,document.onmousemove=null,document.onmouseup=null,s!==c&&(l.updateSlide({elements:e.value}),o())};r?(document.ontouchmove=w,document.ontouchend=x):(document.onmousemove=w,document.onmouseup=x)}}};return{rotateElement:i}};var Zo={text:"text",image:"picture",shape:"shape",line:"line",chart:"chart",table:"table",video:"video",audio:"audio",latex:"formula"},To={text:20,image:20,shape:15,chart:200,table:20,video:250,audio:20,latex:20},Mo=function(e,t){var n=e.left,l=e.top,a=e.width,o=e.height,i=Math.sqrt(Math.pow(a,2)+Math.pow(o,2))/2,r=180*Math.atan(o/a)/Math.PI,u=(180-t-r)*Math.PI/180,c=(r-t)*Math.PI/180,s=(90-t)*Math.PI/180,d=t*Math.PI/180,f=a/2,v=o/2,p=n+f,h=l+v,m={left:p+i*Math.cos(u),top:h-i*Math.sin(u)},g={left:p+v*Math.cos(s),top:h-v*Math.sin(s)},y={left:p+i*Math.cos(c),top:h-i*Math.sin(c)},w={left:p+f*Math.cos(d),top:h+f*Math.sin(d)},x={left:p-i*Math.cos(u),top:h+i*Math.sin(u)},b={left:p-v*Math.sin(d),top:h+v*Math.cos(d)},k={left:p-i*Math.cos(c),top:h+i*Math.sin(c)},_={left:p-f*Math.cos(d),top:h-f*Math.sin(d)};return{leftTopPoint:m,topPoint:g,rightTopPoint:y,rightPoint:w,rightBottomPoint:x,bottomPoint:b,leftBottomPoint:k,leftPoint:_}},Uo=function(e,t){var n=(0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)({},p.RIGHT_BOTTOM,t.leftTopPoint),p.LEFT_BOTTOM,t.rightTopPoint),p.LEFT_TOP,t.rightBottomPoint),p.RIGHT_TOP,t.leftBottomPoint),p.TOP,t.bottomPoint),p.BOTTOM,t.topPoint),p.LEFT,t.rightPoint),p.RIGHT,t.leftPoint);return n[e]};const Wo=function(e,t,n){var l=X(),a=V(),i=(0,o.Jk)(l),r=i.activeElementIdList,u=i.activeGroupElementId,c=(0,o.Jk)(a),s=c.viewportRatio,d=(0,o.Jk)(se()),f=d.ctrlOrShiftKeyActive,v=_l(),h=v.addHistorySnapshot,m=function(o,i,c){var d=!(o instanceof MouseEvent);if(!d||o.changedTouches&&o.changedTouches[0]){var v=!0;l.setScalingState(!0);var m,w=i.left,x=i.top,b=i.width,k=i.height,_="table"===i.type?i.cellMinHeight:0,I="rotate"in i&&i.rotate?i.rotate:0,S=Math.PI*I/180,C=f.value||"fixedRatio"in i&&i.fixedRatio,L=b/k,E=d?o.changedTouches[0].pageX:o.pageX,Z=d?o.changedTouches[0].pageY:o.pageY,T=To[i.type]||20,M=function(e){return e<T?T:e},U=0,W=0,D=[],H=[];if("rotate"in i&&i.rotate){var F=i.left,A=i.top,O=i.width,P=i.height;m=Mo({left:F,top:A,width:O,height:P},I);var B=Uo(c,m);U=B.left,W=B.top}else{var z,N=wl,j=wl*s.value,Y=i.id===u.value,V=(0,y.Z)(e.value);try{for(V.s();!(z=V.n()).done;){var J=z.value;if((!("rotate"in J)||!J.rotate)&&("line"!==J.type&&(!Y||J.id!==i.id)&&(Y||!r.value.includes(J.id)))){var q=J.left,X=J.top,G=J.width,K=J.height,Q=q+G,$=X+K,ee={value:X,range:[q,Q]},te={value:$,range:[q,Q]},ne={value:q,range:[X,$]},le={value:Q,range:[X,$]};D.push(ee,te),H.push(ne,le)}}}catch(ve){V.e(ve)}finally{V.f()}var ae={value:0,range:[0,N]},oe={value:j,range:[0,N]},ie={value:j/2,range:[0,N]},re={value:0,range:[0,j]},ue={value:N,range:[0,j]},ce={value:N/2,range:[0,j]};D.push(ae,oe,ie),H.push(re,ue,ce),D=Me(D),H=Me(H)}var se=function(e,n){var l=5,a=[],o=!1,i=!1,r={offsetX:0,offsetY:0};if(n||0===n)for(var u=0;u<D.length;u++){var c=D[u],s=c.value,d=c.range,f=Math.min.apply(Math,(0,R.Z)(d).concat([e||0])),v=Math.max.apply(Math,(0,R.Z)(d).concat([e||0]));Math.abs(n-s)<l&&!i&&(r.offsetY=n-s,i=!0,a.push({type:"horizontal",axis:{x:f-50,y:s},length:v-f+100}))}if(e||0===e)for(var p=0;p<H.length;p++){var h=H[p],m=h.value,g=h.range,y=Math.min.apply(Math,(0,R.Z)(g).concat([n||0])),w=Math.max.apply(Math,(0,R.Z)(g).concat([n||0]));Math.abs(e-m)<l&&!o&&(r.offsetX=e-m,o=!0,a.push({type:"vertical",axis:{x:m,y:y-50},length:w-y+100}))}return t.value=a,r},de=function(t){if(v){var l=t instanceof MouseEvent?t.pageX:t.changedTouches[0].pageX,a=t instanceof MouseEvent?t.pageY:t.changedTouches[0].pageY,o=l-E,r=a-Z,u=b,s=k,d=w,f=x;if(I){var h=(Math.cos(S)*o+Math.sin(S)*r)/n.value,m=(Math.cos(S)*r-Math.sin(S)*o)/n.value;C&&(c!==p.RIGHT_BOTTOM&&c!==p.LEFT_TOP||(m=h/L),c!==p.LEFT_BOTTOM&&c!==p.RIGHT_TOP||(m=-h/L)),c===p.RIGHT_BOTTOM?(u=M(b+h),s=M(k+m)):c===p.LEFT_BOTTOM?(u=M(b-h),s=M(k+m),d=w-(u-b)):c===p.LEFT_TOP?(u=M(b-h),s=M(k-m),d=w-(u-b),f=x-(s-k)):c===p.RIGHT_TOP?(u=M(b+h),s=M(k-m),f=x-(s-k)):c===p.TOP?(s=M(k-m),f=x-(s-k)):c===p.BOTTOM?s=M(k+m):c===p.LEFT?(u=M(b-h),d=w-(u-b)):c===p.RIGHT&&(u=M(b+h));var y=Mo({width:u,height:s,left:d,top:f},I),T=Uo(c,y),D=T.left,H=T.top,F=D-U,A=H-W;d-=F,f-=A}else{var O=o/n.value,P=r/n.value;if(C&&(c!==p.RIGHT_BOTTOM&&c!==p.LEFT_TOP||(P=O/L),c!==p.LEFT_BOTTOM&&c!==p.RIGHT_TOP||(P=-O/L)),c===p.RIGHT_BOTTOM){var R=se(w+b+O,x+k+P),B=R.offsetX,z=R.offsetY;O-=B,P-=z,C&&(z?O=P*L:P=O/L),u=M(b+O),s=M(k+P)}else if(c===p.LEFT_BOTTOM){var N=se(w+O,x+k+P),j=N.offsetX,Y=N.offsetY;O-=j,P-=Y,C&&(Y?O=-P*L:P=-O/L),u=M(b-O),s=M(k+P),d=w-(u-b)}else if(c===p.LEFT_TOP){var V=se(w+O,x+P),J=V.offsetX,q=V.offsetY;O-=J,P-=q,C&&(q?O=P*L:P=O/L),u=M(b-O),s=M(k-P),d=w-(u-b),f=x-(s-k)}else if(c===p.RIGHT_TOP){var X=se(w+b+O,x+P),G=X.offsetX,K=X.offsetY;O-=G,P-=K,C&&(K?O=-P*L:P=-O/L),u=M(b+O),s=M(k-P),f=x-(s-k)}else if(c===p.LEFT){var Q=se(w+O,null),$=Q.offsetX;O-=$,u=M(b-O),d=w-(u-b)}else if(c===p.RIGHT){var ee=se(w+b+O,null),te=ee.offsetX;O-=te,u=M(b+O)}else if(c===p.TOP){var ne=se(null,x+P),le=ne.offsetY;P-=le,s=M(k-P),f=x-(s-k)}else if(c===p.BOTTOM){var ae=se(null,x+k+P),oe=ae.offsetY;P-=oe,s=M(k+P)}}e.value=e.value.map((function(e){if(i.id!==e.id)return e;if("shape"===e.type&&"pathFormula"in e&&e.pathFormula){var t=xl[e.pathFormula],n="";return n="editable"in t?t.formula(u,s,e.keypoint):t.formula(u,s),(0,g.Z)((0,g.Z)({},e),{},{left:d,top:f,width:u,height:s,viewBox:[u,s],path:n})}if("table"===e.type){var l=_+(s-k)/e.data.length;return l=l<36?36:l,l===_?(0,g.Z)((0,g.Z)({},e),{},{left:d,width:u}):(0,g.Z)((0,g.Z)({},e),{},{left:d,top:f,width:u,height:s,cellMinHeight:l<36?36:l})}return(0,g.Z)((0,g.Z)({},e),{},{left:d,top:f,width:u,height:s})}))}},fe=function(n){v=!1,document.ontouchmove=null,document.ontouchend=null,document.onmousemove=null,document.onmouseup=null,t.value=[];var o=n instanceof MouseEvent?n.pageX:n.changedTouches[0].pageX,i=n instanceof MouseEvent?n.pageY:n.changedTouches[0].pageY;E===o&&Z===i||(a.updateSlide({elements:e.value}),l.setScalingState(!1),h())};d?(document.ontouchmove=de,document.ontouchend=fe):(document.onmousemove=de,document.onmouseup=fe)}},w=function(t,l,o){var i=!0,u=l.minX,c=l.maxX,s=l.minY,d=l.maxY,v=c-u,m=d-s,y=v/m,w=t.pageX,x=t.pageY,b=JSON.parse(JSON.stringify(e.value));document.onmousemove=function(t){if(i){var l=t.pageX,a=t.pageY,h=(l-w)/n.value,k=(a-x)/n.value;f.value&&(o!==p.RIGHT_BOTTOM&&o!==p.LEFT_TOP||(k=h/y),o!==p.LEFT_BOTTOM&&o!==p.RIGHT_TOP||(k=-h/y));var _=u,I=c,S=s,C=d;o===p.RIGHT_BOTTOM?(I=c+h,C=d+k):o===p.LEFT_BOTTOM?(_=u+h,C=d+k):o===p.LEFT_TOP?(_=u+h,S=s+k):o===p.RIGHT_TOP?(I=c+h,S=s+k):o===p.TOP?S=s+k:o===p.BOTTOM?C=d+k:o===p.LEFT?_=u+h:o===p.RIGHT&&(I=c+h);var L=I-_,E=C-S,Z=L/v,T=E/m;Z<=0&&(Z=0),T<=0&&(T=0),e.value=e.value.map((function(e){if(("image"===e.type||"shape"===e.type)&&r.value.includes(e.id)){var t=b.find((function(t){return t.id===e.id}));return(0,g.Z)((0,g.Z)({},e),{},{width:t.width*Z,height:t.height*T,left:_+(t.left-u)*Z,top:S+(t.top-s)*T})}return e}))}},document.onmouseup=function(t){i=!1,document.onmousemove=null,document.onmouseup=null,w===t.pageX&&x===t.pageY||(a.updateSlide({elements:e.value}),h())}};return{scaleElement:m,scaleMultiElement:w}},Do=function(e,t){var n=X(),l=(0,o.Jk)(n),a=l.activeElementIdList,i=l.activeGroupElementId,r=l.handleElementId,u=l.editorAreaFocus,c=(0,o.Jk)(se()),s=c.ctrlOrShiftKeyActive,d=function(l,o){var c=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(u.value||n.setEditorareaFocus(!0),a.value.includes(o.id)){if(s.value){var d=[];if(o.groupId){var f=[];e.value.forEach((function(e){e.groupId===o.groupId&&f.push(e.id)})),d=a.value.filter((function(e){return!f.includes(e)}))}else d=a.value.filter((function(e){return e!==o.id}));d.length>0&&n.setActiveElementIdList(d)}else if(r.value!==o.id)n.setHandleElementId(o.id);else if(i.value!==o.id){var v=l instanceof MouseEvent?l.pageX:l.changedTouches[0].pageX,p=l instanceof MouseEvent?l.pageY:l.changedTouches[0].pageY;l.target.onmouseup=function(e){var t=e.pageX,l=e.pageY;v===t&&p===l&&(n.setActiveGroupElementId(o.id),e.target.onmouseup=null)}}}else{var h=[];if(h=s.value?[].concat((0,R.Z)(a.value),[o.id]):[o.id],o.groupId){var m=[];e.value.forEach((function(e){e.groupId===o.groupId&&m.push(e.id)})),h=[].concat((0,R.Z)(h),m)}n.setActiveElementIdList((0,z.uniq)(h)),n.setHandleElementId(o.id)}c&&t(l,o)};return{selectElement:d}},Ho=function(e,t,n){var l=V(),a=(0,o.Jk)(X()),i=a.activeElementIdList,r=a.activeGroupElementId,u=(0,o.Jk)(se()),c=u.shiftKeyState,s=(0,o.Jk)(l),d=s.viewportRatio,f=_l(),v=f.addHistorySnapshot,p=function(a,o){var u=!(a instanceof MouseEvent);if((!u||a.changedTouches&&a.changedTouches[0])&&i.value.includes(o.id)){var s,f=!0,p=wl,h=wl*d.value,m=5,w=JSON.parse(JSON.stringify(e.value)),x=w.filter((function(e){return i.value.includes(e.id)})),b=o.left,k=o.top,_=o.width,I="height"in o&&o.height?o.height:0,S="rotate"in o&&o.rotate?o.rotate:0,C=u?a.changedTouches[0].pageX:a.pageX,L=u?a.changedTouches[0].pageY:a.pageY,E=null,Z=o.id===r.value,T=[],M=[],U=(0,y.Z)(e.value);try{for(U.s();!(s=U.n()).done;){var W=s.value;if("line"!==W.type&&((!Z||W.id!==o.id)&&(Z||!i.value.includes(W.id)))){var D=void 0,H=void 0,F=void 0,A=void 0;if("rotate"in W&&W.rotate){var O=Le({left:W.left,top:W.top,width:W.width,height:W.height,rotate:W.rotate}),P=O.xRange,B=O.yRange;D=P[0],H=B[0],F=P[1]-P[0],A=B[1]-B[0]}else D=W.left,H=W.top,F=W.width,A=W.height;var z=D+F,N=H+A,j=H+A/2,Y=D+F/2,V={value:H,range:[D,z]},J={value:N,range:[D,z]},q={value:j,range:[D,z]},X={value:D,range:[H,N]},G={value:z,range:[H,N]},K={value:Y,range:[H,N]};T.push(V,J,q),M.push(X,G,K)}}}catch(ie){U.e(ie)}finally{U.f()}var Q={value:0,range:[0,p]},$={value:h,range:[0,p]},ee={value:h/2,range:[0,p]},te={value:0,range:[0,h]},ne={value:p,range:[0,h]},le={value:p/2,range:[0,h]};T.push(Q,$,ee),M.push(te,ne,le),T=Me(T),M=Me(M);var ae=function(l){var a=l instanceof MouseEvent?l.pageX:l.changedTouches[0].pageX,r=l instanceof MouseEvent?l.pageY:l.changedTouches[0].pageY;if(!1!==E&&(E=Math.abs(C-a)<m&&Math.abs(L-r)<m),f&&!E){var u=(a-C)/n.value,s=(r-L)/n.value;c.value&&(Math.abs(u)>Math.abs(s)&&(s=0),Math.abs(u)<Math.abs(s)&&(u=0));var d,v,p,h,y=b+u,w=k+s;if(1===i.value.length||Z)if(S){var U=Le({left:y,top:w,width:_,height:I,rotate:S}),W=U.xRange,D=U.yRange;d=W[0],v=W[1],p=D[0],h=D[1]}else"line"===o.type?(d=y,v=y+Math.max(o.start[0],o.end[0]),p=w,h=w+Math.max(o.start[1],o.end[1])):(d=y,v=y+_,p=w,h=w+I);else{for(var H=[],F=[],A=[],O=[],P=0;P<x.length;P++){var B=x[P],z=B.left+u,N=B.top+s,j=B.width,Y="height"in B&&B.height?B.height:0,V="rotate"in B&&B.rotate?B.rotate:0;if("rotate"in B&&B.rotate){var J=Le({left:z,top:N,width:j,height:Y,rotate:V}),q=J.xRange,X=J.yRange;H.push(q[0]),F.push(X[0]),A.push(q[1]),O.push(X[1])}else"line"===B.type?(H.push(z),F.push(N),A.push(z+Math.max(B.start[0],B.end[0])),O.push(N+Math.max(B.start[1],B.end[1]))):(H.push(z),F.push(N),A.push(z+j),O.push(N+Y))}d=Math.min.apply(Math,H),v=Math.max.apply(Math,A),p=Math.min.apply(Math,F),h=Math.max.apply(Math,O)}for(var G=d+(v-d)/2,K=p+(h-p)/2,Q=[],$=!1,ee=!1,te=0;te<T.length;te++){var ne=T[te],le=ne.value,ae=ne.range,oe=Math.min.apply(Math,(0,R.Z)(ae).concat([d,v])),ie=Math.max.apply(Math,(0,R.Z)(ae).concat([d,v]));Math.abs(p-le)<m&&!ee&&(w-=p-le,ee=!0,Q.push({type:"horizontal",axis:{x:oe-50,y:le},length:ie-oe+100})),Math.abs(h-le)<m&&!ee&&(w-=h-le,ee=!0,Q.push({type:"horizontal",axis:{x:oe-50,y:le},length:ie-oe+100})),Math.abs(K-le)<m&&!ee&&(w-=K-le,ee=!0,Q.push({type:"horizontal",axis:{x:oe-50,y:le},length:ie-oe+100}))}for(var re=0;re<M.length;re++){var ue=M[re],ce=ue.value,se=ue.range,de=Math.min.apply(Math,(0,R.Z)(se).concat([p,h])),fe=Math.max.apply(Math,(0,R.Z)(se).concat([p,h]));Math.abs(d-ce)<m&&!$&&(y-=d-ce,$=!0,Q.push({type:"vertical",axis:{x:ce,y:de-50},length:fe-de+100})),Math.abs(v-ce)<m&&!$&&(y-=v-ce,$=!0,Q.push({type:"vertical",axis:{x:ce,y:de-50},length:fe-de+100})),Math.abs(G-ce)<m&&!$&&(y-=G-ce,$=!0,Q.push({type:"vertical",axis:{x:ce,y:de-50},length:fe-de+100}))}if(t.value=Q,1===i.value.length||Z)e.value=e.value.map((function(e){return e.id===o.id?(0,g.Z)((0,g.Z)({},e),{},{left:y,top:w}):e}));else{var ve=e.value.find((function(e){return e.id===o.id}));if(!ve)return;e.value=e.value.map((function(e){return i.value.includes(e.id)?e.id===o.id?(0,g.Z)((0,g.Z)({},e),{},{left:y,top:w}):(0,g.Z)((0,g.Z)({},e),{},{left:e.left+(y-ve.left),top:e.top+(w-ve.top)}):e}))}}},oe=function(n){f=!1,document.ontouchmove=null,document.ontouchend=null,document.onmousemove=null,document.onmouseup=null,t.value=[];var a=n instanceof MouseEvent?n.pageX:n.changedTouches[0].pageX,o=n instanceof MouseEvent?n.pageY:n.changedTouches[0].pageY;C===a&&L===o||(l.updateSlide({elements:e.value}),v())};u?(document.ontouchmove=ae,document.ontouchend=oe):(document.onmousemove=ae,document.onmouseup=oe)}};return{dragElement:p}},Fo=function(e){var t=V(),n=(0,o.Jk)(X()),l=n.canvasScale,a=_l(),i=a.addHistorySnapshot,r=function(n,a,o){for(var r=!0,u=8,c=n.pageX,s=n.pageY,d=[],f=0;f<e.value.length;f++){var v=e.value[f];if("line"!==v.type&&!v.rotate){var p=v.left,m=v.top,y=v.width,w=v.height,x=p+y,b=m+w,k=m+w/2,_=p+y/2,I={x:_,y:m},S={x:_,y:b},C={x:p,y:k},L={x,y:k},E={x:p,y:m},Z={x,y:m},T={x:p,y:b},M={x,y:b};d.push(I,S,C,L,E,Z,T,M)}}document.onmousemove=function(t){if(r){var n=t.pageX,i=t.pageY,f=(n-c)/l.value,v=(i-s)/l.value,p=a.left+a.start[0],m=a.top+a.start[1],y=a.left+a.end[0],w=a.top+a.end[1],x=a.broken||a.curve||[0,0],b=a.left+x[0],k=a.top+x[1],_=a.cubic||[[0,0],[0,0]],I=(0,ne.Z)(_,2),S=I[0],C=I[1],L=a.left+S[0],E=a.top+S[1],Z=a.left+C[0],T=a.top+C[1];if(o===h.START){p+=f,m+=v,Math.abs(p-y)<u&&(p=y),Math.abs(m-w)<u&&(m=w);for(var M=0,U=d;M<U.length;M++){var W=U[M],D=W.x,H=W.y;if(Math.abs(D-p)<u&&Math.abs(H-m)<u){p=D,m=H;break}}}else if(o===h.END){y+=f,w+=v,Math.abs(p-y)<u&&(y=p),Math.abs(m-w)<u&&(w=m);for(var F=0,A=d;F<A.length;F++){var O=A[F],P=O.x,R=O.y;if(Math.abs(P-y)<u&&Math.abs(R-w)<u){y=P,w=R;break}}}else o===h.C?(b+=f,k+=v,Math.abs(b-p)<u&&(b=p),Math.abs(k-m)<u&&(k=m),Math.abs(b-y)<u&&(b=y),Math.abs(k-w)<u&&(k=w),Math.abs(b-(p+y)/2)<u&&Math.abs(k-(m+w)/2)<u&&(b=(p+y)/2,k=(m+w)/2)):o===h.C1?(L+=f,E+=v,Math.abs(L-p)<u&&(L=p),Math.abs(E-m)<u&&(E=m),Math.abs(L-y)<u&&(L=y),Math.abs(E-w)<u&&(E=w)):o===h.C2&&(Z+=f,T+=v,Math.abs(Z-p)<u&&(Z=p),Math.abs(T-m)<u&&(T=m),Math.abs(Z-y)<u&&(Z=y),Math.abs(T-w)<u&&(T=w));var B=Math.min(p,y),z=Math.min(m,w),N=Math.max(p,y),j=Math.max(m,w),Y=[0,0],V=[N-B,j-z];p>y&&(Y[0]=N-B,V[0]=0),m>w&&(Y[1]=j-z,V[1]=0),e.value=e.value.map((function(e){if(e.id===a.id){var t=(0,g.Z)((0,g.Z)({},e),{},{left:B,top:z,start:Y,end:V});return o===h.START||o===h.END?(a.broken&&(t.broken=[(Y[0]+V[0])/2,(Y[1]+V[1])/2]),a.curve&&(t.curve=[(Y[0]+V[0])/2,(Y[1]+V[1])/2]),a.cubic&&(t.cubic=[[(Y[0]+V[0])/2,(Y[1]+V[1])/2],[(Y[0]+V[0])/2,(Y[1]+V[1])/2]])):o===h.C?(a.broken&&(t.broken=[b-B,k-z]),a.curve&&(t.curve=[b-B,k-z])):a.cubic&&(t.cubic=[[L-B,E-z],[Z-B,T-z]]),t}return e}))}},document.onmouseup=function(n){r=!1,document.onmousemove=null,document.onmouseup=null;var l=n.pageX,a=n.pageY;c===l&&s===a||(t.updateSlide({elements:e.value}),i())}};return{dragLineElement:r}},Ao=function(e,t){var n=V(),l=_l(),a=l.addHistorySnapshot,o=function(l,o){var i=!(l instanceof MouseEvent);if(!i||l.changedTouches&&l.changedTouches[0]){var r=!0,u=i?l.changedTouches[0].pageX:l.pageX,c=i?l.changedTouches[0].pageY:l.pageY,s=xl[o.pathFormula],d=null;if("editable"in s){var f=s.getBaseSize(o.width,o.height),v=f*o.keypoint,p=(0,ne.Z)(s.range,2),h=p[0],m=p[1],y=s.relative;d={baseSize:f,originPos:v,min:h,max:m,relative:y}}var w=function(n){if(r){var l=n instanceof MouseEvent?n.pageX:n.changedTouches[0].pageX,a=n instanceof MouseEvent?n.pageY:n.changedTouches[0].pageY,i=(l-u)/t.value,f=(a-c)/t.value;e.value=e.value.map((function(e){if(e.id===o.id&&d){var t=d,n=t.baseSize,l=t.originPos,a=t.min,r=t.max,u=t.relative,c=e,v=0;return"left"===u&&(v=(l+i)/n),"right"===u&&(v=(l-i)/n),"center"===u&&(v=(l-2*i)/n),"top"===u&&(v=(l+f)/n),"bottom"===u&&(v=(l-f)/n),v<a&&(v=a),v>r&&(v=r),(0,g.Z)((0,g.Z)({},e),{},{keypoint:v,path:s.formula(c.width,c.height,v)})}return e}))}},x=function(t){r=!1,document.ontouchmove=null,document.ontouchend=null,document.onmousemove=null,document.onmouseup=null;var l=t instanceof MouseEvent?t.pageX:t.changedTouches[0].pageX,o=t instanceof MouseEvent?t.pageY:t.changedTouches[0].pageY;u===l&&c===o||(n.updateSlide({elements:e.value}),a())};i?(document.ontouchmove=w,document.ontouchend=x):(document.onmousemove=w,document.onmouseup=x)}};return{moveShapeKeypoint:o}},Oo=function(e){var t=X(),n=(0,o.Jk)(t),l=n.canvasScale,a=n.creatingElement,i=function(t){var n=t.start,a=t.end;if(e.value){var o=e.value.getBoundingClientRect(),i=(0,ne.Z)(n,2),r=i[0],u=i[1],c=(0,ne.Z)(a,2),s=c[0],d=c[1],f=Math.min(r,s),v=Math.max(r,s),p=Math.min(u,d),h=Math.max(u,d),m=(f-o.x)/l.value,g=(p-o.y)/l.value,y=(v-f)/l.value,w=(h-p)/l.value;return{left:m,top:g,width:y,height:w}}},r=function(t){var n=t.start,a=t.end;if(e.value){var o=e.value.getBoundingClientRect(),i=(0,ne.Z)(n,2),r=i[0],u=i[1],c=(0,ne.Z)(a,2),s=c[0],d=c[1],f=Math.min(r,s),v=Math.max(r,s),p=Math.min(u,d),h=Math.max(u,d),m=(f-o.x)/l.value,g=(p-o.y)/l.value,y=(v-f)/l.value,w=(h-p)/l.value,x=[r===f?0:y,u===p?0:w],b=[s===f?0:y,d===p?0:w];return{left:m,top:g,start:x,end:b}}},u=Il(),c=u.createTextElement,s=u.createShapeElement,d=u.createLineElement,f=function(e){if(a.value){var n=a.value.type;if("text"===n){var l=i(e);l&&c(l,{vertical:a.value.vertical})}else if("shape"===n){var o=i(e);o&&s(o,a.value.data)}else if("line"===n){var u=r(e);u&&d(u,a.value.data)}t.setCreatingElement(null)}};return{formatCreateSelection:i,insertElementFromCreateSelection:f}},Po=function(){var e=V(),t=(0,o.Jk)(X()),n=t.activeElementIdList,l=t.activeElementList,a=(0,o.Jk)(e),i=a.currentSlide,r=a.viewportRatio,u=_l(),c=u.addHistorySnapshot,s=function(t){var a,o=wl,u=wl*r.value,s=Te(l.value),d=s.minX,v=s.maxX,p=s.minY,h=s.maxY,m=JSON.parse(JSON.stringify(i.value.elements)),g=(0,y.Z)(m);try{for(g.s();!(a=g.n()).done;){var w=a.value;if(n.value.includes(w.id)){if(t===f.CENTER){var x=p+(h-p)/2-u/2,b=d+(v-d)/2-o/2;w.top=w.top-x,w.left=w.left-b}if(t===f.TOP){var k=p-0;w.top=w.top-k}else if(t===f.VERTICAL){var _=p+(h-p)/2-u/2;w.top=w.top-_}else if(t===f.BOTTOM){var I=h-u;w.top=w.top-I}else if(t===f.LEFT){var S=d-0;w.left=w.left-S}else if(t===f.HORIZONTAL){var C=d+(v-d)/2-o/2;w.left=w.left-C}else if(t===f.RIGHT){var L=v-o;w.left=w.left-L}}}}catch(E){g.e(E)}finally{g.f()}e.updateSlide({elements:m}),c()};return{alignElementToCanvas:s}},Ro=function(e){var t=(0,u.Fl)((function(){if(e.value){var t=e.value,n=t.h,l=t.v,a=t.blur,o=t.color;return"".concat(n,"px ").concat(l,"px ").concat(a,"px ").concat(o)}return""}));return{shadowStyle:t}},Bo=function(e,t){var n=(0,u.Fl)((function(){var n="";return e.value&&t.value?n="rotateX(180deg) rotateY(180deg)":t.value?n="rotateX(180deg)":e.value&&(n="rotateY(180deg)"),n}));return{flipStyle:n}};var zo,No;(function(e){e["RECT"]="rect",e["ELLIPSE"]="ellipse",e["POLYGON"]="polygon"})(zo||(zo={})),function(e){e["RECT"]="rect",e["ROUNDRECT"]="roundRect",e["ELLIPSE"]="ellipse",e["TRIANGLE"]="triangle",e["PENTAGON"]="pentagon",e["RHOMBUS"]="rhombus",e["STAR"]="star"}(No||(No={}));var jo={rect:{name:"rectangle",type:zo.RECT,radius:"0",style:""},rect2:{name:"Rectangle 2",type:zo.POLYGON,style:"polygon(0% 0%, 80% 0%, 100% 20%, 100% 100%, 0 100%)",createPath:function(e,t){return"M 0 0 L ".concat(.8*e," 0 L ").concat(e," ").concat(.2*t," L ").concat(e," ").concat(t," L 0 ").concat(t," Z")}},rect3:{name:"Rectangle 3",type:zo.POLYGON,style:"polygon(0% 0%, 80% 0%, 100% 20%, 100% 100%, 20% 100%, 0% 80%)",createPath:function(e,t){return"M 0 0 L ".concat(.8*e," 0 L ").concat(e," ").concat(.2*t," L ").concat(e," ").concat(t," L ").concat(.2*e," ").concat(t," L 0 ").concat(.8*t,"Z")}},roundRect:{name:"rounded rectangle",type:zo.RECT,radius:"10px",style:"inset(0 0 0 0 round 10px 10px 10px 10px)"},ellipse:{name:"circle",type:zo.ELLIPSE,style:"ellipse(50% 50% at 50% 50%)"},triangle:{name:"Triangle",type:zo.POLYGON,style:"polygon(50% 0%, 0% 100%, 100% 100%)",createPath:function(e,t){return"M ".concat(.5*e," 0 L 0 ").concat(t," L ").concat(e," ").concat(t," Z")}},triangle2:{name:"Triangle 2",type:zo.POLYGON,style:"polygon(50% 100%, 0% 0%, 100% 0%)",createPath:function(e,t){return"M ".concat(.5*e," ").concat(t," L 0 0 L ").concat(e," 0 Z")}},triangle3:{name:"Triangle 3",type:zo.POLYGON,style:"polygon(0% 0%, 0% 100%, 100% 100%)",createPath:function(e,t){return"M 0 0 L 0 ".concat(t," L ").concat(e," ").concat(t," Z")}},rhombus:{name:"Rhombus",type:zo.POLYGON,style:"polygon(50% 0%, 100% 50%, 50% 100%, 0% 50%)",createPath:function(e,t){return"M ".concat(.5*e," 0 L ").concat(e," ").concat(.5*t," L ").concat(.5*e," ").concat(t," L 0 ").concat(.5*t," Z")}},pentagon:{name:"pentagon",type:zo.POLYGON,style:"polygon(50% 0%, 100% 38%, 82% 100%, 18% 100%, 0% 38%)",createPath:function(e,t){return"M ".concat(.5*e," 0 L ").concat(e," ").concat(.38*t," L ").concat(.82*e," ").concat(t," L ").concat(.18*e," ").concat(t," L 0 ").concat(.38*t,"Z")}},hexagon:{name:"Hexagon",type:zo.POLYGON,style:"polygon(20% 0%, 80% 0%, 100% 50%, 80% 100%, 20% 100%, 0% 50%)",createPath:function(e,t){return"M ".concat(.2*e," 0 L ").concat(.8*e," 0 L ").concat(e," ").concat(.5*t," L ").concat(.8*e," ").concat(t," L ").concat(.2*e," ").concat(t," L 0 ").concat(.5*t," Z")}},heptagon:{name:"Heptagon",type:zo.POLYGON,style:"polygon(50% 0%, 90% 20%, 100% 60%, 75% 100%, 25% 100%, 0% 60%, 10% 20%)",createPath:function(e,t){return"M ".concat(.5*e," 0 L ").concat(.9*e," ").concat(.2*t," L ").concat(e," ").concat(.6*t," L ").concat(.75*e," ").concat(t," L ").concat(.25*e," ").concat(t," L 0 ").concat(.6*t," L ").concat(.1*e," ").concat(.2*t," Z")}},octagon:{name:"octagon",type:zo.POLYGON,style:"polygon(30% 0%, 70% 0%, 100% 30%, 100% 70%, 70% 100%, 30% 100%, 0% 70%, 0% 30%)",createPath:function(e,t){return"M ".concat(.3*e," 0 L ").concat(.7*e," 0 L ").concat(e," ").concat(.3*t," L ").concat(e," ").concat(.7*t," L ").concat(.7*e," ").concat(t," L ").concat(.3*e," ").concat(t," L 0 ").concat(.7*t," L 0 ").concat(.3*t," Z")}},chevron:{name:"V-shaped",type:zo.POLYGON,style:"polygon(75% 0%, 100% 50%, 75% 100%, 0% 100%, 25% 50%, 0% 0%)",createPath:function(e,t){return"M ".concat(.75*e," 0 L ").concat(e," ").concat(.5*t," L ").concat(.75*e," ").concat(t," L 0 ").concat(t," L ").concat(.25*e," ").concat(.5*t," L 0 0 Z")}},point:{name:"point",type:zo.POLYGON,style:"polygon(0% 0%, 75% 0%, 100% 50%, 75% 100%, 0% 100%)",createPath:function(e,t){return"M 0 0 L ".concat(.75*e," 0 L ").concat(e," ").concat(.5*t," L ").concat(.75*e," ").concat(t," L 0 ").concat(t," Z")}},arrow:{name:"arrow",type:zo.POLYGON,style:"polygon(0% 20%, 60% 20%, 60% 0%, 100% 50%, 60% 100%, 60% 80%, 0% 80%)",createPath:function(e,t){return"M 0 ".concat(.2*t," L ").concat(.6*e," ").concat(.2*t," L ").concat(.6*e," 0 L ").concat(e," ").concat(.5*t," L ").concat(.6*e," $ {height} L ").concat(.6*e," ").concat(.8*t," L 0 ").concat(.8*t," Z")}},parallelogram:{name:"parallelogram",type:zo.POLYGON,style:"polygon(30% 0%, 100% 0%, 70% 100%, 0% 100%)",createPath:function(e,t){return"M ".concat(.3*e," 0 L ").concat(e," 0 L ").concat(.7*e," ").concat(t," L 0 ").concat(t," Z")}},parallelogram2:{name:"Parallelogram 2",type:zo.POLYGON,style:"polygon(30% 100%, 100% 100%, 70% 0%, 0% 0%)",createPath:function(e,t){return"M ".concat(.3*e," ").concat(t," L ").concat(e," ").concat(t," L ").concat(.7*e," 0 L 0 0 Z")}},trapezoid:{name:"trapezoid",type:zo.POLYGON,style:"polygon(25% 0%, 75% 0%, 100% 100%, 0% 100%)",createPath:function(e,t){return"M ".concat(.25*e," 0 L ").concat(.75*e," 0 L ").concat(e," ").concat(t," L 0 ").concat(t," Z")}},trapezoid2:{name:"Trapezoid 2",type:zo.POLYGON,style:"polygon(0% 0%, 100% 0%, 75% 100%, 25% 100%)",createPath:function(e,t){return"M 0 0 L ".concat(e," 0 L ").concat(.75*e," ").concat(t," L ").concat(.25*e," ").concat(t," Z")}}};const Yo=function(e){var t=(0,u.Fl)((function(){if(!e.value)return jo.rect;var t=e.value.shape||zo.RECT;return jo[t]})),n=(0,u.Fl)((function(){if(!e.value)return{top:"0",left:"0",width:"100%",height:"100%"};var t=(0,ne.Z)(e.value.range,2),n=t[0],l=t[1],a=(l[0]-n[0])/100,o=(l[1]-n[1])/100,i=n[0]/a,r=n[1]/o;return{left:-i+"%",top:-r+"%",width:100/a+"%",height:100/o+"%"}}));return{clipShape:t,imgPosition:n}},Vo=function(e){var t=(0,u.Fl)((function(){if(!e.value)return"";for(var t="",n=Object.keys(e.value),l=0,a=n;l<a.length;l++){var o=a[l];t+="".concat(o,"(").concat(e.value[o],") ")}return t}));return{filter:t}},Jo=function(e){var t=(0,u.Fl)((function(){var t,n;return null!==(t=null===(n=e.value)||void 0===n?void 0:n.width)&&void 0!==t?t:0})),n=(0,u.Fl)((function(){var t;return(null===(t=e.value)||void 0===t?void 0:t.style)||"solid"})),l=(0,u.Fl)((function(){var t;return(null===(t=e.value)||void 0===t?void 0:t.color)||"#d14424"})),a=(0,u.Fl)((function(){if("dashed"!==n.value)return"0 0";var e=t.value;return e<=6?"".concat(4.5*e," ").concat(2*e):"".concat(4*e," ").concat(1.5*e)}));return{outlineWidth:t,outlineStyle:n,outlineColor:l,strokeDashArray:a}};var qo=["width","height"],Xo=["rx","ry","width","height","stroke","stroke-width","stroke-dasharray"];const Go=(0,u.aZ)({__name:"ImageRectOutline",props:{width:{},height:{},outline:{},radius:{default:"0"}},setup:function(e){var t=e,n=Jo((0,c.Vh)(t,"outline")),l=n.outlineWidth,a=n.outlineColor,o=n.strokeDashArray;return function(e,t){return e.outline?((0,u.wg)(),(0,u.iD)("svg",{key:0,class:"image-rect-outline",overflow:"visible",width:e.width,height:e.height},[(0,u._)("rect",{"vector-effect":"non-scaling-stroke","stroke-linecap":"butt","stroke-miterlimit":"8",fill:"transparent",rx:e.radius,ry:e.radius,width:e.width,height:e.height,stroke:(0,c.SU)(a),"stroke-width":(0,c.SU)(l),"stroke-dasharray":(0,c.SU)(o)},null,8,Xo)],8,qo)):(0,u.kq)("",!0)}}}),Ko=(0,ll.Z)(Go,[["__scopeId","data-v-35e36256"]]),Qo=Ko;var $o=["width","height"],ei=["cx","cy","rx","ry","stroke","stroke-width","stroke-dasharray"];const ti=(0,u.aZ)({__name:"ImageEllipseOutline",props:{width:{},height:{},outline:{}},setup:function(e){var t=e,n=Jo((0,c.Vh)(t,"outline")),l=n.outlineWidth,a=n.outlineColor,o=n.strokeDashArray;return function(e,t){return e.outline?((0,u.wg)(),(0,u.iD)("svg",{key:0,class:"image-ellipse-outline",overflow:"visible",width:e.width,height:e.height},[(0,u._)("ellipse",{"vector-effect":"non-scaling-stroke","stroke-linecap":"butt","stroke-miterlimit":"8",fill:"transparent",cx:e.width/2,cy:e.height/2,rx:e.width/2,ry:e.height/2,stroke:(0,c.SU)(a),"stroke-width":(0,c.SU)(l),"stroke-dasharray":(0,c.SU)(o)},null,8,ei)],8,$o)):(0,u.kq)("",!0)}}}),ni=(0,ll.Z)(ti,[["__scopeId","data-v-11836cf8"]]),li=ni;var ai=["width","height"],oi=["d","stroke","stroke-width","stroke-dasharray"];const ii=(0,u.aZ)({__name:"ImagePolygonOutline",props:{width:{},height:{},createPath:{type:Function},outline:{}},setup:function(e){var t=e,n=Jo((0,c.Vh)(t,"outline")),l=n.outlineWidth,a=n.outlineColor,o=n.strokeDashArray;return function(e,t){return e.outline?((0,u.wg)(),(0,u.iD)("svg",{key:0,class:"image-polygon-outline",overflow:"visible",width:e.width,height:e.height},[(0,u._)("path",{"vector-effect":"non-scaling-stroke","stroke-linecap":"butt","stroke-miterlimit":"8",fill:"transparent",d:e.createPath(e.width,e.height),stroke:(0,c.SU)(a),"stroke-width":(0,c.SU)(l),"stroke-dasharray":(0,c.SU)(o)},null,8,oi)],8,ai)):(0,u.kq)("",!0)}}}),ri=(0,ll.Z)(ii,[["__scopeId","data-v-6e021ee2"]]),ui=ri;var ci={class:"image-outline"};const si=(0,u.aZ)({__name:"index",props:{elementInfo:{}},setup:function(e){var t=e,n=(0,u.Fl)((function(){return t.elementInfo.clip})),l=Yo(n),a=l.clipShape;return function(e,t){return(0,u.wg)(),(0,u.iD)("div",ci,["rect"===(0,c.SU)(a).type?((0,u.wg)(),(0,u.j4)(Qo,{key:0,width:e.elementInfo.width,height:e.elementInfo.height,radius:(0,c.SU)(a).radius,outline:e.elementInfo.outline},null,8,["width","height","radius","outline"])):"ellipse"===(0,c.SU)(a).type?((0,u.wg)(),(0,u.j4)(li,{key:1,width:e.elementInfo.width,height:e.elementInfo.height,outline:e.elementInfo.outline},null,8,["width","height","outline"])):"polygon"===(0,c.SU)(a).type?((0,u.wg)(),(0,u.j4)(ui,{key:2,width:e.elementInfo.width,height:e.elementInfo.height,outline:e.elementInfo.outline,createPath:(0,c.SU)(a).createPath},null,8,["width","height","outline","createPath"])):(0,u.kq)("",!0)])}}}),di=si,fi=di;var vi=function(e){return(0,u.dD)("data-v-5984406b"),e=e(),(0,u.Cn)(),e},pi=["src"],hi=["src"],mi=["onMousedown"],gi=vi((function(){return(0,u._)("svg",{width:"16",height:"16",fill:"#fff",stroke:"#333"},[(0,u._)("path",{"stroke-width":"0.3","shape-rendering":"crispEdges",d:"M 16 0 L 0 0 L 0 16 L 4 16 L 4 4 L 16 4 L 16 0 Z"})],-1)})),yi=[gi],wi=["onMousedown"],xi=vi((function(){return(0,u._)("svg",{width:"16",height:"16",fill:"#fff",stroke:"#333"},[(0,u._)("path",{"stroke-width":"0.3","shape-rendering":"crispEdges",d:"M 16 0 L 0 0 L 0 4 L 16 4 Z"})],-1)})),bi=[xi];const ki=(0,u.aZ)({__name:"ImageClipHandler",props:{src:{},clipPath:{},width:{},height:{},top:{},left:{},rotate:{},clipData:{}},emits:["clip"],setup:function(e,t){var n=t.emit,l=e,i=n,r=(0,o.Jk)(X()),s=r.canvasScale,d=(0,o.Jk)(se()),f=d.ctrlOrShiftKeyActive,v=(0,c.iH)({top:"0",left:"0"}),h=(0,c.iH)(!1),y=(0,c.iH)(null),w=function(){var e=l.clipData?l.clipData.range:[[0,0],[100,100]],t=(0,ne.Z)(e,2),n=t[0],a=t[1],o=(a[0]-n[0])/100,i=(a[1]-n[1])/100,r=n[0]/o,u=n[1]/i;return{widthScale:o,heightScale:i,left:r,top:u}},x=(0,u.Fl)((function(){var e=w(),t=e.widthScale,n=e.heightScale,l=e.left,a=e.top;return{left:-l,top:-a,width:100/t,height:100/n}})),b=(0,u.Fl)((function(){return{top:x.value.top+"%",left:x.value.left+"%",width:x.value.width+"%",height:x.value.height+"%"}})),k=(0,c.iH)({top:0,left:0,width:0,height:0}),_=(0,u.Fl)((function(){var e=k.value,t=e.top,n=e.left,l=e.width,a=e.height;return{top:t+"%",left:n+"%",width:l+"%",height:a+"%"}})),I=(0,u.Fl)((function(){var e=x.value.width,t=x.value.height,n=k.value,l=n.top,a=n.left,o=n.width,i=n.height;return{left:100/o*-a+"%",top:100/i*-l+"%",width:e/o*100+"%",height:t/i*100+"%"}})),S=function(){var e=w(),t=e.left,n=e.top;k.value={left:t,top:n,width:100,height:100},v.value={top:-n+"%",left:-t+"%"}},C=function(){if(!h.value)if(y.value){var e=w(),t=e.left,n=e.top,a={left:(k.value.left-t)/100*l.width,top:(k.value.top-n)/100*l.height,width:(k.value.width-100)/100*l.width,height:(k.value.height-100)/100*l.height},o={range:y.value,position:a};i("clip",o)}else i("clip",null)},L=function(e){var t=e.key.toUpperCase();t===m.ENTER&&C()};(0,u.bv)((function(){S(),document.addEventListener("keydown",L)})),(0,u.Ah)((function(){document.removeEventListener("keydown",L)}));var E=function(){var e={left:parseInt(I.value.left),top:parseInt(I.value.top),width:parseInt(I.value.width),height:parseInt(I.value.height)},t=100/e.width,n=100/e.height,l=[-e.left*t,-e.top*n],a=[100*t+l[0],100*n+l[1]];y.value=[l,a]},Z=function(e){h.value=!0;var t=!0,n=e.pageX,a=e.pageY,o=x.value,i=(0,g.Z)({},k.value);document.onmousemove=function(e){if(t){var r=e.pageX,u=e.pageY,c=(r-n)/s.value/l.width*100,d=(u-a)/s.value/l.height*100;l.rotate>45&&l.rotate<135&&(c=(u-a)/s.value/l.width*100,d=-(r-n)/s.value/l.height*100),(l.rotate>=135&&l.rotate<=180||l.rotate>=-180&&l.rotate<=-135)&&(c=-c,d=-d),l.rotate>-135&&l.rotate<-45&&(c=-(u-a)/s.value/l.width*100,d=(r-n)/s.value/l.height*100);var f=i.left+c,v=i.top+d;f<0?f=0:f+i.width>o.width&&(f=o.width-i.width),v<0?v=0:v+i.height>o.height&&(v=o.height-i.height),k.value=(0,g.Z)((0,g.Z)({},k.value),{},{left:f,top:v})}},document.onmouseup=function(){t=!1,document.onmousemove=null,document.onmouseup=null,E(),setTimeout((function(){h.value=!1}),0)}},T=function(e,t){h.value=!0;var n=!0,a=50/l.width*100,o=50/l.height*100,i=e.pageX,r=e.pageY,u=x.value,c=(0,g.Z)({},k.value),d=k.value.width/k.value.height;document.onmousemove=function(e){if(n){var v,h,m,g,y=e.pageX,w=e.pageY,x=(y-i)/s.value/l.width*100,b=(w-r)/s.value/l.height*100;l.rotate>45&&l.rotate<135&&(x=(w-r)/s.value/l.width*100,b=-(y-i)/s.value/l.height*100),(l.rotate>=135&&l.rotate<=180||l.rotate>=-180&&l.rotate<=-135)&&(x=-x,b=-b),l.rotate>-135&&l.rotate<-45&&(x=-(w-r)/s.value/l.width*100,b=(y-i)/s.value/l.height*100),f.value&&(t!==p.RIGHT_BOTTOM&&t!==p.LEFT_TOP||(b=x/d),t!==p.LEFT_BOTTOM&&t!==p.RIGHT_TOP||(b=-x/d)),t===p.LEFT_TOP?(c.left+x<0&&(x=-c.left),c.top+b<0&&(b=-c.top),c.width-x<a&&(x=c.width-a),c.height-b<o&&(b=c.height-o),m=c.width-x,g=c.height-b,v=c.left+x,h=c.top+b):t===p.RIGHT_TOP?(c.left+c.width+x>u.width&&(x=u.width-(c.left+c.width)),c.top+b<0&&(b=-c.top),c.width+x<a&&(x=a-c.width),c.height-b<o&&(b=c.height-o),m=c.width+x,g=c.height-b,v=c.left,h=c.top+b):t===p.LEFT_BOTTOM?(c.left+x<0&&(x=-c.left),c.top+c.height+b>u.height&&(b=u.height-(c.top+c.height)),c.width-x<a&&(x=c.width-a),c.height+b<o&&(b=o-c.height),m=c.width-x,g=c.height+b,v=c.left+x,h=c.top):t===p.RIGHT_BOTTOM?(c.left+c.width+x>u.width&&(x=u.width-(c.left+c.width)),c.top+c.height+b>u.height&&(b=u.height-(c.top+c.height)),c.width+x<a&&(x=a-c.width),c.height+b<o&&(b=o-c.height),m=c.width+x,g=c.height+b,v=c.left,h=c.top):t===p.TOP?(c.top+b<0&&(b=-c.top),c.height-b<o&&(b=c.height-o),m=c.width,g=c.height-b,v=c.left,h=c.top+b):t===p.BOTTOM?(c.top+c.height+b>u.height&&(b=u.height-(c.top+c.height)),c.height+b<o&&(b=o-c.height),m=c.width,g=c.height+b,v=c.left,h=c.top):t===p.LEFT?(c.left+x<0&&(x=-c.left),c.width-x<a&&(x=c.width-a),m=c.width-x,g=c.height,v=c.left+x,h=c.top):(c.left+c.width+x>u.width&&(x=u.width-(c.left+c.width)),c.width+x<a&&(x=a-c.width),g=c.height,m=c.width+x,v=c.left,h=c.top),k.value={left:v,top:h,width:m,height:g}}},document.onmouseup=function(){n=!1,document.onmousemove=null,document.onmouseup=null,E(),setTimeout((function(){return h.value=!1}),0)}},M=(0,u.Fl)((function(){var e="rotate-",t=l.rotate;return t>-22.5&&t<=22.5?e+0:t>22.5&&t<=67.5?e+45:t>67.5&&t<=112.5?e+90:t>112.5&&t<=157.5?e+135:t>157.5||t<=-157.5?e+0:t>-157.5&&t<=-112.5?e+45:t>-112.5&&t<=-67.5?e+90:t>-67.5&&t<=-22.5?e+135:e+0})),U=[p.LEFT_TOP,p.RIGHT_TOP,p.LEFT_BOTTOM,p.RIGHT_BOTTOM],W=[p.TOP,p.BOTTOM,p.LEFT,p.RIGHT];return function(e,t){var n=(0,u.Q2)("click-outside");return(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"image-clip-handler",style:(0,pe.j5)(v.value)},[(0,u._)("img",{class:"bottom-img",src:e.src,draggable:!1,alt:"",style:(0,pe.j5)(b.value)},null,12,pi),(0,u._)("div",{class:"top-image-content",style:(0,pe.j5)((0,g.Z)((0,g.Z)({},_.value),{},{clipPath:e.clipPath}))},[(0,u._)("img",{class:"top-img",src:e.src,draggable:!1,alt:"",style:(0,pe.j5)(I.value)},null,12,hi)],4),(0,u._)("div",{class:"operate",style:(0,pe.j5)(_.value),onMousedown:t[0]||(t[0]=(0,a.iM)((function(e){return Z(e)}),["stop"]))},[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(U,(function(e){return(0,u._)("div",{class:(0,pe.C_)(["clip-point",e,M.value]),key:e,onMousedown:(0,a.iM)((function(t){return T(t,e)}),["stop"])},yi,42,mi)})),64)),((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(W,(function(e){return(0,u._)("div",{class:(0,pe.C_)(["clip-point",e,M.value]),key:e,onMousedown:(0,a.iM)((function(t){return T(t,e)}),["stop"])},bi,42,wi)})),64))],36)],4)),[[n,C]])}}}),_i=(0,ll.Z)(ki,[["__scopeId","data-v-5984406b"]]),Ii=_i;var Si=["src"];const Ci=(0,u.aZ)({__name:"index",props:{elementInfo:{},selectElement:{type:Function},contextmenus:{type:Function}},setup:function(e){var t=e,n=X(),l=V(),i=(0,o.Jk)(n),r=i.clipingImageElementId,s=(0,u.Fl)((function(){return r.value===t.elementInfo.id})),d=_l(),f=d.addHistorySnapshot,v=(0,u.Fl)((function(){return t.elementInfo.shadow})),p=Ro(v),h=p.shadowStyle,m=(0,u.Fl)((function(){return t.elementInfo.flipH})),y=(0,u.Fl)((function(){return t.elementInfo.flipV})),w=Bo(m,y),x=w.flipStyle,b=(0,u.Fl)((function(){return t.elementInfo.clip})),k=Yo(b),_=k.clipShape,I=k.imgPosition,S=(0,u.Fl)((function(){return t.elementInfo.filters})),C=Vo(S),L=C.filter,E=function(e){t.elementInfo.lock||(e.stopPropagation(),t.selectElement(e,t.elementInfo))},Z=function(e){if(n.setClipingImageElementId(""),e){var a=e.range,o=e.position,i=t.elementInfo.clip||{shape:"rect",range:[[0,0],[100,100]]},r=t.elementInfo.left+o.left,u=t.elementInfo.top+o.top,c=t.elementInfo.width+o.width,s=t.elementInfo.height+o.height,d=0,v=0;if(t.elementInfo.rotate){var p=r+c/2-(t.elementInfo.left+t.elementInfo.width/2),h=-(u+s/2-(t.elementInfo.top+t.elementInfo.height/2)),m=-t.elementInfo.rotate*Math.PI/180,y=p*Math.cos(m)-h*Math.sin(m),w=p*Math.sin(m)+h*Math.cos(m);d=y-p,v=-(w-h)}var x={clip:(0,g.Z)((0,g.Z)({},i),{},{range:a}),left:r+d,top:u+v,width:c,height:s};l.updateElement({id:t.elementInfo.id,props:x}),f()}};return function(e,t){var n=(0,u.Q2)("contextmenu");return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["editable-element-image",{lock:e.elementInfo.lock}]),style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[s.value?((0,u.wg)(),(0,u.j4)(Ii,{key:0,src:e.elementInfo.src,clipData:e.elementInfo.clip,width:e.elementInfo.width,height:e.elementInfo.height,top:e.elementInfo.top,left:e.elementInfo.left,rotate:e.elementInfo.rotate,clipPath:(0,c.SU)(_).style,onClip:t[0]||(t[0]=function(e){return Z(e)})},null,8,["src","clipData","width","height","top","left","rotate","clipPath"])):(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{key:1,class:"element-content",style:(0,pe.j5)({filter:(0,c.SU)(h)?"drop-shadow(".concat((0,c.SU)(h),")"):"",transform:(0,c.SU)(x)}),onMousedown:t[2]||(t[2]=function(e){return E(e)}),onTouchstart:t[3]||(t[3]=function(e){return E(e)})},[(0,u.Wm)(fi,{elementInfo:e.elementInfo},null,8,["elementInfo"]),(0,u._)("div",{class:"image-content",style:(0,pe.j5)({clipPath:(0,c.SU)(_).style})},[(0,u._)("img",{src:e.elementInfo.src,draggable:!1,style:(0,pe.j5)({top:(0,c.SU)(I).top,left:(0,c.SU)(I).left,width:(0,c.SU)(I).width,height:(0,c.SU)(I).height,filter:(0,c.SU)(L)}),onDragstart:t[1]||(t[1]=(0,a.iM)((function(){}),["prevent"])),alt:""},null,44,Si),e.elementInfo.colorMask?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"color-mask",style:(0,pe.j5)({backgroundColor:e.elementInfo.colorMask})},null,4)):(0,u.kq)("",!0)],4)],36)),[[n,e.contextmenus]])],4)],6)}}}),Li=(0,ll.Z)(Ci,[["__scopeId","data-v-1156b3e1"]]),Ei=Li;var Zi=["width","height"],Ti=["d","stroke","stroke-width","stroke-dasharray"];const Mi=(0,u.aZ)({__name:"ElementOutline",props:{width:{},height:{},outline:{}},setup:function(e){var t=e,n=Jo((0,c.Vh)(t,"outline")),l=n.outlineWidth,a=n.outlineColor,o=n.strokeDashArray;return function(e,t){return e.outline?((0,u.wg)(),(0,u.iD)("svg",{key:0,class:"element-outline",overflow:"visible",width:e.width,height:e.height},[(0,u._)("path",{"vector-effect":"non-scaling-stroke","stroke-linecap":"butt","stroke-miterlimit":"8",fill:"transparent",d:"M0,0 L".concat(e.width,",0 L").concat(e.width,",").concat(e.height," L0,").concat(e.height," Z"),stroke:(0,c.SU)(a),"stroke-width":(0,c.SU)(l),"stroke-dasharray":(0,c.SU)(o)},null,8,Ti)],8,Zi)):(0,u.kq)("",!0)}}}),Ui=(0,ll.Z)(Mi,[["__scopeId","data-v-efb76626"]]),Wi=Ui;var Di=n(62078),Hi=n(2376),Fi=n(84348),Ai=n(12806),Oi=n(30728),Pi=n(58463),Ri=n(24251),Bi=n(50915),zi=n(53833),Ni=n(36912),ji=function(e){var t={},n=function(e,n){return t[e]=n};return n("Alt-ArrowUp",w.MI),n("Alt-ArrowDown",w.Ig),n("Mod-z",Pi.Yw),n("Mod-y",Pi.KX),n("Backspace",Ni.dU),n("Escape",w.N0),n("Mod-b",(0,w.w9)(e.marks.strong)),n("Mod-i",(0,w.w9)(e.marks.em)),n("Mod-u",(0,w.w9)(e.marks.underline)),n("Mod-d",(0,w.w9)(e.marks.strikethrough)),n("Mod-e",(0,w.w9)(e.marks.code)),n("Mod-;",(0,w.w9)(e.marks.superscript)),n("Mod-'",(0,w.w9)(e.marks.subscript)),n("Enter",(0,w.QF)((0,zi.s6)(e.nodes.list_item),w.QK,w.mD,w.X0,w.$j)),n("Mod-[",(0,zi.IB)(e.nodes.list_item)),n("Mod-]",(0,zi.bw)(e.nodes.list_item)),n("Tab",(0,zi.bw)(e.nodes.list_item)),t},Yi=function(e){return(0,Ni.S0)(/^\s*>\s$/,e)},Vi=function(e){return(0,Ni.S0)(/^(\d+)\.\s$/,e,(function(e){return{order:+e[1]}}),(function(e,t){return t.childCount+t.attrs.order===+e[1]}))},Ji=function(e){return(0,Ni.S0)(/^\s*([-+*])\s$/,e)},qi=function(){var e=/(?:^|\s)((?:`)((?:[^`]+))(?:`))$/;return new Ni.VK(e,(function(e,t,n,l){var a=e.schema,o=e.tr.insertText("".concat(t[2]," "),n,l),i=a.marks.code.create();return o.addMark(n,n+t[2].length,i)}))},Xi=function(){var e=/(?:https?:\/\/)?[\w-]+(?:\.[\w-]+)+\.?(?:\d+)?(?:\/\S*)?$/;return new Ni.VK(e,(function(e,t,n,l){var a=e.schema,o=e.tr.insertText(t[0],n,l),i=a.marks.link.create({href:t[0],title:t[0]});return o.addMark(n,n+t[0].length,i)}))},Gi=function(e){var t=[].concat((0,R.Z)(Ni.yR),[Ni.LH,Ni.pR]);return t.push(Yi(e.nodes.blockquote)),t.push(Vi(e.nodes.ordered_list)),t.push(Ji(e.nodes.bullet_list)),t.push(qi()),t.push(Xi()),(0,Ni.Hw)({rules:t})},Ki=function(e){return"paragraph"===e.type.name&&2===e.nodeSize},Qi=function(e){return new Hi.Sy({props:{decorations:function(t){var n=t.selection.$from;if(Ki(n.parent)){var l=Fi.p.node(n.before(),n.after(),{"data-placeholder":e});return Fi.EH.create(t.doc,[l])}}}})},$i=function(e,t){var n=null===t||void 0===t?void 0:t.placeholder,l=[Gi(e),(0,Oi.h)(ji(e)),(0,Oi.h)(w.YR),(0,Ri.q)(),(0,Bi.d)(),(0,Pi.m8)()];return n&&l.push(Qi(n)),l},er=n(14073),tr={attrs:{order:{default:1},listStyleType:{default:""}},content:"list_item+",group:"block",parseDOM:[{tag:"ol",getAttrs:function(e){var t=(e.hasAttribute("start")?e.getAttribute("start"):1)||1,n={order:+t},l=e.style.listStyleType;return l&&(n["listStyleType"]=l),n}}],toDOM:function(e){var t=e.attrs,n=t.order,l=t.listStyleType,a="";l&&(a+="list-style-type: ".concat(l,";"));var o={style:a};return 1!==n&&(o["start"]=n),["ol",o,0]}},nr={attrs:{listStyleType:{default:""}},content:"list_item+",group:"block",parseDOM:[{tag:"ul",getAttrs:function(e){var t=e.style.listStyleType;return t?{listStyleType:t}:{}}}],toDOM:function(e){var t=e.attrs.listStyleType,n="";return t&&(n+="list-style-type: ".concat(t,";")),["ul",{style:n},0]}},lr=(0,g.Z)((0,g.Z)({},zi.qb),{},{content:"paragraph block*",group:"block"}),ar={attrs:{align:{default:""},indent:{default:0},textIndent:{default:0}},content:"inline*",group:"block",parseDOM:[{tag:"p",getAttrs:function(e){var t=e.style,n=t.textAlign,l=t.textIndent,a=e.getAttribute("align")||n||"";a=/(left|right|center|justify)/.test(a)?a:"";var o=0;l&&(/em/.test(l)?o=parseInt(l):/px/.test(l)&&(o=Math.floor(parseInt(l)/20),o||(o=1)));var i=+(e.getAttribute("data-indent")||0);return{align:a,indent:i,textIndent:o}}},{tag:"img",ignore:!0},{tag:"pre",skip:!0}],toDOM:function(e){var t=e.attrs,n=t.align,l=t.indent,a=t.textIndent,o="";n&&"left"!==n&&(o+="text-align: ".concat(n,";")),a&&(o+="text-indent: ".concat(20*a,"px;"));var i={style:o};return l&&(i["data-indent"]=l),["p",i,0]}},or=er.td.doc,ir=er.td.blockquote,rr=er.td.text;const ur={doc:or,paragraph:ar,blockquote:ir,text:rr,ordered_list:tr,bullet_list:nr,list_item:lr};var cr={excludes:"subscript",parseDOM:[{tag:"sub"},{style:"vertical-align",getAttrs:function(e){return"sub"===e&&null}}],toDOM:function(){return["sub",0]}},sr={excludes:"superscript",parseDOM:[{tag:"sup"},{style:"vertical-align",getAttrs:function(e){return"super"===e&&null}}],toDOM:function(){return["sup",0]}},dr={parseDOM:[{tag:"strike"},{style:"text-decoration",getAttrs:function(e){return"line-through"===e&&null}},{style:"text-decoration-line",getAttrs:function(e){return"line-through"===e&&null}}],toDOM:function(){return["span",{style:"text-decoration-line: line-through;"},0]}},fr={parseDOM:[{tag:"u"},{style:"text-decoration",getAttrs:function(e){return"underline"===e&&null}},{style:"text-decoration-line",getAttrs:function(e){return"underline"===e&&null}}],toDOM:function(){return["span",{style:"text-decoration: underline;"},0]}},vr={attrs:{color:{}},inline:!0,group:"inline",parseDOM:[{style:"color",getAttrs:function(e){return e?{color:e}:{}}}],toDOM:function(e){var t=e.attrs.color,n="";return t&&(n+="color: ".concat(t,";")),["span",{style:n},0]}},pr={attrs:{backcolor:{}},inline:!0,group:"inline",parseDOM:[{style:"background-color",getAttrs:function(e){return e?{backcolor:e}:{}}}],toDOM:function(e){var t=e.attrs.backcolor,n="";return t&&(n+="background-color: ".concat(t,";")),["span",{style:n},0]}},hr={attrs:{fontsize:{}},inline:!0,group:"inline",parseDOM:[{style:"font-size",getAttrs:function(e){return e?{fontsize:e}:{}}}],toDOM:function(e){var t=e.attrs.fontsize,n="";return t&&(n+="font-size: ".concat(t,";")),["span",{style:n},0]}},mr={attrs:{fontname:{}},inline:!0,group:"inline",parseDOM:[{style:"font-family",getAttrs:function(e){return{fontname:e&&"string"===typeof e?e.replace(/[\"\']/g,""):""}}}],toDOM:function(e){var t=e.attrs.fontname,n="";return t&&(n+="font-family: ".concat(t,";")),["span",{style:n},0]}},gr={attrs:{href:{},title:{default:null},target:{default:"_blank"}},inclusive:!1,parseDOM:[{tag:"a[href]",getAttrs:function(e){var t=e.getAttribute("href"),n=e.getAttribute("title");return{href:t,title:n}}}],toDOM:function(e){return["a",e.attrs,0]}},yr={attrs:{index:{default:null}},parseDOM:[{tag:"mark",getAttrs:function(e){var t=e.dataset.index;return{index:t}}}],toDOM:function(e){return["mark",{"data-index":e.attrs.index},0]}},wr=er.EI.em,xr=er.EI.strong,br=er.EI.code;const kr={em:wr,strong:xr,fontsize:hr,fontname:mr,code:br,forecolor:vr,backcolor:pr,subscript:cr,superscript:sr,strikethrough:dr,underline:fr,link:gr,mark:yr};var _r,Ir=ur,Sr=kr,Cr=new Ai.V_({nodes:Ir,marks:Sr}),Lr=function(e){var t="<div>".concat(e,"</div>"),n=new window.DOMParser,l=n.parseFromString(t,"text/html").body.firstElementChild;return Ai.aw.fromSchema(Cr).parse(l)},Er=function(e,t,n,l){return new Fi.tk(e,(0,g.Z)({state:Hi.yy.create({doc:Lr(t),plugins:$i(Cr,l)})},n))},Zr=n(59391);(function(e){e["RICH_TEXT_COMMAND"]="RICH_TEXT_COMMAND",e["OPEN_CHART_DATA_EDITOR"]="OPEN_CHART_DATA_EDITOR",e["OPEN_LATEX_EDITOR"]="OPEN_LATEX_EDITOR"})(_r||(_r={}));var Tr=(0,Zr.Z)();const Mr=Tr;n(19649);var Ur=function(e,t,n){var l=e,a=l.selection,o=l.doc;if(!a||!o)return e;var i=a.from,r=a.to,u=t.nodes,c=u.blockquote,s=u.list_item,d=u.paragraph,f=[];n=n||"";var v=new Set([c,s,d]);return o.nodesBetween(i,r,(function(e,t){var l=e.type,a=e.attrs.align||"";return a!==n&&v.has(l)&&f.push({node:e,pos:t,nodeType:l}),!0})),f.length?(f.forEach((function(t){var l=t.node,a=t.pos,o=t.nodeType,i=l.attrs;i=n?(0,g.Z)((0,g.Z)({},i),{},{align:n}):(0,g.Z)((0,g.Z)({},i),{},{align:null}),e=e.setNodeMarkup(a,o,i,l.marks)})),e):e},Wr=function(e,t){var n=e.state,l=n.schema,a=n.selection,o=Ur(n.tr.setSelection(a),l,t);e.dispatch(o)},Dr=function(e,t){return e.type===t.nodes.bullet_list||e.type===t.nodes.ordered_list},Hr=function(e,t,n){return function(l,a){var o=l.schema,i=l.selection,r=i.$from,u=i.$to,c=r.blockRange(u);if(!c)return!1;var s=S((function(e){return Dr(e,o)}))(i);if(c.depth>=1&&s&&c.depth-s.depth<=1){if(s.node.type===e&&!n)return(0,zi.IB)(t)(l,a);if(Dr(s.node,o)&&e.validContent(s.node.content)){var d=l.tr;if(n){var f=(0,g.Z)((0,g.Z)({},s.node.attrs),{},{listStyleType:n});d.setNodeMarkup(s.pos,e,f)}else d.setNodeMarkup(s.pos,e);return a&&a(d),!1}}return n?(0,zi.KI)(e,{listStyleType:n})(l,a):(0,zi.KI)(e)(l,a)}};function Fr(e,t,n,l){if(!e.doc)return e;var a=e.doc.nodeAt(t);if(!a)return e;var o=0,i=8,r=(a.attrs[l]||0)+n;if(r<o&&(r=o),r>i&&(r=i),r===a.attrs[l])return e;var u=(0,g.Z)((0,g.Z)({},a.attrs),{},(0,te.Z)({},l,r));return e.setNodeMarkup(t,a.type,u,a.marks)}var Ar=function(e,t,n,l){var a=e,o=a.selection,i=a.doc;if(!o||!i)return e;if(!(o instanceof Hi.Bs||o instanceof Hi.C1))return e;var r=o.from,u=o.to;return i.nodesBetween(r,u,(function(a,o){var i=a.type;return"paragraph"===i.name||"blockquote"===i.name?(e=Fr(e,o,n,l),!1):!Dr(a,t)})),e},Or=function(e,t){var n=e.state,l=n.schema,a=n.selection,o=Ar(n.tr.setSelection(a),l,t,"indent");return!!o.docChanged&&(e.dispatch(o),!0)},Pr=function(e,t){var n=e.state,l=n.schema,a=n.selection,o=Ar(n.tr.setSelection(a),l,t,"textIndent");return!!o.docChanged&&(e.dispatch(o),!0)},Rr=["keep"];const Br=(0,u.aZ)({__name:"ProsemirrorEditor",props:{elementId:{},defaultColor:{},defaultFontName:{},value:{},editable:{type:Boolean,default:!1},autoFocus:{type:Boolean,default:!1}},emits:["update","focus","blur","mousedown"],setup:function(e,t){var n,l=t.expose,a=t.emit,i=e,r=a,s=X(),d=(0,o.Jk)(s),f=d.handleElementId,v=d.textFormatPainter,p=(0,c.iH)(),h=(0,z.debounce)((function(){r("update",n.dom.innerHTML)}),300,{trailing:!0}),m=function(){s.setDisableHotkeysState(!0),r("focus")},g=function(){s.setDisableHotkeysState(!1),r("blur")},_=(0,z.debounce)((function(){var e=D(n,{color:i.defaultColor,fontname:i.defaultFontName});s.setRichtextAttrs(e)}),30,{trailing:!0}),I=function(){h(),_()},S=(0,u.Fl)((function(){return i.value}));(0,u.YP)(S,(function(){if(n&&!n.hasFocus()){var e=n.state,t=e.doc,l=e.tr;n.dispatch(l.replaceRangeWith(0,t.content.size,Lr(S.value)))}})),(0,u.YP)((function(){return i.editable}),(function(){n.setProps({editable:function(){return i.editable}})}));var C=function(){return n.focus()};l({focus:C});var E=function(e){var t=e.target,l=e.action;if((t||f.value===i.elementId)&&(!t||t===i.elementId)){var a,o="command"in l?[l]:l,r=(0,y.Z)(o);try{for(r.s();!(a=r.n()).done;){var u=a.value;if("fontname"===u.command&&u.value){var c=n.state.schema.marks.fontname.create({fontname:u.value});x(n),b(n,c)}else if("fontsize"===u.command&&u.value){var s=n.state.schema.marks.fontsize.create({fontsize:u.value});x(n),b(n,s)}else if("fontsize-add"===u.command){var d=u.value?+u.value:2;x(n);var v=H(n)+d+"px",p=n.state.schema.marks.fontsize.create({fontsize:v});b(n,p)}else if("fontsize-reduce"===u.command){var m=u.value?+u.value:2;x(n);var g=H(n)-m;g<12&&(g=12);var I=n.state.schema.marks.fontsize.create({fontsize:g+"px"});b(n,I)}else if("color"===u.command&&u.value){var S=n.state.schema.marks.forecolor.create({color:u.value});x(n),b(n,S)}else if("backcolor"===u.command&&u.value){var C=n.state.schema.marks.backcolor.create({backcolor:u.value});x(n),b(n,C)}else if("bold"===u.command)x(n),(0,w.w9)(n.state.schema.marks.strong)(n.state,n.dispatch);else if("em"===u.command)x(n),(0,w.w9)(n.state.schema.marks.em)(n.state,n.dispatch);else if("underline"===u.command)x(n),(0,w.w9)(n.state.schema.marks.underline)(n.state,n.dispatch);else if("strikethrough"===u.command)x(n),(0,w.w9)(n.state.schema.marks.strikethrough)(n.state,n.dispatch);else if("subscript"===u.command)(0,w.w9)(n.state.schema.marks.subscript)(n.state,n.dispatch);else if("superscript"===u.command)(0,w.w9)(n.state.schema.marks.superscript)(n.state,n.dispatch);else if("blockquote"===u.command){var E=L("blockquote",n.state);E?(0,w.xb)(n.state,n.dispatch):(0,w.ym)(n.state.schema.nodes.blockquote)(n.state,n.dispatch)}else if("code"===u.command)(0,w.w9)(n.state.schema.marks.code)(n.state,n.dispatch);else if("align"===u.command&&u.value)Wr(n,u.value);else if("indent"===u.command&&u.value)Or(n,+u.value);else if("textIndent"===u.command&&u.value)Pr(n,+u.value);else if("bulletList"===u.command){var Z=u.value||"",T=n.state.schema.nodes,U=T.bullet_list,W=T.list_item;Hr(U,W,Z)(n.state,n.dispatch)}else if("orderedList"===u.command){var D=u.value||"",F=n.state.schema.nodes,A=F.ordered_list,O=F.list_item;Hr(A,O,D)(n.state,n.dispatch)}else if("clear"===u.command){x(n);var P=n.state.selection,R=P.$from,B=P.$to;n.dispatch(n.state.tr.removeMark(R.pos,B.pos))}else if("link"===u.command){var z=n.state.schema.marks.link,N=n.state.selection,j=N.from,Y=N.to,V=k(n.state.doc,j,Y,z);if(V)if(u.value){var J=n.state.schema.marks.link.create({href:u.value,title:u.value});b(n,J,{from:V.from.pos,to:V.to.pos+1})}else n.dispatch(n.state.tr.removeMark(V.from.pos,V.to.pos+1,z));else if(M(n.state,z))if(u.value){var q=n.state.schema.marks.link.create({href:u.value,title:u.value});b(n,q)}else(0,w.w9)(z)(n.state,n.dispatch);else u.value&&(x(n),(0,w.w9)(z,{href:u.value,title:u.value})(n.state,n.dispatch))}else"insert"===u.command&&u.value&&n.dispatch(n.state.tr.insertText(u.value))}}catch(X){r.e(X)}finally{r.f()}n.focus(),h(),_()}},Z=function(){if(v.value){for(var e=v.value,t=e.keep,n=(0,Di.Z)(e,Rr),l=[{command:"clear"}],a=0,o=Object.keys(n);a<o.length;a++){var i=o[a],r=i,u=v.value[i];!0===u?l.push({command:r}):u&&l.push({command:r,value:u})}E({action:l}),t||s.setTextFormatPainter(null)}};return(0,u.bv)((function(){n=Er(p.value,S.value,{handleDOMEvents:{focus:m,blur:g,keydown:I,click:_,mouseup:Z},editable:function(){return i.editable}}),i.autoFocus&&n.focus()})),(0,u.Ah)((function(){n&&n.destroy()})),Mr.on(_r.RICH_TEXT_COMMAND,E),(0,u.Ah)((function(){Mr.off(_r.RICH_TEXT_COMMAND,E)})),function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["prosemirror-editor",{"format-painter":(0,c.SU)(v)}]),ref_key:"editorViewRef",ref:p,onMousedown:t[0]||(t[0]=function(e){return r("mousedown",e)})},null,34)}}}),zr=(0,ll.Z)(Br,[["__scopeId","data-v-3608adca"]]),Nr=zr;var jr=function(e){return(0,u.dD)("data-v-2a1e49ba"),e=e(),(0,u.Cn)(),e},Yr=jr((function(){return(0,u._)("div",{class:"drag-handler top"},null,-1)})),Vr=jr((function(){return(0,u._)("div",{class:"drag-handler bottom"},null,-1)}));const Jr=(0,u.aZ)({__name:"index",props:{elementInfo:{},selectElement:{type:Function},contextmenus:{type:Function}},setup:function(e){var t=e,n=X(),l=V(),a=(0,o.Jk)(n),i=a.handleElementId,r=a.isScaling,s=_l(),d=s.addHistorySnapshot,f=(0,c.iH)(),v=(0,u.Fl)((function(){return t.elementInfo.shadow})),p=Ro(v),h=p.shadowStyle,m=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.elementInfo.lock||(e.stopPropagation(),t.selectElement(e,t.elementInfo,n))},g=(0,c.iH)(-1),y=(0,c.iH)(-1);(0,u.YP)(r,(function(){i.value===t.elementInfo.id&&(r.value||(t.elementInfo.vertical||-1===g.value||(l.updateElement({id:t.elementInfo.id,props:{height:g.value}}),g.value=-1),t.elementInfo.vertical&&-1!==y.value&&(l.updateElement({id:t.elementInfo.id,props:{width:y.value}}),y.value=-1)))}));var w=function(e){var n=e[0].contentRect;if(f.value){var a=n.height+20,o=n.width+20;t.elementInfo.vertical||t.elementInfo.height===a||(r.value?g.value=a:l.updateElement({id:t.elementInfo.id,props:{height:a}})),t.elementInfo.vertical&&t.elementInfo.width!==o&&(r.value?y.value=o:l.updateElement({id:t.elementInfo.id,props:{width:o}}))}},x=new ResizeObserver(w);(0,u.bv)((function(){f.value&&x.observe(f.value)})),(0,u.Ah)((function(){f.value&&x.unobserve(f.value)}));var b=function(e){l.updateElement({id:t.elementInfo.id,props:{content:e}}),d()},k=(0,z.debounce)((function(){var e=t.elementInfo.content.replaceAll(/<[^>]+>/g,"");e||l.deleteElement(t.elementInfo.id)}),300,{trailing:!0}),_=(0,u.Fl)((function(){return i.value===t.elementInfo.id}));return(0,u.YP)(_,(function(){_.value||k()})),function(e,t){var n=(0,u.Q2)("contextmenu");return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["editable-element-text",{lock:e.elementInfo.lock}]),style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"element-content",ref_key:"elementRef",ref:f,style:(0,pe.j5)({width:e.elementInfo.vertical?"auto":e.elementInfo.width+"px",height:e.elementInfo.vertical?e.elementInfo.height+"px":"auto",backgroundColor:e.elementInfo.fill,opacity:e.elementInfo.opacity,textShadow:(0,c.SU)(h),lineHeight:e.elementInfo.lineHeight,letterSpacing:(e.elementInfo.wordSpace||0)+"px",color:e.elementInfo.defaultColor,fontFamily:e.elementInfo.defaultFontName,writingMode:e.elementInfo.vertical?"vertical-rl":"horizontal-tb"}),onMousedown:t[2]||(t[2]=function(e){return m(e)}),onTouchstart:t[3]||(t[3]=function(e){return m(e)})},[(0,u.Wm)(Wi,{width:e.elementInfo.width,height:e.elementInfo.height,outline:e.elementInfo.outline},null,8,["width","height","outline"]),(0,u.Wm)(Nr,{class:"text",elementId:e.elementInfo.id,defaultColor:e.elementInfo.defaultColor,defaultFontName:e.elementInfo.defaultFontName,editable:!e.elementInfo.lock,value:e.elementInfo.content,style:(0,pe.j5)({"--paragraphSpace":"".concat(void 0===e.elementInfo.paragraphSpace?5:e.elementInfo.paragraphSpace,"px")}),onUpdate:t[0]||(t[0]=function(e){return b(e)}),onMousedown:t[1]||(t[1]=function(e){return m(e,!1)})},null,8,["elementId","defaultColor","defaultFontName","editable","value","style"]),Yr,Vr],36)),[[n,e.contextmenus]])],4)],6)}}}),qr=(0,ll.Z)(Jr,[["__scopeId","data-v-2a1e49ba"]]),Xr=qr;var Gr=["id","gradientTransform"],Kr=["stop-color"],Qr=["stop-color"],$r=["id"],eu=["stop-color"],tu=["stop-color"];const nu=(0,u.aZ)({__name:"GradientDefs",props:{id:{},type:{},color1:{},color2:{},rotate:{default:0}},setup:function(e){return function(e,t){return"linear"===e.type?((0,u.wg)(),(0,u.iD)("linearGradient",{key:0,id:e.id,x1:"0%",y1:"0%",x2:"100%",y2:"0%",gradientTransform:"rotate(".concat(e.rotate,",0.5,0.5)")},[(0,u._)("stop",{offset:"0%","stop-color":e.color1},null,8,Kr),(0,u._)("stop",{offset:"100%","stop-color":e.color2},null,8,Qr)],8,Gr)):((0,u.wg)(),(0,u.iD)("radialGradient",{key:1,id:e.id},[(0,u._)("stop",{offset:"0%","stop-color":e.color1},null,8,eu),(0,u._)("stop",{offset:"100%","stop-color":e.color2},null,8,tu)],8,$r))}}}),lu=nu,au=lu;var ou=["keep"],iu=["width","height"],ru={key:0},uu=["transform"],cu=["d","fill","stroke","stroke-width","stroke-dasharray"];const su=(0,u.aZ)({__name:"index",props:{elementInfo:{},selectElement:{type:Function},contextmenus:{type:Function}},setup:function(e){var t=e,n=X(),l=V(),a=(0,o.Jk)(n),i=a.handleElementId,r=a.shapeFormatPainter,s=_l(),d=s.addHistorySnapshot,f=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.elementInfo.lock||(e.stopPropagation(),t.selectElement(e,t.elementInfo,n))},v=function(){if(r.value){var e=r.value,a=e.keep,o=(0,Di.Z)(e,ou);l.updateElement({id:t.elementInfo.id,props:o}),d(),a||n.setShapeFormatPainter(null)}},p=(0,u.Fl)((function(){return t.elementInfo.outline})),h=Jo(p),m=h.outlineWidth,y=h.outlineColor,w=h.strokeDashArray,x=(0,u.Fl)((function(){return t.elementInfo.shadow})),b=Ro(x),k=b.shadowStyle,_=(0,u.Fl)((function(){return t.elementInfo.flipH})),I=(0,u.Fl)((function(){return t.elementInfo.flipV})),S=Bo(_,I),C=S.flipStyle,L=(0,c.iH)(!1);(0,u.YP)(i,(function(){i.value!==t.elementInfo.id&&L.value&&(L.value=!1)}));var E=(0,u.Fl)((function(){var e={content:"",defaultFontName:"Microsoft Yahei",defaultColor:"#000",align:"middle"};return t.elementInfo.text?t.elementInfo.text:e})),Z=function(e){var n=(0,g.Z)((0,g.Z)({},E.value),{},{content:e});l.updateElement({id:t.elementInfo.id,props:{text:n}}),d()},T=function(){if(t.elementInfo.text){var e=t.elementInfo.text.content.replaceAll(/<[^>]+>/g,"");e||(l.removeElementProps({id:t.elementInfo.id,propName:"text"}),d())}},M=(0,c.iH)(),U=function(){L.value=!0,(0,u.Y3)((function(){return M.value&&M.value.focus()}))};return function(e,t){var n=(0,u.Q2)("contextmenu");return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["editable-element-shape",{lock:e.elementInfo.lock,"format-painter":(0,c.SU)(r)}]),style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"element-content",style:(0,pe.j5)({opacity:e.elementInfo.opacity,filter:(0,c.SU)(k)?"drop-shadow(".concat((0,c.SU)(k),")"):"",transform:(0,c.SU)(C),color:E.value.defaultColor,fontFamily:E.value.defaultFontName}),onMousedown:t[3]||(t[3]=function(e){return f(e)}),onMouseup:t[4]||(t[4]=function(e){return v()}),onTouchstart:t[5]||(t[5]=function(e){return f(e)}),onDblclick:t[6]||(t[6]=function(e){return U()})},[((0,u.wg)(),(0,u.iD)("svg",{overflow:"visible",width:e.elementInfo.width,height:e.elementInfo.height},[e.elementInfo.gradient?((0,u.wg)(),(0,u.iD)("defs",ru,[(0,u.Wm)(au,{id:"editabel-gradient-".concat(e.elementInfo.id),type:e.elementInfo.gradient.type,color1:e.elementInfo.gradient.color[0],color2:e.elementInfo.gradient.color[1],rotate:e.elementInfo.gradient.rotate},null,8,["id","type","color1","color2","rotate"])])):(0,u.kq)("",!0),(0,u._)("g",{transform:"scale(".concat(e.elementInfo.width/e.elementInfo.viewBox[0],", ").concat(e.elementInfo.height/e.elementInfo.viewBox[1],") translate(0,0) matrix(1,0,0,1,0,0)")},[(0,u._)("path",{class:"shape-path","vector-effect":"non-scaling-stroke","stroke-linecap":"butt","stroke-miterlimit":"8",d:e.elementInfo.path,fill:e.elementInfo.gradient?"url(#editabel-gradient-".concat(e.elementInfo.id,")"):e.elementInfo.fill,stroke:(0,c.SU)(y),"stroke-width":(0,c.SU)(m),"stroke-dasharray":(0,c.SU)(w)},null,8,cu)],8,uu)],8,iu)),(0,u._)("div",{class:(0,pe.C_)(["shape-text",[E.value.align,{editable:L.value||E.value.content}]])},[L.value||E.value.content?((0,u.wg)(),(0,u.j4)(Nr,{key:0,ref_key:"prosemirrorEditorRef",ref:M,elementId:e.elementInfo.id,defaultColor:E.value.defaultColor,defaultFontName:E.value.defaultFontName,editable:!e.elementInfo.lock,value:E.value.content,onUpdate:t[0]||(t[0]=function(e){return Z(e)}),onBlur:t[1]||(t[1]=function(e){return T()}),onMousedown:t[2]||(t[2]=function(e){return f(e,!1)})},null,8,["elementId","defaultColor","defaultFontName","editable","value"])):(0,u.kq)("",!0)],2)],36)),[[n,e.contextmenus]])],4)],6)}}}),du=(0,ll.Z)(su,[["__scopeId","data-v-3d624beb"]]),fu=du;var vu=["id","markerWidth","markerHeight","refX","refY"],pu=["d","fill","transform"];const hu=(0,u.aZ)({__name:"LinePointMarker",props:{id:{},position:{},type:{},baseSize:{},color:{}},setup:function(e){var t=e,n={dot:"m0 5a5 5 0 1 0 10 0a5 5 0 1 0 -10 0z",arrow:"M0,0 L10,5 0,10 Z"},l={"arrow-start":180,"arrow-end":0},a=(0,u.Fl)((function(){return n[t.type]})),o=(0,u.Fl)((function(){return l["".concat(t.type,"-").concat(t.position)]||0})),i=(0,u.Fl)((function(){return t.baseSize<2?2:t.baseSize}));return function(e,t){return(0,u.wg)(),(0,u.iD)("marker",{id:"".concat(e.id,"-").concat(e.type,"-").concat(e.position),markerUnits:"userSpaceOnUse",orient:"auto",markerWidth:3*i.value,markerHeight:3*i.value,refX:1.5*i.value,refY:1.5*i.value},[(0,u._)("path",{d:a.value,fill:e.color,transform:"scale(".concat(.3*i.value,", ").concat(.3*i.value,") rotate(").concat(o.value,", 5, 5)")},null,8,pu)],8,vu)}}}),mu=hu,gu=mu;var yu=["width","height"],wu=["d","stroke","stroke-width","stroke-dasharray","marker-start","marker-end"],xu=["d"];const bu=(0,u.aZ)({__name:"index",props:{elementInfo:{},selectElement:{type:Function},contextmenus:{type:Function}},setup:function(e){var t=e,n=function(e){t.elementInfo.lock||(e.stopPropagation(),t.selectElement(e,t.elementInfo))},l=(0,u.Fl)((function(){return t.elementInfo.shadow})),a=Ro(l),o=a.shadowStyle,i=(0,u.Fl)((function(){var e=Math.abs(t.elementInfo.start[0]-t.elementInfo.end[0]);return e<24?24:e})),r=(0,u.Fl)((function(){var e=Math.abs(t.elementInfo.start[1]-t.elementInfo.end[1]);return e<24?24:e})),s=(0,u.Fl)((function(){if("dashed"!==t.elementInfo.style)return"0 0";var e=t.elementInfo.width;return e<=8?"".concat(5*e," ").concat(2.5*e):"".concat(5*e," ").concat(1.5*e)})),d=(0,u.Fl)((function(){return He(t.elementInfo)}));return function(e,t){var l=(0,u.Q2)("contextmenu");return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["editable-element-shape",{lock:e.elementInfo.lock}]),style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px"})},[(0,u._)("div",{class:"element-content",style:(0,pe.j5)({filter:(0,c.SU)(o)?"drop-shadow(".concat((0,c.SU)(o),")"):""}),onMousedown:t[0]||(t[0]=function(e){return n(e)}),onTouchstart:t[1]||(t[1]=function(e){return n(e)})},[((0,u.wg)(),(0,u.iD)("svg",{overflow:"visible",width:i.value,height:r.value},[(0,u._)("defs",null,[e.elementInfo.points[0]?((0,u.wg)(),(0,u.j4)(gu,{key:0,id:e.elementInfo.id,position:"start",type:e.elementInfo.points[0],color:e.elementInfo.color,baseSize:e.elementInfo.width},null,8,["id","type","color","baseSize"])):(0,u.kq)("",!0),e.elementInfo.points[1]?((0,u.wg)(),(0,u.j4)(gu,{key:1,id:e.elementInfo.id,position:"end",type:e.elementInfo.points[1],color:e.elementInfo.color,baseSize:e.elementInfo.width},null,8,["id","type","color","baseSize"])):(0,u.kq)("",!0)]),(0,u._)("path",{class:"line-point",d:d.value,stroke:e.elementInfo.color,"stroke-width":e.elementInfo.width,"stroke-dasharray":s.value,fill:"none","marker-start":e.elementInfo.points[0]?"url(#".concat(e.elementInfo.id,"-").concat(e.elementInfo.points[0],"-start)"):"","marker-end":e.elementInfo.points[1]?"url(#".concat(e.elementInfo.id,"-").concat(e.elementInfo.points[1],"-end)"):""},null,8,wu),(0,u.wy)((0,u._)("path",{class:"line-path",d:d.value,stroke:"transparent","stroke-width":"20",fill:"none"},null,8,xu),[[l,e.contextmenus]])],8,yu))],36)],6)}}}),ku=(0,ll.Z)(bu,[["__scopeId","data-v-16512454"]]),_u=ku;var Iu=n(27678);n(4991);const Su=(0,u.aZ)({__name:"Chart",props:{width:{},height:{},type:{},data:{},themeColor:{},legends:{},options:{},gridColor:{},legend:{}},setup:function(e){var t,n=e,l=(0,c.iH)(),a=(0,u.f3)(xo)||(0,c.iH)(1),o=(0,u.Fl)((function(){return n.legend?n.height-20:n.height})),i=function(){return(0,g.Z)((0,g.Z)({},n.data),{},{series:n.data.series[0]})},r=function(){var e=n.options||{};return(0,g.Z)((0,g.Z)({},e),{},{width:n.width*a.value,height:o.value*a.value})},s=function(){if(l.value){var e=r();"bar"===n.type&&(t=new Iu.vz(l.value,n.data,e)),"line"===n.type&&(t=new Iu.wW(l.value,n.data,e)),"pie"===n.type&&(t=new Iu.uc(l.value,i(),e))}},d=function(){if(t){var e=r(),l="pie"===n.type?i():n.data;t.update(l,e)}else s()};(0,u.YP)([function(){return n.width},function(){return n.height},function(){return n.data},function(){return n.options},a],d),(0,u.bv)(s);var f=(0,u.Fl)((function(){var e=[];if(n.themeColor.length>=10)e=n.themeColor;else if(1===n.themeColor.length)e=(0,B.Z)(n.themeColor[0]).analogous(10).map((function(e){return e.toRgbString()}));else{var t=n.themeColor.length,l=(0,B.Z)(n.themeColor[t-1]).analogous(11-t).map((function(e){return e.toRgbString()}));e=[].concat((0,R.Z)(n.themeColor.slice(0,t-1)),(0,R.Z)(l))}return e})),v=function(){if(l.value)for(var e=0;e<10;e++)l.value.style.setProperty("--theme-color-".concat(e+1),f.value[e])};(0,u.YP)(f,v),(0,u.bv)(v);var p=function(){l.value&&n.gridColor&&l.value.style.setProperty("--grid-color",n.gridColor)};return(0,u.YP)((function(){return n.gridColor}),p),(0,u.bv)(p),function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"chart",style:(0,pe.j5)({flexDirection:"top"===e.legend?"column-reverse":"column"})},[(0,u._)("div",{class:"chart-content",ref_key:"chartRef",ref:l,style:(0,pe.j5)({width:e.width+"px",height:o.value+"px",transform:"scale(".concat(1/(0,c.SU)(a),")")})},null,4),e.legend?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"legends",style:(0,pe.j5)({transform:"scale(".concat(1/(0,c.SU)(a),")")})},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.legends,(function(t,n){return(0,u.wg)(),(0,u.iD)("div",{class:"legend",key:n,style:(0,pe.j5)({color:e.gridColor})},[(0,u._)("div",{class:"block",style:(0,pe.j5)({backgroundColor:f.value[n]})},null,4),(0,u.Uk)(" "+(0,pe.zw)(t),1)],4)})),128))],4)):(0,u.kq)("",!0)],4)}}}),Cu=(0,ll.Z)(Su,[["__scopeId","data-v-ae2a96a6"]]),Lu=Cu,Eu=(0,u.aZ)({__name:"index",props:{elementInfo:{},selectElement:{type:Function},contextmenus:{type:Function}},setup:function(e){var t=e,n=function(e){t.elementInfo.lock||(e.stopPropagation(),t.selectElement(e,t.elementInfo))},l=function(){Mr.emit(_r.OPEN_CHART_DATA_EDITOR)};return function(e,t){var a=(0,u.Q2)("contextmenu");return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["editable-element-chart",{lock:e.elementInfo.lock}]),style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"element-content",style:(0,pe.j5)({backgroundColor:e.elementInfo.fill}),onMousedown:t[0]||(t[0]=function(e){return n(e)}),onTouchstart:t[1]||(t[1]=function(e){return n(e)}),onDblclick:t[2]||(t[2]=function(e){return l()})},[(0,u.Wm)(Wi,{width:e.elementInfo.width,height:e.elementInfo.height,outline:e.elementInfo.outline},null,8,["width","height","outline"]),(0,u.Wm)(Lu,{width:e.elementInfo.width,height:e.elementInfo.height,type:e.elementInfo.chartType,data:e.elementInfo.data,options:e.elementInfo.options,themeColor:e.elementInfo.themeColor,gridColor:e.elementInfo.gridColor,legends:e.elementInfo.data.legends,legend:e.elementInfo.legend||""},null,8,["width","height","type","data","options","themeColor","gridColor","legends","legend"])],36)),[[a,e.contextmenus]])],4)],6)}}}),Zu=(0,ll.Z)(Eu,[["__scopeId","data-v-6fc3de39"]]),Tu=Zu;var Mu=function(e){if(!e)return{};var t=e.bold,n=e.em,l=e.underline,a=e.strikethrough,o=e.color,i=e.backcolor,r=e.fontsize,u=e.fontname,c=e.align,s="".concat(l?"underline":""," ").concat(a?"line-through":"");return" "===s&&(s="none"),{fontWeight:t?"bold":"normal",fontStyle:n?"italic":"normal",textDecoration:s,color:o||"#000",backgroundColor:i||"",fontSize:r||"14px",fontFamily:u||"Microsoft Yahei",textAlign:c||"left"}},Uu=function(e){return e.replace(/\n/g,"</br>").replace(/ /g,"&nbsp;")};const Wu=function(e){var t=(0,u.Fl)((function(){for(var t=[],n=0;n<e.value.length;n++)for(var l=e.value[n],a=0;a<l.length;a++){var o=l[a];if(o.colspan>1||o.rowspan>1)for(var i=n;i<n+o.rowspan;i++)for(var r=i===n?a+1:a;r<a+o.colspan;r++)t.push("".concat(i,"_").concat(r))}return t}));return{hideCells:t}},Du=function(e){var t=(0,c.iH)(["",""]);return(0,u.YP)((function(){return e.value}),(function(){e.value&&(t.value=De(e.value.color))}),{immediate:!0}),{subThemeColor:t}};var Hu=["innerHTML"];const Fu=(0,u.aZ)({__name:"CustomTextarea",props:{value:{default:""}},emits:["updateValue","insertExcelData"],setup:function(e,t){var n=t.emit,l=e,a=n,o=(0,c.iH)(),i=(0,c.iH)(""),r=(0,c.iH)(!1);(0,u.YP)((function(){return l.value}),(function(){r.value||(i.value=l.value,o.value&&(o.value.innerHTML=l.value))}),{immediate:!0});var s=function(){if(o.value){var e=o.value.innerHTML;a("updateValue",e)}},d=function(){r.value=!0,o.value&&(o.value.onpaste=function(e){if(e.preventDefault(),e.clipboardData){var t=e.clipboardData.items[0];t&&"string"===t.kind&&"text/plain"===t.type&&t.getAsString((function(e){var t=Se(e);if("object"!==(0,hl.Z)(t)){var n=Ce(e);if(n)return a("insertExcelData",n),void(o.value&&(o.value.innerHTML=n[0][0]));document.execCommand("insertText",!1,e)}}))}})},f=function(){r.value=!1,o.value&&(o.value.onpaste=null)};return(0,u.Jd)((function(){o.value&&(o.value.onpaste=null)})),function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"custom-textarea",ref_key:"textareaRef",ref:o,contenteditable:!0,onFocus:t[0]||(t[0]=function(e){return d()}),onBlur:t[1]||(t[1]=function(e){return f()}),onInput:t[2]||(t[2]=function(e){return s()}),innerHTML:i.value},null,40,Hu)}}}),Au=(0,ll.Z)(Fu,[["__scopeId","data-v-7a7222ac"]]),Ou=Au;var Pu={key:0,class:"handler"},Ru=["onMousedown"],Bu=["width"],zu=["rowspan","colspan","data-cell-index","onMousedown","onMouseenter"],Nu=["innerHTML"];const ju=(0,u.aZ)({__name:"EditableTable",props:{data:{},width:{},cellMinHeight:{},colWidths:{},outline:{},theme:{},editable:{type:Boolean,default:!0}},emits:["change","changeColWidths","changeSelectedCells"],setup:function(e,t){var n=t.emit,l=e,i=n,r=(0,o.Jk)(X()),d=r.canvasScale,f=(0,c.iH)(!1),v=(0,c.iH)([]),p=(0,c.iH)([]),h=(0,u.Fl)({get:function(){return l.data},set:function(e){i("change",e)}}),y=(0,u.Fl)((function(){return l.theme})),w=Du(y),x=w.subThemeColor,b=(0,c.iH)([]),k=(0,u.Fl)((function(){return b.value.reduce((function(e,t){return e+t}))}));(0,u.YP)([function(){return l.colWidths},function(){return l.width}],(function(){b.value=l.colWidths.map((function(e){return e*l.width}))}),{immediate:!0});var _=function(){v.value=[],p.value=[]};(0,u.YP)((function(){return l.editable}),(function(){l.editable||_()}));var I=(0,u.Fl)((function(){for(var e=[],t=1;t<b.value.length+1;t++){var n=b.value.slice(0,t).reduce((function(e,t){return e+t}));e.push(n)}return e})),S=(0,u.Fl)((function(){return l.data})),C=Wu(S),L=C.hideCells,E=(0,u.Fl)((function(){if(!v.value.length)return[];var e=(0,ne.Z)(v.value,2),t=e[0],n=e[1];if(!p.value.length)return["".concat(t,"_").concat(n)];var l=(0,ne.Z)(p.value,2),a=l[0],o=l[1];if(t===a&&n===o)return["".concat(t,"_").concat(n)];for(var i=[],r=Math.min(t,a),u=Math.min(n,o),c=Math.max(t,a),s=Math.max(n,o),d=0;d<h.value.length;d++)for(var f=h.value[d],m=0;m<f.length;m++)d>=r&&d<=c&&m>=u&&m<=s&&i.push("".concat(d,"_").concat(m));return i}));(0,u.YP)(E,(function(e,t){(0,z.isEqual)(e,t)||i("changeSelectedCells",E.value)}));var Z=(0,u.Fl)((function(){return E.value.length>1?null:E.value[0]})),T=function(){return f.value=!1},M=function(e,t,n){0===e.button&&(p.value=[],f.value=!0,v.value=[t,n])},U=function(e,t){f.value&&(p.value=[e,t])};(0,u.bv)((function(){document.addEventListener("mouseup",T)})),(0,u.Ah)((function(){document.removeEventListener("mouseup",T)}));var W=function(e,t){return L.value.includes("".concat(e,"_").concat(t))},D=function(e){var t=h.value.length-1;v.value=[0,e],p.value=[t,e]},H=function(e){var t=h.value[e].length-1;v.value=[e,0],p.value=[e,t]},F=function(){var e=h.value.length-1,t=h.value[e].length-1;v.value=[0,0],p.value=[e,t]},A=function(e){for(var t=JSON.parse(JSON.stringify(h.value)),n=h.value[e],l=[],a=0;a<n.length;a++)W(e,a)&&l.push(a);for(var o=0,i=l;o<i.length;o++)for(var r=i[o],u=e;u>=0;u--)if(!W(u,r)){t[u][r].rowspan=t[u][r].rowspan-1;break}t.splice(e,1),h.value=t},O=function(e){for(var t=JSON.parse(JSON.stringify(h.value)),n=[],l=0;l<h.value.length;l++)W(l,e)&&n.push(l);for(var a=0,o=n;a<o.length;a++)for(var r=o[a],u=e;u>=0;u--)if(!W(r,u)){t[r][u].colspan=t[r][u].colspan-1;break}h.value=t.map((function(t){return t.splice(e,1),t})),b.value.splice(e,1),i("changeColWidths",b.value)},P=function(e){for(var t=JSON.parse(JSON.stringify(h.value)),n=[],l=0;l<t[0].length;l++)n.push({colspan:1,rowspan:1,text:"",id:(0,s.x0)(10)});t.splice(e,0,n),h.value=t},B=function(e){h.value=h.value.map((function(t){var n={colspan:1,rowspan:1,text:"",id:(0,s.x0)(10)};return t.splice(e,0,n),t})),b.value.splice(e,0,100),i("changeColWidths",b.value)},N=function(e,t){var n=JSON.parse(JSON.stringify(h.value)),l={colspan:1,rowspan:1,text:""};if(e){for(var a=[],o=0;o<e;o++){for(var r=[],u=0;u<n[0].length;u++)r.push((0,g.Z)((0,g.Z)({},l),{},{id:(0,s.x0)(10)}));a.push(r)}n=[].concat((0,R.Z)(n),a)}t&&(n=n.map((function(e){for(var n=[],a=0;a<t;a++){var o=(0,g.Z)((0,g.Z)({},l),{},{id:(0,s.x0)(10)});n.push(o)}return[].concat((0,R.Z)(e),n)})),b.value=[].concat((0,R.Z)(b.value),(0,R.Z)(new Array(t).fill(100))),i("changeColWidths",b.value)),h.value=n},j=function(){var e=(0,ne.Z)(v.value,2),t=e[0],n=e[1],l=(0,ne.Z)(p.value,2),a=l[0],o=l[1],i=Math.min(t,a),r=Math.min(n,o),u=Math.max(t,a),c=Math.max(n,o),s=JSON.parse(JSON.stringify(h.value));s[i][r].rowspan=u-i+1,s[i][r].colspan=c-r+1,h.value=s,_()},Y=function(e,t){var n=JSON.parse(JSON.stringify(h.value));n[e][t].rowspan=1,n[e][t].colspan=1,h.value=n,_()},V=function(e,t){_();var n=!0,l=b.value[t],a=e.pageX,o=50;document.onmousemove=function(e){if(n){var i=(e.pageX-a)/d.value,r=l+i<o?o:Math.round(l+i);b.value[t]=r}},document.onmouseup=function(){n=!1,document.onmousemove=null,document.onmouseup=null,i("changeColWidths",b.value)}},J=function(){for(var e=JSON.parse(JSON.stringify(h.value)),t=0;t<e.length;t++)for(var n=0;n<e[t].length;n++)E.value.includes("".concat(t,"_").concat(n))&&(e[t][n].text="");h.value=e},q=function(){var e=function e(t,n){return h.value[t]?h.value[t][n]?W(t,n)?e(t,n+1):[t,n]:e(t+1,0):null};p.value=[];var t=v.value[0],n=v.value[1]+1,l=e(t,n);l?v.value=l:(P(t+1),v.value=[t+1,0]),(0,u.Y3)((function(){var e=document.querySelector(".cell-text.active");e&&e.focus()}))},G=function(e){if(l.editable&&E.value.length){var t=e.key.toUpperCase();if(E.value.length<2){if(t===m.TAB&&(e.preventDefault(),q()),e.ctrlKey&&t===m.UP){e.preventDefault();var n=+E.value[0].split("_")[0];P(n)}if(e.ctrlKey&&t===m.DOWN){e.preventDefault();var a=+E.value[0].split("_")[0];P(a+1)}if(e.ctrlKey&&t===m.LEFT){e.preventDefault();var o=+E.value[0].split("_")[1];B(o)}if(e.ctrlKey&&t===m.RIGHT){e.preventDefault();var i=+E.value[0].split("_")[1];B(i+1)}}else t===m.DELETE&&J()}};(0,u.bv)((function(){document.addEventListener("keydown",G)})),(0,u.Ah)((function(){document.removeEventListener("keydown",G)}));var K=(0,z.debounce)((function(e,t,n){h.value[t][n].text=e,i("change",h.value)}),300,{trailing:!0}),Q=function(e,t,n){var l=e.length,a=e[0].length,o=0,r=0;t+l>h.value.length&&(o=t+l-h.value.length),n+a>h.value[0].length&&(r=n+a-h.value[0].length),(o||r)&&N(o,r),(0,u.Y3)((function(){for(var o=0;o<l;o++)for(var r=0;r<a;r++)h.value[t+o][n+r]&&(h.value[t+o][n+r].text=e[o][r]);i("change",h.value)}))},$=function(){for(var e=[],t=0;t<h.value.length;t++){for(var n=h.value[t],l=[],a=0;a<n.length;a++)W(t,a)||l.push(n[a]);l.length&&e.push(l)}return e},ee=function(){var e=$(),t=e.length>1,n=e[0].length>1;return{canDeleteRow:t,canDeleteCol:n}},te=function(e,t){var n=E.value.length>1,l=h.value[e][t],a=n,o=!n&&(l.rowspan>1||l.colspan>1);return{canMerge:a,canSplit:o}},le=function(e){var t=e.dataset.cellIndex,n=+t.split("_")[0],l=+t.split("_")[1];E.value.includes("".concat(n,"_").concat(l))||(v.value=[n,l],p.value=[]);var a=te(n,l),o=a.canMerge,i=a.canSplit,r=ee(),u=r.canDeleteRow,c=r.canDeleteCol;return[{text:"Insert column",children:[{text:"To the left",handler:function(){return B(l)}},{text:"To the right",handler:function(){return B(l+1)}}]},{text:"Insert row",children:[{text:"To the top",handler:function(){return P(n)}},{text:"Go to the bottom",handler:function(){return P(n+1)}}]},{text:"Delete column",disable:!c,handler:function(){return O(l)}},{text:"Delete row",disable:!u,handler:function(){return A(n)}},{divider:!0},{text:"Merge cells",disable:!o,handler:j},{text:"Unmerge cells",disable:!i,handler:function(){return Y(n,l)}},{divider:!0},{text:"Select current column",handler:function(){return D(l)}},{text:"Select current line",handler:function(){return H(n)}},{text:"Select all cells",handler:F}]};return function(e,t){var n,l,o,i,r,s=(0,u.Q2)("contextmenu");return(0,u.wg)(),(0,u.iD)("div",{class:"editable-table",style:(0,pe.j5)({width:k.value+"px"})},[e.editable?((0,u.wg)(),(0,u.iD)("div",Pu,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(I.value,(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"drag-line",key:t,style:(0,pe.j5)({left:e+"px"}),onMousedown:function(e){return V(e,t)}},null,44,Ru)})),128))])):(0,u.kq)("",!0),(0,u._)("table",{class:(0,pe.C_)({theme:y.value,"row-header":null===(n=y.value)||void 0===n?void 0:n.rowHeader,"row-footer":null===(l=y.value)||void 0===l?void 0:l.rowFooter,"col-header":null===(o=y.value)||void 0===o?void 0:o.colHeader,"col-footer":null===(i=y.value)||void 0===i?void 0:i.colFooter}),style:(0,pe.j5)("--themeColor: ".concat(null===(r=y.value)||void 0===r?void 0:r.color,"; --subThemeColor1: ").concat((0,c.SU)(x)[0],"; --subThemeColor2: ").concat((0,c.SU)(x)[1]))},[(0,u._)("colgroup",null,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(b.value,(function(e,t){return(0,u.wg)(),(0,u.iD)("col",{span:"1",key:t,width:e},null,8,Bu)})),128))]),(0,u._)("tbody",null,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(h.value,(function(t,n){return(0,u.wg)(),(0,u.iD)("tr",{key:n,style:(0,pe.j5)({height:e.cellMinHeight+"px"})},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(t,(function(t,l){return(0,u.wy)(((0,u.wg)(),(0,u.iD)("td",{class:(0,pe.C_)(["cell",{selected:E.value.includes("".concat(n,"_").concat(l))&&E.value.length>1,active:Z.value==="".concat(n,"_").concat(l)}]),style:(0,pe.j5)((0,g.Z)({borderStyle:e.outline.style,borderColor:e.outline.color,borderWidth:e.outline.width+"px"},(0,c.SU)(Mu)(t.style))),key:t.id,rowspan:t.rowspan,colspan:t.colspan,"data-cell-index":"".concat(n,"_").concat(l),onMousedown:function(e){return M(e,n,l)},onMouseenter:function(e){return U(n,l)}},[Z.value==="".concat(n,"_").concat(l)?((0,u.wg)(),(0,u.j4)(Ou,{key:0,class:(0,pe.C_)(["cell-text",{active:Z.value==="".concat(n,"_").concat(l)}]),style:(0,pe.j5)({minHeight:e.cellMinHeight-4+"px"}),value:t.text,onUpdateValue:function(e){return(0,c.SU)(K)(e,n,l)},onInsertExcelData:function(e){return Q(e,n,l)}},null,8,["class","style","value","onUpdateValue","onInsertExcelData"])):((0,u.wg)(),(0,u.iD)("div",{key:1,class:"cell-text",style:(0,pe.j5)({minHeight:e.cellMinHeight-4+"px"}),innerHTML:(0,c.SU)(Uu)(t.text)},null,12,Nu))],46,zu)),[[a.F8,!(0,c.SU)(L).includes("".concat(n,"_").concat(l))],[s,function(e){return le(e)}]])})),128))],4)})),128))])],6)],4)}}}),Yu=(0,ll.Z)(ju,[["__scopeId","data-v-4fdca5cc"]]),Vu=Yu;var Ju={class:"element-content"};const qu=(0,u.aZ)({__name:"index",props:{elementInfo:{},selectElement:{type:Function},contextmenus:{type:Function}},setup:function(e){var t=e,n=X(),l=V(),i=(0,o.Jk)(n),r=i.canvasScale,s=i.handleElementId,d=i.isScaling,f=(0,c.iH)(),v=_l(),p=v.addHistorySnapshot,h=function(e){t.elementInfo.lock||(e.stopPropagation(),t.selectElement(e,t.elementInfo))},m=(0,c.iH)(!1);(0,u.YP)(s,(function(){s.value!==t.elementInfo.id&&(m.value=!1)})),(0,u.YP)(m,(function(){n.setDisableHotkeysState(m.value)}));var g=function(){t.elementInfo.lock||(m.value=!0)},y=(0,c.iH)(-1);(0,u.YP)(d,(function(){s.value===t.elementInfo.id&&(d.value&&(m.value=!1),d.value||-1===y.value||(l.updateElement({id:t.elementInfo.id,props:{height:y.value}}),y.value=-1))}));var w=function(e){var n=e[0].contentRect;if(f.value){var a=n.height;t.elementInfo.height!==a&&(d.value?y.value=a:l.updateElement({id:t.elementInfo.id,props:{height:a}}))}},x=new ResizeObserver(w);(0,u.bv)((function(){f.value&&x.observe(f.value)})),(0,u.Ah)((function(){f.value&&x.unobserve(f.value)}));var b=function(e){l.updateElement({id:t.elementInfo.id,props:{data:e}}),p()},k=function(e){var n=e.reduce((function(e,t){return e+t})),a=e.map((function(e){return e/n}));l.updateElement({id:t.elementInfo.id,props:{width:n,colWidths:a}}),p()},_=function(e){(0,u.Y3)((function(){return n.setSelectedTableCells(e)}))};return function(e,t){var n=(0,u.Q2)("contextmenu");return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["editable-element-table",{lock:e.elementInfo.lock}]),ref_key:"elementRef",ref:f,style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",Ju,[(0,u.Wm)(Vu,{onMousedown:t[0]||(t[0]=(0,a.iM)((function(){}),["stop"])),data:e.elementInfo.data,width:e.elementInfo.width,cellMinHeight:e.elementInfo.cellMinHeight,colWidths:e.elementInfo.colWidths,outline:e.elementInfo.outline,theme:e.elementInfo.theme,editable:m.value,onChange:t[1]||(t[1]=function(e){return b(e)}),onChangeColWidths:t[2]||(t[2]=function(e){return k(e)}),onChangeSelectedCells:t[3]||(t[3]=function(e){return _(e)})},null,8,["data","width","cellMinHeight","colWidths","outline","theme","editable"]),!m.value||e.elementInfo.lock?((0,u.wg)(),(0,u.iD)("div",{key:0,class:(0,pe.C_)(["table-mask",{lock:e.elementInfo.lock}]),onDblclick:t[4]||(t[4]=function(e){return g()}),onMousedown:t[5]||(t[5]=function(e){return h(e)}),onTouchstart:t[6]||(t[6]=function(e){return h(e)})},[(0,c.SU)(s)===e.elementInfo.id?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"mask-tip",style:(0,pe.j5)({transform:"scale(".concat(1/(0,c.SU)(r),")")})},"双击编辑",4)):(0,u.kq)("",!0)],34)):(0,u.kq)("",!0)])),[[n,e.contextmenus]])],4)],6)}}}),Xu=(0,ll.Z)(qu,[["__scopeId","data-v-742a731e"]]),Gu=Xu;var Ku=["width","height","stroke","stroke-width"],Qu=["transform"],$u=["d"];const ec=(0,u.aZ)({__name:"index",props:{elementInfo:{},selectElement:{type:Function},contextmenus:{type:Function}},setup:function(e){var t=e,n=function(e){t.elementInfo.lock||(e.stopPropagation(),t.selectElement(e,t.elementInfo))},l=function(){Mr.emit(_r.OPEN_LATEX_EDITOR)};return function(e,t){var a=(0,u.Q2)("contextmenu");return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["editable-element-latex",{lock:e.elementInfo.lock}]),style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"element-content",onMousedown:t[0]||(t[0]=function(e){return n(e)}),onTouchstart:t[1]||(t[1]=function(e){return n(e)}),onDblclick:t[2]||(t[2]=function(e){return l()})},[((0,u.wg)(),(0,u.iD)("svg",{overflow:"visible",width:e.elementInfo.width,height:e.elementInfo.height,stroke:e.elementInfo.color,"stroke-width":e.elementInfo.strokeWidth,fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[(0,u._)("g",{transform:"scale(".concat(e.elementInfo.width/e.elementInfo.viewBox[0],", ").concat(e.elementInfo.height/e.elementInfo.viewBox[1],") translate(0,0) matrix(1,0,0,1,0,0)")},[(0,u._)("path",{d:e.elementInfo.path},null,8,$u)],8,Qu)],8,Ku))],32)),[[a,e.contextmenus]])],4)],6)}}}),tc=(0,ll.Z)(ec,[["__scopeId","data-v-35c33b80"]]),nc=tc,lc=function(e,t){(0,u.bv)((function(){if(t.value){var n="normal";if(/m3u8(#|\?|$)/i.exec(e)?n="hls":/.flv(#|\?|$)/i.exec(e)&&(n="flv"),t.value&&"hls"===n&&(t.value.canPlayType("application/x-mpegURL")||t.value.canPlayType("application/vnd.apple.mpegURL"))&&(n="normal"),"hls"===n){var l=window.Hls;if(l&&l.isSupported()){var a=new l;a.loadSource(e),a.attachMedia(t.value)}}else if("flv"===n){var o=window.flvjs;if(o&&o.isSupported()){var i=o.createPlayer({type:"flv",url:e});i.attachMediaElement(t.value),i.load()}}}}))};var ac=function(e){return(0,u.dD)("data-v-e55352ca"),e=e(),(0,u.Cn)(),e},oc={key:0,class:"load-error"},ic=["src","autoplay","poster"],rc={class:"bezel"},uc=ac((function(){return(0,u._)("div",{class:"controller-mask"},null,-1)})),cc={class:"controller"},sc={class:"icons icons-left"},dc={class:"icon-content"},fc={class:"volume"},vc={class:"icon-content"},pc=ac((function(){return(0,u._)("span",{class:"thumb"},null,-1)})),hc=[pc],mc={class:"time"},gc={class:"ptime"},yc={class:"dtime"},wc={class:"icons icons-right"},xc={class:"speed"},bc={class:"icon speed-icon"},kc=["onClick"],_c={class:"icon-content"},Ic={class:"bar"},Sc=ac((function(){return(0,u._)("span",{class:"thumb"},null,-1)})),Cc=[Sc];const Lc=(0,u.aZ)({__name:"index",props:{width:{},height:{},src:{},poster:{default:""},autoplay:{type:Boolean,default:!1},scale:{default:1}},setup:function(e){var t=e,n=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0===e||isNaN(e))return"00:00";var t=function(e){return e<10?"0"+e:""+e},n=Math.floor(e/3600),l=Math.floor((e-3600*n)/60),a=Math.floor(e-3600*n-60*l);return(n>0?[n,l,a]:[l,a]).map(t).join(":")},l=function(e){return e.getBoundingClientRect().left},a=(0,c.iH)(),o=(0,c.iH)(),i=(0,c.iH)(),r=(0,c.iH)(.5),s=(0,c.iH)(!0),d=(0,c.iH)(0),f=(0,c.iH)(0),v=(0,c.iH)(0),p=(0,c.iH)(!1),h=(0,c.iH)(!1),m=(0,c.iH)(1),g=(0,c.iH)(!1),y=(0,c.iH)("00:00"),w=(0,c.iH)("0"),x=(0,u.Fl)((function(){return n(d.value)})),b=(0,u.Fl)((function(){return n(f.value)})),k=(0,u.Fl)((function(){return d.value/f.value*100+"%"})),_=(0,u.Fl)((function(){return v.value/f.value*100+"%"})),I=(0,u.Fl)((function(){return 100*r.value+"%"})),S=(0,c.iH)(!1),C=[{label:"2x",value:2},{label:"1.5x",value:1.5},{label:"1.25x",value:1.25},{label:"1x",value:1},{label:"0.75x",value:.75},{label:"0.5x",value:.5}],L=function(e){a.value&&(e=Math.max(e,0),e=Math.min(e,f.value),a.value.currentTime=e,d.value=e)},E=function(){a.value&&(s.value=!1,a.value.play(),h.value=!0)},Z=function(){a.value&&(s.value=!0,a.value.pause(),h.value=!0)},T=function(){s.value?E():Z()},M=function(e){a.value&&(e=Math.max(e,0),e=Math.min(e,1),a.value.volume=e,r.value=e,a.value.muted&&0!==e&&(a.value.muted=!1))},U=function(e){a.value&&(a.value.playbackRate=e),m.value=e},W=function(){var e;f.value=(null===(e=a.value)||void 0===e?void 0:e.duration)||0},D=function(){var e;d.value=(null===(e=a.value)||void 0===e?void 0:e.currentTime)||0},H=function(){p.value?(L(0),E()):Z()},F=function(){var e;v.value=null!==(e=a.value)&&void 0!==e&&e.buffered.length?a.value.buffered.end(a.value.buffered.length-1):0},A=(0,c.iH)(!1),O=function(){return A.value=!0},P=function(e){if(a.value&&o.value){var t="clientX"in e?e.clientX:e.changedTouches[0].clientX,n=(t-l(o.value))/o.value.clientWidth;n=Math.max(n,0),n=Math.min(n,1);var i=n*f.value;a.value.currentTime=i,d.value=i}},R=function e(t){if(a.value&&o.value){var n="clientX"in t?t.clientX:t.changedTouches[0].clientX,i=(n-l(o.value))/o.value.clientWidth;i=Math.max(i,0),i=Math.min(i,1);var r=i*f.value;a.value.currentTime=r,d.value=r,document.removeEventListener("mousemove",P),document.removeEventListener("touchmove",P),document.removeEventListener("mouseup",e),document.removeEventListener("touchend",e)}},B=function(){document.addEventListener("mousemove",P),document.addEventListener("touchmove",P),document.addEventListener("mouseup",R),document.addEventListener("touchend",R)},z=function(e){if(i.value){var t="clientX"in e?e.clientX:e.changedTouches[0].clientX,n=(t-l(i.value))/45;M(n)}},N=function e(){document.removeEventListener("mousemove",z),document.removeEventListener("touchmove",z),document.removeEventListener("mouseup",e),document.removeEventListener("touchend",e)},j=function(){document.addEventListener("mousemove",z),document.addEventListener("touchmove",z),document.addEventListener("mouseup",N),document.addEventListener("touchend",N)},Y=function(e){if(i.value){var t=(e.clientX-l(i.value))/45;M(t)}},V=function(e){if(f.value&&o.value){var t=o.value.getBoundingClientRect().left,l=e.clientX-t;if(l<0||l>o.value.offsetWidth)return;var a=f.value*(l/o.value.offsetWidth);w.value="".concat(l-(a>=3600?25:20),"px"),y.value=n(a),g.value=!0}},J=function(){a.value&&(a.value.muted?(a.value.muted=!1,M(.5)):(a.value.muted=!0,M(0)))},q=function(){p.value=!p.value},X=(0,c.iH)(-1),G=(0,c.iH)(!1),K=function(){G.value=!1,clearTimeout(X.value),X.value=setTimeout((function(){var e;null!==(e=a.value)&&void 0!==e&&e.played.length&&(G.value=!0)}),3e3)};return lc(t.src,a),function(e,t){var n=(0,u.up)("IconPause"),l=(0,u.up)("IconPlayOne"),c=(0,u.up)("IconVolumeMute"),d=(0,u.up)("IconVolumeNotice"),f=(0,u.up)("IconVolumeSmall");return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["video-player",{"hide-controller":G.value}]),style:(0,pe.j5)({width:e.width*e.scale+"px",height:e.height*e.scale+"px",transform:"scale(".concat(1/e.scale,")")}),onMousemove:t[22]||(t[22]=function(e){return K()}),onClick:t[23]||(t[23]=function(e){return K()})},[(0,u._)("div",{class:"video-wrap",onClick:t[8]||(t[8]=function(e){return T()})},[A.value?((0,u.wg)(),(0,u.iD)("div",oc,"视频加载失败")):(0,u.kq)("",!0),(0,u._)("video",{class:"video",ref_key:"videoRef",ref:a,src:e.src,autoplay:e.autoplay,poster:e.poster,"webkit-playsinline":"",playsinline:"",onDurationchange:t[0]||(t[0]=function(e){return W()}),onTimeupdate:t[1]||(t[1]=function(e){return D()}),onEnded:t[2]||(t[2]=function(e){return H()}),onProgress:t[3]||(t[3]=function(e){return F()}),onPlay:t[4]||(t[4]=function(e){K(),s.value=!1}),onPause:t[5]||(t[5]=function(e){return K()}),onError:t[6]||(t[6]=function(e){return O()})},null,40,ic),(0,u._)("div",rc,[(0,u._)("span",{class:(0,pe.C_)(["bezel-icon",{"bezel-transition":h.value}]),onAnimationend:t[7]||(t[7]=function(e){return h.value=!1})},[s.value?((0,u.wg)(),(0,u.j4)(n,{key:0})):((0,u.wg)(),(0,u.j4)(l,{key:1}))],34)])]),uc,(0,u._)("div",cc,[(0,u._)("div",sc,[(0,u._)("div",{class:"icon play-icon",onClick:t[9]||(t[9]=function(e){return T()})},[(0,u._)("span",dc,[s.value?((0,u.wg)(),(0,u.j4)(l,{key:0})):((0,u.wg)(),(0,u.j4)(n,{key:1}))])]),(0,u._)("div",fc,[(0,u._)("div",{class:"icon volume-icon",onClick:t[10]||(t[10]=function(e){return J()})},[(0,u._)("span",vc,[0===r.value?((0,u.wg)(),(0,u.j4)(c,{key:0})):1===r.value?((0,u.wg)(),(0,u.j4)(d,{key:1})):((0,u.wg)(),(0,u.j4)(f,{key:2}))])]),(0,u._)("div",{class:"volume-bar-wrap",onMousedown:t[11]||(t[11]=function(e){return j()}),onTouchstart:t[12]||(t[12]=function(e){return j()}),onClick:t[13]||(t[13]=function(e){return Y(e)})},[(0,u._)("div",{class:"volume-bar",ref_key:"volumeBarRef",ref:i},[(0,u._)("div",{class:"volume-bar-inner",style:(0,pe.j5)({width:I.value})},hc,4)],512)],32)]),(0,u._)("span",mc,[(0,u._)("span",gc,(0,pe.zw)(x.value),1),(0,u.Uk)(" / "),(0,u._)("span",yc,(0,pe.zw)(b.value),1)])]),(0,u._)("div",wc,[(0,u._)("div",xc,[(0,u._)("div",bc,[(0,u._)("span",{class:"icon-content",onClick:t[14]||(t[14]=function(e){return S.value=!S.value})},(0,pe.zw)(1===m.value?"倍速":m.value+"x"),1),S.value?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"speed-menu",onMouseleave:t[15]||(t[15]=function(e){return S.value=!1})},[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(C,(function(e){return(0,u._)("div",{class:(0,pe.C_)(["speed-menu-item",{active:e.value===m.value}]),key:e.label,onClick:function(t){return U(e.value)}},(0,pe.zw)(e.label),11,kc)})),64))],32)):(0,u.kq)("",!0)])]),(0,u._)("div",{class:"loop",onClick:t[16]||(t[16]=function(e){return q()})},[(0,u._)("div",{class:(0,pe.C_)(["icon loop-icon",{active:p.value}])},[(0,u._)("span",_c,"循环"+(0,pe.zw)(p.value?"开":"关"),1)],2)])]),(0,u._)("div",{class:"bar-wrap",ref_key:"playBarWrap",ref:o,onMousedown:t[17]||(t[17]=function(e){return B()}),onTouchstart:t[18]||(t[18]=function(e){return B()}),onMousemove:t[19]||(t[19]=function(e){return V(e)}),onMouseenter:t[20]||(t[20]=function(e){return g.value=!0}),onMouseleave:t[21]||(t[21]=function(e){return g.value=!1})},[(0,u._)("div",{class:(0,pe.C_)(["bar-time",{hidden:!g.value}]),style:(0,pe.j5)({left:w.value})},(0,pe.zw)(y.value),7),(0,u._)("div",Ic,[(0,u._)("div",{class:"loaded",style:(0,pe.j5)({width:_.value})},null,4),(0,u._)("div",{class:"played",style:(0,pe.j5)({width:k.value})},Cc,4)])],544)])],38)}}}),Ec=(0,ll.Z)(Lc,[["__scopeId","data-v-e55352ca"]]),Zc=Ec,Tc=(0,u.aZ)({__name:"index",props:{elementInfo:{},selectElement:{type:Function},contextmenus:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(X()),l=n.canvasScale,a=function(e){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t.elementInfo.lock||(e.stopPropagation(),t.selectElement(e,t.elementInfo,n))};return function(e,t){var n=(0,u.Q2)("contextmenu");return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["editable-element-video",{lock:e.elementInfo.lock}]),style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"element-content",onMousedown:t[2]||(t[2]=function(e){return a(e,!1)}),onTouchstart:t[3]||(t[3]=function(e){return a(e,!1)})},[(0,u.Wm)(Zc,{width:e.elementInfo.width,height:e.elementInfo.height,src:e.elementInfo.src,poster:e.elementInfo.poster,scale:(0,c.SU)(l)},null,8,["width","height","src","poster","scale"]),((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(["t","b","l","r"],(function(e){return(0,u._)("div",{class:(0,pe.C_)(["handler-border",e]),key:e,onMousedown:t[0]||(t[0]=function(e){return a(e)}),onTouchstart:t[1]||(t[1]=function(e){return a(e)})},null,34)})),64))],32)),[[n,e.contextmenus]])],4)],6)}}}),Mc=(0,ll.Z)(Tc,[["__scopeId","data-v-5dc89f2a"]]),Uc=Mc;var Wc=function(e){return(0,u.dD)("data-v-44037f56"),e=e(),(0,u.Cn)(),e},Dc=["src","autoplay"],Hc={class:"controller"},Fc={class:"icons"},Ac={class:"icon-content"},Oc={class:"volume"},Pc={class:"icon-content"},Rc=Wc((function(){return(0,u._)("span",{class:"thumb"},null,-1)})),Bc=[Rc],zc={class:"time"},Nc={class:"ptime"},jc={class:"dtime"},Yc={class:"bar"},Vc=Wc((function(){return(0,u._)("span",{class:"thumb"},null,-1)})),Jc=[Vc];const qc=(0,u.aZ)({__name:"AudioPlayer",props:{src:{},loop:{type:Boolean},autoplay:{type:Boolean,default:!1},scale:{default:1}},setup:function(e,t){var n=t.expose,l=e,a=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(0===e||isNaN(e))return"00:00";var t=function(e){return e<10?"0"+e:""+e},n=Math.floor(e/3600),l=Math.floor((e-3600*n)/60),a=Math.floor(e-3600*n-60*l);return(n>0?[n,l,a]:[l,a]).map(t).join(":")},o=function(e){return e.getBoundingClientRect().left},i=(0,c.iH)(),r=(0,c.iH)(),s=(0,c.iH)(),d=(0,c.iH)(.5),f=(0,c.iH)(!0),v=(0,c.iH)(0),p=(0,c.iH)(0),h=(0,c.iH)(0),m=(0,c.iH)(!1),g=(0,c.iH)("00:00"),y=(0,c.iH)("0"),w=(0,u.Fl)((function(){return a(v.value)})),x=(0,u.Fl)((function(){return a(p.value)})),b=(0,u.Fl)((function(){return v.value/p.value*100+"%"})),k=(0,u.Fl)((function(){return h.value/p.value*100+"%"})),_=(0,u.Fl)((function(){return 100*d.value+"%"})),I=function(e){i.value&&(e=Math.max(e,0),e=Math.min(e,p.value),i.value.currentTime=e,v.value=e)},S=function(){i.value&&(f.value=!1,i.value.play())},C=function(){i.value&&(f.value=!0,i.value.pause())},L=function(){f.value?S():C()},E=function(e){i.value&&(e=Math.max(e,0),e=Math.min(e,1),i.value.volume=e,d.value=e,i.value.muted&&0!==e&&(i.value.muted=!1))},Z=function(){var e;p.value=(null===(e=i.value)||void 0===e?void 0:e.duration)||0},T=function(){var e;v.value=(null===(e=i.value)||void 0===e?void 0:e.currentTime)||0},M=function(){f.value=!1},U=function(){l.loop?(I(0),S()):C()},W=function(){var e;h.value=null!==(e=i.value)&&void 0!==e&&e.buffered.length?i.value.buffered.end(i.value.buffered.length-1):0},D=function(){return dl.error("视频加载失败")},H=function(e){if(i.value&&r.value){var t="clientX"in e?e.clientX:e.changedTouches[0].clientX,n=(t-o(r.value))/r.value.clientWidth;n=Math.max(n,0),n=Math.min(n,1);var l=n*p.value;i.value.currentTime=l,v.value=l}},F=function e(t){if(i.value&&r.value){var n="clientX"in t?t.clientX:t.changedTouches[0].clientX,l=(n-o(r.value))/r.value.clientWidth;l=Math.max(l,0),l=Math.min(l,1);var a=l*p.value;i.value.currentTime=a,v.value=a,document.removeEventListener("mousemove",H),document.removeEventListener("touchmove",H),document.removeEventListener("mouseup",e),document.removeEventListener("touchend",e)}},A=function(){document.addEventListener("mousemove",H),document.addEventListener("touchmove",H),document.addEventListener("mouseup",F),document.addEventListener("touchend",F)},O=function(e){if(s.value){var t="clientX"in e?e.clientX:e.changedTouches[0].clientX,n=(t-o(s.value))/45;E(n)}},P=function e(){document.removeEventListener("mousemove",O),document.removeEventListener("touchmove",O),document.removeEventListener("mouseup",e),document.removeEventListener("touchend",e)},R=function(){document.addEventListener("mousemove",O),document.addEventListener("touchmove",O),document.addEventListener("mouseup",P),document.addEventListener("touchend",P)},B=function(e){if(s.value){var t=(e.clientX-o(s.value))/45;E(t)}},z=function(e){if(p.value&&r.value){var t=r.value.getBoundingClientRect().left,n=e.clientX-t;if(n<0||n>r.value.offsetWidth)return;var l=p.value*(n/r.value.offsetWidth);y.value="".concat(n-(l>=3600?25:20),"px"),g.value=a(l),m.value=!0}},N=function(){i.value&&(i.value.muted?(i.value.muted=!1,E(.5)):(i.value.muted=!0,E(0)))};return n({toggle:L}),function(e,t){var n=(0,u.up)("IconPlayOne"),l=(0,u.up)("IconPause"),a=(0,u.up)("IconVolumeMute"),o=(0,u.up)("IconVolumeNotice"),c=(0,u.up)("IconVolumeSmall");return(0,u.wg)(),(0,u.iD)("div",{class:"audio-player",style:(0,pe.j5)({transform:"scale(".concat(1/e.scale,")")})},[(0,u._)("audio",{class:"audio",ref_key:"audioRef",ref:i,src:e.src,autoplay:e.autoplay,onDurationchange:t[0]||(t[0]=function(e){return Z()}),onTimeupdate:t[1]||(t[1]=function(e){return T()}),onPlay:t[2]||(t[2]=function(e){return M()}),onEnded:t[3]||(t[3]=function(e){return U()}),onProgress:t[4]||(t[4]=function(e){return W()}),onError:t[5]||(t[5]=function(e){return D()})},null,40,Dc),(0,u._)("div",Hc,[(0,u._)("div",Fc,[(0,u._)("div",{class:"icon play-icon",onClick:t[6]||(t[6]=function(e){return L()})},[(0,u._)("span",Ac,[f.value?((0,u.wg)(),(0,u.j4)(n,{key:0})):((0,u.wg)(),(0,u.j4)(l,{key:1}))])]),(0,u._)("div",Oc,[(0,u._)("div",{class:"icon volume-icon",onClick:t[7]||(t[7]=function(e){return N()})},[(0,u._)("span",Pc,[0===d.value?((0,u.wg)(),(0,u.j4)(a,{key:0})):1===d.value?((0,u.wg)(),(0,u.j4)(o,{key:1})):((0,u.wg)(),(0,u.j4)(c,{key:2}))])]),(0,u._)("div",{class:"volume-bar-wrap",onMousedown:t[8]||(t[8]=function(e){return R()}),onTouchstart:t[9]||(t[9]=function(e){return R()}),onClick:t[10]||(t[10]=function(e){return B(e)})},[(0,u._)("div",{class:"volume-bar",ref_key:"volumeBarRef",ref:s},[(0,u._)("div",{class:"volume-bar-inner",style:(0,pe.j5)({width:_.value})},Bc,4)],512)],32)])]),(0,u._)("span",zc,[(0,u._)("span",Nc,(0,pe.zw)(w.value),1),(0,u.Uk)(" / "),(0,u._)("span",jc,(0,pe.zw)(x.value),1)]),(0,u._)("div",{class:"bar-wrap",ref_key:"playBarWrap",ref:r,onMousedown:t[11]||(t[11]=function(e){return A()}),onTouchstart:t[12]||(t[12]=function(e){return A()}),onMousemove:t[13]||(t[13]=function(e){return z(e)}),onMouseenter:t[14]||(t[14]=function(e){return m.value=!0}),onMouseleave:t[15]||(t[15]=function(e){return m.value=!1})},[(0,u._)("div",{class:(0,pe.C_)(["bar-time",{hidden:!m.value}]),style:(0,pe.j5)({left:y.value})},(0,pe.zw)(g.value),7),(0,u._)("div",Yc,[(0,u._)("div",{class:"loaded",style:(0,pe.j5)({width:k.value})},null,4),(0,u._)("div",{class:"played",style:(0,pe.j5)({width:b.value})},Jc,4)])],544)])],4)}}}),Xc=(0,ll.Z)(qc,[["__scopeId","data-v-44037f56"]]),Gc=Xc,Kc=(0,u.aZ)({__name:"index",props:{elementInfo:{},selectElement:{type:Function},contextmenus:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(X()),l=n.canvasScale,i=n.handleElementId,r=(0,o.Jk)(V()),s=r.viewportRatio,d=(0,u.Fl)((function(){return Math.min(t.elementInfo.width,t.elementInfo.height)+"px"})),f=(0,u.Fl)((function(){var e=wl,n=wl*s.value,a=280/l.value,o=50/l.value,i=t.elementInfo.width,r=t.elementInfo.height,u=t.elementInfo.left,c=t.elementInfo.top,d=0,f=r;return u+a>=e&&(d=i-a),c+r+o>=n&&(f=-o),{left:d+"px",top:f+"px"}})),v=function(e){t.elementInfo.lock||(e.stopPropagation(),t.selectElement(e,t.elementInfo))};return function(e,t){var n=(0,u.up)("IconVolumeNotice"),o=(0,u.Q2)("contextmenu");return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["editable-element-audio",{lock:e.elementInfo.lock}]),style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"element-content",onMousedown:t[1]||(t[1]=function(e){return v(e)}),onTouchstart:t[2]||(t[2]=function(e){return v(e)})},[(0,u.Wm)(n,{class:"audio-icon",style:(0,pe.j5)({fontSize:d.value,color:e.elementInfo.color})},null,8,["style"]),(0,c.SU)(i)===e.elementInfo.id?((0,u.wg)(),(0,u.j4)(Gc,{key:0,class:"audio-player",style:(0,pe.j5)((0,g.Z)({},f.value)),src:e.elementInfo.src,loop:e.elementInfo.loop,scale:(0,c.SU)(l),onMousedown:t[0]||(t[0]=(0,a.iM)((function(){}),["stop"]))},null,8,["style","src","loop","scale"])):(0,u.kq)("",!0)],32)),[[o,e.contextmenus]])],4)],6)}}}),Qc=(0,ll.Z)(Kc,[["__scopeId","data-v-53bdc956"]]),$c=Qc;var es=["id"];const ts=(0,u.aZ)({__name:"EditableElement",props:{elementInfo:{},elementIndex:{},isMultiSelect:{type:Boolean},selectElement:{type:Function},openLinkDialog:{type:Function}},setup:function(e){var t=e,n=(0,u.Fl)((function(){var e=(0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)({},vl.IMAGE,Ei),vl.TEXT,Xr),vl.SHAPE,fu),vl.LINE,_u),vl.CHART,Tu),vl.TABLE,Gu),vl.LATEX,nc),vl.VIDEO,Uc),vl.AUDIO,$c);return e[t.elementInfo.type]||null})),l=Dl(),a=l.orderElement,o=Po(),i=o.alignElementToCanvas,r=Tl(),c=r.combineElements,s=r.uncombineElements,v=Zl(),p=v.deleteElement,h=El(),m=h.lockElement,g=h.unlockElement,y=Ml(),w=y.copyElement,x=y.pasteElement,b=y.cutElement,k=Ul(),_=k.selectAllElement,I=function(){return t.elementInfo.lock?[{text:"unlock",handler:function(){return g(t.elementInfo)}}]:[{text:"Cut",subText:"Ctrl + X",handler:b},{text:"Copy",subText:"Ctrl + C",handler:w},{text:"Paste",subText:"Ctrl + V",handler:x},{divider:!0},{text:"Horizontal center",handler:function(){return i(f.HORIZONTAL)},children:[{text:"Horizontal and vertical centering",handler:function(){return i(f.CENTER)}},{text:"Horizontally centered",handler:function(){return i(f.HORIZONTAL)}},{text:"Left-aligned",handler:function(){return i(f.LEFT)}},{text:"right-aligned",handler:function(){return i(f.RIGHT)}}]},{text:"vertically centered",handler:function(){return i(f.VERTICAL)},children:[{text:"Horizontal and vertical centering",handler:function(){return i(f.CENTER)}},{text:"Vertically centered",handler:function(){return i(f.VERTICAL)}},{text:"Align top",handler:function(){return i(f.TOP)}},{text:"Align bottom",handler:function(){return i(f.BOTTOM)}}]},{divider:!0},{text:"Send to top",disable:t.isMultiSelect&&!t.elementInfo.groupId,handler:function(){return a(t.elementInfo,d.TOP)},children:[{text:"Put on top",handler:function(){return a(t.elementInfo,d.TOP)}},{text:"Move one level up",handler:function(){return a(t.elementInfo,d.UP)}}]},{text:"Put to bottom",disable:t.isMultiSelect&&!t.elementInfo.groupId,handler:function(){return a(t.elementInfo,d.BOTTOM)},children:[{text:"Put to bottom",handler:function(){return a(t.elementInfo,d.BOTTOM)}},{text:"Move one level down",handler:function(){return a(t.elementInfo,d.DOWN)}}]},{divider:!0},{text:"Set link",handler:t.openLinkDialog},{text:t.elementInfo.groupId?"Ungroup":"Group",subText:"Ctrl + G",handler:t.elementInfo.groupId?s:c,hide:!t.isMultiSelect},{text:"Select all",subText:"Ctrl + A",handler:_},{text:"Lock",subText:"Ctrl + L",handler:m},{text:"delete",subText:"Delete",handler:p}]};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"editable-element",ref:"elementRef",id:"editable-element-".concat(e.elementInfo.id),style:(0,pe.j5)({zIndex:e.elementIndex})},[((0,u.wg)(),(0,u.j4)((0,u.LL)(n.value),{elementInfo:e.elementInfo,selectElement:e.selectElement,contextmenus:I},null,8,["elementInfo","selectElement"]))],12,es)}}}),ns=ts,ls=ns,as=(0,u.aZ)({__name:"MouseSelection",props:{top:{},left:{},width:{},height:{},quadrant:{}},setup:function(e){return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)("mouse-selection quadrant-".concat(e.quadrant)),style:(0,pe.j5)({top:e.top+"px",left:e.left+"px",width:e.width+"px",height:e.height+"px"})},null,6)}}}),os=(0,ll.Z)(as,[["__scopeId","data-v-2c5e1d42"]]),is=os;var rs={class:"grid-lines"},us=["d","stroke"];const cs=(0,u.aZ)({__name:"GridLines",setup:function(e){var t=(0,o.Jk)(X()),n=t.canvasScale,l=t.gridLineSize,a=(0,o.Jk)(V()),i=a.currentSlide,r=a.viewportRatio,s=(0,u.Fl)((function(){var e;return null===(e=i.value)||void 0===e?void 0:e.background})),d=(0,u.Fl)((function(){var e,t=(null===(e=s.value)||void 0===e?void 0:e.color)||"#fff",n=["#000","#fff"];return B.Z.mostReadable(t,n,{includeFallbackColors:!0}).setAlpha(.5).toRgbString()})),f=(0,u.Fl)((function(){for(var e=wl,t=wl*r.value,n="",a=0;a<=Math.floor(t/l.value);a++)n+="M0 ".concat(a*l.value," L").concat(e," ").concat(a*l.value," ");for(var o=0;o<=Math.floor(e/l.value);o++)n+="M".concat(o*l.value," 0 L").concat(o*l.value," ").concat(t," ");return n}));return function(e,t){return(0,u.wg)(),(0,u.iD)("svg",rs,[(0,u._)("path",{style:(0,pe.j5)({transform:"scale(".concat((0,c.SU)(n),")")}),d:f.value,fill:"none",stroke:d.value,"stroke-width":"0.3","stroke-dasharray":"5"},null,12,us)])}}}),ss=(0,ll.Z)(cs,[["__scopeId","data-v-05484a24"]]),ds=ss,fs=function(e){var t=(0,u.Fl)((function(){if(!e.value)return{backgroundColor:"#fff"};var t=e.value,n=t.type,l=t.color,a=t.image,o=t.imageSize,i=t.gradientColor,r=t.gradientRotate,u=t.gradientType;if("solid"===n)return{backgroundColor:l};if("image"===n)return a?"repeat"===o?{backgroundImage:"url(".concat(a),backgroundRepeat:"repeat",backgroundSize:"contain"}:{backgroundImage:"url(".concat(a),backgroundRepeat:"no-repeat",backgroundSize:o||"cover"}:{backgroundColor:"#fff"};if("gradient"===n){var c=r||0,s=i?i[0]:"#fff",d=i?i[1]:"#fff";return"radial"===u?{backgroundImage:"radial-gradient(".concat(s,", ").concat(d)}:{backgroundImage:"linear-gradient(".concat(c,"deg, ").concat(s,", ").concat(d)}}return{backgroundColor:"#fff"}}));return{backgroundStyle:t}},vs=(0,u.aZ)({__name:"ViewportBackground",setup:function(e){var t=(0,o.Jk)(X()),n=t.gridLineSize,l=(0,o.Jk)(V()),a=l.currentSlide,i=(0,u.Fl)((function(){var e;return null===(e=a.value)||void 0===e?void 0:e.background})),r=fs(i),s=r.backgroundStyle;return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"viewport-background",style:(0,pe.j5)((0,c.SU)(s))},[(0,c.SU)(n)?((0,u.wg)(),(0,u.j4)(ds,{key:0})):(0,u.kq)("",!0)],4)}}}),ps=(0,ll.Z)(vs,[["__scopeId","data-v-b6b18502"]]),hs=ps,ms=(0,u.aZ)({__name:"AlignmentLine",props:{type:{},axis:{},length:{},canvasScale:{}},setup:function(e){var t=e,n=(0,u.Fl)((function(){return t.axis.x*t.canvasScale+"px"})),l=(0,u.Fl)((function(){return t.axis.y*t.canvasScale+"px"})),a=(0,u.Fl)((function(){return"vertical"===t.type?{height:t.length*t.canvasScale+"px"}:{width:t.length*t.canvasScale+"px"}}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"alignment-line",style:(0,pe.j5)({left:n.value,top:l.value})},[(0,u._)("div",{class:(0,pe.C_)(["line",e.type]),style:(0,pe.j5)(a.value)},null,6)],4)}}}),gs=(0,ll.Z)(ms,[["__scopeId","data-v-ed6fc00a"]]),ys=gs;var ws={class:"ruler"};const xs=(0,u.aZ)({__name:"Ruler",props:{viewportStyles:{}},setup:function(e){var t=e,n=(0,o.Jk)(X()),l=n.canvasScale,a=(0,u.Fl)((function(){return t.viewportStyles.width*l.value/10}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",ws,[(0,u._)("div",{class:"h",style:(0,pe.j5)({width:e.viewportStyles.width*(0,c.SU)(l)+"px",left:e.viewportStyles.left+"px"})},[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(20,(function(e){return(0,u._)("div",{class:(0,pe.C_)(["ruler-marker-100",{hide:a.value<36,omit:a.value<72}]),key:"marker-100-".concat(e)},[(0,u._)("span",null,(0,pe.zw)(e),1)],2)})),64))],4),(0,u._)("div",{class:"v",style:(0,pe.j5)({height:e.viewportStyles.height*(0,c.SU)(l)+"px",top:e.viewportStyles.top+"px"})},[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(20,(function(e){return(0,u._)("div",{class:(0,pe.C_)(["ruler-marker-100",{hide:a.value<36,omit:a.value<72}]),key:e,style:(0,pe.j5)({height:a.value+"px"})},[(0,u._)("span",null,(0,pe.zw)(e),1)],6)})),64))],4)])}}}),bs=(0,ll.Z)(xs,[["__scopeId","data-v-2963c74c"]]),ks=bs;var _s=["width","height"],Is=["d"];const Ss=(0,u.aZ)({__name:"ElementCreateSelection",emits:["created"],setup:function(e,t){var n=t.emit,l=n,i=X(),r=(0,o.Jk)(i),s=r.creatingElement,d=(0,o.Jk)(se()),f=d.ctrlOrShiftKeyActive,v=(0,c.iH)(),p=(0,c.iH)(),h=(0,c.iH)(),m=(0,c.iH)({x:0,y:0});(0,u.bv)((function(){if(h.value){var e=h.value.getBoundingClientRect(),t=e.x,n=e.y;m.value={x:t,y:n}}}));var g=function(e){var t=!0,n=e.pageX,a=e.pageY;v.value=[n,a],document.onmousemove=function(e){if(s.value&&t){var l=e.pageX,o=e.pageY;if(f.value){var i=l-n,r=o-a,u=Math.abs(i),c=Math.abs(r);if("shape"===s.value.type){var d=r>0&&i<0||r<0&&i>0;u>c?o=d?a-i:a+i:l=d?n-r:n+r}else"line"===s.value.type&&(u>c?o=a:l=n)}p.value=[l,o]}},document.onmouseup=function(e){var o,r;if(document.onmousemove=null,document.onmouseup=null,2!==e.button){t=!1;var u=e.pageX,c=e.pageY,d=30;if("line"===(null===(o=s.value)||void 0===o?void 0:o.type)&&(Math.abs(u-n)>=d||Math.abs(c-a)>=d))l("created",{start:v.value,end:p.value});else if("line"!==(null===(r=s.value)||void 0===r?void 0:r.type)&&Math.abs(u-n)>=d&&Math.abs(c-a)>=d)l("created",{start:v.value,end:p.value});else{var f=200,h=Math.min(u,n),m=Math.min(c,a),g=Math.max(u,n),y=Math.max(c,a),w=g-h>=d?g-h:f,x=y-m>=d?y-m:f;l("created",{start:[h,m],end:[h+w,m+x]})}}else setTimeout((function(){return i.setCreatingElement(null)}),0)}},y=(0,u.Fl)((function(){if(!v.value||!p.value)return null;if(!s.value||"line"!==s.value.type)return null;var e=(0,ne.Z)(v.value,2),t=e[0],n=e[1],l=(0,ne.Z)(p.value,2),a=l[0],o=l[1],i=Math.min(t,a),r=Math.max(t,a),u=Math.min(n,o),c=Math.max(n,o),d=r-i>=24?r-i:24,f=c-u>=24?c-u:24,h=t===i?0:r-i,m=n===u?0:c-u,g=a===i?0:r-i,y=o===u?0:c-u,w="M".concat(h,", ").concat(m," L").concat(g,", ").concat(y);return{svgWidth:d,svgHeight:f,startX:h,startY:m,endX:g,endY:y,path:w}})),w=(0,u.Fl)((function(){if(!v.value||!p.value)return{};var e=(0,ne.Z)(v.value,2),t=e[0],n=e[1],l=(0,ne.Z)(p.value,2),a=l[0],o=l[1],i=Math.min(t,a),r=Math.max(t,a),u=Math.min(n,o),c=Math.max(n,o),s=r-i,d=c-u;return{left:i-m.value.x+"px",top:u-m.value.y+"px",width:s+"px",height:d+"px"}}));return function(e,t){var n,l;return(0,u.wg)(),(0,u.iD)("div",{class:"element-create-selection",ref_key:"selectionRef",ref:h,onMousedown:t[0]||(t[0]=(0,a.iM)((function(e){return g(e)}),["stop"])),onContextmenu:t[1]||(t[1]=(0,a.iM)((function(){}),["stop","prevent"]))},[v.value&&p.value?((0,u.wg)(),(0,u.iD)("div",{key:0,class:(0,pe.C_)(["selection",null===(n=(0,c.SU)(s))||void 0===n?void 0:n.type]),style:(0,pe.j5)(w.value)},["line"===(null===(l=(0,c.SU)(s))||void 0===l?void 0:l.type)&&y.value?((0,u.wg)(),(0,u.iD)("svg",{key:0,overflow:"visible",width:y.value.svgWidth,height:y.value.svgHeight},[(0,u._)("path",{d:y.value.path,stroke:"#d14424",fill:"none","stroke-width":"2"},null,8,Is)],8,_s)):(0,u.kq)("",!0)],6)):(0,u.kq)("",!0)],544)}}}),Cs=(0,ll.Z)(Ss,[["__scopeId","data-v-85b0bbaa"]]),Ls=Cs;var Es={overflow:"visible"},Zs=["d","fill"];const Ts=(0,u.aZ)({__name:"ShapeCreateCanvas",emits:["created"],setup:function(e,t){var n=t.emit,l=n,i=X(),r=(0,o.Jk)(se()),s=r.ctrlOrShiftKeyActive,d=(0,c.iH)(),f=(0,c.iH)({x:0,y:0});(0,u.bv)((function(){if(d.value){var e=d.value.getBoundingClientRect(),t=e.x,n=e.y;f.value={x:t,y:n}}}));var v=(0,c.iH)(),p=(0,c.iH)([]),h=(0,c.iH)(!1),g=function(e){var t=e.pageX-f.value.x,n=e.pageY-f.value.y;if(s.value&&p.value.length){var l=(0,ne.Z)(p.value[p.value.length-1],2),a=l[0],o=l[1];Math.abs(a-t)-Math.abs(o-n)>0?n=o:t=a}return{pageX:t,pageY:n}},y=function(e){var t=g(e),n=t.pageX,l=t.pageY;if(v.value=[n,l],p.value.length>=2){var a=(0,ne.Z)(p.value[0],2),o=a[0],i=a[1];Math.abs(o-n)<5&&Math.abs(i-l)<5?h.value=!0:h.value=!1}else h.value=!1},w=(0,u.Fl)((function(){for(var e="",t=0;t<p.value.length;t++){var n=p.value[t];e+=0===t?"M ".concat(n[0]," ").concat(n[1]," "):"L ".concat(n[0]," ").concat(n[1]," ")}return p.value.length&&v.value&&(e+="L ".concat(v.value[0]," ").concat(v.value[1])),e})),x=function(e){var t=g(e),n=t.pageX,a=t.pageY;if(h.value){for(var o=p.value.map((function(e){return e[0]})),i=p.value.map((function(e){return e[1]})),r=Math.min.apply(Math,(0,R.Z)(o)),u=Math.min.apply(Math,(0,R.Z)(i)),c=Math.max.apply(Math,(0,R.Z)(o)),s=Math.max.apply(Math,(0,R.Z)(i)),d=p.value.map((function(e){return[e[0]-r,e[1]-u]})),v="",m=0;m<d.length;m++){var y=d[m];v+=0===m?"M ".concat(y[0]," ").concat(y[1]," "):"L ".concat(y[0]," ").concat(y[1]," ")}v+="Z",l("created",{start:[r+f.value.x,u+f.value.y],end:[c+f.value.x,s+f.value.y],path:v,viewBox:[c-r,s-u]})}else p.value.push([n,a])},b=function(){i.setCreatingCustomShapeState(!1)},k=function(e){var t=e.key.toUpperCase();t===m.ESC&&b()};return(0,u.bv)((function(){dl.success("Click to start drawing any polygon, close the beginning and end to complete the drawing, press the ESC key or the right mouse button to close"),document.addEventListener("keydown",k)})),(0,u.Ah)((function(){return document.removeEventListener("keydown",k)})),function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"shape-create-canvas",ref_key:"shapeCanvasRef",ref:d,onMousedown:t[0]||(t[0]=(0,a.iM)((function(e){return x(e)}),["stop"])),onMousemove:t[1]||(t[1]=function(e){return y(e)}),onContextmenu:t[2]||(t[2]=(0,a.iM)((function(e){return b()}),["stop","prevent"]))},[((0,u.wg)(),(0,u.iD)("svg",Es,[(0,u._)("path",{d:w.value,stroke:"#d14424",fill:h.value?"rgba(226, 83, 77, 0.15)":"none","stroke-width":"2"},null,8,Zs)]))],544)}}}),Ms=(0,ll.Z)(Ts,[["__scopeId","data-v-2b1ccf28"]]),Us=Ms,Ws=function(e,t){var n=(0,u.Fl)((function(){return[{direction:p.LEFT_TOP,style:{}},{direction:p.TOP,style:{left:e.value/2+"px"}},{direction:p.RIGHT_TOP,style:{left:e.value+"px"}},{direction:p.LEFT,style:{top:t.value/2+"px"}},{direction:p.RIGHT,style:{left:e.value+"px",top:t.value/2+"px"}},{direction:p.LEFT_BOTTOM,style:{top:t.value+"px"}},{direction:p.BOTTOM,style:{left:e.value/2+"px",top:t.value+"px"}},{direction:p.RIGHT_BOTTOM,style:{left:e.value+"px",top:t.value+"px"}}]})),l=(0,u.Fl)((function(){return[{direction:p.LEFT,style:{top:t.value/2+"px"}},{direction:p.RIGHT,style:{left:e.value+"px",top:t.value/2+"px"}}]})),a=(0,u.Fl)((function(){return[{direction:p.TOP,style:{left:e.value/2+"px"}},{direction:p.BOTTOM,style:{left:e.value/2+"px",top:t.value+"px"}}]})),o=(0,u.Fl)((function(){return[{type:v.T,style:{width:e.value+"px"}},{type:v.B,style:{top:t.value+"px",width:e.value+"px"}},{type:v.L,style:{height:t.value+"px"}},{type:v.R,style:{left:e.value+"px",height:t.value+"px"}}]}));return{resizeHandlers:n,textElementResizeHandlers:l,verticalTextElementResizeHandlers:a,borderLines:o}},Ds=(0,u.aZ)({__name:"ResizeHandler",props:{type:{},rotate:{default:0}},setup:function(e){var t=e,n=(0,u.Fl)((function(){var e="rotate-",n=t.rotate;return n>-22.5&&n<=22.5?e+0:n>22.5&&n<=67.5?e+45:n>67.5&&n<=112.5?e+90:n>112.5&&n<=157.5?e+135:n>157.5||n<=-157.5?e+0:n>-157.5&&n<=-112.5?e+45:n>-112.5&&n<=-67.5?e+90:n>-67.5&&n<=-22.5?e+135:e+0}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["resize-handler",n.value,e.type])},null,2)}}}),Hs=(0,ll.Z)(Ds,[["__scopeId","data-v-1e66197f"]]),Fs=Hs,As=(0,u.aZ)({__name:"BorderLine",props:{type:{},isWide:{type:Boolean,default:!1}},setup:function(e){return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["border-line",e.type,{wide:e.isWide}])},null,2)}}}),Os=(0,ll.Z)(As,[["__scopeId","data-v-8346cf6c"]]),Ps=Os,Rs=(0,u.aZ)({__name:"MultiSelectOperate",props:{elementList:{},scaleMultiElement:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(X()),l=n.activeElementIdList,i=n.canvasScale,r=(0,u.Fl)((function(){return t.elementList.filter((function(e){return l.value.includes(e.id)}))})),s=(0,c.iH)({minX:0,maxX:0,minY:0,maxY:0}),d=(0,u.Fl)((function(){return(s.value.maxX-s.value.minX)*i.value})),f=(0,u.Fl)((function(){return(s.value.maxY-s.value.minY)*i.value})),v=Ws(d,f),p=v.resizeHandlers,h=v.borderLines,m=function(){var e=Te(r.value),t=e.minX,n=e.maxX,l=e.minY,a=e.maxY;s.value={minX:t,maxX:n,minY:l,maxY:a}};(0,u.m0)(m);var g=(0,u.Fl)((function(){return r.value.some((function(e){return!!("image"!==e.type&&"shape"!==e.type||e.rotate)}))}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"multi-select-operate",style:(0,pe.j5)({left:s.value.minX*(0,c.SU)(i)+"px",top:s.value.minY*(0,c.SU)(i)+"px"})},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(h),(function(e){return(0,u.wg)(),(0,u.j4)(Ps,{key:e.type,type:e.type,style:(0,pe.j5)(e.style)},null,8,["type","style"])})),128)),g.value?(0,u.kq)("",!0):((0,u.wg)(!0),(0,u.iD)(u.HY,{key:0},(0,u.Ko)((0,c.SU)(p),(function(t){return(0,u.wg)(),(0,u.j4)(Fs,{key:t.direction,type:t.direction,style:(0,pe.j5)(t.style),onMousedown:(0,a.iM)((function(n){return e.scaleMultiElement(n,s.value,t.direction)}),["stop"])},null,8,["type","style","onMousedown"])})),128))],4)}}}),Bs=(0,ll.Z)(Rs,[["__scopeId","data-v-97dc9b9a"]]),zs=Bs;var Ns={class:"rotate-handler"};function js(e,t){return(0,u.wg)(),(0,u.iD)("div",Ns)}const Ys={},Vs=(0,ll.Z)(Ys,[["render",js],["__scopeId","data-v-b99d8dae"]]),Js=Vs;var qs={inheritAttrs:!1};const Xs=(0,u.aZ)((0,g.Z)((0,g.Z)({},qs),{},{__name:"ImageElementOperate",props:{elementInfo:{},handlerVisible:{type:Boolean},rotateElement:{type:Function},scaleElement:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(X()),l=n.canvasScale,i=n.clipingImageElementId,r=(0,u.Fl)((function(){return i.value===t.elementInfo.id})),s=(0,u.Fl)((function(){return t.elementInfo.width*l.value})),d=(0,u.Fl)((function(){return t.elementInfo.height*l.value})),f=Ws(s,d),v=f.resizeHandlers,p=f.borderLines;return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["image-element-operate",{cliping:r.value}])},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(p),(function(e){return(0,u.wg)(),(0,u.j4)(Ps,{class:"operate-border-line",key:e.type,type:e.type,style:(0,pe.j5)(e.style)},null,8,["type","style"])})),128)),e.handlerVisible?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(v),(function(t){return(0,u.wg)(),(0,u.j4)(Fs,{class:"operate-resize-handler",key:t.direction,type:t.direction,rotate:e.elementInfo.rotate,style:(0,pe.j5)(t.style),onMousedown:(0,a.iM)((function(n){return e.scaleElement(n,e.elementInfo,t.direction)}),["stop"])},null,8,["type","rotate","style","onMousedown"])})),128)),(0,u.Wm)(Js,{class:"operate-rotate-handler",style:(0,pe.j5)({left:s.value/2+"px"}),onMousedown:t[0]||(t[0]=(0,a.iM)((function(t){return e.rotateElement(t,e.elementInfo)}),["stop"]))},null,8,["style"])],64)):(0,u.kq)("",!0)],2)}}})),Gs=(0,ll.Z)(Xs,[["__scopeId","data-v-7bcad5a9"]]),Ks=Gs;var Qs={class:"text-element-operate"},$s={inheritAttrs:!1};const ed=(0,u.aZ)((0,g.Z)((0,g.Z)({},$s),{},{__name:"TextElementOperate",props:{elementInfo:{},handlerVisible:{type:Boolean},rotateElement:{type:Function},scaleElement:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(X()),l=n.canvasScale,i=(0,u.Fl)((function(){return t.elementInfo.width*l.value})),r=(0,u.Fl)((function(){return t.elementInfo.height*l.value})),s=Ws(i,r),d=s.textElementResizeHandlers,f=s.verticalTextElementResizeHandlers,v=s.borderLines,p=(0,u.Fl)((function(){return t.elementInfo.vertical?f.value:d.value}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Qs,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(v),(function(e){return(0,u.wg)(),(0,u.j4)(Ps,{class:"operate-border-line",key:e.type,type:e.type,style:(0,pe.j5)(e.style)},null,8,["type","style"])})),128)),e.handlerVisible?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(p.value,(function(t){return(0,u.wg)(),(0,u.j4)(Fs,{class:"operate-resize-handler",key:t.direction,type:t.direction,rotate:e.elementInfo.rotate,style:(0,pe.j5)(t.style),onMousedown:(0,a.iM)((function(n){return e.scaleElement(n,e.elementInfo,t.direction)}),["stop"])},null,8,["type","rotate","style","onMousedown"])})),128)),(0,u.Wm)(Js,{class:"operate-rotate-handler",style:(0,pe.j5)({left:i.value/2+"px"}),onMousedown:t[0]||(t[0]=(0,a.iM)((function(t){return e.rotateElement(t,e.elementInfo)}),["stop"]))},null,8,["style"])],64)):(0,u.kq)("",!0)])}}})),td=ed,nd=td;var ld={class:"shape-element-operate"},ad={inheritAttrs:!1};const od=(0,u.aZ)((0,g.Z)((0,g.Z)({},ad),{},{__name:"ShapeElementOperate",props:{elementInfo:{},handlerVisible:{type:Boolean},rotateElement:{type:Function},scaleElement:{type:Function},moveShapeKeypoint:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(X()),l=n.canvasScale,i=(0,u.Fl)((function(){return t.elementInfo.width*l.value})),r=(0,u.Fl)((function(){return t.elementInfo.height*l.value})),s=Ws(i,r),d=s.resizeHandlers,f=s.borderLines,v=(0,u.Fl)((function(){if(!t.elementInfo.pathFormula||void 0===t.elementInfo.keypoint)return{};var e=xl[t.elementInfo.pathFormula];if("editable"in e){var n=e.getBaseSize(t.elementInfo.width,t.elementInfo.height)*t.elementInfo.keypoint;if("left"===e.relative)return{left:n*l.value+"px"};if("right"===e.relative)return{left:(t.elementInfo.width-n)*l.value+"px"};if("center"===e.relative)return{left:(t.elementInfo.width-n)/2*l.value+"px"};if("top"===e.relative)return{top:n*l.value+"px"};if("bottom"===e.relative)return{top:(t.elementInfo.height-n)*l.value+"px"}}return{}}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",ld,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(f),(function(e){return(0,u.wg)(),(0,u.j4)(Ps,{class:"operate-border-line",key:e.type,type:e.type,style:(0,pe.j5)(e.style)},null,8,["type","style"])})),128)),e.handlerVisible?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(d),(function(t){return(0,u.wg)(),(0,u.j4)(Fs,{class:"operate-resize-handler",key:t.direction,type:t.direction,rotate:e.elementInfo.rotate,style:(0,pe.j5)(t.style),onMousedown:(0,a.iM)((function(n){return e.scaleElement(n,e.elementInfo,t.direction)}),["stop"])},null,8,["type","rotate","style","onMousedown"])})),128)),(0,u.Wm)(Js,{class:"operate-rotate-handler",style:(0,pe.j5)({left:i.value/2+"px"}),onMousedown:t[0]||(t[0]=(0,a.iM)((function(t){return e.rotateElement(t,e.elementInfo)}),["stop"]))},null,8,["style"]),void 0!==e.elementInfo.keypoint?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"operate-keypoint-handler",style:(0,pe.j5)(v.value),onMousedown:t[1]||(t[1]=(0,a.iM)((function(t){return e.moveShapeKeypoint(t,e.elementInfo)}),["stop"]))},null,36)):(0,u.kq)("",!0)],64)):(0,u.kq)("",!0)])}}})),id=(0,ll.Z)(od,[["__scopeId","data-v-52dcdbf8"]]),rd=id;var ud={class:"line-element-operate"},cd=["width","height","stroke"],sd={key:0},dd=["x1","y1","x2","y2"],fd=["x1","y1","x2","y2"],vd=["x1","y1","x2","y2"],pd=["x1","y1","x2","y2"],hd={inheritAttrs:!1};const md=(0,u.aZ)((0,g.Z)((0,g.Z)({},hd),{},{__name:"LineElementOperate",props:{elementInfo:{},handlerVisible:{type:Boolean},dragLineElement:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(X()),l=n.canvasScale,i=(0,u.Fl)((function(){return Math.max(t.elementInfo.start[0],t.elementInfo.end[0])})),r=(0,u.Fl)((function(){return Math.max(t.elementInfo.start[1],t.elementInfo.end[1])})),s=(0,u.Fl)((function(){var e=[{handler:h.START,style:{left:t.elementInfo.start[0]*l.value+"px",top:t.elementInfo.start[1]*l.value+"px"}},{handler:h.END,style:{left:t.elementInfo.end[0]*l.value+"px",top:t.elementInfo.end[1]*l.value+"px"}}];if(t.elementInfo.curve||t.elementInfo.broken){var n=t.elementInfo.curve||t.elementInfo.broken;e.push({handler:h.C,style:{left:n[0]*l.value+"px",top:n[1]*l.value+"px"}})}else if(t.elementInfo.cubic){var a=(0,ne.Z)(t.elementInfo.cubic,2),o=a[0],i=a[1];e.push({handler:h.C1,style:{left:o[0]*l.value+"px",top:o[1]*l.value+"px"}}),e.push({handler:h.C2,style:{left:i[0]*l.value+"px",top:i[1]*l.value+"px"}})}return e}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",ud,[e.handlerVisible?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(s.value,(function(t){return(0,u.wg)(),(0,u.j4)(Fs,{class:"operate-resize-handler",key:t.handler,style:(0,pe.j5)(t.style),onMousedown:(0,a.iM)((function(n){return e.dragLineElement(n,e.elementInfo,t.handler)}),["stop"])},null,8,["style","onMousedown"])})),128)),((0,u.wg)(),(0,u.iD)("svg",{width:i.value||1,height:r.value||1,stroke:e.elementInfo.color,overflow:"visible",style:(0,pe.j5)({transform:"scale(".concat((0,c.SU)(l),")")})},[e.elementInfo.curve?((0,u.wg)(),(0,u.iD)("g",sd,[(0,u._)("line",{class:"anchor-line",x1:e.elementInfo.start[0],y1:e.elementInfo.start[1],x2:e.elementInfo.curve[0],y2:e.elementInfo.curve[1]},null,8,dd),(0,u._)("line",{class:"anchor-line",x1:e.elementInfo.end[0],y1:e.elementInfo.end[1],x2:e.elementInfo.curve[0],y2:e.elementInfo.curve[1]},null,8,fd)])):(0,u.kq)("",!0),e.elementInfo.cubic?((0,u.wg)(!0),(0,u.iD)(u.HY,{key:1},(0,u.Ko)(e.elementInfo.cubic,(function(t,n){return(0,u.wg)(),(0,u.iD)("g",{key:n},[0===n?((0,u.wg)(),(0,u.iD)("line",{key:0,class:"anchor-line",x1:e.elementInfo.start[0],y1:e.elementInfo.start[1],x2:t[0],y2:t[1]},null,8,vd)):(0,u.kq)("",!0),1===n?((0,u.wg)(),(0,u.iD)("line",{key:1,class:"anchor-line",x1:e.elementInfo.end[0],y1:e.elementInfo.end[1],x2:t[0],y2:t[1]},null,8,pd)):(0,u.kq)("",!0)])})),128)):(0,u.kq)("",!0)],12,cd))],64)):(0,u.kq)("",!0)])}}})),gd=(0,ll.Z)(md,[["__scopeId","data-v-3aa5cc44"]]),yd=gd;var wd={class:"table-element-operate"},xd={inheritAttrs:!1};const bd=(0,u.aZ)((0,g.Z)((0,g.Z)({},xd),{},{__name:"TableElementOperate",props:{elementInfo:{},handlerVisible:{type:Boolean},rotateElement:{type:Function},scaleElement:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(X()),l=n.canvasScale,i=(0,u.Fl)((function(){return t.elementInfo.outline.width||1})),r=(0,u.Fl)((function(){return(t.elementInfo.width+i.value)*l.value})),s=(0,u.Fl)((function(){return t.elementInfo.height*l.value})),d=Ws(r,s),f=d.resizeHandlers,v=d.borderLines;return function(e,t){return(0,u.wg)(),(0,u.iD)("div",wd,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(v),(function(e){return(0,u.wg)(),(0,u.j4)(Ps,{class:"operate-border-line",key:e.type,type:e.type,style:(0,pe.j5)(e.style)},null,8,["type","style"])})),128)),e.handlerVisible?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(f),(function(t){return(0,u.wg)(),(0,u.j4)(Fs,{class:"operate-resize-handler",key:t.direction,type:t.direction,rotate:e.elementInfo.rotate,style:(0,pe.j5)(t.style),onMousedown:(0,a.iM)((function(n){return e.scaleElement(n,e.elementInfo,t.direction)}),["stop"])},null,8,["type","rotate","style","onMousedown"])})),128)),(0,u.Wm)(Js,{class:"operate-rotate-handler",style:(0,pe.j5)({left:r.value/2+"px"}),onMousedown:t[0]||(t[0]=(0,a.iM)((function(t){return e.rotateElement(t,e.elementInfo)}),["stop"]))},null,8,["style"])],64)):(0,u.kq)("",!0)])}}})),kd=bd,_d=kd;var Id={class:"common-element-operate"},Sd={inheritAttrs:!1};const Cd=(0,u.aZ)((0,g.Z)((0,g.Z)({},Sd),{},{__name:"CommonElementOperate",props:{elementInfo:{},handlerVisible:{type:Boolean},rotateElement:{type:Function},scaleElement:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(X()),l=n.canvasScale,i=(0,u.Fl)((function(){return t.elementInfo.width*l.value})),r=(0,u.Fl)((function(){return t.elementInfo.height*l.value})),s=Ws(i,r),d=s.resizeHandlers,f=s.borderLines,v=(0,u.Fl)((function(){return["chart","video","audio"].includes(t.elementInfo.type)}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Id,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(f),(function(e){return(0,u.wg)(),(0,u.j4)(Ps,{class:"operate-border-line",key:e.type,type:e.type,style:(0,pe.j5)(e.style)},null,8,["type","style"])})),128)),e.handlerVisible?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(d),(function(t){return(0,u.wg)(),(0,u.j4)(Fs,{class:"operate-resize-handler",key:t.direction,type:t.direction,rotate:e.elementInfo.rotate,style:(0,pe.j5)(t.style),onMousedown:(0,a.iM)((function(n){return e.scaleElement(n,e.elementInfo,t.direction)}),["stop"])},null,8,["type","rotate","style","onMousedown"])})),128)),v.value?(0,u.kq)("",!0):((0,u.wg)(),(0,u.j4)(Js,{key:0,class:"operate-rotate-handler",style:(0,pe.j5)({left:i.value/2+"px"}),onMousedown:t[0]||(t[0]=(0,a.iM)((function(t){return e.rotateElement(t,e.elementInfo)}),["stop"]))},null,8,["style"]))],64)):(0,u.kq)("",!0)])}}})),Ld=Cd,Ed=Ld,Zd=function(){var e=V(),t=_l(),n=t.addHistorySnapshot,l=function(t,l){var a=/^(https?):\/\/[\w\-]+(\.[\w\-]+)+([\w\-.,@?^=%&:\/~+#]*[\w\-@?^=%&\/~+#])?$/;if("web"===l.type&&!a.test(l.target))return dl.error("不是正确的网页链接地址"),!1;if("slide"===l.type&&!l.target)return dl.error("请先选择链接目标"),!1;var o={link:l};return e.updateElement({id:t.id,props:o}),n(),!0},a=function(t){e.removeElementProps({id:t.id,propName:"link"}),n()};return{setLink:l,removeLink:a}},Td=(0,u.aZ)({__name:"Divider",props:{type:{default:"horizontal"},margin:{default:0}},setup:function(e){return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["divider",e.type]),style:(0,pe.j5)({margin:"horizontal"===e.type?"".concat(e.margin||24,"px 0"):"0 ".concat(e.margin||8,"px")})},null,6)}}}),Md=(0,ll.Z)(Td,[["__scopeId","data-v-6b66cde8"]]),Ud=Md;var Wd=["href"],Dd={class:"btns"};const Hd=(0,u.aZ)({__name:"LinkHandler",props:{elementInfo:{},link:{},openLinkDialog:{type:Function}},setup:function(e){var t=e,n=X(),l=V(),a=(0,o.Jk)(n),i=a.canvasScale,r=(0,o.Jk)(l),s=r.slides,d=Zd(),f=d.removeLink,v=(0,u.Fl)((function(){return"line"===t.elementInfo.type?0:t.elementInfo.height})),p=function(e){var t=s.value.findIndex((function(t){return t.id===e}));-1!==t&&(n.setActiveElementIdList([]),l.updateSlideIndex(t))};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"link-handler",style:(0,pe.j5)({top:v.value*(0,c.SU)(i)+10+"px"})},["web"===e.link.type?((0,u.wg)(),(0,u.iD)("a",{key:0,class:"link",href:e.link.target,target:"_blank"},(0,pe.zw)(e.link.target),9,Wd)):((0,u.wg)(),(0,u.iD)("a",{key:1,class:"link",onClick:t[0]||(t[0]=function(t){return p(e.link.target)})},"幻灯片页面 "+(0,pe.zw)(e.link.target),1)),(0,u._)("div",Dd,[(0,u._)("div",{class:"btn",onClick:t[1]||(t[1]=function(t){return e.openLinkDialog()})},"更换"),(0,u.Wm)(Ud,{type:"vertical"}),(0,u._)("div",{class:"btn",onClick:t[2]||(t[2]=function(t){return(0,c.SU)(f)(e.elementInfo)})},"移除")])],4)}}}),Fd=(0,ll.Z)(Hd,[["__scopeId","data-v-316c4664"]]),Ad=Fd;var Od={key:1,class:"animation-index"};const Pd=(0,u.aZ)({__name:"index",props:{elementInfo:{},isSelected:{type:Boolean},isActive:{type:Boolean},isActiveGroupElement:{type:Boolean},isMultiSelect:{type:Boolean},rotateElement:{type:Function},scaleElement:{type:Function},dragLineElement:{type:Function},moveShapeKeypoint:{type:Function},openLinkDialog:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(X()),l=n.canvasScale,i=n.toolbarState,r=(0,o.Jk)(V()),s=r.formatedAnimations,d=(0,u.Fl)((function(){var e=(0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)({},vl.IMAGE,Ks),vl.TEXT,nd),vl.SHAPE,rd),vl.LINE,yd),vl.TABLE,_d),vl.CHART,Ed),vl.LATEX,Ed),vl.VIDEO,Ed),vl.AUDIO,Ed);return e[t.elementInfo.type]||null})),f=(0,u.Fl)((function(){for(var e=[],n=0;n<s.value.length;n++){var l=s.value[n].animations.map((function(e){return e.elId}));l.includes(t.elementInfo.id)&&e.push(n)}return e})),v=(0,u.Fl)((function(){return"rotate"in t.elementInfo?t.elementInfo.rotate:0})),p=(0,u.Fl)((function(){return"height"in t.elementInfo?t.elementInfo.height:0}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["operate",{"multi-select":e.isMultiSelect&&!e.isActive}]),style:(0,pe.j5)({top:e.elementInfo.top*(0,c.SU)(l)+"px",left:e.elementInfo.left*(0,c.SU)(l)+"px",transform:"rotate(".concat(v.value,"deg)"),transformOrigin:"".concat(e.elementInfo.width*(0,c.SU)(l)/2,"px ").concat(p.value*(0,c.SU)(l)/2,"px")})},[e.isSelected?((0,u.wg)(),(0,u.j4)((0,u.LL)(d.value),{key:0,elementInfo:e.elementInfo,handlerVisible:!e.elementInfo.lock&&(e.isActiveGroupElement||!e.isMultiSelect),rotateElement:e.rotateElement,scaleElement:e.scaleElement,dragLineElement:e.dragLineElement,moveShapeKeypoint:e.moveShapeKeypoint},null,8,["elementInfo","handlerVisible","rotateElement","scaleElement","dragLineElement","moveShapeKeypoint"])):(0,u.kq)("",!0),"elAnimation"===(0,c.SU)(i)&&f.value.length?((0,u.wg)(),(0,u.iD)("div",Od,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(f.value,(function(e){return(0,u.wg)(),(0,u.iD)("div",{class:"index-item",key:e},(0,pe.zw)(e+1),1)})),128))])):(0,u.kq)("",!0),e.isActive&&e.elementInfo.link?((0,u.wg)(),(0,u.j4)(Ad,{key:2,elementInfo:e.elementInfo,link:e.elementInfo.link,openLinkDialog:e.openLinkDialog,onMousedown:t[0]||(t[0]=(0,a.iM)((function(){}),["stop"]))},null,8,["elementInfo","link","openLinkDialog"])):(0,u.kq)("",!0)],6)}}}),Rd=(0,ll.Z)(Pd,[["__scopeId","data-v-5ec1ff35"]]),Bd=Rd;var zd=["src"];const Nd=(0,u.aZ)({__name:"BaseImageElement",props:{elementInfo:{}},setup:function(e){var t=e,n=(0,u.Fl)((function(){return t.elementInfo.shadow})),l=Ro(n),a=l.shadowStyle,o=(0,u.Fl)((function(){return t.elementInfo.flipH})),i=(0,u.Fl)((function(){return t.elementInfo.flipV})),r=Bo(o,i),s=r.flipStyle,d=(0,u.Fl)((function(){return t.elementInfo.clip})),f=Yo(d),v=f.clipShape,p=f.imgPosition,h=(0,u.Fl)((function(){return t.elementInfo.filters})),m=Vo(h),g=m.filter;return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"base-element-image",style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u._)("div",{class:"element-content",style:(0,pe.j5)({filter:(0,c.SU)(a)?"drop-shadow(".concat((0,c.SU)(a),")"):"",transform:(0,c.SU)(s)})},[(0,u.Wm)(fi,{elementInfo:e.elementInfo},null,8,["elementInfo"]),(0,u._)("div",{class:"image-content",style:(0,pe.j5)({clipPath:(0,c.SU)(v).style})},[(0,u._)("img",{src:e.elementInfo.src,draggable:!1,style:(0,pe.j5)({top:(0,c.SU)(p).top,left:(0,c.SU)(p).left,width:(0,c.SU)(p).width,height:(0,c.SU)(p).height,filter:(0,c.SU)(g)}),alt:""},null,12,zd),e.elementInfo.colorMask?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"color-mask",style:(0,pe.j5)({backgroundColor:e.elementInfo.colorMask})},null,4)):(0,u.kq)("",!0)],4)],4)],4)],4)}}}),jd=(0,ll.Z)(Nd,[["__scopeId","data-v-24fef706"]]),Yd=jd;var Vd=["innerHTML"];const Jd=(0,u.aZ)({__name:"BaseTextElement",props:{elementInfo:{}},setup:function(e){var t=e,n=(0,u.Fl)((function(){return t.elementInfo.shadow})),l=Ro(n),a=l.shadowStyle;return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"base-element-text",style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u._)("div",{class:"element-content",style:(0,pe.j5)({width:e.elementInfo.vertical?"auto":e.elementInfo.width+"px",height:e.elementInfo.vertical?e.elementInfo.height+"px":"auto",backgroundColor:e.elementInfo.fill,opacity:e.elementInfo.opacity,textShadow:(0,c.SU)(a),lineHeight:e.elementInfo.lineHeight,letterSpacing:(e.elementInfo.wordSpace||0)+"px",color:e.elementInfo.defaultColor,fontFamily:e.elementInfo.defaultFontName,writingMode:e.elementInfo.vertical?"vertical-rl":"horizontal-tb"})},[(0,u.Wm)(Wi,{width:e.elementInfo.width,height:e.elementInfo.height,outline:e.elementInfo.outline},null,8,["width","height","outline"]),(0,u._)("div",{class:"text ProseMirror-static",style:(0,pe.j5)({"--paragraphSpace":"".concat(void 0===e.elementInfo.paragraphSpace?5:e.elementInfo.paragraphSpace,"px")}),innerHTML:e.elementInfo.content},null,12,Vd)],4)],4)],4)}}}),qd=(0,ll.Z)(Jd,[["__scopeId","data-v-52a206f2"]]),Xd=qd;var Gd=["width","height"],Kd={key:0},Qd=["transform"],$d=["d","fill","stroke","stroke-width","stroke-dasharray"],ef=["innerHTML"];const tf=(0,u.aZ)({__name:"BaseShapeElement",props:{elementInfo:{}},setup:function(e){var t=e,n=(0,u.Fl)((function(){return t.elementInfo.outline})),l=Jo(n),a=l.outlineWidth,o=l.outlineColor,i=l.strokeDashArray,r=(0,u.Fl)((function(){return t.elementInfo.shadow})),s=Ro(r),d=s.shadowStyle,f=(0,u.Fl)((function(){return t.elementInfo.flipH})),v=(0,u.Fl)((function(){return t.elementInfo.flipV})),p=Bo(f,v),h=p.flipStyle,m=(0,u.Fl)((function(){var e={content:"",defaultFontName:"微软雅黑",defaultColor:"#000",align:"middle"};return t.elementInfo.text?t.elementInfo.text:e}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"base-element-shape",style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u._)("div",{class:"element-content",style:(0,pe.j5)({opacity:e.elementInfo.opacity,filter:(0,c.SU)(d)?"drop-shadow(".concat((0,c.SU)(d),")"):"",transform:(0,c.SU)(h),color:m.value.defaultColor,fontFamily:m.value.defaultFontName})},[((0,u.wg)(),(0,u.iD)("svg",{overflow:"visible",width:e.elementInfo.width,height:e.elementInfo.height},[e.elementInfo.gradient?((0,u.wg)(),(0,u.iD)("defs",Kd,[(0,u.Wm)(au,{id:"base-gradient-".concat(e.elementInfo.id),type:e.elementInfo.gradient.type,color1:e.elementInfo.gradient.color[0],color2:e.elementInfo.gradient.color[1],rotate:e.elementInfo.gradient.rotate},null,8,["id","type","color1","color2","rotate"])])):(0,u.kq)("",!0),(0,u._)("g",{transform:"scale(".concat(e.elementInfo.width/e.elementInfo.viewBox[0],", ").concat(e.elementInfo.height/e.elementInfo.viewBox[1],") translate(0,0) matrix(1,0,0,1,0,0)")},[(0,u._)("path",{"vector-effect":"non-scaling-stroke","stroke-linecap":"butt","stroke-miterlimit":"8",d:e.elementInfo.path,fill:e.elementInfo.gradient?"url(#base-gradient-".concat(e.elementInfo.id,")"):e.elementInfo.fill,stroke:(0,c.SU)(o),"stroke-width":(0,c.SU)(a),"stroke-dasharray":(0,c.SU)(i)},null,8,$d)],8,Qd)],8,Gd)),(0,u._)("div",{class:(0,pe.C_)(["shape-text",m.value.align])},[(0,u._)("div",{class:"ProseMirror-static",innerHTML:m.value.content},null,8,ef)],2)],4)],4)],4)}}}),nf=(0,ll.Z)(tf,[["__scopeId","data-v-b13f8fa8"]]),lf=nf;var af=["width","height"],of=["d","stroke","stroke-width","stroke-dasharray","marker-start","marker-end"];const rf=(0,u.aZ)({__name:"BaseLineElement",props:{elementInfo:{}},setup:function(e){var t=e,n=(0,u.Fl)((function(){return t.elementInfo.shadow})),l=Ro(n),a=l.shadowStyle,o=(0,u.Fl)((function(){var e=Math.abs(t.elementInfo.start[0]-t.elementInfo.end[0]);return e<24?24:e})),i=(0,u.Fl)((function(){var e=Math.abs(t.elementInfo.start[1]-t.elementInfo.end[1]);return e<24?24:e})),r=(0,u.Fl)((function(){if("dashed"!==t.elementInfo.style)return"0 0";var e=t.elementInfo.width;return e<=8?"".concat(5*e," ").concat(2.5*e):"".concat(5*e," ").concat(1.5*e)})),s=(0,u.Fl)((function(){return He(t.elementInfo)}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"base-element-line",style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px"})},[(0,u._)("div",{class:"element-content",style:(0,pe.j5)({filter:(0,c.SU)(a)?"drop-shadow(".concat((0,c.SU)(a),")"):""})},[((0,u.wg)(),(0,u.iD)("svg",{overflow:"visible",width:o.value,height:i.value},[(0,u._)("defs",null,[e.elementInfo.points[0]?((0,u.wg)(),(0,u.j4)(gu,{key:0,id:e.elementInfo.id,position:"start",type:e.elementInfo.points[0],color:e.elementInfo.color,baseSize:e.elementInfo.width},null,8,["id","type","color","baseSize"])):(0,u.kq)("",!0),e.elementInfo.points[1]?((0,u.wg)(),(0,u.j4)(gu,{key:1,id:e.elementInfo.id,position:"end",type:e.elementInfo.points[1],color:e.elementInfo.color,baseSize:e.elementInfo.width},null,8,["id","type","color","baseSize"])):(0,u.kq)("",!0)]),(0,u._)("path",{d:s.value,stroke:e.elementInfo.color,"stroke-width":e.elementInfo.width,"stroke-dasharray":r.value,fill:"none","marker-start":e.elementInfo.points[0]?"url(#".concat(e.elementInfo.id,"-").concat(e.elementInfo.points[0],"-start)"):"","marker-end":e.elementInfo.points[1]?"url(#".concat(e.elementInfo.id,"-").concat(e.elementInfo.points[1],"-end)"):""},null,8,of)],8,af))],4)],4)}}}),uf=(0,ll.Z)(rf,[["__scopeId","data-v-443e2f82"]]),cf=uf,sf=(0,u.aZ)({__name:"BaseChartElement",props:{elementInfo:{}},setup:function(e){var t=(0,u.f3)(xo)||(0,c.iH)(1),n=(0,u.Fl)((function(){return t.value<1})),l=(0,u.Fl)((function(){return n.value?1/t.value:1}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"base-element-chart",style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u._)("div",{class:"element-content",style:(0,pe.j5)({backgroundColor:e.elementInfo.fill})},[(0,u.Wm)(Wi,{width:e.elementInfo.width,height:e.elementInfo.height,outline:e.elementInfo.outline},null,8,["width","height","outline"]),(0,u.Wm)(Lu,{width:e.elementInfo.width*l.value,height:e.elementInfo.height*l.value,type:e.elementInfo.chartType,data:e.elementInfo.data,options:e.elementInfo.options,themeColor:e.elementInfo.themeColor,gridColor:e.elementInfo.gridColor,legends:e.elementInfo.data.legends,legend:e.elementInfo.legend||"",style:(0,pe.j5)({zoom:1/l.value})},null,8,["width","height","type","data","options","themeColor","gridColor","legends","legend","style"])],4)],4)],4)}}}),df=(0,ll.Z)(sf,[["__scopeId","data-v-7c03d68d"]]),ff=df;var vf=["width"],pf=["rowspan","colspan"],hf=["innerHTML"];const mf=(0,u.aZ)({__name:"StaticTable",props:{data:{},width:{},cellMinHeight:{},colWidths:{},outline:{},theme:{},editable:{type:Boolean,default:!0}},setup:function(e){var t=e,n=(0,c.iH)([]),l=(0,u.Fl)((function(){return n.value.reduce((function(e,t){return e+t}))}));(0,u.YP)([function(){return t.colWidths},function(){return t.width}],(function(){n.value=t.colWidths.map((function(e){return e*t.width}))}),{immediate:!0});var o=(0,u.Fl)((function(){return t.data})),i=Wu(o),r=i.hideCells,s=(0,u.Fl)((function(){return t.theme})),d=Du(s),f=d.subThemeColor;return function(e,t){var o,i,d,v,p;return(0,u.wg)(),(0,u.iD)("div",{class:"static-table",style:(0,pe.j5)({width:l.value+"px"})},[(0,u._)("table",{class:(0,pe.C_)({theme:s.value,"row-header":null===(o=s.value)||void 0===o?void 0:o.rowHeader,"row-footer":null===(i=s.value)||void 0===i?void 0:i.rowFooter,"col-header":null===(d=s.value)||void 0===d?void 0:d.colHeader,"col-footer":null===(v=s.value)||void 0===v?void 0:v.colFooter}),style:(0,pe.j5)("--themeColor: ".concat(null===(p=s.value)||void 0===p?void 0:p.color,"; --subThemeColor1: ").concat((0,c.SU)(f)[0],"; --subThemeColor2: ").concat((0,c.SU)(f)[1]))},[(0,u._)("colgroup",null,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(n.value,(function(e,t){return(0,u.wg)(),(0,u.iD)("col",{span:"1",key:t,width:e},null,8,vf)})),128))]),(0,u._)("tbody",null,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.data,(function(t,n){return(0,u.wg)(),(0,u.iD)("tr",{key:n,style:(0,pe.j5)({height:e.cellMinHeight+"px"})},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(t,(function(t,l){return(0,u.wy)(((0,u.wg)(),(0,u.iD)("td",{class:"cell",style:(0,pe.j5)((0,g.Z)({borderStyle:e.outline.style,borderColor:e.outline.color,borderWidth:e.outline.width+"px"},(0,c.SU)(Mu)(t.style))),key:t.id,rowspan:t.rowspan,colspan:t.colspan},[(0,u._)("div",{class:"cell-text",style:(0,pe.j5)({minHeight:e.cellMinHeight-4+"px"}),innerHTML:(0,c.SU)(Uu)(t.text)},null,12,hf)],12,pf)),[[a.F8,!(0,c.SU)(r).includes("".concat(n,"_").concat(l))]])})),128))],4)})),128))])],6)],4)}}}),gf=(0,ll.Z)(mf,[["__scopeId","data-v-5d949d4d"]]),yf=gf;var wf={class:"element-content"};const xf=(0,u.aZ)({__name:"BaseTableElement",props:{elementInfo:{}},setup:function(e){return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"base-element-table",style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u._)("div",wf,[(0,u.Wm)(yf,{data:e.elementInfo.data,width:e.elementInfo.width,cellMinHeight:e.elementInfo.cellMinHeight,colWidths:e.elementInfo.colWidths,outline:e.elementInfo.outline,theme:e.elementInfo.theme},null,8,["data","width","cellMinHeight","colWidths","outline","theme"])])],4)],4)}}}),bf=(0,ll.Z)(xf,[["__scopeId","data-v-3eff7eba"]]),kf=bf;var _f={class:"element-content"},If=["width","height","stroke","stroke-width"],Sf=["transform"],Cf=["d"];const Lf=(0,u.aZ)({__name:"BaseLatexElement",props:{elementInfo:{}},setup:function(e){return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"base-element-latex",style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u._)("div",_f,[((0,u.wg)(),(0,u.iD)("svg",{overflow:"visible",width:e.elementInfo.width,height:e.elementInfo.height,stroke:e.elementInfo.color,"stroke-width":e.elementInfo.strokeWidth,fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[(0,u._)("g",{transform:"scale(".concat(e.elementInfo.width/e.elementInfo.viewBox[0],", ").concat(e.elementInfo.height/e.elementInfo.viewBox[1],") translate(0,0) matrix(1,0,0,1,0,0)")},[(0,u._)("path",{d:e.elementInfo.path},null,8,Cf)],8,Sf)],8,If))])],4)],4)}}}),Ef=(0,ll.Z)(Lf,[["__scopeId","data-v-1587280d"]]),Zf=Ef,Tf=(0,u.aZ)({__name:"BaseVideoElement",props:{elementInfo:{}},setup:function(e){return function(e,t){var n=(0,u.up)("IconPlayOne");return(0,u.wg)(),(0,u.iD)("div",{class:"base-element-video",style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u._)("div",{class:"element-content",style:(0,pe.j5)({backgroundImage:e.elementInfo.poster?"url(".concat(e.elementInfo.poster,")"):""})},[(0,u.Wm)(n,{class:"icon"})],4)],4)],4)}}}),Mf=(0,ll.Z)(Tf,[["__scopeId","data-v-09436dde"]]),Uf=Mf;var Wf={class:"element-content"};const Df=(0,u.aZ)({__name:"BaseAudioElement",props:{elementInfo:{}},setup:function(e){var t=e,n=(0,u.Fl)((function(){return Math.min(t.elementInfo.width,t.elementInfo.height)+"px"}));return function(e,t){var l=(0,u.up)("IconVolumeNotice");return(0,u.wg)(),(0,u.iD)("div",{class:"base-element-audio",style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u._)("div",Wf,[(0,u.Wm)(l,{class:"audio-icon",style:(0,pe.j5)({fontSize:n.value,color:e.elementInfo.color})},null,8,["style"])])],4)],4)}}}),Hf=(0,ll.Z)(Df,[["__scopeId","data-v-5da834d7"]]),Ff=Hf,Af=(0,u.aZ)({__name:"ThumbnailElement",props:{elementInfo:{},elementIndex:{}},setup:function(e){var t=e,n=(0,u.Fl)((function(){var e=(0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)({},vl.IMAGE,Yd),vl.TEXT,Xd),vl.SHAPE,lf),vl.LINE,cf),vl.CHART,ff),vl.TABLE,kf),vl.LATEX,Zf),vl.VIDEO,Uf),vl.AUDIO,Ff);return e[t.elementInfo.type]||null}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["base-element","base-element-".concat(e.elementInfo.id)]),style:(0,pe.j5)({zIndex:e.elementIndex})},[((0,u.wg)(),(0,u.j4)((0,u.LL)(n.value),{elementInfo:e.elementInfo,target:"thumbnail"},null,8,["elementInfo"]))],6)}}}),Of=Af,Pf=Of;var Rf={key:1,class:"placeholder"};const Bf=(0,u.aZ)({__name:"index",props:{slide:{},size:{},visible:{type:Boolean,default:!0}},setup:function(e){var t=e,n=(0,o.Jk)(V()),l=n.viewportRatio,a=(0,u.Fl)((function(){return t.slide.background})),i=fs(a),r=i.backgroundStyle,s=(0,u.Fl)((function(){return t.size/wl}));return(0,u.JJ)(xo,s),function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"thumbnail-slide",style:(0,pe.j5)({width:e.size+"px",height:e.size*(0,c.SU)(l)+"px"})},[e.visible?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"elements",style:(0,pe.j5)({width:(0,c.SU)(wl)+"px",height:(0,c.SU)(wl)*(0,c.SU)(l)+"px",transform:"scale(".concat(s.value,")")})},[(0,u._)("div",{class:"background",style:(0,pe.j5)((0,c.SU)(r))},null,4),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.slide.elements,(function(e,t){return(0,u.wg)(),(0,u.j4)(Pf,{key:e.id,elementInfo:e,elementIndex:t+1},null,8,["elementInfo","elementIndex"])})),128))],4)):((0,u.wg)(),(0,u.iD)("div",Rf,"加载中 ..."))],4)}}}),zf=(0,ll.Z)(Bf,[["__scopeId","data-v-43dcaa52"]]),Nf=zf;var jf=["onClick"];const Yf=(0,u.aZ)({__name:"Tabs",props:{value:{},tabs:{},card:{type:Boolean,default:!1},tabsStyle:{},tabStyle:{},spaceAround:{type:Boolean,default:!1},spaceBetween:{type:Boolean,default:!1}},emits:["update:value"],setup:function(e,t){var n=t.emit,l=n;return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["tabs",{card:e.card,"space-around":e.spaceAround,"space-between":e.spaceBetween}]),style:(0,pe.j5)(e.tabsStyle||{})},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.tabs,(function(t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["tab",{active:t.key===e.value}]),key:t.key,style:(0,pe.j5)((0,g.Z)((0,g.Z)({},e.tabStyle||{}),{},{"--color":t.color})),onClick:function(e){return l("update:value",t.key)}},(0,pe.zw)(t.label),15,jf)})),128))],6)}}}),Vf=(0,ll.Z)(Yf,[["__scopeId","data-v-5e3d7626"]]),Jf=Vf,qf=(0,u.aZ)({__name:"Button",props:{checked:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},type:{default:"default"},size:{default:"normal"},first:{type:Boolean,default:!1},last:{type:Boolean,default:!1}},emits:["click"],setup:function(e,t){var n=t.emit,l=e,a=n,o=function(){l.disabled||a("click")};return function(e,t){return(0,u.wg)(),(0,u.iD)("button",{class:(0,pe.C_)(["button",{disabled:e.disabled,checked:!e.disabled&&e.checked,default:!e.disabled&&"default"===e.type,primary:!e.disabled&&"primary"===e.type,checkbox:!e.disabled&&"checkbox"===e.type,radio:!e.disabled&&"radio"===e.type,small:"small"===e.size,first:e.first,last:e.last}]),onClick:t[0]||(t[0]=function(e){return o()})},[(0,u.WI)(e.$slots,"default")],2)}}}),Xf=(0,ll.Z)(qf,[["__scopeId","data-v-52c90330"]]),Gf=Xf;var Kf={key:0,class:"select-wrap"},Qf={class:"selector"},$f={class:"icon"},ev=["onClick"],tv={class:"selector"},nv={class:"icon"};const lv=(0,u.aZ)({__name:"Select",props:{value:{},options:{},disabled:{type:Boolean,default:!1}},emits:["update:value"],setup:function(e,t){var n=t.emit,l=e,a=(0,u.Fl)((function(){var e;return(null===(e=l.options.find((function(e){return e.value===l.value})))||void 0===e?void 0:e.label)||l.value})),o=n,i=(0,c.iH)(!1),r=(0,c.iH)(),s=(0,c.iH)(0),d=function(){r.value&&(s.value=r.value.clientWidth)},f=new ResizeObserver(d);(0,u.bv)((function(){r.value&&f.observe(r.value)})),(0,u.Ah)((function(){r.value&&f.unobserve(r.value)}));var v=function(e){e.disabled||(o("update:value",e.value),i.value=!1)};return function(e,t){var n=(0,u.up)("IconDown");return e.disabled?((0,u.wg)(),(0,u.iD)("div",Kf,[(0,u._)("div",{class:"select disabled",ref_key:"selectRef",ref:r},[(0,u._)("div",Qf,(0,pe.zw)(e.value),1),(0,u._)("div",$f,[(0,u.WI)(e.$slots,"icon",{},(function(){return[(0,u.Wm)(n,{size:14})]}))])],512)])):((0,u.wg)(),(0,u.j4)(lo,{key:1,class:"select-wrap",trigger:"click",value:i.value,"onUpdate:value":t[0]||(t[0]=function(e){return i.value=e}),placement:"bottom",contentStyle:{padding:0,boxShadow:"0 6px 16px 0 rgba(0, 0, 0, 0.08)"}},{content:(0,u.w5)((function(){return[(0,u._)("div",{class:"options",style:(0,pe.j5)({width:s.value+2+"px"})},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.options,(function(t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["option",{disabled:t.disabled,selected:t.value===e.value}]),key:t.value,onClick:function(e){return v(t)}},(0,pe.zw)(t.label),11,ev)})),128))],4)]})),default:(0,u.w5)((function(){return[(0,u._)("div",{class:"select",ref_key:"selectRef",ref:r},[(0,u._)("div",tv,(0,pe.zw)(a.value),1),(0,u._)("div",nv,[(0,u.WI)(e.$slots,"icon",{},(function(){return[(0,u.Wm)(n,{size:14})]}))])],512)]})),_:3},8,["value","contentStyle"]))}}}),av=(0,ll.Z)(lv,[["__scopeId","data-v-5bf3b141"]]),ov=av;var iv=function(e){return(0,u.dD)("data-v-41523c93"),e=e(),(0,u.Cn)(),e},rv={class:"link-dialog"},uv={key:2,class:"preview"},cv=iv((function(){return(0,u._)("div",null,"Preview:",-1)})),sv={class:"btns"};const dv=(0,u.aZ)({__name:"LinkDialog",emits:["close"],setup:function(e,t){var n,l=t.emit,a=l,i=(0,o.Jk)(X()),r=i.handleElement,s=(0,o.Jk)(V()),d=s.slides,f=s.currentSlide,v=(0,c.iH)("web"),p=(0,c.iH)(""),h=(0,c.iH)(""),m=(0,u.Fl)((function(){return d.value.map((function(e,t){return{label:"幻灯片 ".concat(t+1),value:e.id,disabled:f.value.id===e.id}}))}));h.value=(null===(n=d.value.find((function(e){return e.id!==f.value.id})))||void 0===n?void 0:n.id)||"";var g=(0,u.Fl)((function(){return h.value&&d.value.find((function(e){return e.id===h.value}))||null})),y=[{key:"web",label:"网页链接"},{key:"slide",label:"幻灯片页面"}],w=Zd(),x=w.setLink;(0,u.bv)((function(){var e;null!==(e=r.value)&&void 0!==e&&e.link&&("web"===r.value.link.type?p.value=r.value.link.target:"slide"===r.value.link.type&&(h.value=r.value.link.target),v.value=r.value.link.type)}));var b=function(){var e={type:v.value,target:"web"===v.value?p.value:h.value};if(r.value){var t=x(r.value,e);t?a("close"):p.value=""}};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",rv,[(0,u.Wm)(Jf,{tabs:y,value:v.value,"onUpdate:value":t[0]||(t[0]=function(e){return v.value=e}),tabsStyle:{marginBottom:"20px"}},null,8,["value"]),"web"===v.value?((0,u.wg)(),(0,u.j4)($a,{key:0,class:"input",value:p.value,"onUpdate:value":t[1]||(t[1]=function(e){return p.value=e}),placeholder:"请输入网页链接地址"},null,8,["value"])):(0,u.kq)("",!0),"slide"===v.value?((0,u.wg)(),(0,u.j4)(ov,{key:1,class:"input",value:h.value,"onUpdate:value":t[2]||(t[2]=function(e){return h.value=e}),options:m.value},null,8,["value","options"])):(0,u.kq)("",!0),"slide"===v.value&&g.value?((0,u.wg)(),(0,u.iD)("div",uv,[cv,(0,u.Wm)(Nf,{class:"thumbnail",slide:g.value,size:500},null,8,["slide"])])):(0,u.kq)("",!0),(0,u._)("div",sv,[(0,u.Wm)(Gf,{onClick:t[3]||(t[3]=function(e){return a("close")}),style:{"margin-right":"10px"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("Cancel")]})),_:1}),(0,u.Wm)(Gf,{type:"primary",onClick:t[4]||(t[4]=function(e){return b()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("confirm")]})),_:1})])])}}}),fv=(0,ll.Z)(dv,[["__scopeId","data-v-41523c93"]]),vv=fv,pv=(0,u.aZ)({__name:"Modal",props:{visible:{type:Boolean},width:{default:480},closeButton:{type:Boolean,default:!1},closeOnClickMask:{type:Boolean,default:!0},closeOnEsc:{type:Boolean,default:!0},contentStyle:{}},emits:["update:visible","closed"],setup:function(e,t){var n=t.emit,l=qn.IconClose,o=e,i=(0,c.iH)(),r=n,s=(0,c.iH)(!1),d=(0,u.Fl)((function(){return(0,g.Z)({width:o.width+"px"},o.contentStyle||{})}));(0,u.YP)((function(){return o.visible}),(function(){o.visible&&(0,u.Y3)((function(){return i.value.focus()}))}));var f=function(){r("update:visible",!1),r("closed")},v=function(){o.visible&&o.closeOnEsc&&f()},p=function(){o.closeOnClickMask&&f()};return function(e,t){return(0,u.wg)(),(0,u.j4)(u.lR,{to:"body"},[(0,u.Wm)(a.uT,{name:"modal-fade"},{default:(0,u.w5)((function(){return[(0,u.wy)((0,u._)("div",{class:"modal",ref_key:"modalRef",ref:i,tabindex:"-1",onKeyup:t[4]||(t[4]=(0,a.D2)((function(e){return v()}),["esc"]))},[(0,u._)("div",{class:"mask",onClick:t[0]||(t[0]=function(e){return p()})}),(0,u.Wm)(a.uT,{name:"modal-zoom",onAfterLeave:t[2]||(t[2]=function(e){return s.value=!1}),onBeforeEnter:t[3]||(t[3]=function(e){return s.value=!0})},{default:(0,u.w5)((function(){return[(0,u.wy)((0,u._)("div",{class:"modal-content",style:(0,pe.j5)(d.value)},[e.closeButton?((0,u.wg)(),(0,u.iD)("span",{key:0,class:"close-btn",onClick:t[1]||(t[1]=function(e){return f()})},[(0,u.Wm)((0,c.SU)(l))])):(0,u.kq)("",!0),s.value?(0,u.WI)(e.$slots,"default",{key:1}):(0,u.kq)("",!0)],4),[[a.F8,e.visible]])]})),_:3})],544),[[a.F8,e.visible]])]})),_:3})])}}}),hv=(0,ll.Z)(pv,[["__scopeId","data-v-fea8edcc"]]),mv=hv;var gv={class:"operates"},yv={key:2,class:"drag-mask"};const wv=(0,u.aZ)({__name:"index",setup:function(e){var t=X(),n=(0,o.Jk)(t),l=n.activeElementIdList,i=n.activeGroupElementId,r=n.handleElementId,s=n.hiddenElementIdList,d=n.editorAreaFocus,f=n.gridLineSize,v=n.showRuler,p=n.creatingElement,h=n.creatingCustomShape,g=n.canvasScale,y=n.textFormatPainter,w=(0,o.Jk)(V()),x=w.currentSlide,b=(0,o.Jk)(se()),k=b.ctrlKeyState,_=b.spaceKeyState,I=(0,c.iH)(),S=(0,c.iH)([]),C=(0,c.iH)(!1),L=function(){return C.value=!0};(0,u.YP)(r,(function(){t.setActiveGroupElementId("")}));var E=(0,c.iH)([]),Z=function(){E.value=x.value?JSON.parse(JSON.stringify(x.value.elements)):[]};(0,u.m0)(Z);var T=(0,c.iH)(),M=Io(T),U=M.dragViewport,W=M.viewportStyles;Co(T);var D=So(E,I),H=D.mouseSelection,F=D.mouseSelectionVisible,A=D.mouseSelectionQuadrant,O=D.updateMouseSelection,P=Ho(E,S,g),R=P.dragElement,B=Fo(E),N=B.dragLineElement,j=Do(E,R),Y=j.selectElement,J=Wo(E,S,g),q=J.scaleElement,G=J.scaleMultiElement,K=Eo(E,I,g),Q=K.rotateElement,$=Ao(E,g),ee=$.moveShapeKeypoint,te=Ul(),ne=te.selectAllElement,le=Zl(),ae=le.deleteAllElements,oe=Ml(),ie=oe.pasteElement,re=Ol(),ue=re.enterScreeningFromStart,ce=Ll(),de=ce.updateSlideIndex,fe=Il(),ve=fe.createTextElement,he=fe.createShapeElement;(0,u.bv)((function(){l.value.length&&(0,u.Y3)((function(){return t.setActiveElementIdList([])}))}));var me=function(e){l.value.length&&t.setActiveElementIdList([]),_.value?U(e):O(e),d.value||t.setEditorareaFocus(!0),y.value&&t.setTextFormatPainter(null),_o()},ge=function(e){if(!(l.value.length||p.value||h.value)&&I.value){var t=I.value.getBoundingClientRect(),n=(e.pageX-t.x)/g.value,a=(e.pageY-t.y)/g.value;ve({left:n,top:a,width:200/g.value,height:0})}};(0,u.Ah)((function(){y.value&&t.setTextFormatPainter(null)}));var ye=function(){d.value&&t.setEditorareaFocus(!1)},we=Pl(),xe=we.scaleCanvas,be=(0,z.throttle)(xe,100,{leading:!0,trailing:!1}),ke=(0,z.throttle)(de,300,{leading:!0,trailing:!1}),_e=function(e){e.preventDefault(),k.value?e.deltaY>0?be("-"):e.deltaY<0&&be("+"):e.deltaY>0?ke(m.DOWN):e.deltaY<0&&ke(m.UP)},Ie=function(){t.setRulerState(!v.value)},Se=Oo(I),Ce=Se.insertElementFromCreateSelection,Le=Se.formatCreateSelection,Ee=function(e){var n=e.start,l=e.end,a=e.path,o=e.viewBox,i=Le({start:n,end:l});i&&he(i,{path:a,viewBox:o}),t.setCreatingCustomShapeState(!1)},Ze=function(){return[{text:"Paste",subText:"Ctrl + V",handler:ie},{text:"Select all",subText:"Ctrl + A",handler:ne},{text:"ruler",subText:v.value?"√":"",handler:Ie},{text:"grid lines",handler:function(){return t.setGridLineSize(f.value?0:50)},children:[{text:"None",subText:0===f.value?"√":"",handler:function(){return t.setGridLineSize(0)}},{text:"small",subText:25===f.value?"√":"",handler:function(){return t.setGridLineSize(25)}},{text:"中",subText:50===f.value?"√":"",handler:function(){return t.setGridLineSize(50)}},{text:"big",subText:100===f.value?"√":"",handler:function(){return t.setGridLineSize(100)}}]},{text:"Reset current page",handler:ae},{divider:!0},{text:"Slide show",subText:"F5",handler:ue}]};return(0,u.JJ)(xo,g),function(e,t){var n=(0,u.Q2)("contextmenu"),o=(0,u.Q2)("click-outside");return(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"canvas",ref_key:"canvasRef",ref:T,onWheel:t[4]||(t[4]=function(e){return _e(e)}),onMousedown:t[5]||(t[5]=function(e){return me(e)}),onDblclick:t[6]||(t[6]=function(e){return ge(e)})},[(0,c.SU)(p)?((0,u.wg)(),(0,u.j4)(Ls,{key:0,onCreated:t[0]||(t[0]=function(e){return(0,c.SU)(Ce)(e)})})):(0,u.kq)("",!0),(0,c.SU)(h)?((0,u.wg)(),(0,u.j4)(Us,{key:1,onCreated:t[1]||(t[1]=function(e){return Ee(e)})})):(0,u.kq)("",!0),(0,u._)("div",{class:"viewport-wrapper",style:(0,pe.j5)({width:(0,c.SU)(W).width*(0,c.SU)(g)+"px",height:(0,c.SU)(W).height*(0,c.SU)(g)+"px",left:(0,c.SU)(W).left+"px",top:(0,c.SU)(W).top+"px"})},[(0,u._)("div",gv,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(S.value,(function(e,t){return(0,u.wg)(),(0,u.j4)(ys,{key:t,type:e.type,axis:e.axis,length:e.length,canvasScale:(0,c.SU)(g)},null,8,["type","axis","length","canvasScale"])})),128)),(0,c.SU)(l).length>1?((0,u.wg)(),(0,u.j4)(zs,{key:0,elementList:E.value,scaleMultiElement:(0,c.SU)(G)},null,8,["elementList","scaleMultiElement"])):(0,u.kq)("",!0),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(E.value,(function(e){return(0,u.wy)(((0,u.wg)(),(0,u.j4)(Bd,{key:e.id,elementInfo:e,isSelected:(0,c.SU)(l).includes(e.id),isActive:(0,c.SU)(r)===e.id,isActiveGroupElement:(0,c.SU)(i)===e.id,isMultiSelect:(0,c.SU)(l).length>1,rotateElement:(0,c.SU)(Q),scaleElement:(0,c.SU)(q),openLinkDialog:L,dragLineElement:(0,c.SU)(N),moveShapeKeypoint:(0,c.SU)(ee)},null,8,["elementInfo","isSelected","isActive","isActiveGroupElement","isMultiSelect","rotateElement","scaleElement","dragLineElement","moveShapeKeypoint"])),[[a.F8,!(0,c.SU)(s).includes(e.id)]])})),128)),(0,u.Wm)(hs)]),(0,u._)("div",{class:"viewport",ref_key:"viewportRef",ref:I,style:(0,pe.j5)({transform:"scale(".concat((0,c.SU)(g),")")})},[(0,c.SU)(F)?((0,u.wg)(),(0,u.j4)(is,{key:0,top:(0,c.SU)(H).top,left:(0,c.SU)(H).left,width:(0,c.SU)(H).width,height:(0,c.SU)(H).height,quadrant:(0,c.SU)(A)},null,8,["top","left","width","height","quadrant"])):(0,u.kq)("",!0),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(E.value,(function(e,t){return(0,u.wy)(((0,u.wg)(),(0,u.j4)(ls,{key:e.id,elementInfo:e,elementIndex:t+1,isMultiSelect:(0,c.SU)(l).length>1,selectElement:(0,c.SU)(Y),openLinkDialog:L},null,8,["elementInfo","elementIndex","isMultiSelect","selectElement"])),[[a.F8,!(0,c.SU)(s).includes(e.id)]])})),128))],4)],4),(0,c.SU)(_)?((0,u.wg)(),(0,u.iD)("div",yv)):(0,u.kq)("",!0),(0,c.SU)(v)?((0,u.wg)(),(0,u.j4)(ks,{key:3,viewportStyles:(0,c.SU)(W)},null,8,["viewportStyles"])):(0,u.kq)("",!0),(0,u.Wm)(mv,{visible:C.value,"onUpdate:visible":t[3]||(t[3]=function(e){return C.value=e}),width:540},{default:(0,u.w5)((function(){return[(0,u.Wm)(vv,{onClose:t[2]||(t[2]=function(e){return C.value=!1})})]})),_:1},8,["visible"])],32)),[[n,Ze],[o,ye]])}}}),xv=(0,ll.Z)(wv,[["__scopeId","data-v-7c16d8cc"]]),bv=xv;var kv={class:"shape-item-thumbnail"},_v={class:"shape-content"},Iv={overflow:"visible",width:"18",height:"18"},Sv=["transform"],Cv=["fill","stroke","d"];const Lv=(0,u.aZ)({__name:"ShapeItemThumbnail",props:{shape:{}},setup:function(e){return function(e,t){return(0,u.wg)(),(0,u.iD)("div",kv,[(0,u._)("div",_v,[((0,u.wg)(),(0,u.iD)("svg",Iv,[(0,u._)("g",{transform:"scale(".concat(18/e.shape.viewBox[0],", ").concat(18/e.shape.viewBox[1],") translate(0,0) matrix(1,0,0,1,0,0)")},[(0,u._)("path",{class:(0,pe.C_)(["shape-path",{outlined:e.shape.outlined}]),"vector-effect":"non-scaling-stroke","stroke-linecap":"butt","stroke-miterlimit":"8",fill:e.shape.outlined?"#999":"transparent",stroke:e.shape.outlined?"transparent":"#999","stroke-width":"2",d:e.shape.path},null,10,Cv)],8,Sv)]))])])}}}),Ev=(0,ll.Z)(Lv,[["__scopeId","data-v-8603ad34"]]),Zv=Ev;var Tv={class:"shape-pool"},Mv={class:"category-name"},Uv={class:"shape-list"};const Wv=(0,u.aZ)({__name:"ShapePool",emits:["select"],setup:function(e,t){var n=t.emit,l=n,a=function(e){l("select",e)};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Tv,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(bl),(function(e){return(0,u.wg)(),(0,u.iD)("div",{class:"category",key:e.type},[(0,u._)("div",Mv,(0,pe.zw)(e.type),1),(0,u._)("div",Uv,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.children,(function(e,t){return(0,u.wg)(),(0,u.j4)(Zv,{class:"shape-item",key:t,shape:e,onClick:function(t){return a(e)}},null,8,["shape","onClick"])})),128))])])})),128))])}}}),Dv=(0,ll.Z)(Wv,[["__scopeId","data-v-8b994b42"]]),Hv=Dv;var Fv=[{type:"straight line",children:[{path:"M 0 0 L 20 20",style:"solid",points:["",""]},{path:"M 0 0 L 20 20",style:"dashed",points:["",""]},{path:"M 0 0 L 20 20",style:"solid",points:["","arrow"]},{path:"M 0 0 L 20 20",style:"dashed",points:["","arrow"]},{path:"M 0 0 L 20 20",style:"solid",points:["","dot"]}]},{type:"polyline, curve",children:[{path:"M 0 0 L 0 20 L 20 20",style:"solid",points:["","arrow"],isBroken:!0},{path:"M 0 0 Q 0 20 20 20",style:"solid",points:["","arrow"],isCurve:!0},{path:"M 0 0 C 20 0 0 20 20 20",style:"solid",points:["","arrow"],isCubic:!0}]}],Av={class:"line-pool"},Ov={class:"category-name"},Pv={class:"line-list"},Rv=["onClick"],Bv={overflow:"visible",width:"20",height:"20"},zv=["d","stroke-dasharray","marker-start","marker-end"];const Nv=(0,u.aZ)({__name:"LinePool",emits:["select"],setup:function(e,t){var n=t.emit,l=n,a=function(e){l("select",e)};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Av,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(Fv),(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"category",key:e.type},[(0,u._)("div",Ov,(0,pe.zw)(e.type),1),(0,u._)("div",Pv,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.children,(function(e,n){return(0,u.wg)(),(0,u.iD)("div",{class:"line-item",key:n},[(0,u._)("div",{class:"line-content",onClick:function(t){return a(e)}},[((0,u.wg)(),(0,u.iD)("svg",Bv,[(0,u._)("defs",null,[e.points[0]?((0,u.wg)(),(0,u.j4)(gu,{key:0,class:"line-marker",id:"preset-line-".concat(t,"-").concat(n),position:"start",type:e.points[0],color:"currentColor",baseSize:2},null,8,["id","type"])):(0,u.kq)("",!0),e.points[1]?((0,u.wg)(),(0,u.j4)(gu,{key:1,class:"line-marker",id:"preset-line-".concat(t,"-").concat(n),position:"end",type:e.points[1],color:"currentColor",baseSize:2},null,8,["id","type"])):(0,u.kq)("",!0)]),(0,u._)("path",{class:"line-path",d:e.path,stroke:"currentColor",fill:"none","stroke-width":"2","stroke-dasharray":"solid"===e.style?"0, 0":"4, 1","marker-start":e.points[0]?"url(#".concat("preset-line-".concat(t,"-").concat(n),"-",e.points[0],"-start)"):"","marker-end":e.points[1]?"url(#".concat("preset-line-".concat(t,"-").concat(n),"-",e.points[1],"-end)"):""},null,8,zv)]))],8,Rv)])})),128))])])})),128))])}}}),jv=(0,ll.Z)(Nv,[["__scopeId","data-v-554824b6"]]),Yv=jv;var Vv={class:"chart-pool"},Jv=["onClick"];const qv=(0,u.aZ)({__name:"ChartPool",emits:["select"],setup:function(e,t){var n=t.emit,l=n,a=["bar","horizontalBar","line","area","scatter","pie","ring"],o=function(e){l("select",e)};return function(e,t){var n=(0,u.up)("IconChartLine"),l=(0,u.up)("IconChartHistogram"),i=(0,u.up)("IconChartPie"),r=(0,u.up)("IconChartHistogramOne"),c=(0,u.up)("IconChartLineArea"),s=(0,u.up)("IconChartRing"),d=(0,u.up)("IconChartScatter");return(0,u.wg)(),(0,u.iD)("ul",Vv,[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(a,(function(e,t){return(0,u._)("li",{class:"chart-item",key:t},[(0,u._)("div",{class:"chart-content",onClick:function(t){return o(e)}},["line"===e?((0,u.wg)(),(0,u.j4)(n,{key:0,size:"24"})):"bar"===e?((0,u.wg)(),(0,u.j4)(l,{key:1,size:"24"})):"pie"===e?((0,u.wg)(),(0,u.j4)(i,{key:2,size:"24"})):"horizontalBar"===e?((0,u.wg)(),(0,u.j4)(r,{key:3,size:"24"})):"area"===e?((0,u.wg)(),(0,u.j4)(c,{key:4,size:"24"})):"ring"===e?((0,u.wg)(),(0,u.j4)(s,{key:5,size:"24"})):"scatter"===e?((0,u.wg)(),(0,u.j4)(d,{key:6,size:"24"})):(0,u.kq)("",!0)],8,Jv)])})),64))])}}}),Xv=(0,ll.Z)(qv,[["__scopeId","data-v-398f5699"]]),Gv=Xv;var Kv=function(e){return(0,u.dD)("data-v-268948c2"),e=e(),(0,u.Cn)(),e},Qv={class:"prefix"},$v={class:"input-wrap"},ep=["disabled","placeholder"],tp={class:"handlers"},np=Kv((function(){return(0,u._)("svg",{fill:"currentColor",width:"1em",height:"1em",viewBox:"64 64 896 896"},[(0,u._)("path",{d:"M890.5 755.3L537.9 269.2c-12.8-17.6-39-17.6-51.7 0L133.5 755.3A8 8 0 00140 768h75c5.1 0 9.9-2.5 12.9-6.6L512 369.8l284.1 391.6c3 4.1 7.8 6.6 12.9 6.6h75c6.5 0 10.3-7.4 6.5-12.7z"})],-1)})),lp=[np],ap=Kv((function(){return(0,u._)("svg",{fill:"currentColor",width:"1em",height:"1em",viewBox:"64 64 896 896"},[(0,u._)("path",{d:"M884 256h-75c-5.1 0-9.9 2.5-12.9 6.6L512 654.2 227.9 262.6c-3-4.1-7.8-6.6-12.9-6.6h-75c-6.5 0-10.3 7.4-6.5 12.7l352.6 486.1c12.8 17.6 39 17.6 51.7 0l352.6-486.1c3.9-5.3.1-12.7-6.4-12.7z"})],-1)})),op=[ap],ip={class:"suffix"};const rp=(0,u.aZ)({__name:"NumberInput",props:{value:{},disabled:{type:Boolean,default:!1},placeholder:{default:""},min:{default:0},max:{default:1/0},step:{default:1}},emits:["update:value","input","change","blur","focus","enter"],setup:function(e,t){var n=t.emit,l=e,o=n,i=(0,c.iH)(0),r=(0,c.iH)(!1);(0,u.YP)((function(){return l.value}),(function(){l.value!==i.value&&(i.value=l.value)}),{immediate:!0}),(0,u.YP)(i,(function(){var e=+i.value;isNaN(e)?e=l.min:e>l.max?e=l.max:e<l.min&&(e=l.min),i.value=e,o("update:value",i.value)}));var s=function(e){r.value=!1,o("blur",e)},d=function(e){r.value=!0,o("focus",e)};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["number-input",{disabled:e.disabled,focused:r.value}])},[(0,u._)("span",Qv,[(0,u.WI)(e.$slots,"prefix")]),(0,u._)("div",$v,[(0,u.wy)((0,u._)("input",{type:"text",disabled:e.disabled,"onUpdate:modelValue":t[0]||(t[0]=function(e){return i.value=e}),placeholder:e.placeholder,onInput:t[1]||(t[1]=function(e){return o("input",e)}),onFocus:t[2]||(t[2]=function(e){return d(e)}),onBlur:t[3]||(t[3]=function(e){return s(e)}),onChange:t[4]||(t[4]=function(e){return o("change",e)}),onKeydown:t[5]||(t[5]=(0,a.D2)((function(e){return o("enter",e)}),["enter"]))},null,40,ep),[[a.nr,i.value]]),(0,u._)("div",tp,[(0,u._)("span",{class:"handler",onClick:t[6]||(t[6]=function(t){return i.value+=e.step})},lp),(0,u._)("span",{class:"handler",onClick:t[7]||(t[7]=function(t){return i.value-=e.step})},op)])]),(0,u._)("span",ip,[(0,u.WI)(e.$slots,"suffix")])],2)}}}),up=(0,ll.Z)(rp,[["__scopeId","data-v-268948c2"]]),cp=up;var sp=function(e){return(0,u.dD)("data-v-372c6730"),e=e(),(0,u.Cn)(),e},dp={class:"table-generator"},fp={class:"title"},vp={class:"lef"},pp=["onMouseenter"],hp={key:1,class:"custom"},mp={class:"row"},gp=sp((function(){return(0,u._)("div",{class:"label",style:{width:"25%"}},"行数：",-1)})),yp={class:"row"},wp=sp((function(){return(0,u._)("div",{class:"label",style:{width:"25%"}},"列数：",-1)})),xp={class:"btns"};const bp=(0,u.aZ)({__name:"TableGenerator",emits:["insert","close"],setup:function(e,t){var n=t.emit,l=n,a=(0,c.iH)([]),o=(0,c.iH)(3),i=(0,c.iH)(3),r=(0,c.iH)(!1),s=function(){if(a.value.length){var e=(0,ne.Z)(a.value,2),t=e[0],n=e[1];l("insert",{row:t,col:n})}},d=function(){return o.value<1||o.value>20||i.value<1||i.value>20?dl.warning("行数/列数必须在0~20之间！"):(l("insert",{row:o.value,col:i.value}),void(r.value=!1))},f=function(){l("close"),r.value=!1};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",dp,[(0,u._)("div",fp,[(0,u._)("div",vp,"表格 "+(0,pe.zw)(a.value.length?"".concat(a.value[0]," x ").concat(a.value[1]):""),1),(0,u._)("div",{class:"right",onClick:t[0]||(t[0]=function(e){return r.value=!r.value})},(0,pe.zw)(r.value?"返回":"自定义"),1)]),r.value?((0,u.wg)(),(0,u.iD)("div",hp,[(0,u._)("div",mp,[gp,(0,u.Wm)(cp,{min:1,max:20,value:o.value,"onUpdate:value":t[3]||(t[3]=function(e){return o.value=e}),style:{width:"75%"}},null,8,["value"])]),(0,u._)("div",yp,[wp,(0,u.Wm)(cp,{min:1,max:20,value:i.value,"onUpdate:value":t[4]||(t[4]=function(e){return i.value=e}),style:{width:"75%"}},null,8,["value"])]),(0,u._)("div",xp,[(0,u.Wm)(Gf,{class:"btn",onClick:t[5]||(t[5]=function(e){return f()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("取消")]})),_:1}),(0,u.Wm)(Gf,{class:"btn",type:"primary",onClick:t[6]||(t[6]=function(e){return d()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("确认")]})),_:1})])])):((0,u.wg)(),(0,u.iD)("table",{key:0,onMouseleave:t[1]||(t[1]=function(e){return a.value=[]}),onClick:t[2]||(t[2]=function(e){return s()})},[(0,u._)("tbody",null,[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(10,(function(e){return(0,u._)("tr",{key:e},[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(10,(function(t){return(0,u._)("td",{onMouseenter:function(n){return a.value=[e,t]},key:t},[(0,u._)("div",{class:(0,pe.C_)(["cell",{active:a.value.length&&e<=a.value[0]&&t<=a.value[1]}])},null,2)],40,pp)})),64))])})),64))])],32))])}}}),kp=(0,ll.Z)(bp,[["__scopeId","data-v-372c6730"]]),_p=kp;var Ip={class:"media-input"},Sp={class:"btns"},Cp={class:"btns"};const Lp=(0,u.aZ)({__name:"MediaInput",emits:["insertVideo","insertAudio","close"],setup:function(e,t){var n=t.emit,l=n,a=(0,c.iH)("video"),o=(0,c.iH)("https://mazwai.com/videvo_files/video/free/2019-01/small_watermarked/181004_04_Dolphins-Whale_06_preview.webm"),i=(0,c.iH)("https://freesound.org/data/previews/614/614107_11861866-lq.mp3"),r=[{key:"video",label:"视频"},{key:"audio",label:"音频"}],s=function(){if(!o.value)return dl.error("请先输入正确的视频地址");l("insertVideo",o.value)},d=function(){if(!i.value)return dl.error("请先输入正确的音频地址");l("insertAudio",i.value)};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Ip,[(0,u.Wm)(Jf,{tabs:r,value:a.value,"onUpdate:value":t[0]||(t[0]=function(e){return a.value=e}),tabsStyle:{marginBottom:"15px"}},null,8,["value"]),"video"===a.value?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[(0,u.Wm)($a,{value:o.value,"onUpdate:value":t[1]||(t[1]=function(e){return o.value=e}),placeholder:"请输入视频地址，e.g. https://xxx.mp4"},null,8,["value"]),(0,u._)("div",Sp,[(0,u.Wm)(Gf,{onClick:t[2]||(t[2]=function(e){return l("close")}),style:{"margin-right":"10px"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("取消")]})),_:1}),(0,u.Wm)(Gf,{type:"primary",onClick:t[3]||(t[3]=function(e){return s()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("确认")]})),_:1})])],64)):(0,u.kq)("",!0),"audio"===a.value?((0,u.wg)(),(0,u.iD)(u.HY,{key:1},[(0,u.Wm)($a,{value:i.value,"onUpdate:value":t[4]||(t[4]=function(e){return i.value=e}),placeholder:"请输入音频地址，e.g. https://xxx.mp3"},null,8,["value"]),(0,u._)("div",Cp,[(0,u.Wm)(Gf,{onClick:t[5]||(t[5]=function(e){return l("close")}),style:{"margin-right":"10px"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("取消")]})),_:1}),(0,u.Wm)(Gf,{type:"primary",onClick:t[6]||(t[6]=function(e){return d()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("确认")]})),_:1})])],64)):(0,u.kq)("",!0)])}}}),Ep=(0,ll.Z)(Lp,[["__scopeId","data-v-35a1214c"]]),Zp=Ep;var Tp=n(13576);Tp.kh.SUB_SUP_SCALE=.5;var Mp=[{label:"Gaussian formula",latex:"\\int\\int\\int _ { \\Omega } \\left( \\frac { \\partial {P} } { \\partial {x} } + \\frac { \\partial { Q} } { \\partial {y} } + \\frac { \\partial {R} }{ \\partial {z} } \\right) \\mathrm { d } V = \\oint _ { \\ partial \\Omega } ( P \\cos \\alpha + Q \\cos \\beta + R \\cos \\gamma ) \\mathrm{ d} S"},{label:"Fourier series",latex:"f(x) = \\frac {a_0} 2 + \\sum_{n = 1}^\\infty {({a_n}\\cos {nx} + {b_n}\\sin {nx}) }"},{label:"Taylor expansion",latex:"e ^ { x } = 1 + \\frac { x } { 1 ! } + \\frac { x ^ { 2 } } { 2 ! } + \\frac { x ^ { 3 } } { 3 ! } + ... , \\quad - \\infty < x < \\infty"},{label:"definite integral",latex:"\\lim_ { n \\rightarrow + \\infty } \\sum _ { i = 1 } ^ { n } f \\left[ a + \\frac { i } { n } ( b - a ) \\right] \\frac { b - a } { n } = \\int _ { a } ^ { b } f ( x ) dx"},{label:"Trigonometric Identity 1",latex:"\\sin \\alpha \\pm \\sin \\beta = 2 \\sin \\frac { 1 } { 2 } ( \\alpha \\pm \\beta ) \\cos \\frac { 1 } { 2 } ( \\alpha \\mp \\beta )"},{label:"Trigonometric Identity 2",latex:"\\cos \\alpha + \\cos \\beta = 2 \\cos \\frac { 1 } { 2 } ( \\alpha + \\beta ) \\cos \\frac { 1 } { 2 } ( \\alpha - \\beta )"},{label:"Expansion of sum",latex:"( 1 + x ) ^ { n } = 1 + \\frac { n x } { 1 ! } + \\frac { n ( n - 1 ) x ^ { 2 } } { 2 ! } + ... "},{label:"Euler's formula",latex:" e^{ix} = \\cos {x} + i\\sin {x}"},{label:"Bernoulli equation",latex:"\\frac {dy} {dx} + P(x)y = Q(x) y^n ({n} \\not= {0,1})"},{label:"total differential equation",latex:"du(x,y) = P(x,y)dx + Q(x,y)dy = 0"},{label:"non-homogeneous equation",latex:"y = (\\int Q(x) e^{\\int {P(x)dx}}dx + C)e^{-\\int {P(x)dx}}"},{label:"Cauchy's mean value theorem",latex:"\\frac{{f(b) - f(a)}}{{F(b) - F(a)}} = \\frac{{f'(\\xi )}}{{F '(\\xi )}}"},{label:"Lagrange's mean value theorem",latex:"f(b) - f(a) = f'(\\xi )(b - a)"},{label:"derivative formula",latex:"(\\arcsin x)' = \\frac{1}{{\\sqrt {1 - x^2} }}"},{label:"trigonometric function integral",latex:"\\int {tgxdx = - \\ln \\left| {\\cos x} \\right| + C}"},{label:"quadratic surface",latex:"\\frac{{{x^2}}}{{{a^2}}} + \\frac{{{y^2}}}{{{b^2}}} - \\frac {{{z^2}}}{{{c^2}}} = 1"},{label:"Second differential",latex:"\\frac {{d^2}y} {dx^2} + P(x) \\frac {dy} {dx} + Q(x)y = f(x)"},{label:"Directional derivative",latex:"\\frac{{\\partial f}}{{\\partial l}} = \\frac{{\\partial f}}{{\\partial x}}\\cos \\phi +  \frac{{\\partial f}}{{\\partial y}}\\sin \\phi"}],Up=[{type:"operators",label:"math",children:[{latex:"\\cdot"},{latex:"\\pm"},{latex:"\\mp"},{latex:"+"},{latex:"-"},{latex:"\\times"},{latex:"\\div"},{latex:"<"},{latex:">"},{latex:"="},{latex:"\\neq\\ne"},{latex:"\\leqq"},{latex:"\\geqq"},{latex:"\\leq"},{latex:"\\geq"},{latex:"\\propto"},{latex:"\\sim"},{latex:"\\equiv"},{latex:"\\dagger"},{latex:"\\ddagger"},{latex:"\\ell"},{latex:"\\#"},{latex:"\\$"},{latex:"\\&"},{latex:"\\%"},{latex:"\\langle\\rangle"},{latex:"()"},{latex:"[]"},{latex:"\\{\\}"},{latex:"||"},{latex:"\\|"},{latex:"\\exists"},{latex:"\\in"},{latex:"\\subset"},{latex:"\\supset"},{latex:"\\cup"},{latex:"\\cap"},{latex:"\\infty"},{latex:"\\partial"},{latex:"\\nabla"},{latex:"\\aleph"},{latex:"\\wp"},{latex:"\\therefore"},{latex:"\\mid"},{latex:"\\sum"},{latex:"\\prod"},{latex:"\\bigoplus"},{latex:"\\bigodot"},{latex:"\\int"},{latex:"\\oint"},{latex:"\\oplus"},{latex:"\\odot"},{latex:"\\perp"},{latex:"\\angle"},{latex:"\\triangle"},{latex:"\\Box"},{latex:"\\rightarrow"},{latex:"\\to"},{latex:"\\leftarrow"},{latex:"\\gets"},{latex:"\\circ"},{latex:"\\bigcirc"},{latex:"\\bullet"},{latex:"\\star"},{latex:"\\diamond"},{latex:"\\ast"},{latex:","},{latex:"."},{latex:";"},{latex:"!"}]},{type:"group",label:"combination",children:[{latex:"\\frac{a}{b}"},{latex:"\\frac{dx}{dx}"},{latex:"\\frac{\\partial a}{\\partial b}"},{latex:"\\sqrt{x}"},{latex:"\\sqrt[n]{x}"},{latex:"x^{n}"},{latex:"x_{n}"},{latex:"x_a^b"},{latex:"\\int_{a}^{b}"},{latex:"\\oint_a^b"},{latex:"\\lim_{a \\rightarrow b}"},{latex:"\\prod_a^b"},{latex:"\\sum_a^b"},{latex:"\\left(\\begin{array}a \\\\ b\\end{array}\\right)"},{latex:"\\begin{bmatrix}a & b \\\\ c & d \\end{bmatrix}"},{latex:"\\begin{cases}a & x = 0 \\\\ b & x > 0\\end{cases}"},{latex:"\\hat{a}"},{latex:"\\breve{a}"},{latex:"\\acute{a}"},{latex:"\\grave{a}"},{latex:"\\tilde{a}"},{latex:"\\bar{a}"},{latex:"\\vec{a}"},{latex:"\\underline{a}"},{latex:"\\overline{a}"},{latex:"\\widehat{ab}"},{latex:"\\overleftarrow{ab}"},{latex:"\\overrightarrow{ab}"}]},{type:"verbatim",label:"function",children:[{latex:"\\log"},{latex:"\\ln"},{latex:"\\exp"},{latex:"\\mod"},{latex:"\\lim"},{latex:"\\sin"},{latex:"\\cos"},{latex:"\\tan"},{latex:"\\csc"},{latex:"\\sec"},{latex:"\\cot"},{latex:"\\sinh"},{latex:"\\cosh"},{latex:"\\tanh"},{latex:"\\csch"},{latex:"\\sech"},{latex:"\\coth"},{latex:"\\arcsin"},{latex:"\\arccos"},{latex:"\\arctan"},{latex:"\\arccsc"},{latex:"\\arcsec"},{latex:"\\arccot"}]},{type:"greek",label:"Greek alphabet",children:[{latex:"\\alpha"},{latex:"\\beta"},{latex:"\\gamma"},{latex:"\\delta"},{latex:"\\varepsilon"},{latex:"\\zeta"},{latex:"\\eta"},{latex:"\\vartheta"},{latex:"\\iota"},{latex:"\\kappa"},{latex:"\\lambda"},{latex:"\\mu"},{latex:"\\nu"},{latex:"\\xi"},{latex:"\\omicron"},{latex:"\\pi"},{latex:"\\rho"},{latex:"\\sigma"},{latex:"\\tau"},{latex:"\\upsilon"},{latex:"\\varphi"},{latex:"\\chi"},{latex:"\\psi"},{latex:"\\omega"},{latex:"\\epsilon"},{latex:"\\theta"},{latex:"\\phi"},{latex:"\\varsigma"},{latex:"\\Alpha"},{latex:"\\Beta"},{latex:"\\Gamma"},{latex:"\\Delta"},{latex:"\\Epsilon"},{latex:"\\Zeta"},{latex:"\\Eta"},{latex:"\\Theta"},{latex:"\\Iota"},{latex:"\\Kappa"},{latex:"\\Lambda"},{latex:"\\Mu"},{latex:"\\Nu"},{latex:"\\Xi"},{latex:"\\Omicron"},{latex:"\\Pi"},{latex:"\\Rho"},{latex:"\\Sigma"},{latex:"\\Tau"},{latex:"\\Upsilon"},{latex:"\\Phi"},{latex:"\\Chi"},{latex:"\\Psi"},{latex:"\\Omega"}]}],Wp=["width","height"],Dp=["transform"],Hp=["d"];const Fp=(0,u.aZ)({__name:"FormulaContent",props:{latex:{},width:{},height:{}},setup:function(e){var t=e,n=(0,c.iH)({x:0,y:0,w:0,h:0}),l=(0,c.iH)("");(0,u.YP)((function(){return t.latex}),(function(){var e=new Tp._q(t.latex);l.value=e.pathd({}),n.value=e.box({})}),{immediate:!0});var a=(0,u.Fl)((function(){var e=n.value.w+32,l=n.value.h+32;return e>t.width||l>t.height?e/l>t.width/t.height?t.width/e:t.height/l:1}));return function(e,t){return(0,u.wg)(),(0,u.iD)("svg",{class:"formula-content",overflow:"visible",width:n.value.w+32,height:n.value.h+32,stroke:"#000","stroke-width":"1",fill:"none","stroke-linecap":"round","stroke-linejoin":"round"},[(0,u._)("g",{transform:"scale(".concat(a.value,", ").concat(a.value,") translate(0,0) matrix(1,0,0,1,0,0)"),"transform-origin":"0 50%"},[(0,u._)("path",{d:l.value},null,8,Hp)],8,Dp)],8,Wp)}}}),Ap=(0,ll.Z)(Fp,[["__scopeId","data-v-567417d3"]]),Op=Ap;var Pp=["innerHTML"];const Rp=(0,u.aZ)({__name:"SymbolContent",props:{latex:{}},setup:function(e){var t=e,n=(0,u.Fl)((function(){var e=new Tp._q(t.latex);return e.svg({SCALE_X:10,SCALE_Y:10})}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"symbol-content",innerHTML:n.value},null,8,Pp)}}}),Bp=Rp,zp=Bp;var Np=["disabled","value","rows","placeholder"];const jp=(0,u.aZ)({__name:"TextArea",props:{value:{},rows:{default:4},disabled:{type:Boolean,default:!1},resizable:{type:Boolean,default:!1},placeholder:{default:""}},emits:["update:value"],setup:function(e,t){var n=t.emit,l=n,a=function(e){l("update:value",e.target.value)};return function(e,t){return(0,u.wg)(),(0,u.iD)("textarea",{class:(0,pe.C_)(["textarea",{disabled:e.disabled,resizable:e.resizable}]),disabled:e.disabled,value:e.value,rows:e.rows,placeholder:e.placeholder,onInput:t[0]||(t[0]=function(e){return a(e)})},null,42,Np)}}}),Yp=(0,ll.Z)(jp,[["__scopeId","data-v-326ac8a0"]]),Vp=Yp;var Jp={class:"latex-editor"},qp={class:"container"},Xp={class:"left"},Gp={class:"input-area"},Kp={class:"preview"},Qp={key:0,class:"placeholder"},$p={key:1,class:"preview-content"},eh={class:"right"},th={class:"content"},nh={key:0,class:"symbol"},lh={class:"symbol-pool"},ah=["onClick"],oh={key:1,class:"formula"},ih={class:"formula-title"},rh=["onClick"],uh={class:"footer"};const ch=(0,u.aZ)({__name:"index",props:{value:{default:""}},emits:["update","close"],setup:function(e,t){var n=t.emit,l=[{label:"Common symbols",key:"symbol"},{label:"Preset formula",key:"formula"}],a=e,o=n,i=Mp,r=Up.map((function(e){return{label:e.label,key:e.type}})),s=(0,c.iH)(""),d=(0,c.iH)("symbol"),f=(0,c.iH)(),v=(0,c.iH)(Up[0].type),p=(0,u.Fl)((function(){var e=Up.find((function(e){return e.type===v.value}));return(null===e||void 0===e?void 0:e.children)||[]}));(0,u.bv)((function(){a.value&&(s.value=a.value)}));var h=function(){if(!s.value)return dl.error("Formula cannot be empty");var e=new Tp._q(s.value),t=e.pathd({}),n=e.box({});o("update",{latex:s.value,path:t,w:n.w+32,h:n.h+32})},m=function(e){f.value&&(f.value.focus(),document.execCommand("insertText",!1,e))};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Jp,[(0,u._)("div",qp,[(0,u._)("div",Xp,[(0,u._)("div",Gp,[(0,u.Wm)(Vp,{value:s.value,"onUpdate:value":t[0]||(t[0]=function(e){return s.value=e}),placeholder:"Enter LaTeX formula",ref_key:"textAreaRef",ref:f},null,8,["value"])]),(0,u._)("div",Kp,[s.value?((0,u.wg)(),(0,u.iD)("div",$p,[(0,u.Wm)(Op,{width:518,height:138,latex:s.value},null,8,["latex"])])):((0,u.wg)(),(0,u.iD)("div",Qp,"Formula preview"))])]),(0,u._)("div",eh,[(0,u.Wm)(Jf,{tabs:l,value:d.value,"onUpdate:value":t[1]||(t[1]=function(e){return d.value=e}),card:""},null,8,["value"]),(0,u._)("div",th,["symbol"===d.value?((0,u.wg)(),(0,u.iD)("div",nh,[(0,u.Wm)(Jf,{tabs:(0,c.SU)(r),value:v.value,"onUpdate:value":t[2]||(t[2]=function(e){return v.value=e}),spaceBetween:"",tabsStyle:{margin:"10px 10px 0"}},null,8,["tabs","value"]),(0,u._)("div",lh,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(p.value,(function(e){return(0,u.wg)(),(0,u.iD)("div",{class:"symbol-item",key:e.latex,onClick:function(t){return m(e.latex)}},[(0,u.Wm)(zp,{latex:e.latex},null,8,["latex"])],8,ah)})),128))])])):((0,u.wg)(),(0,u.iD)("div",oh,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(i),(function(e){return(0,u.wg)(),(0,u.iD)("div",{class:"formula-item",key:e.label},[(0,u._)("div",ih,(0,pe.zw)(e.label),1),(0,u._)("div",{class:"formula-item-content",onClick:function(t){return s.value=e.latex}},[(0,u.Wm)(Op,{width:236,height:60,latex:e.latex},null,8,["latex"])],8,rh)])})),128))]))])])]),(0,u._)("div",uh,[(0,u.Wm)(Gf,{class:"btn",onClick:t[3]||(t[3]=function(e){return o("close")})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Cancel")]})),_:1}),(0,u.Wm)(Gf,{class:"btn",type:"primary",onClick:t[4]||(t[4]=function(e){return h()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Sure")]})),_:1})])])}}}),sh=(0,ll.Z)(ch,[["__scopeId","data-v-54fe141e"]]),dh=sh;var fh=["accept"];const vh=(0,u.aZ)({__name:"FileInput",props:{accept:{default:"image/*"}},emits:["change"],setup:function(e,t){var n=t.emit,l=n,a=(0,c.iH)(),o=function(){a.value&&(a.value.value="",a.value.click())},i=function(e){var t=e.target.files;t&&l("change",t)};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"file-input",onClick:t[1]||(t[1]=function(e){return o()})},[(0,u.WI)(e.$slots,"default"),(0,u._)("input",{class:"input",type:"file",name:"upload",ref_key:"inputRef",ref:a,accept:e.accept,onChange:t[0]||(t[0]=function(e){return i(e)})},null,40,fh)])}}}),ph=(0,ll.Z)(vh,[["__scopeId","data-v-64bedb34"]]),hh=ph;var mh={class:"canvas-tool"},gh={class:"left-handler"},yh={class:"add-element-handler"},wh={class:"handler-item group-btn"},xh={class:"right-handler"},bh={class:"text"};const kh=(0,u.aZ)({__name:"index",setup:function(e){var t=X(),n=(0,o.Jk)(t),l=n.creatingElement,a=n.creatingCustomShape,i=n.showSelectPanel,r=n.showSearchPanel,s=(0,o.Jk)(ce()),d=s.canUndo,f=s.canRedo,v=_l(),p=v.redo,h=v.undo,m=Pl(),g=m.scaleCanvas,y=m.setCanvasScalePercentage,w=m.resetCanvas,x=m.canvasScalePercentage,b=[200,150,100,80,50],k=(0,c.iH)(!1),_=function(e){y(e),k.value=!1},I=Il(),S=I.createImageElement,C=I.createChartElement,L=I.createTableElement,E=I.createLatexElement,Z=I.createVideoElement,T=I.createAudioElement,M=function(e){var t=e[0];t&&yl(t).then((function(e){return S(e)}))},U=(0,c.iH)(!1),W=(0,c.iH)(!1),D=(0,c.iH)(!1),H=(0,c.iH)(!1),F=(0,c.iH)(!1),A=(0,c.iH)(!1),O=(0,c.iH)(!1),P=function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.setCreatingElement({type:"text",vertical:e})},R=function(e){"arbitrary polygon"===e.title?t.setCreatingCustomShapeState(!0):t.setCreatingElement({type:"shape",data:e}),U.value=!1},B=function(e){t.setCreatingElement({type:"line",data:e}),W.value=!1},z=function(){t.setSelectPanelState(!i.value)},N=function(){t.setSearchPanelState(!r.value)};return function(e,t){var n,o=(0,u.up)("IconBack"),s=(0,u.up)("IconNext"),v=(0,u.up)("IconMoveOne"),m=(0,u.up)("IconSearch"),y=(0,u.up)("IconFontSize"),I=(0,u.up)("IconTextRotationNone"),S=(0,u.up)("IconTextRotationDown"),j=(0,u.up)("IconDown"),Y=(0,u.up)("IconPicture"),V=(0,u.up)("IconGraphicDesign"),J=(0,u.up)("IconConnection"),q=(0,u.up)("IconChartProportion"),X=(0,u.up)("IconInsertTable"),G=(0,u.up)("IconFormula"),K=(0,u.up)("IconVideoTwo"),Q=(0,u.up)("IconMinus"),$=(0,u.up)("IconPlus"),ee=(0,u.up)("IconFullScreen"),te=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",mh,[(0,u._)("div",gh,[(0,u.wy)((0,u.Wm)(o,{class:(0,pe.C_)(["handler-item",{disable:!(0,c.SU)(d)}]),onClick:t[0]||(t[0]=function(e){return(0,c.SU)(h)()})},null,8,["class"]),[[te,"Undo"]]),(0,u.wy)((0,u.Wm)(s,{class:(0,pe.C_)(["handler-item",{disable:!(0,c.SU)(f)}]),onClick:t[1]||(t[1]=function(e){return(0,c.SU)(p)()})},null,8,["class"]),[[te,"Redo"]]),(0,u.Wm)(Ud,{type:"vertical",style:{height:"20px"}}),(0,u.wy)((0,u.Wm)(v,{class:(0,pe.C_)(["handler-item",{active:(0,c.SU)(i)}]),onClick:t[2]||(t[2]=function(e){return z()})},null,8,["class"]),[[te,"SelectPanel"]]),(0,u.wy)((0,u.Wm)(m,{class:(0,pe.C_)(["handler-item",{active:(0,c.SU)(r)}]),onClick:t[3]||(t[3]=function(e){return N()})},null,8,["class"]),[[te,"Find/Replace"]])]),(0,u._)("div",yh,[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",wh,[(0,u.Wm)(y,{class:(0,pe.C_)(["icon",{active:"text"===(null===(n=(0,c.SU)(l))||void 0===n?void 0:n.type)}]),onClick:t[4]||(t[4]=function(e){return P()})},null,8,["class"]),(0,u.Wm)(lo,{trigger:"click",value:O.value,"onUpdate:value":t[7]||(t[7]=function(e){return O.value=e}),style:{height:"100%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(io,{center:"",onClick:t[5]||(t[5]=function(){P(),O.value=!1})},{default:(0,u.w5)((function(){return[(0,u.Wm)(I),(0,u.Uk)(" Horizontal text box")]})),_:1}),(0,u.Wm)(io,{center:"",onClick:t[6]||(t[6]=function(){P(!0),O.value=!1})},{default:(0,u.w5)((function(){return[(0,u.Wm)(S),(0,u.Uk)(" vertical text box")]})),_:1})]})),default:(0,u.w5)((function(){return[(0,u.Wm)(j,{class:"arrow"})]})),_:1},8,["value"])])),[[te,"Insert Text"]]),(0,u.Wm)(hh,{onChange:t[8]||(t[8]=function(e){return M(e)})},{default:(0,u.w5)((function(){return[(0,u.wy)((0,u.Wm)(Y,{class:"handler-item"},null,512),[[te,"Insert picture"]])]})),_:1}),(0,u.Wm)(lo,{trigger:"click",value:U.value,"onUpdate:value":t[10]||(t[10]=function(e){return U.value=e})},{content:(0,u.w5)((function(){return[(0,u.Wm)(Hv,{onSelect:t[9]||(t[9]=function(e){return R(e)})})]})),default:(0,u.w5)((function(){var e;return[(0,u.wy)((0,u.Wm)(V,{class:(0,pe.C_)(["handler-item",{active:(0,c.SU)(a)||"shape"===(null===(e=(0,c.SU)(l))||void 0===e?void 0:e.type)}])},null,8,["class"]),[[te,"Insert shape"]])]})),_:1},8,["value"]),(0,u.Wm)(lo,{trigger:"click",value:W.value,"onUpdate:value":t[12]||(t[12]=function(e){return W.value=e})},{content:(0,u.w5)((function(){return[(0,u.Wm)(Yv,{onSelect:t[11]||(t[11]=function(e){return B(e)})})]})),default:(0,u.w5)((function(){var e;return[(0,u.wy)((0,u.Wm)(J,{class:(0,pe.C_)(["handler-item",{active:"line"===(null===(e=(0,c.SU)(l))||void 0===e?void 0:e.type)}])},null,8,["class"]),[[te,"Insert line"]])]})),_:1},8,["value"]),(0,u.Wm)(lo,{trigger:"click",value:D.value,"onUpdate:value":t[14]||(t[14]=function(e){return D.value=e})},{content:(0,u.w5)((function(){return[(0,u.Wm)(Gv,{onSelect:t[13]||(t[13]=function(e){(0,c.SU)(C)(e),D.value=!1})})]})),default:(0,u.w5)((function(){return[(0,u.wy)((0,u.Wm)(q,{class:"handler-item"},null,512),[[te,"Insert chart"]])]})),_:1},8,["value"]),(0,u.Wm)(lo,{trigger:"click",value:H.value,"onUpdate:value":t[17]||(t[17]=function(e){return H.value=e})},{content:(0,u.w5)((function(){return[(0,u.Wm)(_p,{onClose:t[15]||(t[15]=function(e){return H.value=!1}),onInsert:t[16]||(t[16]=function(e){var t=e.row,n=e.col;(0,c.SU)(L)(t,n),H.value=!1})})]})),default:(0,u.w5)((function(){return[(0,u.wy)((0,u.Wm)(X,{class:"handler-item"},null,512),[[te,"Insert table"]])]})),_:1},8,["value"]),(0,u.wy)((0,u.Wm)(G,{class:"handler-item",onClick:t[18]||(t[18]=function(e){return A.value=!0})},null,512),[[te,"Insert formula"]]),(0,u.Wm)(lo,{trigger:"click",value:F.value,"onUpdate:value":t[22]||(t[22]=function(e){return F.value=e})},{content:(0,u.w5)((function(){return[(0,u.Wm)(Zp,{onClose:t[19]||(t[19]=function(e){return F.value=!1}),onInsertVideo:t[20]||(t[20]=function(e){(0,c.SU)(Z)(e),F.value=!1}),onInsertAudio:t[21]||(t[21]=function(e){(0,c.SU)(T)(e),F.value=!1})})]})),default:(0,u.w5)((function(){return[(0,u.wy)((0,u.Wm)(K,{class:"handler-item"},null,512),[[te,"Insert audio and video"]])]})),_:1},8,["value"])]),(0,u._)("div",xh,[(0,u.Wm)(Q,{class:"handler-item viewport-size",onClick:t[23]||(t[23]=function(e){return(0,c.SU)(g)("-")})}),(0,u.Wm)(lo,{trigger:"click",value:k.value,"onUpdate:value":t[24]||(t[24]=function(e){return k.value=e})},{content:(0,u.w5)((function(){return[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(b,(function(e){return(0,u.Wm)(io,{center:"",key:e,onClick:function(t){return _(e)}},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,pe.zw)(e)+"%",1)]})),_:2},1032,["onClick"])})),64))]})),default:(0,u.w5)((function(){return[(0,u._)("span",bh,(0,pe.zw)((0,c.SU)(x)),1)]})),_:1},8,["value"]),(0,u.Wm)($,{class:"handler-item viewport-size",onClick:t[25]||(t[25]=function(e){return(0,c.SU)(g)("+")})}),(0,u.wy)((0,u.Wm)(ee,{class:"handler-item viewport-size-adaptation",onClick:t[26]||(t[26]=function(e){return(0,c.SU)(w)()})},null,512),[[te,"Adapt to screen"]])]),(0,u.Wm)(mv,{visible:A.value,"onUpdate:visible":t[29]||(t[29]=function(e){return A.value=e}),width:880},{default:(0,u.w5)((function(){return[(0,u.Wm)(dh,{onClose:t[27]||(t[27]=function(e){return A.value=!1}),onUpdate:t[28]||(t[28]=function(e){(0,c.SU)(E)(e),A.value=!1})})]})),_:1},8,["visible"])])}}}),_h=(0,ll.Z)(kh,[["__scopeId","data-v-04572b52"]]),Ih=_h,Sh=function(){var e=(0,o.Jk)(V()),t=e.slides,n=(0,c.iH)(null),l=(0,c.iH)(50),a=function e(){t.value.length>l.value?n.value=setTimeout((function(){l.value=l.value+20,e()}),600):l.value=9999};return(0,u.bv)(a),(0,u.Ah)((function(){n.value&&clearTimeout(n.value)})),{slidesLoadLimit:l}};var Ch={class:"layout-pool"},Lh=["onClick"];const Eh=(0,u.aZ)({__name:"LayoutPool",emits:["select"],setup:function(e,t){var n=t.emit,l=n,a=(0,o.Jk)(V()),i=a.layouts,r=function(e){l("select",e)};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Ch,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(i),(function(e){return(0,u.wg)(),(0,u.iD)("div",{class:"layout-item",key:e.id,onClick:function(t){return r(e)}},[(0,u.Wm)(Nf,{class:"thumbnail",slide:e,size:180},null,8,["slide"])],8,Lh)})),128))])}}}),Zh=(0,ll.Z)(Eh,[["__scopeId","data-v-8ee3e590"]]),Th=Zh;var Mh=n(9980),Uh=n.n(Mh),Wh={class:"add-slide"},Dh={class:"select-btn"},Hh=["onMousedown"],Fh={class:"page-number"};const Ah=(0,u.aZ)({__name:"index",setup:function(e){var t=X(),n=V(),l=se(),a=(0,o.Jk)(t),i=a.selectedSlidesIndex,r=a.thumbnailsFocus,s=(0,o.Jk)(n),d=s.slides,f=s.slideIndex,v=(0,o.Jk)(l),p=v.ctrlKeyState,h=v.shiftKeyState,m=Sh(),g=m.slidesLoadLimit,y=(0,u.Fl)((function(){return[].concat((0,R.Z)(i.value),[f.value])})),w=(0,c.iH)(!1),x=Ll(),b=x.copySlide,k=x.pasteSlide,_=x.createSlide,I=x.createSlideByTemplate,S=x.copyAndPasteSlide,C=x.deleteSlide,L=x.cutSlide,E=x.selectAllSlide,Z=x.sortSlides,T=(0,c.iH)();(0,u.YP)((function(){return f.value}),(function(){y.value.length&&t.updateSelectedSlidesIndex([]),(0,u.Y3)((function(){var e,t=null===(e=T.value)||void 0===e||null===(e=e.$el)||void 0===e?void 0:e.querySelector(".thumbnail-item.active");T.value&&t&&!Fe(t,T.value.$el)&&setTimeout((function(){t.scrollIntoView({behavior:"smooth"})}),100)}))}));var M=function(e){t.setActiveElementIdList([]),f.value!==e&&n.updateSlideIndex(e)},U=function(e,n){var l=y.value.length>1;if(!l||!y.value.includes(n)||0===e.button)if(p.value)if(f.value===n){if(!l)return;var a=y.value.filter((function(e){return e!==n}));t.updateSelectedSlidesIndex(a),M(y.value[0])}else if(y.value.includes(n)){var o=y.value.filter((function(e){return e!==n}));t.updateSelectedSlidesIndex(o)}else{var i=[].concat((0,R.Z)(y.value),[n]);t.updateSelectedSlidesIndex(i)}else if(h.value){if(f.value===n&&!l)return;var r=Math.min.apply(Math,(0,R.Z)(y.value)),u=n;n<r&&(u=Math.max.apply(Math,(0,R.Z)(y.value)),r=n);for(var c=[],s=r;s<=u;s++)c.push(s);t.updateSelectedSlidesIndex(c)}else t.updateSelectedSlidesIndex([]),M(n)},W=function(e){r.value!==e&&(t.setThumbnailsFocus(e),e||t.updateSelectedSlidesIndex([]))},D=function(e){var t=e.newIndex,n=e.oldIndex;void 0!==t&&void 0!==n&&t!==n&&Z(t,n)},H=Ol(),F=H.enterScreening,A=H.enterScreeningFromStart,O=function(){return[{text:"Paste",subText:"Ctrl + V",handler:k},{text:"Select all",subText:"Ctrl + A",handler:E},{text:"New page",subText:"Enter",handler:_},{text:"Slide show",subText:"F5",handler:A}]},P=function(){return[{text:"Cut",subText:"Ctrl + X",handler:L},{text:"Copy",subText:"Ctrl + C",handler:b},{text:"Paste",subText:"Ctrl + V",handler:k},{text:"Select all",subText:"Ctrl + A",handler:E},{divider:!0},{text:"New page",subText:"Enter",handler:_},{text:"Copy page",subText:"Ctrl + D",handler:S},{text:"Delete page",subText:"Delete",handler:function(){return C()}},{divider:!0},{text:"Show from current",subText:"Shift + F5",handler:F}]};return function(e,t){var n=(0,u.up)("IconPlus"),l=(0,u.up)("IconDown"),a=(0,u.Q2)("contextmenu"),o=(0,u.Q2)("click-outside");return(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"thumbnails",onMousedown:t[4]||(t[4]=function(){return W(!0)})},[(0,u._)("div",Wh,[(0,u._)("div",{class:"btn",onClick:t[0]||(t[0]=function(e){return(0,c.SU)(_)()})},[(0,u.Wm)(n,{class:"icon"}),(0,u.Uk)("Add slides ")]),(0,u.Wm)(lo,{trigger:"click",placement:"bottom-start",value:w.value,"onUpdate:value":t[2]||(t[2]=function(e){return w.value=e}),center:""},{content:(0,u.w5)((function(){return[(0,u.Wm)(Th,{onSelect:t[1]||(t[1]=function(e){(0,c.SU)(I)(e),w.value=!1})})]})),default:(0,u.w5)((function(){return[(0,u._)("div",Dh,[(0,u.Wm)(l)])]})),_:1},8,["value"])]),(0,u.Wm)((0,c.SU)(Uh()),{class:"thumbnail-list",ref_key:"thumbnailsRef",ref:T,modelValue:(0,c.SU)(d),animation:200,scroll:!0,scrollSensitivity:50,onEnd:D,itemKey:"id"},{item:(0,u.w5)((function(e){var n=e.element,l=e.index;return[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["thumbnail-item",{active:(0,c.SU)(f)===l,selected:y.value.includes(l)}]),onMousedown:function(e){return U(e,l)},onDblclick:t[3]||(t[3]=function(e){return(0,c.SU)(F)()})},[(0,u._)("div",{class:(0,pe.C_)(["label",{"offset-left":l>=99}])},(0,pe.zw)((0,c.SU)(fe)(l+1,2)),3),(0,u.Wm)(Nf,{class:"thumbnail",slide:n,size:120,visible:l<(0,c.SU)(g)},null,8,["slide","visible"])],42,Hh)),[[a,P]])]})),_:1},8,["modelValue"]),(0,u._)("div",Fh," slideshow "+(0,pe.zw)((0,c.SU)(f)+1)+" / "+(0,pe.zw)((0,c.SU)(d).length),1)],32)),[[o,function(){return W(!1)}],[a,O]])}}}),Oh=(0,ll.Z)(Ah,[["__scopeId","data-v-27836fe5"]]),Ph=Oh,Rh=function(){var e=X(),t=(0,o.Jk)(e),n=t.richTextAttrs,l=t.textFormatPainter,a=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];l.value?e.setTextFormatPainter(null):e.setTextFormatPainter({keep:t,bold:n.value.bold,em:n.value.em,underline:n.value.underline,strikethrough:n.value.strikethrough,color:n.value.color,backcolor:n.value.backcolor,fontname:n.value.fontname,fontsize:n.value.fontsize,align:n.value.align})};return{toggleTextFormatPainter:a}};n(25499);var Bh=n(28374),zh={class:"bar"},Nh=["data-tooltip"],jh=["data-tooltip"],Yh=["data-tooltip"];const Vh=(0,u.aZ)({__name:"Slider",props:{value:{},disabled:{type:Boolean,default:!1},min:{default:0},max:{default:100},step:{default:1},range:{type:Boolean,default:!1}},emits:["update:value"],setup:function(e,t){var n=t.emit,l=function(e){return e.getBoundingClientRect().left},a=e,o=n,i=(0,c.iH)(),r=(0,c.iH)(0),s=(0,c.iH)(0),d=(0,c.iH)(0),f=(0,c.iH)("end"),v=function(e){var t=e/100*(a.max-a.min);if(a.step>=1)t=Math.fround(t);else{var n=a.step.toString(),l=n.match(/^[0.]*([1-9])/);if(l){var o=l[1],i=n.indexOf(o)-1;if(i>0){var r=Math.pow(10,i);t=Math.fround(t*r)/r}}}return Bh.ZP.plus(t,a.min)},p=(0,u.Fl)((function(){return v(r.value)})),h=(0,u.Fl)((function(){return v(s.value)})),m=(0,u.Fl)((function(){return v(d.value)}));(0,u.YP)((function(){return a.value}),(function(){a.max!==a.min&&("number"===typeof a.value?r.value=(a.value-a.min)/(a.max-a.min)*100:(s.value=(a.value[0]-a.min)/(a.max-a.min)*100,d.value=(a.value[1]-a.min)/(a.max-a.min)*100))}),{immediate:!0});var g=function(e){if(!i.value)return 0;var t="clientX"in e?e.clientX:e.changedTouches[0].clientX,n=(t-l(i.value))/i.value.clientWidth;n=Math.max(n,0),n=Math.min(n,1);var o=100*n,r=a.step/(a.max-a.min)*100,u=o%r;return u>0&&(u<=r/2?o-=u:o=o-u+r),o},y=function(e){var t=g(e);"start"===f.value?s.value=t:d.value=t},w=function e(t){x(t);var n=v(r.value),l=a.value,i="start"===f.value?[n,l[1]]:[l[0],n];if(i[0]>i[1]){var u=[i[1],i[0]];i[0]=u[0],i[1]=u[1]}o("update:value",i),document.removeEventListener("mousemove",y),document.removeEventListener("touchmove",y),document.removeEventListener("mouseup",e),document.removeEventListener("touchend",e)},x=function(e){r.value=g(e)},b=function e(t){x(t);var n=v(r.value);o("update:value",n),document.removeEventListener("mousemove",x),document.removeEventListener("touchmove",x),document.removeEventListener("mouseup",e),document.removeEventListener("touchend",e)},k=function(e){if(!a.disabled)if(a.range){var t=g(e);Math.abs(t-s.value)<Math.abs(t-d.value)?f.value="start":f.value="end",document.addEventListener("mousemove",y),document.addEventListener("touchmove",y),document.addEventListener("mouseup",w),document.addEventListener("touchend",w)}else document.addEventListener("mousemove",x),document.addEventListener("touchmove",x),document.addEventListener("mouseup",b),document.addEventListener("touchend",b)};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["slider",{disabled:e.disabled}]),ref_key:"sliderRef",ref:i,onMousedown:t[0]||(t[0]=function(e){return k(e)})},[(0,u._)("div",zh,[e.range?((0,u.wg)(),(0,u.iD)(u.HY,{key:1},[(0,u._)("div",{class:"track",style:(0,pe.j5)({width:"".concat(d.value-s.value,"%"),left:"".concat(s.value,"%")})},null,4),(0,u._)("div",{class:"thumb",style:(0,pe.j5)({left:"".concat(s.value,"%")}),"data-tooltip":h.value},null,12,jh),(0,u._)("div",{class:"thumb",style:(0,pe.j5)({left:"".concat(d.value,"%")}),"data-tooltip":m.value},null,12,Yh)],64)):((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[(0,u._)("div",{class:"track",style:(0,pe.j5)({width:"".concat(r.value,"%")})},null,4),(0,u._)("div",{class:"thumb",style:(0,pe.j5)({left:"".concat(r.value,"%")}),"data-tooltip":p.value},null,12,Nh)],64))])],34)}}}),Jh=(0,ll.Z)(Vh,[["__scopeId","data-v-563bd2a0"]]),qh=Jh;var Xh=function(e){return(0,u.dD)("data-v-44185c3a"),e=e(),(0,u.Cn)(),e},Gh={class:"element-opacity"},Kh={class:"row"},Qh=Xh((function(){return(0,u._)("div",{style:{width:"40%"}},"Opacity:",-1)}));const $h=(0,u.aZ)({__name:"ElementOpacity",setup:function(e){var t=V(),n=(0,o.Jk)(X()),l=n.handleElement,a=(0,c.iH)(1);(0,u.YP)(l,(function(){l.value&&(a.value="opacity"in l.value&&void 0!==l.value.opacity?l.value.opacity:1)}),{deep:!0,immediate:!0});var i=_l(),r=i.addHistorySnapshot,s=function(e){if(l.value){var n={opacity:e};t.updateElement({id:l.value.id,props:n}),r()}};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Gh,[(0,u._)("div",Kh,[Qh,(0,u.Wm)(qh,{min:0,max:1,step:.1,value:a.value,"onUpdate:value":t[0]||(t[0]=function(e){return s(e)}),style:{width:"60%"}},null,8,["value"])])])}}}),em=(0,ll.Z)($h,[["__scopeId","data-v-44185c3a"]]),tm=em;n(98041);var nm={class:"color-block"};const lm=(0,u.aZ)({__name:"ColorButton",props:{color:{}},setup:function(e){return function(e,t){var n=(0,u.up)("IconPlatte");return(0,u.wg)(),(0,u.j4)(Gf,{class:"color-btn"},{default:(0,u.w5)((function(){return[(0,u._)("div",nm,[(0,u._)("div",{class:"content",style:(0,pe.j5)({backgroundColor:e.color})},null,4)]),(0,u.Wm)(n,{class:"color-btn-icon"})]})),_:1})}}}),am=(0,ll.Z)(lm,[["__scopeId","data-v-7fa73bdc"]]),om=am;n(97389);const im=(0,u.aZ)({__name:"Checkboard",props:{size:{default:8},white:{default:"#fff"},grey:{default:"#e6e6e6"}},setup:function(e){var t=e,n={},l=function(e,t,n){var l=document.createElement("canvas");l.width=l.height=2*n;var a=l.getContext("2d");return a?(a.fillStyle=e,a.fillRect(0,0,l.width,l.height),a.fillStyle=t,a.fillRect(0,0,n,n),a.translate(n,n),a.fillRect(0,0,n,n),l.toDataURL()):null},a=function(e,t,a){var o=e+","+t+","+a;if(n[o])return n[o];var i=l(e,t,a);return n[o]=i,i},o=(0,u.Fl)((function(){var e=a(t.white,t.grey,t.size);return{backgroundImage:"url(".concat(e,")")}}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"checkerboard",style:(0,pe.j5)(o.value)},null,4)}}}),rm=(0,ll.Z)(im,[["__scopeId","data-v-fa191ace"]]),um=rm;var cm=function(e){return(0,u.dD)("data-v-84628bc8"),e=e(),(0,u.Cn)(),e},sm={class:"alpha"},dm={class:"alpha-checkboard-wrap"},fm=cm((function(){return(0,u._)("div",{class:"alpha-picker"},null,-1)})),vm=[fm];const pm=(0,u.aZ)({__name:"Alpha",props:{value:{}},emits:["colorChange"],setup:function(e,t){var n=t.emit,l=e,a=n,o=(0,u.Fl)((function(){return l.value})),i=(0,u.Fl)((function(){var e=[o.value.r,o.value.g,o.value.b].join(",");return"linear-gradient(to right, rgba(".concat(e,", 0) 0%, rgba(").concat(e,", 1) 100%)")})),r=(0,c.iH)(),s=function(e){if(e.preventDefault(),r.value){var t,n=r.value.clientWidth,l=r.value.getBoundingClientRect().left+window.pageXOffset,i=e.pageX-l;t=i<0?0:i>n?1:Math.round(100*i/n)/100,o.value.a!==t&&a("colorChange",{r:o.value.r,g:o.value.g,b:o.value.b,a:t})}},d=function e(){window.removeEventListener("mousemove",s),window.removeEventListener("mouseup",e)},f=function(e){s(e),window.addEventListener("mousemove",s),window.addEventListener("mouseup",d)};return(0,u.Ah)(d),function(e,t){return(0,u.wg)(),(0,u.iD)("div",sm,[(0,u._)("div",dm,[(0,u.Wm)(um)]),(0,u._)("div",{class:"alpha-gradient",style:(0,pe.j5)({background:i.value})},null,4),(0,u._)("div",{class:"alpha-container",ref_key:"alphaRef",ref:r,onMousedown:t[0]||(t[0]=function(e){return f(e)})},[(0,u._)("div",{class:"alpha-pointer",style:(0,pe.j5)({left:100*o.value.a+"%"})},vm,4)],544)])}}}),hm=(0,ll.Z)(pm,[["__scopeId","data-v-84628bc8"]]),mm=hm;var gm=function(e){return(0,u.dD)("data-v-5711e710"),e=e(),(0,u.Cn)(),e},ym={class:"hue"},wm=gm((function(){return(0,u._)("div",{class:"hue-picker"},null,-1)})),xm=[wm];const bm=(0,u.aZ)({__name:"Hue",props:{value:{},hue:{}},emits:["colorChange"],setup:function(e,t){var n=t.emit,l=e,a=n,o=(0,c.iH)(0),i=(0,c.iH)(""),r=(0,u.Fl)((function(){var e=(0,B.Z)(l.value).toHsl();return-1!==l.hue&&(e.h=l.hue),e})),s=(0,u.Fl)((function(){return 0===r.value.h&&"right"===i.value?"100%":100*r.value.h/360+"%"}));(0,u.YP)((function(){return l.value}),(function(){var e=(0,B.Z)(l.value).toHsl(),t=0===e.s?l.hue:e.h;0!==t&&t-o.value>0&&(i.value="right"),0!==t&&t-o.value<0&&(i.value="left"),o.value=t}));var d=(0,c.iH)(),f=function(e){if(e.preventDefault(),d.value){var t,n,o=d.value.clientWidth,i=d.value.getBoundingClientRect().left+window.pageXOffset,u=e.pageX-i;u<0?t=0:u>o?t=360:(n=100*u/o,t=360*n/100),-1!==l.hue&&r.value.h===t||a("colorChange",{h:t,l:r.value.l,s:r.value.s,a:r.value.a})}},v=function e(){window.removeEventListener("mousemove",f),window.removeEventListener("mouseup",e)},p=function(e){f(e),window.addEventListener("mousemove",f),window.addEventListener("mouseup",v)};return(0,u.Ah)(v),function(e,t){return(0,u.wg)(),(0,u.iD)("div",ym,[(0,u._)("div",{class:"hue-container",ref_key:"hueRef",ref:d,onMousedown:t[0]||(t[0]=function(e){return p(e)})},[(0,u._)("div",{class:"hue-pointer",style:(0,pe.j5)({left:s.value})},xm,4)],544)])}}}),km=(0,ll.Z)(bm,[["__scopeId","data-v-5711e710"]]),_m=km;var Im=function(e){return(0,u.dD)("data-v-c79c0446"),e=e(),(0,u.Cn)(),e},Sm=Im((function(){return(0,u._)("div",{class:"saturation-white"},null,-1)})),Cm=Im((function(){return(0,u._)("div",{class:"saturation-black"},null,-1)})),Lm=Im((function(){return(0,u._)("div",{class:"saturation-circle"},null,-1)})),Em=[Lm];const Zm=(0,u.aZ)({__name:"Saturation",props:{value:{},hue:{}},emits:["colorChange"],setup:function(e,t){var n=t.emit,l=e,a=n,o=(0,u.Fl)((function(){var e=(0,B.Z)(l.value).toHsv();return-1!==l.hue&&(e.h=l.hue),e})),i=(0,u.Fl)((function(){return"hsl(".concat(o.value.h,", 100%, 50%)")})),r=(0,u.Fl)((function(){return-100*o.value.v+1+100+"%"})),s=(0,u.Fl)((function(){return 100*o.value.s+"%"})),d=(0,z.throttle)((function(e){a("colorChange",e)}),20,{leading:!0,trailing:!1}),f=(0,c.iH)(),v=function(e){if(e.preventDefault(),f.value){var t=f.value.clientWidth,n=f.value.clientHeight,l=f.value.getBoundingClientRect().left+window.pageXOffset,a=f.value.getBoundingClientRect().top+window.pageYOffset,i=(0,z.clamp)(e.pageX-l,0,t),r=(0,z.clamp)(e.pageY-a,0,n),u=i/t,c=(0,z.clamp)(-r/n+1,0,1);d({h:o.value.h,s:u,v:c,a:o.value.a})}},p=function e(){window.removeEventListener("mousemove",v),window.removeEventListener("mouseup",e)},h=function(e){v(e),window.addEventListener("mousemove",v),window.addEventListener("mouseup",p)};return(0,u.Ah)(p),function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"saturation",ref_key:"saturationRef",ref:f,style:(0,pe.j5)({background:i.value}),onMousedown:t[0]||(t[0]=function(e){return h(e)})},[Sm,Cm,(0,u._)("div",{class:"saturation-pointer",style:(0,pe.j5)({top:r.value,left:s.value})},Em,4)],36)}}}),Tm=(0,ll.Z)(Zm,[["__scopeId","data-v-c79c0446"]]),Mm=Tm;var Um={class:"editable-input"},Wm=["value"];const Dm=(0,u.aZ)({__name:"EditableInput",props:{value:{}},emits:["colorChange"],setup:function(e,t){var n=t.emit,l=e,a=n,o=(0,u.Fl)((function(){var e="";return e=l.value.a<1?(0,B.Z)(l.value).toHex8String().toUpperCase():(0,B.Z)(l.value).toHexString().toUpperCase(),e.replace("#","")})),i=function(e){var t=e.target.value;t.length>=6&&a("colorChange",(0,B.Z)(t).toRgb())};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Um,[(0,u._)("input",{class:"input-content",value:o.value,onInput:t[0]||(t[0]=function(e){return i(e)})},null,40,Wm)])}}}),Hm=(0,ll.Z)(Dm,[["__scopeId","data-v-eb50f8e8"]]),Fm=Hm;var Am={class:"color-picker"},Om={class:"picker-saturation-wrap"},Pm={class:"picker-controls"},Rm={class:"picker-color-wrap"},Bm={class:"picker-sliders"},zm={class:"picker-hue-wrap"},Nm={class:"picker-alpha-wrap"},jm={class:"picker-field"},Ym={class:"picker-presets"},Vm=["onClick"],Jm={class:"picker-gradient-presets"},qm=["onClick"],Xm={class:"picker-presets"},Gm=["onClick"],Km={key:0,class:"recent-colors-title"},Qm={class:"picker-presets"},$m=["onClick"],eg="RECENT_COLORS";const tg=(0,u.aZ)({__name:"index",props:{modelValue:{default:"#e86b99"}},emits:["update:modelValue"],setup:function(e,t){var n=t.emit,l=e,a=n,o=[["#7f7f7f","#f2f2f2"],["#0d0d0d","#808080"],["#1c1a10","#ddd8c3"],["#0e243d","#c6d9f0"],["#233f5e","#dae5f0"],["#632623","#f2dbdb"],["#4d602c","#eaf1de"],["#3f3150","#e6e0ec"],["#1e5867","#d9eef3"],["#99490f","#fee9da"]],i=function(e,t,n){for(var l=(0,B.Z)(e).toRgb(),a=(0,B.Z)(t).toRgb(),o=(a.r-l.r)/n,i=(a.g-l.g)/n,r=(a.b-l.b)/n,u=[],c=0;c<n;c++){var s=(0,B.Z)({r:l.r+o*c,g:l.g+i*c,b:l.b+r*c}).toRgbString();u.push(s)}return u},r=function(){for(var e=[],t=0,n=o;t<n.length;t++){var l=n[t];e.push(i(l[1],l[0],5))}return e},s=["#000000","#ffffff","#eeece1","#1e497b","#4e81bb","#e2534d","#9aba60","#8165a0","#47acc5","#f9974c"],d=["#c21401","#ff1e02","#ffc12a","#ffff3a","#90cf5b","#00af57","#00afee","#0071be","#00215f","#72349d"],f=(0,c.iH)(-1),v=(0,c.iH)([]),p=(0,u.Fl)({get:function(){return(0,B.Z)(l.modelValue).toRgb()},set:function(e){var t="rgba(".concat([e.r,e.g,e.b,e.a].join(","),")");a("update:modelValue",t)}}),h=r(),m=(0,u.Fl)((function(){return"rgba(".concat([p.value.r,p.value.g,p.value.b,p.value.a].join(","),")")})),g=function(e){f.value=(0,B.Z)(e).toHsl().h,a("update:modelValue",e)},y=(0,z.debounce)((function(){var e=(0,B.Z)(p.value).toRgbString();if(!v.value.includes(e)){v.value=[e].concat((0,R.Z)(v.value));var t=10;v.value.length>t&&(v.value=v.value.slice(0,t))}}),300,{trailing:!0});(0,u.bv)((function(){var e=localStorage.getItem(eg);e&&(v.value=JSON.parse(e))})),(0,u.YP)(v,(function(){var e=JSON.stringify(v.value);localStorage.setItem(eg,e)}));var w=function(e){"h"in e?(f.value=e.h,p.value=(0,B.Z)(e).toRgb()):(f.value=(0,B.Z)(e).toHsl().h,p.value=e),y()},x=function(){var e="EyeDropper"in window;e?b():k()},b=function(){dl.success("Press the ESC key to close the color picker");var e=new window.EyeDropper;e.open().then((function(e){var t=(0,B.Z)(e.sRGBHex);f.value=t.toHsl().h,p.value=t.toRgb(),y()}))["catch"]((function(){dl.success("Close the color picker")}))},k=function(){var e=document.querySelector(".canvas");if(e){var t=document.createElement("div");t.style.cssText="position: fixed; top: 0; left: 0; bottom: 0; right: 0; z-index: 9999; cursor: wait;",document.body.appendChild(t);var n=document.createElement("div");n.style.cssText="position: absolute; top: -100px; left: -100px; width: 16px; height: 16px; border: 1px solid #000; z-index: 999",t.appendChild(n);var l=e.getBoundingClientRect(),a=l.left,o=l.top,i=l.width,r=l.height,u=function(e){return(!e.tagName||"FOREIGNOBJECT"!==e.tagName.toUpperCase())&&(!e.classList||!e.classList.contains("operate"))};(0,Vl.rT)(e,{filter:u,fontEmbedCSS:"",width:i,height:r,canvasWidth:i,canvasHeight:r,pixelRatio:1}).then((function(e){e.style.cssText="position: absolute; top: ".concat(o,"px; left: ").concat(a,"px; cursor: crosshair;"),t.style.cursor="default",t.appendChild(e);var l=e.getContext("2d");if(l){var i="",r=function(e){var t=e.x,r=e.y,u=t-a,c=r-o,s=(0,ne.Z)(l.getImageData(u,c,1,1).data,4),d=s[0],f=s[1],v=s[2],p=s[3];i="rgba(".concat(d,", ").concat(f,", ").concat(v,", ").concat((p/255).toFixed(2),")"),n.style.left=t+10+"px",n.style.top=r+10+"px",n.style.backgroundColor=i},u=function(){i="",n.style.left="-100px",n.style.top="-100px",n.style.backgroundColor=""},c=function n(l){if(i&&0===l.button){var a=(0,B.Z)(i);f.value=a.toHsl().h,p.value=a.toRgb(),y()}document.body.removeChild(t),e.removeEventListener("mousemove",r),e.removeEventListener("mouseleave",u),window.removeEventListener("mousedown",n)};e.addEventListener("mousemove",r),e.addEventListener("mouseleave",u),window.addEventListener("mousedown",c)}}))["catch"]((function(){dl.error("取色吸管初始化失败"),document.body.removeChild(t)}))}};return function(e,t){var n=(0,u.up)("IconNeedle");return(0,u.wg)(),(0,u.iD)("div",Am,[(0,u._)("div",Om,[(0,u.Wm)(Mm,{value:p.value,hue:f.value,onColorChange:t[0]||(t[0]=function(e){return w(e)})},null,8,["value","hue"])]),(0,u._)("div",Pm,[(0,u._)("div",Rm,[(0,u._)("div",{class:"picker-current-color",style:(0,pe.j5)({background:m.value})},null,4),(0,u.Wm)(um)]),(0,u._)("div",Bm,[(0,u._)("div",zm,[(0,u.Wm)(_m,{value:p.value,hue:f.value,onColorChange:t[1]||(t[1]=function(e){return w(e)})},null,8,["value","hue"])]),(0,u._)("div",Nm,[(0,u.Wm)(mm,{value:p.value,onColorChange:t[2]||(t[2]=function(e){return w(e)})},null,8,["value"])])])]),(0,u._)("div",jm,[(0,u.Wm)(Fm,{class:"input",value:p.value,onColorChange:t[3]||(t[3]=function(e){return w(e)})},null,8,["value"]),(0,u._)("div",{class:"straw",onClick:t[4]||(t[4]=function(e){return x()})},[(0,u.Wm)(n)]),(0,u._)("div",{class:"transparent",onClick:t[5]||(t[5]=function(e){return g("#00000000")})},[(0,u.Wm)(um)])]),(0,u._)("div",Ym,[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(s,(function(e){return(0,u._)("div",{class:"picker-presets-color",key:e,style:(0,pe.j5)({background:e}),onClick:function(t){return g(e)}},null,12,Vm)})),64))]),(0,u._)("div",Jm,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(h),(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"picker-gradient-col",key:t},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e,(function(e){return(0,u.wg)(),(0,u.iD)("div",{class:"picker-gradient-color",key:e,style:(0,pe.j5)({background:e}),onClick:function(t){return g(e)}},null,12,qm)})),128))])})),128))]),(0,u._)("div",Xm,[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(d,(function(e){return(0,u._)("div",{key:e,class:"picker-presets-color",style:(0,pe.j5)({background:e}),onClick:function(t){return g(e)}},null,12,Gm)})),64))]),v.value.length?((0,u.wg)(),(0,u.iD)("div",Km,"最近使用：")):(0,u.kq)("",!0),(0,u._)("div",Qm,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(v.value,(function(e){return(0,u.wg)(),(0,u.iD)("div",{key:e,class:"picker-presets-color alpha",onClick:function(t){return g(e)}},[(0,u._)("div",{class:"picker-presets-color-content",style:(0,pe.j5)({background:e})},null,4)],8,$m)})),128))])])}}}),ng=(0,ll.Z)(tg,[["__scopeId","data-v-0712bba8"]]),lg=ng;var ag=function(e){return(0,u.dD)("data-v-0566b060"),e=e(),(0,u.Cn)(),e},og=ag((function(){return(0,u._)("span",{class:"switch-core"},null,-1)})),ig=[og];const rg=(0,u.aZ)({__name:"Switch",props:{value:{type:Boolean},disabled:{type:Boolean,default:!1}},emits:["update:value"],setup:function(e,t){var n=t.emit,l=e,a=n,o=function(){l.disabled||a("update:value",!l.value)};return function(e,t){return(0,u.wg)(),(0,u.iD)("span",{class:(0,pe.C_)(["switch",{active:e.value,disabled:e.disabled}]),onClick:t[0]||(t[0]=function(e){return o()})},ig,2)}}}),ug=(0,ll.Z)(rg,[["__scopeId","data-v-0566b060"]]),cg=ug;var sg=function(e){return(0,u.dD)("data-v-e2cc77f4"),e=e(),(0,u.Cn)(),e},dg={class:"element-outline"},fg={key:0,class:"row"},vg=sg((function(){return(0,u._)("div",{style:{width:"40%"}},"Enable borders:",-1)})),pg={class:"switch-wrapper",style:{width:"60%"}},hg={class:"row"},mg=sg((function(){return(0,u._)("div",{style:{width:"40%"}},"Border style:",-1)})),gg={class:"row"},yg=sg((function(){return(0,u._)("div",{style:{width:"40%"}},"Border color:",-1)})),wg={class:"row"},xg=sg((function(){return(0,u._)("div",{style:{width:"40%"}},"Border thickness:",-1)}));const bg=(0,u.aZ)({__name:"ElementOutline",props:{fixed:{type:Boolean,default:!1}},setup:function(e){var t=V(),n=(0,o.Jk)(t),l=n.theme,a=(0,o.Jk)(X()),i=a.handleElement,r=(0,c.iH)(),s=(0,c.iH)(!1);(0,u.YP)(i,(function(){i.value&&(r.value="outline"in i.value?i.value.outline:void 0,s.value=!!r.value)}),{deep:!0,immediate:!0});var d=_l(),f=d.addHistorySnapshot,v=function(e){if(i.value){var n={outline:(0,g.Z)((0,g.Z)({},r.value),e)};t.updateElement({id:i.value.id,props:n}),f()}},p=function(e){if(i.value){if(e){var n=l.value.outline;t.updateElement({id:i.value.id,props:{outline:n}})}else t.removeElementProps({id:i.value.id,propName:"outline"});f()}};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",dg,[e.fixed?(0,u.kq)("",!0):((0,u.wg)(),(0,u.iD)("div",fg,[vg,(0,u._)("div",pg,[(0,u.Wm)(cg,{value:s.value,"onUpdate:value":t[0]||(t[0]=function(e){return p(e)})},null,8,["value"])])])),s.value&&r.value?((0,u.wg)(),(0,u.iD)(u.HY,{key:1},[(0,u._)("div",hg,[mg,(0,u.Wm)(ov,{style:{width:"60%"},value:r.value.style||"","onUpdate:value":t[1]||(t[1]=function(e){return v({style:e})}),options:[{label:"solid border",value:"solid"},{label:"dashed border",value:"dashed"}]},null,8,["value"])]),(0,u._)("div",gg,[yg,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:r.value.color,"onUpdate:modelValue":t[2]||(t[2]=function(e){return v({color:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:r.value.color||"#000"},null,8,["color"])]})),_:1})]),(0,u._)("div",wg,[xg,(0,u.Wm)(cp,{value:r.value.width||0,"onUpdate:value":t[3]||(t[3]=function(e){return v({width:e})}),style:{width:"60%"}},null,8,["value"])])],64)):(0,u.kq)("",!0)])}}}),kg=(0,ll.Z)(bg,[["__scopeId","data-v-e2cc77f4"]]),_g=kg;var Ig=function(e){return(0,u.dD)("data-v-28c2ce13"),e=e(),(0,u.Cn)(),e},Sg={class:"element-shadow"},Cg={class:"row"},Lg=Ig((function(){return(0,u._)("div",{style:{width:"40%"}},"Enable shadows:",-1)})),Eg={class:"switch-wrapper",style:{width:"60%"}},Zg={class:"row"},Tg=Ig((function(){return(0,u._)("div",{style:{width:"40%"}},"Horizontal shadow:",-1)})),Mg={class:"row"},Ug=Ig((function(){return(0,u._)("div",{style:{width:"40%"}},"Vertical shadow:",-1)})),Wg={class:"row"},Dg=Ig((function(){return(0,u._)("div",{style:{width:"40%"}},"Blur Shadow:",-1)})),Hg={class:"row"},Fg=Ig((function(){return(0,u._)("div",{style:{width:"40%"}},"Shadow color:",-1)}));const Ag=(0,u.aZ)({__name:"ElementShadow",setup:function(e){var t=V(),n=(0,o.Jk)(t),l=n.theme,a=(0,o.Jk)(X()),i=a.handleElement,r=(0,c.iH)(),s=(0,c.iH)(!1);(0,u.YP)(i,(function(){i.value&&(r.value="shadow"in i.value?i.value.shadow:void 0,s.value=!!r.value)}),{deep:!0,immediate:!0});var d=_l(),f=d.addHistorySnapshot,v=function(e){if(i.value&&r.value){var n=(0,g.Z)((0,g.Z)({},r.value),e);t.updateElement({id:i.value.id,props:{shadow:n}}),f()}},p=function(e){if(i.value){if(e){var n=l.value.shadow;t.updateElement({id:i.value.id,props:{shadow:n}})}else t.removeElementProps({id:i.value.id,propName:"shadow"});f()}};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Sg,[(0,u._)("div",Cg,[Lg,(0,u._)("div",Eg,[(0,u.Wm)(cg,{value:s.value,"onUpdate:value":t[0]||(t[0]=function(e){return p(e)})},null,8,["value"])])]),s.value&&r.value?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[(0,u._)("div",Zg,[Tg,(0,u.Wm)(qh,{style:{width:"60%"},min:-10,max:10,step:1,value:r.value.h,"onUpdate:value":t[1]||(t[1]=function(e){return v({h:e})})},null,8,["value"])]),(0,u._)("div",Mg,[Ug,(0,u.Wm)(qh,{style:{width:"60%"},min:-10,max:10,step:1,value:r.value.v,"onUpdate:value":t[2]||(t[2]=function(e){return v({v:e})})},null,8,["value"])]),(0,u._)("div",Wg,[Dg,(0,u.Wm)(qh,{style:{width:"60%"},min:1,max:20,step:1,value:r.value.blur,"onUpdate:value":t[3]||(t[3]=function(e){return v({blur:e})})},null,8,["value"])]),(0,u._)("div",Hg,[Fg,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:r.value.color,"onUpdate:modelValue":t[4]||(t[4]=function(e){return v({color:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:r.value.color},null,8,["color"])]})),_:1})])],64)):(0,u.kq)("",!0)])}}}),Og=(0,ll.Z)(Ag,[["__scopeId","data-v-28c2ce13"]]),Pg=Og;var Rg={class:"text-color-block"};const Bg=(0,u.aZ)({__name:"TextColorButton",props:{color:{}},setup:function(e){return function(e,t){return(0,u.wg)(),(0,u.j4)(Gf,{class:"text-color-btn"},{default:(0,u.w5)((function(){return[(0,u.WI)(e.$slots,"default"),(0,u._)("div",Rg,[(0,u._)("div",{class:"text-color-block-content",style:(0,pe.j5)({backgroundColor:e.color})},null,4)])]})),_:3})}}}),zg=(0,ll.Z)(Bg,[["__scopeId","data-v-37449800"]]),Ng=zg,jg=(0,u.aZ)({__name:"CheckboxButton",props:{checked:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1}},setup:function(e){return function(e,t){return(0,u.wg)(),(0,u.j4)(Gf,{checked:e.checked,disabled:e.disabled,type:"checkbox"},{default:(0,u.w5)((function(){return[(0,u.WI)(e.$slots,"default")]})),_:3},8,["checked","disabled"])}}}),Yg=jg,Vg=Yg,Jg=(0,u.aZ)({__name:"ButtonGroup",props:{passive:{type:Boolean,default:!1}},setup:function(e){return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["button-group",{passive:e.passive}]),ref:"groupRef"},[(0,u.WI)(e.$slots,"default")],2)}}}),qg=(0,ll.Z)(Jg,[["__scopeId","data-v-4db942e2"]]),Xg=qg,Gg=(0,u.aZ)({__name:"RadioButton",props:{value:{},disabled:{type:Boolean,default:!1}},setup:function(e){var t=(0,u.f3)(ko),n=t.value,l=t.updateValue;return function(e,t){return(0,u.wg)(),(0,u.j4)(Gf,{checked:!e.disabled&&(0,c.SU)(n)===e.value,disabled:e.disabled,type:"radio",onClick:t[0]||(t[0]=function(t){return!e.disabled&&(0,c.SU)(l)(e.value)})},{default:(0,u.w5)((function(){return[(0,u.WI)(e.$slots,"default")]})),_:3},8,["checked","disabled"])}}}),Kg=Gg,Qg=Kg,$g=(0,u.aZ)({__name:"RadioGroup",props:{value:{},disabled:{type:Boolean,default:!1}},emits:["update:value"],setup:function(e,t){var n=t.emit,l=e,a=n,o=function(e){l.disabled||a("update:value",e)},i=(0,u.Fl)((function(){return l.value}));return(0,u.JJ)(ko,{value:i,updateValue:o}),function(e,t){return(0,u.wg)(),(0,u.j4)(Xg,{class:"radio-group"},{default:(0,u.w5)((function(){return[(0,u.WI)(e.$slots,"default")]})),_:3})}}}),ey=$g,ty=ey;var ny={class:"select-group"};function ly(e,t){return(0,u.wg)(),(0,u.iD)("div",ny,[(0,u.WI)(e.$slots,"default",{},void 0,!0)])}const ay={},oy=(0,ll.Z)(ay,[["render",ly],["__scopeId","data-v-d2acb09c"]]),iy=oy;var ry=function(e){return(0,u.dD)("data-v-76e7495e"),e=e(),(0,u.Cn)(),e},uy={class:"text-style-panel"},cy={class:"preset-style"},sy=["onClick"],dy={class:"link-popover"},fy={class:"btns"},vy={class:"row",passive:""},py={class:"list-wrap"},hy=["onClick"],my=ry((function(){return(0,u._)("span",null,null,-1)})),gy=[my],yy=ry((function(){return(0,u._)("div",{style:{width:"10px"}},null,-1)})),wy={class:"list-wrap"},xy=["onClick"],by=ry((function(){return(0,u._)("span",null,null,-1)})),ky=[by],_y={class:"row"},Iy=ry((function(){return(0,u._)("div",{style:{width:"10px"}},null,-1)})),Sy={class:"row"},Cy=ry((function(){return(0,u._)("div",{style:{width:"40%"}},"Line spacing:",-1)})),Ly={class:"row"},Ey=ry((function(){return(0,u._)("div",{style:{width:"40%"}},"Paragraph spacing:",-1)})),Zy={class:"row"},Ty=ry((function(){return(0,u._)("div",{style:{width:"40%"}},"Word spacing:",-1)})),My={class:"row"},Uy=ry((function(){return(0,u._)("div",{style:{width:"40%"}},"Text box filling:",-1)}));const Wy=(0,u.aZ)({__name:"TextStylePanel",setup:function(e){var t=[{label:"headline",style:{fontSize:"26px",fontWeight:700},cmd:[{command:"clear"},{command:"bold"},{command:"fontsize",value:"66px"},{command:"align",value:"center"}]},{label:"subtitle",style:{fontSize:"22px",fontWeight:700},cmd:[{command:"clear"},{command:"bold"},{command:"fontsize",value:"40px"},{command:"align",value:"center"}]},{label:"text",style:{fontSize:"20px"},cmd:[{command:"clear"},{command:"fontsize",value:"20px"}]},{label:"Text [small]",style:{fontSize:"18px"},cmd:[{command:"clear"},{command:"fontsize",value:"18px"}]},{label:"Note 1",style:{fontSize:"16px",fontStyle:"italic"},cmd:[{command:"clear"},{command:"fontsize",value:"16px"},{command:"em"}]},{label:"Note 2",style:{fontSize:"16px",textDecoration:"underline"},cmd:[{command:"clear"},{command:"fontsize",value:"16px"},{command:"underline"}]}],n=X(),l=V(),a=(0,o.Jk)(n),i=a.handleElement,r=a.handleElementId,s=a.richTextAttrs,d=a.availableFonts,f=a.textFormatPainter,v=_l(),p=v.addHistorySnapshot,h=Rh(),m=h.toggleTextFormatPainter,g=function(e){l.updateElement({id:r.value,props:e}),p()},y=(0,c.iH)(!1),w=(0,c.iH)(!1),x=(0,c.iH)(!1),b=(0,c.iH)(!1),k=(0,c.iH)(["disc","circle","square"]),_=(0,c.iH)(["decimal","lower-roman","upper-roman","lower-alpha","upper-alpha","lower-greek"]),I=(0,c.iH)("#000"),S=(0,c.iH)(),C=(0,c.iH)(),L=(0,c.iH)();(0,u.YP)(i,(function(){i.value&&"text"===i.value.type&&(I.value=i.value.fill||"#fff",S.value=i.value.lineHeight||1.5,C.value=i.value.wordSpace||0,L.value=void 0===i.value.paragraphSpace?5:i.value.paragraphSpace)}),{deep:!0,immediate:!0});var E=["12px","14px","16px","18px","20px","22px","24px","28px","32px","36px","40px","44px","48px","54px","60px","66px","72px","76px","80px","88px","96px","104px","112px","120px"],Z=[.9,1,1.15,1.2,1.4,1.5,1.8,2,2.5,3],T=[0,1,2,3,4,5,6,8,10],M=[0,5,10,15,20,25,30,40,50,80],U=function(e){g({lineHeight:e})},W=function(e){g({paragraphSpace:e})},D=function(e){g({wordSpace:e})},H=function(e){g({fill:e})},F=function(e,t){Mr.emit(_r.RICH_TEXT_COMMAND,{action:{command:e,value:t}})},A=function(e){Mr.emit(_r.RICH_TEXT_COMMAND,{action:e})},P=(0,c.iH)(""),B=(0,c.iH)(!1);(0,u.YP)(s,(function(){return B.value=!1}));var z=function(){P.value=s.value.link},N=function(e){var t=/^(https?):\/\/[\w\-]+(\.[\w\-]+)+([\w\-.,@?^=%&:\/~+#]*[\w\-@?^=%&\/~+#])?$/;if(!e||!t.test(e))return dl.error("Incorrect web link address");F("link",e),B.value=!1};return function(e,n){var l=(0,u.up)("IconFontSize"),a=(0,u.up)("IconAddText"),o=(0,u.up)("IconText"),i=(0,u.up)("IconHighLight"),r=(0,u.up)("IconTextBold"),v=(0,u.up)("IconTextItalic"),p=(0,u.up)("IconTextUnderline"),h=(0,u.up)("IconStrikethrough"),g=(0,u.up)("IconCode"),j=(0,u.up)("IconQuote"),Y=(0,u.up)("IconFormat"),V=(0,u.up)("IconFormatBrush"),J=(0,u.up)("IconLinkOne"),q=(0,u.up)("IconAlignTextLeft"),X=(0,u.up)("IconAlignTextCenter"),G=(0,u.up)("IconAlignTextRight"),K=(0,u.up)("IconAlignTextBoth"),Q=(0,u.up)("IconList"),$=(0,u.up)("IconDown"),ee=(0,u.up)("IconOrderedList"),te=(0,u.up)("IconIndentLeft"),ne=(0,u.up)("IconIndentRight"),le=(0,u.up)("IconRowHeight"),ae=(0,u.up)("IconVerticalSpacingBetweenItems"),oe=(0,u.up)("IconFullwidth"),ie=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",uy,[(0,u._)("div",cy,[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(t,(function(e){return(0,u._)("div",{class:"preset-style-item",key:e.label,style:(0,pe.j5)(e.style),onClick:function(t){return A(e.cmd)}},(0,pe.zw)(e.label),13,sy)})),64))]),(0,u.Wm)(Ud),(0,u.Wm)(iy,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(ov,{class:"font-select",style:{width:"60%"},value:(0,c.SU)(s).fontname,"onUpdate:value":n[0]||(n[0]=function(e){return F("fontname",e)}),options:[].concat((0,R.Z)((0,c.SU)(d)),(0,R.Z)((0,c.SU)(O)))},{icon:(0,u.w5)((function(){return[(0,u.Wm)(l)]})),_:1},8,["value","options"]),(0,u.Wm)(ov,{style:{width:"40%"},value:(0,c.SU)(s).fontsize,"onUpdate:value":n[1]||(n[1]=function(e){return F("fontsize",e)}),options:E.map((function(e){return{label:e,value:e}}))},{icon:(0,u.w5)((function(){return[(0,u.Wm)(a)]})),_:1},8,["value","options"])]})),_:1}),(0,u.Wm)(Xg,{class:"row",passive:""},{default:(0,u.w5)((function(){return[(0,u.Wm)(lo,{trigger:"click",style:{width:"30%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(s).color,"onUpdate:modelValue":n[2]||(n[2]=function(e){return F("color",e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Ng,{first:"",color:(0,c.SU)(s).color},{default:(0,u.w5)((function(){return[(0,u.Wm)(o)]})),_:1},8,["color"])),[[ie,"text color"]])]})),_:1}),(0,u.Wm)(lo,{trigger:"click",style:{width:"30%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(s).backcolor,"onUpdate:modelValue":n[3]||(n[3]=function(e){return F("backcolor",e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Ng,{color:(0,c.SU)(s).backcolor},{default:(0,u.w5)((function(){return[(0,u.Wm)(i)]})),_:1},8,["color"])),[[ie,"text highlight"]])]})),_:1}),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{class:"font-size-btn",style:{width:"20%"},onClick:n[4]||(n[4]=function(e){return F("fontsize-add")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(l),(0,u.Uk)("+")]})),_:1})),[[ie,"Increase font size"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{last:"",class:"font-size-btn",style:{width:"20%"},onClick:n[5]||(n[5]=function(e){return F("fontsize-reduce")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(l),(0,u.Uk)("-")]})),_:1})),[[ie,"Reduce font size"]])]})),_:1}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).bold,onClick:n[6]||(n[6]=function(e){return F("bold")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(r)]})),_:1},8,["checked"])),[[ie,"Bold"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).em,onClick:n[7]||(n[7]=function(e){return F("em")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(v)]})),_:1},8,["checked"])),[[ie,"italics"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).underline,onClick:n[8]||(n[8]=function(e){return F("underline")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(p)]})),_:1},8,["checked"])),[[ie,"Underline"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).strikethrough,onClick:n[9]||(n[9]=function(e){return F("strikethrough")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(h)]})),_:1},8,["checked"])),[[ie,"strikethrough"]])]})),_:1}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).superscript,onClick:n[10]||(n[10]=function(e){return F("superscript")})},{default:(0,u.w5)((function(){return[(0,u.Uk)("A²")]})),_:1},8,["checked"])),[[ie,"superscript"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).subscript,onClick:n[11]||(n[11]=function(e){return F("subscript")})},{default:(0,u.w5)((function(){return[(0,u.Uk)("A₂")]})),_:1},8,["checked"])),[[ie,"subscript"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).code,onClick:n[12]||(n[12]=function(e){return F("code")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(g)]})),_:1},8,["checked"])),[[ie,"inline code"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).blockquote,onClick:n[13]||(n[13]=function(e){return F("blockquote")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(j)]})),_:1},8,["checked"])),[[ie,"Quote"]])]})),_:1}),(0,u.Wm)(Xg,{class:"row",passive:""},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{first:"",style:{flex:"1"},onClick:n[14]||(n[14]=function(e){return F("clear")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(Y)]})),_:1})),[[ie,"clear format"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:!!(0,c.SU)(f),onClick:n[15]||(n[15]=function(e){return(0,c.SU)(m)()}),onDblclick:n[16]||(n[16]=function(e){return(0,c.SU)(m)(!0)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(V)]})),_:1},8,["checked"])),[[ie,"Format Painter (double-click to use continuously)"]]),(0,u.Wm)(lo,{placement:"bottom-end",trigger:"click",value:B.value,"onUpdate:value":n[21]||(n[21]=function(e){return B.value=e}),style:{width:"33.33%"}},{content:(0,u.w5)((function(){return[(0,u._)("div",dy,[(0,u.Wm)($a,{value:P.value,"onUpdate:value":n[17]||(n[17]=function(e){return P.value=e}),placeholder:"Please enter hyperlink"},null,8,["value"]),(0,u._)("div",fy,[(0,u.Wm)(Gf,{size:"small",disabled:!(0,c.SU)(s).link,onClick:n[18]||(n[18]=function(e){return N()}),style:{"margin-right":"5px"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("Remove")]})),_:1},8,["disabled"]),(0,u.Wm)(Gf,{size:"small",type:"primary",onClick:n[19]||(n[19]=function(e){return N(P.value)})},{default:(0,u.w5)((function(){return[(0,u.Uk)("confirm")]})),_:1})])])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{last:"",style:{width:"100%"},checked:!!(0,c.SU)(s).link,onClick:n[20]||(n[20]=function(e){return z()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(J)]})),_:1},8,["checked"])),[[ie,"Hyperlink"]])]})),_:1},8,["value"])]})),_:1}),(0,u.Wm)(Ud),(0,u.Wm)(ty,{class:"row","button-style":"solid",value:(0,c.SU)(s).align,"onUpdate:value":n[22]||(n[22]=function(e){return F("align",e)})},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"left",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(q)]})),_:1})),[[ie,"Left-aligned"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"center",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(X)]})),_:1})),[[ie,"center"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"right",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(G)]})),_:1})),[[ie,"right-aligned"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"justify",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(K)]})),_:1})),[[ie,"Align both ends"]])]})),_:1},8,["value"]),(0,u._)("div",vy,[(0,u.Wm)(Xg,{style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{first:"",type:(0,c.SU)(s).bulletList?"primary":"default",style:{flex:"1"},onClick:n[23]||(n[23]=function(e){return F("bulletList")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(Q)]})),_:1},8,["type"])),[[ie,"Bullets"]]),(0,u.Wm)(lo,{trigger:"click",value:y.value,"onUpdate:value":n[24]||(n[24]=function(e){return y.value=e})},{content:(0,u.w5)((function(){return[(0,u._)("div",py,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(k.value,(function(e){return(0,u.wg)(),(0,u.iD)("ul",{class:"list",key:e,style:(0,pe.j5)({listStyleType:e}),onClick:function(t){return F("bulletList",e)}},[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(3,(function(e){return(0,u._)("li",{class:"list-item",key:e},gy)})),64))],12,hy)})),128))])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{last:"",class:"popover-btn"},{default:(0,u.w5)((function(){return[(0,u.Wm)($)]})),_:1})]})),_:1},8,["value"])]})),_:1}),yy,(0,u.Wm)(Xg,{style:{flex:"1"},passive:""},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{first:"",type:(0,c.SU)(s).orderedList?"primary":"default",style:{flex:"1"},onClick:n[25]||(n[25]=function(e){return F("orderedList")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(ee)]})),_:1},8,["type"])),[[ie,"Ordered List"]]),(0,u.Wm)(lo,{trigger:"click",value:w.value,"onUpdate:value":n[26]||(n[26]=function(e){return w.value=e})},{content:(0,u.w5)((function(){return[(0,u._)("div",wy,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(_.value,(function(e){return(0,u.wg)(),(0,u.iD)("ul",{class:"list",key:e,style:(0,pe.j5)({listStyleType:e}),onClick:function(t){return F("orderedList",e)}},[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(3,(function(e){return(0,u._)("li",{class:"list-item",key:e},ky)})),64))],12,xy)})),128))])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{last:"",class:"popover-btn"},{default:(0,u.w5)((function(){return[(0,u.Wm)($)]})),_:1})]})),_:1},8,["value"])]})),_:1})]),(0,u._)("div",_y,[(0,u.Wm)(Xg,{style:{flex:"1"},passive:""},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{first:"",style:{flex:"1"},onClick:n[27]||(n[27]=function(e){return F("indent","-1")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(te)]})),_:1})),[[ie,"Reduce paragraph indent"]]),(0,u.Wm)(lo,{trigger:"click",value:x.value,"onUpdate:value":n[29]||(n[29]=function(e){return x.value=e})},{content:(0,u.w5)((function(){return[(0,u.Wm)(io,{onClick:n[28]||(n[28]=function(e){return F("textIndent","-1")})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Reduce first line indent")]})),_:1})]})),default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{last:"",class:"popover-btn"},{default:(0,u.w5)((function(){return[(0,u.Wm)($)]})),_:1})]})),_:1},8,["value"])]})),_:1}),Iy,(0,u.Wm)(Xg,{style:{flex:"1"},passive:""},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{first:"",style:{flex:"1"},onClick:n[30]||(n[30]=function(e){return F("indent","+1")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(ne)]})),_:1})),[[ie,"Increase paragraph indent"]]),(0,u.Wm)(lo,{trigger:"click",value:b.value,"onUpdate:value":n[32]||(n[32]=function(e){return b.value=e})},{content:(0,u.w5)((function(){return[(0,u.Wm)(io,{onClick:n[31]||(n[31]=function(e){return F("textIndent","+1")})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Increase first line indent")]})),_:1})]})),default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{last:"",class:"popover-btn"},{default:(0,u.w5)((function(){return[(0,u.Wm)($)]})),_:1})]})),_:1},8,["value"])]})),_:1})]),(0,u.Wm)(Ud),(0,u._)("div",Sy,[Cy,(0,u.Wm)(ov,{style:{width:"60%"},value:S.value||1,"onUpdate:value":n[33]||(n[33]=function(e){return U(e)}),options:Z.map((function(e){return{label:e+"倍",value:e}}))},{icon:(0,u.w5)((function(){return[(0,u.Wm)(le)]})),_:1},8,["value","options"])]),(0,u._)("div",Ly,[Ey,(0,u.Wm)(ov,{style:{width:"60%"},value:L.value||0,"onUpdate:value":n[34]||(n[34]=function(e){return W(e)}),options:M.map((function(e){return{label:e+"px",value:e}}))},{icon:(0,u.w5)((function(){return[(0,u.Wm)(ae)]})),_:1},8,["value","options"])]),(0,u._)("div",Zy,[Ty,(0,u.Wm)(ov,{style:{width:"60%"},value:C.value||0,"onUpdate:value":n[35]||(n[35]=function(e){return D(e)}),options:T.map((function(e){return{label:e+"px",value:e}}))},{icon:(0,u.w5)((function(){return[(0,u.Wm)(oe)]})),_:1},8,["value","options"])]),(0,u._)("div",My,[Uy,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:I.value,"onUpdate:modelValue":n[36]||(n[36]=function(e){return H(e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:I.value},null,8,["color"])]})),_:1})]),(0,u.Wm)(Ud),(0,u.Wm)(_g),(0,u.Wm)(Ud),(0,u.Wm)(Pg),(0,u.Wm)(Ud),(0,u.Wm)(tm)])}}}),Dy=(0,ll.Z)(Wy,[["__scopeId","data-v-76e7495e"]]),Hy=Dy;var Fy={class:"element-flip"};const Ay=(0,u.aZ)({__name:"ElementFlip",setup:function(e){var t=V(),n=(0,o.Jk)(X()),l=n.handleElement,a=(0,c.iH)(!1),i=(0,c.iH)(!1);(0,u.YP)(l,(function(){!l.value||"image"!==l.value.type&&"shape"!==l.value.type||(a.value=!!l.value.flipH,i.value=!!l.value.flipV)}),{deep:!0,immediate:!0});var r=_l(),s=r.addHistorySnapshot,d=function(e){l.value&&(t.updateElement({id:l.value.id,props:e}),s())};return function(e,t){var n=(0,u.up)("IconFlipVertically"),l=(0,u.up)("IconFlipHorizontally");return(0,u.wg)(),(0,u.iD)("div",Fy,[(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Vg,{style:{flex:"1"},checked:i.value,onClick:t[0]||(t[0]=function(e){return d({flipV:!i.value})})},{default:(0,u.w5)((function(){return[(0,u.Wm)(n),(0,u.Uk)(" flip vertically")]})),_:1},8,["checked"]),(0,u.Wm)(Vg,{style:{flex:"1"},checked:a.value,onClick:t[1]||(t[1]=function(e){return d({flipH:!a.value})})},{default:(0,u.w5)((function(){return[(0,u.Wm)(l),(0,u.Uk)(" horizontal flip")]})),_:1},8,["checked"])]})),_:1})])}}}),Oy=(0,ll.Z)(Ay,[["__scopeId","data-v-3d6d86f2"]]),Py=Oy;var Ry=function(e){return(0,u.dD)("data-v-1d548436"),e=e(),(0,u.Cn)(),e},By={class:"element-filter"},zy={class:"row"},Ny=Ry((function(){return(0,u._)("div",{style:{flex:"2"}},"Enable filters:",-1)})),jy={class:"switch-wrapper",style:{flex:"3"}},Yy={key:0,class:"filter"},Vy={class:"name"};const Jy=(0,u.aZ)({__name:"ElementFilter",setup:function(e){var t=[{label:"blur",key:"blur",default:0,value:0,unit:"px",max:10,step:1},{label:"brightness",key:"brightness",default:100,value:100,unit:"%",max:200,step:5},{label:"contrast",key:"contrast",default:100,value:100,unit:"%",max:200,step:5},{label:"Grayscale",key:"grayscale",default:0,value:0,unit:"%",max:100,step:5},{label:"saturate",key:"saturate",default:100,value:100,unit:"%",max:200,step:5},{label:"hue",key:"hue-rotate",default:0,value:0,unit:"deg",max:360,step:10},{label:"opacity",key:"opacity",default:100,value:100,unit:"%",max:100,step:5}],n=V(),l=(0,o.Jk)(X()),a=l.handleElement,i=l.handleElementId,r=(0,c.iH)(JSON.parse(JSON.stringify(t))),s=(0,c.iH)(!1),d=_l(),f=d.addHistorySnapshot;(0,u.YP)(a,(function(){if(a.value&&"image"===a.value.type){var e=a.value.filters;e?(r.value=t.map((function(t){var n=e[t.key];return n?(0,g.Z)((0,g.Z)({},t),{},{value:parseInt(n)}):t})),s.value=!0):(r.value=JSON.parse(JSON.stringify(t)),s.value=!1)}}),{deep:!0,immediate:!0});var v=function(e,t){var l=a.value,o=l.filters||{},r=(0,g.Z)((0,g.Z)({},o),{},(0,te.Z)({},e.key,"".concat(t).concat(e.unit)));n.updateElement({id:i.value,props:{filters:r}}),f()},p=function(e){a.value&&(e?n.updateElement({id:a.value.id,props:{filters:{}}}):n.removeElementProps({id:a.value.id,propName:"filters"}),f())};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",By,[(0,u._)("div",zy,[Ny,(0,u._)("div",jy,[(0,u.Wm)(cg,{value:s.value,"onUpdate:value":t[0]||(t[0]=function(e){return p(e)})},null,8,["value"])])]),s.value?((0,u.wg)(),(0,u.iD)("div",Yy,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(r.value,(function(e){return(0,u.wg)(),(0,u.iD)("div",{class:"filter-item",key:e.key},[(0,u._)("div",Vy,(0,pe.zw)(e.label),1),(0,u.Wm)(qh,{class:"filter-slider",max:e.max,min:0,step:e.step,value:e.value,"onUpdate:value":function(t){return v(e,t)}},null,8,["max","step","value","onUpdate:value"])])})),128))])):(0,u.kq)("",!0)])}}}),qy=(0,ll.Z)(Jy,[["__scopeId","data-v-1d548436"]]),Xy=qy;var Gy=function(e){return(0,u.dD)("data-v-0f5fa619"),e=e(),(0,u.Cn)(),e},Ky={class:"element-color-mask"},Qy={class:"row"},$y=Gy((function(){return(0,u._)("div",{style:{width:"40%"}},"Shading (mask)：",-1)})),ew={class:"switch-wrapper",style:{width:"60%"}},tw={key:0,class:"row",style:{"margin-top":"15px"}},nw=Gy((function(){return(0,u._)("div",{style:{width:"40%"}},"Mask color:",-1)})),lw="rgba(226, 83, 77, 0.5)";const aw=(0,u.aZ)({__name:"ElementColorMask",setup:function(e){var t=V(),n=(0,o.Jk)(X()),l=n.handleElement,a=n.handleElementId,i=(0,c.iH)(lw),r=(0,c.iH)(!1),s=_l(),d=s.addHistorySnapshot;(0,u.YP)(l,(function(){l.value&&"image"===l.value.type&&(l.value.colorMask?(i.value=l.value.colorMask,r.value=!0):r.value=!1)}),{deep:!0,immediate:!0});var f=function(e){l.value&&(e?t.updateElement({id:l.value.id,props:{colorMask:lw}}):t.removeElementProps({id:l.value.id,propName:"colorMask"}),d())},v=function(e){t.updateElement({id:a.value,props:{colorMask:e}}),d()};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Ky,[(0,u._)("div",Qy,[$y,(0,u._)("div",ew,[(0,u.Wm)(cg,{value:r.value,"onUpdate:value":t[0]||(t[0]=function(e){return f(e)})},null,8,["value"])])]),r.value?((0,u.wg)(),(0,u.iD)("div",tw,[nw,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:i.value,"onUpdate:modelValue":t[1]||(t[1]=function(e){return v(e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:i.value},null,8,["color"])]})),_:1})])):(0,u.kq)("",!0)])}}}),ow=(0,ll.Z)(aw,[["__scopeId","data-v-0f5fa619"]]),iw=ow;var rw=function(e){return(0,u.dD)("data-v-be4f0848"),e=e(),(0,u.Cn)(),e},uw={class:"image-style-panel"},cw={class:"clip"},sw=rw((function(){return(0,u._)("div",{class:"title"},"By shape:",-1)})),dw={class:"shape-clip"},fw=["onClick"],vw={key:0,class:"title"};const pw=(0,u.aZ)({__name:"ImageStylePanel",setup:function(e){var t=jo,n=[{label:"aspect ratio (square)",children:[{key:"1:1",ratio:1}]},{label:"aspect ratio (vertical)",children:[{key:"2:3",ratio:1.5},{key:"3:4",ratio:4/3},{key:"3:5",ratio:5/3},{key:"4:5",ratio:5/4}]},{label:"aspect ratio (horizontal)",children:[{key:"3:2",ratio:2/3},{key:"4:3",ratio:3/4},{key:"5:3",ratio:.6},{key:"5:4",ratio:.8}]},{children:[{key:"16:9",ratio:9/16},{key:"16:10",ratio:.625}]}],l=X(),a=V(),i=(0,o.Jk)(l),r=i.handleElement,s=i.handleElementId,d=(0,o.Jk)(a),f=d.currentSlide,v=r,p=(0,c.iH)(!1),h=_l(),m=h.addHistorySnapshot,y=function(){l.setClipingImageElementId(s.value),p.value=!1},w=function(){var e=r.value,t=e.width,n=e.height,l=e.left,a=e.top,o=e.clip?e.clip.range:[[0,0],[100,100]],i=t/((o[1][0]-o[0][0])/100),u=n/((o[1][1]-o[0][1])/100),c=l-i*(o[0][0]/100),s=a-u*(o[0][1]/100);return{originClipRange:o,originWidth:i,originHeight:u,originLeft:c,originTop:s}},x=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=r.value,l=w(),o=l.originClipRange,i=l.originWidth,u=l.originHeight,c=l.originLeft,d=l.originTop;if(t){var f,v=u/i,p=0,h=100;if(v>t){var x=(1-t/v)/2*100;f=[[p,x],[h,h-x]]}else{var b=(1-v/t)/2*100;f=[[b,p],[h-b,h]]}a.updateElement({id:s.value,props:{clip:(0,g.Z)((0,g.Z)({},n.clip),{},{shape:e,range:f}),left:c+i*(f[0][0]/100),top:d+u*(f[0][1]/100),width:i*(f[1][0]-f[0][0])/100,height:u*(f[1][1]-f[0][1])/100}})}else a.updateElement({id:s.value,props:{clip:(0,g.Z)((0,g.Z)({},n.clip),{},{shape:e,range:o})}});y(),m()},b=function(e){var t=e[0];t&&(yl(t).then((function(e){var t={src:e};a.updateElement({id:s.value,props:t})})),m())},k=function(){var e=r.value;if(e.clip){var t=w(),n=t.originWidth,l=t.originHeight,o=t.originLeft,i=t.originTop;a.updateElement({id:s.value,props:{left:o,top:i,width:n,height:l}})}a.removeElementProps({id:s.value,propName:["clip","outline","flip","shadow","filters","colorMask"]}),m()},_=function(){var e=r.value,t=(0,g.Z)((0,g.Z)({},f.value.background),{},{type:"image",image:e.src,imageSize:"cover"});a.updateSlide({background:t}),m()};return function(e,l){var a=(0,u.up)("IconTailoring"),o=(0,u.up)("IconDown"),i=(0,u.up)("IconTransform"),r=(0,u.up)("IconUndo"),s=(0,u.up)("IconTheme");return(0,u.wg)(),(0,u.iD)("div",uw,[(0,u._)("div",{class:"origin-image",style:(0,pe.j5)({backgroundImage:"url(".concat((0,c.SU)(v).src,")")})},null,4),(0,u.Wm)(Py),(0,u.Wm)(Xg,{class:"row",passive:""},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{first:"",style:{width:"calc(100% / 6 * 5)"},onClick:l[0]||(l[0]=function(e){return y()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(a,{class:"btn-icon"}),(0,u.Uk)(" 裁剪图片")]})),_:1}),(0,u.Wm)(lo,{trigger:"click",value:p.value,"onUpdate:value":l[1]||(l[1]=function(e){return p.value=e}),style:{width:"calc(100% / 6)"}},{content:(0,u.w5)((function(){return[(0,u._)("div",cw,[sw,(0,u._)("div",dw,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(t),(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"shape-clip-item",key:t,onClick:function(e){return x(t)}},[(0,u._)("div",{class:"shape",style:(0,pe.j5)({clipPath:e.style})},null,4)],8,fw)})),128))]),((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(n,(function(e){return(0,u.wg)(),(0,u.iD)(u.HY,{key:e.label},[e.label?((0,u.wg)(),(0,u.iD)("div",vw," Press "+(0,pe.zw)(e.label)+"： ",1)):(0,u.kq)("",!0),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.children,(function(e){return(0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},key:e.key,onClick:function(t){return x("rect",e.ratio)}},{default:(0,u.w5)((function(){return[(0,u.Uk)((0,pe.zw)(e.key),1)]})),_:2},1032,["onClick"])})),128))]})),_:2},1024)],64)})),64))])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{last:"",class:"popover-btn",style:{width:"100%"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(o)]})),_:1})]})),_:1},8,["value"])]})),_:1}),(0,u.Wm)(Ud),(0,u.Wm)(iw),(0,u.Wm)(Ud),(0,u.Wm)(Xy),(0,u.Wm)(Ud),(0,u.Wm)(_g),(0,u.Wm)(Ud),(0,u.Wm)(Pg),(0,u.Wm)(Ud),(0,u.Wm)(hh,{onChange:l[2]||(l[2]=function(e){return b(e)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{class:"full-width-btn"},{default:(0,u.w5)((function(){return[(0,u.Wm)(i,{class:"btn-icon"}),(0,u.Uk)(" 替换图片")]})),_:1})]})),_:1}),(0,u.Wm)(Gf,{class:"full-width-btn",onClick:l[3]||(l[3]=function(e){return k()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(r,{class:"btn-icon"}),(0,u.Uk)(" 重置样式")]})),_:1}),(0,u.Wm)(Gf,{class:"full-width-btn",onClick:l[4]||(l[4]=function(e){return _()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(s,{class:"btn-icon"}),(0,u.Uk)(" 设为背景")]})),_:1})])}}}),hw=(0,ll.Z)(pw,[["__scopeId","data-v-be4f0848"]]),mw=hw,gw=function(){var e=X(),t=(0,o.Jk)(e),n=t.shapeFormatPainter,l=t.handleElement,a=function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=l.value;n.value?e.setShapeFormatPainter(null):e.setShapeFormatPainter({keep:t,fill:a.fill,gradient:a.gradient,outline:a.outline,opacity:a.opacity,shadow:a.shadow})};return{toggleShapeFormatPainter:a}};var yw=function(e){return(0,u.dD)("data-v-67ef791e"),e=e(),(0,u.Cn)(),e},ww={class:"shape-style-panel"},xw={class:"title"},bw=yw((function(){return(0,u._)("span",null,"Click to replace shape",-1)})),kw={class:"shape-pool"},_w={class:"shape-list"},Iw={class:"row"},Sw=yw((function(){return(0,u._)("div",{style:{width:"10px"}},null,-1)})),Cw={class:"row"},Lw=yw((function(){return(0,u._)("div",{style:{width:"40%"}},"Starting point color: ",-1)})),Ew={class:"row"},Zw=yw((function(){return(0,u._)("div",{style:{width:"40%"}},"End color: ",-1)})),Tw={key:0,class:"row"},Mw=yw((function(){return(0,u._)("div",{style:{width:"40%"}},"Gradient angle:",-1)})),Uw={class:"row"};const Ww=(0,u.aZ)({__name:"ShapeStylePanel",setup:function(e){var t=X(),n=V(),l=(0,o.Jk)(t),a=l.handleElement,i=l.handleElementId,r=l.richTextAttrs,s=l.availableFonts,d=l.textFormatPainter,f=l.shapeFormatPainter,v=a,p=(0,c.iH)("#000"),h=(0,c.iH)({type:"linear",rotate:0,color:["#fff","#fff"]}),m=(0,c.iH)("fill"),y=(0,c.iH)("middle");(0,u.YP)(a,(function(){var e;a.value&&"shape"===a.value.type&&(p.value=a.value.fill||"#fff",h.value=a.value.gradient||{type:"linear",rotate:0,color:[p.value,"#fff"]},m.value=a.value.gradient?"gradient":"fill",y.value=(null===(e=a.value)||void 0===e||null===(e=e.text)||void 0===e?void 0:e.align)||"middle")}),{deep:!0,immediate:!0});var w=_l(),x=w.addHistorySnapshot,b=Rh(),k=b.toggleTextFormatPainter,_=gw(),I=_.toggleShapeFormatPainter,S=function(e){n.updateElement({id:i.value,props:e}),x()},C=function(e){"fill"===e?(n.removeElementProps({id:i.value,propName:"gradient"}),x()):S({gradient:h.value})},L=function(e){if(h.value){var t=(0,g.Z)((0,g.Z)({},h.value),e);S({gradient:t})}},E=function(e){S({fill:e})},Z=function(e){var t=a.value,n=t.width,l=t.height,o={viewBox:e.viewBox,path:e.path,special:e.special};if(e.pathFormula){o.pathFormula=e.pathFormula,o.viewBox=[n,l];var i=xl[e.pathFormula];"editable"in i?(o.path=i.formula(n,l,i.defaultValue),o.keypoint=i.defaultValue):o.path=i.formula(n,l)}else o.pathFormula=void 0,o.keypoint=void 0;S(o)},T=function(e){var t=a.value,n={content:"",defaultFontName:"Microsoft Yahei",defaultColor:"#000",align:"middle"},l=t.text||n;S({text:(0,g.Z)((0,g.Z)({},l),{},{align:e})})},M=["12px","14px","16px","18px","20px","22px","24px","28px","32px","36px","40px","44px","48px","54px","60px","66px","72px","76px","80px","88px","96px","104px","112px","120px"],U=function(e,t){Mr.emit(_r.RICH_TEXT_COMMAND,{action:{command:e,value:t}})};return function(e,t){var n,l=(0,u.up)("IconDown"),a=(0,u.up)("IconFontSize"),o=(0,u.up)("IconAddText"),i=(0,u.up)("IconText"),g=(0,u.up)("IconHighLight"),w=(0,u.up)("IconTextBold"),x=(0,u.up)("IconTextItalic"),b=(0,u.up)("IconTextUnderline"),_=(0,u.up)("IconStrikethrough"),S=(0,u.up)("IconFormat"),W=(0,u.up)("IconFormatBrush"),D=(0,u.up)("IconAlignTextLeft"),H=(0,u.up)("IconAlignTextCenter"),F=(0,u.up)("IconAlignTextRight"),A=(0,u.up)("IconAlignTextTopOne"),P=(0,u.up)("IconAlignTextMiddleOne"),B=(0,u.up)("IconAlignTextBottomOne"),z=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",ww,[(0,u._)("div",xw,[bw,(0,u.Wm)(l)]),(0,u._)("div",kw,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(bl),(function(e){return(0,u.wg)(),(0,u.iD)("div",{class:"category",key:e.type},[(0,u._)("div",_w,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.children,(function(e,t){return(0,u.wg)(),(0,u.iD)(u.HY,null,["arbitrary polygon"!==e.title?((0,u.wg)(),(0,u.j4)(Zv,{class:"shape-item",key:t,shape:e,onClick:function(t){return Z(e)}},null,8,["shape","onClick"])):(0,u.kq)("",!0)],64)})),256))])])})),128))]),(0,u._)("div",Iw,[(0,u.Wm)(ov,{style:{flex:"1"},value:m.value,"onUpdate:value":t[0]||(t[0]=function(e){return C(e)}),options:[{label:"Solid color fill",value:"fill"},{label:"gradient fill",value:"gradient"}]},null,8,["value"]),Sw,"fill"===m.value?((0,u.wg)(),(0,u.j4)(lo,{key:0,trigger:"click",style:{flex:"1"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:p.value,"onUpdate:modelValue":t[1]||(t[1]=function(e){return E(e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:p.value},null,8,["color"])]})),_:1})):((0,u.wg)(),(0,u.j4)(ov,{key:1,style:{flex:"1"},value:h.value.type,"onUpdate:value":t[2]||(t[2]=function(e){return L({type:e})}),options:[{label:"linear gradient",value:"linear"},{label:"radial gradient",value:"radial"}]},null,8,["value"]))]),"gradient"===m.value?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[(0,u._)("div",Cw,[Lw,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:h.value.color[0],"onUpdate:modelValue":t[3]||(t[3]=function(e){return L({color:[e,h.value.color[1]]})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:h.value.color[0]},null,8,["color"])]})),_:1})]),(0,u._)("div",Ew,[Zw,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:h.value.color[1],"onUpdate:modelValue":t[4]||(t[4]=function(e){return L({color:[h.value.color[0],e]})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:h.value.color[1]},null,8,["color"])]})),_:1})]),"linear"===h.value.type?((0,u.wg)(),(0,u.iD)("div",Tw,[Mw,(0,u.Wm)(qh,{style:{width:"60%"},min:0,max:360,step:15,value:h.value.rotate,"onUpdate:value":t[5]||(t[5]=function(e){return L({rotate:e})})},null,8,["value"])])):(0,u.kq)("",!0)],64)):(0,u.kq)("",!0),(0,u.Wm)(Py),(0,u.Wm)(Ud),null!==(n=(0,c.SU)(v).text)&&void 0!==n&&n.content?((0,u.wg)(),(0,u.iD)(u.HY,{key:1},[(0,u.Wm)(iy,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(ov,{class:"font-select",style:{width:"60%"},value:(0,c.SU)(r).fontname,"onUpdate:value":t[6]||(t[6]=function(e){return U("fontname",e)}),options:[].concat((0,R.Z)((0,c.SU)(s)),(0,R.Z)((0,c.SU)(O)))},{icon:(0,u.w5)((function(){return[(0,u.Wm)(a)]})),_:1},8,["value","options"]),(0,u.Wm)(ov,{style:{width:"40%"},value:(0,c.SU)(r).fontsize,"onUpdate:value":t[7]||(t[7]=function(e){return U("fontsize",e)}),options:M.map((function(e){return{label:e,value:e}}))},{icon:(0,u.w5)((function(){return[(0,u.Wm)(o)]})),_:1},8,["value","options"])]})),_:1}),(0,u.Wm)(Xg,{class:"row",passive:""},{default:(0,u.w5)((function(){return[(0,u.Wm)(lo,{trigger:"click",style:{width:"30%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(r).color,"onUpdate:modelValue":t[8]||(t[8]=function(e){return U("color",e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Ng,{first:"",color:(0,c.SU)(r).color},{default:(0,u.w5)((function(){return[(0,u.Wm)(i)]})),_:1},8,["color"])),[[z,"text color"]])]})),_:1}),(0,u.Wm)(lo,{trigger:"click",style:{width:"30%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(r).backcolor,"onUpdate:modelValue":t[9]||(t[9]=function(e){return U("backcolor",e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Ng,{color:(0,c.SU)(r).backcolor},{default:(0,u.w5)((function(){return[(0,u.Wm)(g)]})),_:1},8,["color"])),[[z,"text highlight"]])]})),_:1}),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{class:"font-size-btn",style:{width:"20%"},onClick:t[10]||(t[10]=function(e){return U("fontsize-add")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(a),(0,u.Uk)("+")]})),_:1})),[[z,"Increase font size"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{last:"",class:"font-size-btn",style:{width:"20%"},onClick:t[11]||(t[11]=function(e){return U("fontsize-reduce")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(a),(0,u.Uk)("-")]})),_:1})),[[z,"Reduce font size"]])]})),_:1}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(r).bold,onClick:t[12]||(t[12]=function(e){return U("bold")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(w)]})),_:1},8,["checked"])),[[z,"Bold"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(r).em,onClick:t[13]||(t[13]=function(e){return U("em")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(x)]})),_:1},8,["checked"])),[[z,"italics"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(r).underline,onClick:t[14]||(t[14]=function(e){return U("underline")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(b)]})),_:1},8,["checked"])),[[z,"Underline"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:(0,c.SU)(r).strikethrough,onClick:t[15]||(t[15]=function(e){return U("strikethrough")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(_)]})),_:1},8,["checked"])),[[z,"strikethrough"]])]})),_:1}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},onClick:t[16]||(t[16]=function(e){return U("clear")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(S)]})),_:1})),[[z,"clear format"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:!!(0,c.SU)(d),onClick:t[17]||(t[17]=function(e){return(0,c.SU)(k)()}),onDblclick:t[18]||(t[18]=function(e){return(0,c.SU)(k)(!0)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(W)]})),_:1},8,["checked"])),[[z,"Format Painter (double-click to use continuously)"]])]})),_:1}),(0,u.Wm)(Ud),(0,u.Wm)(ty,{class:"row","button-style":"solid",value:(0,c.SU)(r).align,"onUpdate:value":t[19]||(t[19]=function(e){return U("align",e)})},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"left",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(D)]})),_:1})),[[z,"Left-aligned"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"center",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(H)]})),_:1})),[[z,"center"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"right",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(F)]})),_:1})),[[z,"right-aligned"]])]})),_:1},8,["value"]),(0,u.Wm)(ty,{class:"row","button-style":"solid",value:y.value,"onUpdate:value":t[20]||(t[20]=function(e){return T(e)})},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"top",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(A)]})),_:1})),[[z,"Top alignment"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"middle",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(P)]})),_:1})),[[z,"center"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"bottom",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(B)]})),_:1})),[[z,"bottom-aligned"]])]})),_:1},8,["value"]),(0,u.Wm)(Ud)],64)):(0,u.kq)("",!0),(0,u.Wm)(_g),(0,u.Wm)(Ud),(0,u.Wm)(Pg),(0,u.Wm)(Ud),(0,u.Wm)(tm),(0,u.Wm)(Ud),(0,u._)("div",Uw,[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:!!(0,c.SU)(f),onClick:t[21]||(t[21]=function(e){return(0,c.SU)(I)()}),onDblclick:t[22]||(t[22]=function(e){return(0,c.SU)(I)(!0)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(W),(0,u.Uk)(" Shape Format Painter")]})),_:1},8,["checked"])),[[z,"Double click to use continuously"]])])])}}}),Dw=(0,ll.Z)(Ww,[["__scopeId","data-v-67ef791e"]]),Hw=Dw;var Fw=function(e){return(0,u.dD)("data-v-35f3f4ee"),e=e(),(0,u.Cn)(),e},Aw={class:"line-style-panel"},Ow={class:"row"},Pw=Fw((function(){return(0,u._)("div",{style:{width:"40%"}},"Line style:",-1)})),Rw={class:"row"},Bw=Fw((function(){return(0,u._)("div",{style:{width:"40%"}},"Line color:",-1)})),zw={class:"row"},Nw=Fw((function(){return(0,u._)("div",{style:{width:"40%"}},"Line width:",-1)})),jw={class:"row"},Yw=Fw((function(){return(0,u._)("div",{style:{width:"40%"}},"Starting point style:",-1)})),Vw={class:"row"},Jw=Fw((function(){return(0,u._)("div",{style:{width:"40%"}},"End point style:",-1)}));const qw=(0,u.aZ)({__name:"LineStylePanel",setup:function(e){var t=V(),n=(0,o.Jk)(X()),l=n.handleElement,a=l,i=_l(),r=i.addHistorySnapshot,s=function(e){l.value&&(t.updateElement({id:l.value.id,props:e}),r())};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Aw,[(0,u._)("div",Ow,[Pw,(0,u.Wm)(ov,{style:{width:"60%"},value:(0,c.SU)(a).style,"onUpdate:value":t[0]||(t[0]=function(e){return s({style:e})}),options:[{label:"solid",value:"solid"},{label:"dashed",value:"dashed"}]},null,8,["value"])]),(0,u._)("div",Rw,[Bw,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(a).color,"onUpdate:modelValue":t[1]||(t[1]=function(e){return s({color:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:(0,c.SU)(a).color},null,8,["color"])]})),_:1})]),(0,u._)("div",zw,[Nw,(0,u.Wm)(cp,{value:(0,c.SU)(a).width,"onUpdate:value":t[2]||(t[2]=function(e){return s({width:e})}),style:{width:"60%"}},null,8,["value"])]),(0,u._)("div",jw,[Yw,(0,u.Wm)(ov,{style:{width:"60%"},value:(0,c.SU)(a).points[0],"onUpdate:value":t[3]||(t[3]=function(e){return s({points:[e,(0,c.SU)(a).points[1]]})}),options:[{label:"None",value:""},{label:"arrow",value:"arrow"},{label:"dot",value:"dot"}]},null,8,["value"])]),(0,u._)("div",Vw,[Jw,(0,u.Wm)(ov,{style:{width:"60%"},value:(0,c.SU)(a).points[1],"onUpdate:value":t[4]||(t[4]=function(e){return s({points:[(0,c.SU)(a).points[0],e]})}),options:[{label:"None",value:""},{label:"arrow",value:"arrow"},{label:"dot",value:"dot"}]},null,8,["value"])]),(0,u.Wm)(Ud),(0,u.Wm)(Pg)])}}}),Xw=(0,ll.Z)(qw,[["__scopeId","data-v-35f3f4ee"]]),Gw=Xw;var Kw={class:"chart-data-editor"},Qw={class:"editor-content"},$w={class:"range-box"},ex=["id","onFocus","onPaste"],tx={class:"btns"},nx={class:"left"},lx={class:"right"},ax=100,ox=32;const ix=(0,u.aZ)({__name:"ChartDataEditor",props:{data:{}},emits:["save","close"],setup:function(e,t){var n=t.emit,l=e,o=n,i=(0,c.iH)([0,0]),r=(0,c.iH)({width:0,height:0}),s=(0,c.iH)(null),d=(0,u.Fl)((function(){var e=i.value[0]*ax,t=i.value[1]*ox;return[{type:"t",style:{width:e+"px"}},{type:"b",style:{top:t+"px",width:e+"px"}},{type:"l",style:{height:t+"px"}},{type:"r",style:{left:e+"px",height:t+"px"}}]})),f=(0,u.Fl)((function(){var e=i.value[0]*ax,t=i.value[1]*ox;return{left:e+"px",top:t+"px"}})),v=function(){var e=[],t=l.data,n=t.labels,a=t.legends,o=t.series,r=n.length,u=o.length;e.push([""].concat((0,R.Z)(a)));for(var c=0;c<r;c++){for(var s=[n[c]],d=0;d<u;d++)s.push(o[d][c]+"");e.push(s)}for(var f=0;f<r+1;f++)for(var v=0;v<u+1;v++){var p=document.querySelector("#cell-".concat(f,"-").concat(v));p&&(p.value=e[f][v]+"")}i.value=[u+1,r+1]};(0,u.bv)(v);var p=function(){if(s.value){var e=(0,ne.Z)(s.value,2),t=e[0],n=e[1],l=document.querySelector("#cell-".concat(t+1,"-").concat(n));l&&l.focus()}},h=function(e){var t=e.key.toUpperCase();t===m.ENTER&&p()};(0,u.bv)((function(){document.addEventListener("keydown",h)})),(0,u.Ah)((function(){document.removeEventListener("keydown",h)}));var g=function(){for(var e=(0,ne.Z)(i.value,2),t=e[0],n=e[1],l=[],a=[],r=[],u=1;u<n;u++){var c="category".concat(u),s=document.querySelector("#cell-".concat(u,"-0"));s&&s.value&&(c=s.value),l.push(c)}for(var d=1;d<t;d++){var f="series".concat(d),v=document.querySelector("#cell-0-".concat(d));v&&v.value&&(f=v.value),a.push(f)}for(var p=1;p<t;p++){for(var h=[],m=1;m<n;m++){var g=document.querySelector("#cell-".concat(m,"-").concat(p)),y=0;g&&g.value&&+g.value&&(y=+g.value),h.push(y)}r.push(h)}o("save",{labels:l,legends:a,series:r})},y=function(){for(var e=1;e<31;e++)for(var t=1;t<7;t++){var n=document.querySelector("#cell-".concat(e,"-").concat(t));n&&(n.value="")}},w=function(e,t,n){if(e.preventDefault(),e.clipboardData){var l=e.clipboardData.items[0];l&&"string"===l.kind&&"text/plain"===l.type&&l.getAsString((function(e){var l=Se(e);if("object"!==(0,hl.Z)(l)){var a=Ce(e);if(a)for(var o=t+a.length,i=n+a[0].length,r=t;r<o;r++)for(var u=n;u<i;u++){var c=document.querySelector("#cell-".concat(r,"-").concat(u));c&&(c.value=a[r-t][u-n])}}}))}},x=function(){return o("close")},b=function(e){var t=!0,n=e.pageX,l=e.pageY,a=i.value[0]*ax,o=i.value[1]*ox;document.onmousemove=function(e){if(t){var i=e.pageX,u=e.pageY,c=i-n,s=u-l,d=a+c,f=o+s;r.value={width:d,height:f}}},document.onmouseup=function(e){t=!1,document.onmousemove=null,document.onmouseup=null;var a=e.pageX,o=e.pageY;if(n!==a||l!==o){var u=r.value.width,c=r.value.height;u%ax>.5*ax&&(u+=ax-u%ax),c%ox>.5*ox&&(c+=ox-c%ox);var s=Math.round(c/ox),d=Math.round(u/ax);s<3&&(s=3),d<2&&(d=2),i.value=[d,s],r.value={width:0,height:0}}}};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Kw,[(0,u._)("div",Qw,[(0,u._)("div",$w,[(0,u._)("div",{class:"temp-range",style:(0,pe.j5)({width:r.value.width+"px",height:r.value.height+"px"})},null,4),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(d.value,(function(e){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["range-line",e.type]),key:e.type,style:(0,pe.j5)(e.style)},null,6)})),128)),(0,u._)("div",{class:"resizable",style:(0,pe.j5)(f.value),onMousedown:t[0]||(t[0]=(0,a.iM)((function(e){return b(e)}),["stop"]))},null,36)]),(0,u._)("table",null,[(0,u._)("tbody",null,[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(31,(function(e){return(0,u._)("tr",{key:e},[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(7,(function(t){return(0,u._)("td",{key:t,class:(0,pe.C_)({head:1===t&&e<=i.value[1]||1===e&&t<=i.value[0]})},[(0,u._)("input",{class:(0,pe.C_)(["item",{selected:e<=i.value[1]&&t<=i.value[0]}]),id:"cell-".concat(e-1,"-").concat(t-1),autocomplete:"off",onFocus:function(n){return s.value=[e-1,t-1]},onPaste:function(n){return w(n,e-1,t-1)}},null,42,ex)],2)})),64))])})),64))])])]),(0,u._)("div",tx,[(0,u._)("div",nx,[(0,u.Wm)(Gf,{class:"btn",onClick:t[1]||(t[1]=function(e){return y()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Clear")]})),_:1})]),(0,u._)("div",lx,[(0,u.Wm)(Gf,{class:"btn",onClick:t[2]||(t[2]=function(e){return x()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Close")]})),_:1}),(0,u.Wm)(Gf,{type:"primary",class:"btn",onClick:t[3]||(t[3]=function(e){return g()}),style:{"margin-left":"10px"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("确认")]})),_:1})])])])}}}),rx=(0,ll.Z)(ix,[["__scopeId","data-v-72084078"]]),ux=rx;var cx=function(e){return(0,u.dD)("data-v-26bf4835"),e=e(),(0,u.Cn)(),e},sx=cx((function(){return(0,u._)("span",{class:"checkbox-input"},null,-1)})),dx=cx((function(){return(0,u._)("input",{class:"checkbox-original",type:"checkbox"},null,-1)})),fx={class:"checkbox-label"};const vx=(0,u.aZ)({__name:"Checkbox",props:{value:{type:Boolean},disabled:{type:Boolean,default:!1}},emits:["update:value"],setup:function(e,t){var n=t.emit,l=e,a=n,o=function(e){l.disabled||a("update:value",e.target.checked)};return function(e,t){return(0,u.wg)(),(0,u.iD)("label",{class:(0,pe.C_)(["checkbox",{checked:e.value,disabled:e.disabled}]),onChange:t[0]||(t[0]=function(e){return o(e)})},[sx,dx,(0,u._)("span",fx,[(0,u.WI)(e.$slots,"default")])],34)}}}),px=(0,ll.Z)(vx,[["__scopeId","data-v-26bf4835"]]),hx=px;var mx=function(e){return(0,u.dD)("data-v-301c29c5"),e=e(),(0,u.Cn)(),e},gx={class:"chart-style-panel"},yx={class:"row"},wx={class:"row"},xx={key:1,class:"row"},bx={key:2,class:"row"},kx={class:"row"},_x=mx((function(){return(0,u._)("div",{style:{width:"40%"}},"legend:",-1)})),Ix={class:"row"},Sx=mx((function(){return(0,u._)("div",{style:{width:"40%"}},"Background fill:",-1)})),Cx={class:"row"},Lx=mx((function(){return(0,u._)("div",{style:{width:"40%"}},"Grid color:",-1)})),Ex={style:{width:"40%"}},Zx={class:"color-btn-wrap",style:{width:"100%"}},Tx=["onClick"],Mx={class:"preset-themes"},Ux=["onClick","onMouseenter"];const Wx=(0,u.aZ)({__name:"index",setup:function(e){var t=[["#d87c7c","#919e8b","#d7ab82","#6e7074","#61a0a8","#efa18d"],["#dd6b66","#759aa0","#e69d87","#8dc1a9","#ea7e53","#eedd78"],["#516b91","#59c4e6","#edafda","#93b7e3","#a5e7f0","#cbb0e3"],["#893448","#d95850","#eb8146","#ffb248","#f2d643","#ebdba4"],["#4ea397","#22c3aa","#7bd9a5","#d0648a","#f58db2","#f2b3c9"],["#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"],["#fc97af","#87f7cf","#f7f494","#72ccff","#f7c5a0","#d4a4eb"],["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463"],["#2ec7c9","#b6a2de","#5ab1ef","#ffb980","#d87a80","#8d98b3"],["#e01f54","#001852","#f5e8c8","#b8d2c7","#c6b38e","#a4d8c2"],["#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8"],["#8a7ca8","#e098c7","#8fd3e8","#71669e","#cc70af","#7cb4cc"]],n=X(),l=V(),i=(0,o.Jk)(n),r=i.handleElement,s=i.handleElementId,d=(0,o.Jk)(l),f=d.theme,v=r,p=(0,c.iH)(!1),h=(0,c.iH)(!1),m=(0,c.iH)([-1,-1]),y=_l(),w=y.addHistorySnapshot,x=(0,c.iH)("#000"),b=(0,c.iH)([]),k=(0,c.iH)(""),_=(0,c.iH)(""),I=(0,c.iH)(!0),S=(0,c.iH)(!0),C=(0,c.iH)(!1),L=(0,c.iH)(!1),E=(0,c.iH)(!1),Z=(0,c.iH)(!1);(0,u.YP)(r,(function(){if(r.value&&"chart"===r.value.type){if(x.value=r.value.fill||"#fff",r.value.options){var e=r.value.options,t=e.lineSmooth,n=e.showLine,l=e.showArea,a=e.horizontalBars,o=e.donut,i=e.stackBars;I.value=!!t,S.value=!!n,C.value=!!l,L.value=!!a,E.value=!!o,Z.value=!!i}b.value=r.value.themeColor,k.value=r.value.gridColor||"#333",_.value=r.value.legend||""}}),{deep:!0,immediate:!0});var T=function(e){l.updateElement({id:s.value,props:e}),w()},M=function(e){p.value=!1,T({data:e})},U=function(e){T({fill:e})},W=function(e){var t=r.value,n=(0,g.Z)((0,g.Z)({},t.options),e);T({options:n})},D=function(e,t){var n={themeColor:b.value.map((function(n,l){return l===t?e:n}))};T(n)},H=function(){var e={themeColor:[].concat((0,R.Z)(b.value),[f.value.themeColor])};T(e)},F=function(e,t){var n=e.slice(0,t+1);T({themeColor:n}),h.value=!1},A=function(e){var t={themeColor:b.value.filter((function(t,n){return n!==e}))};T(t)},O=function(e){T({gridColor:e})},P=function(e){T({legend:e})},B=function(){return p.value=!0};return Mr.on(_r.OPEN_CHART_DATA_EDITOR,B),(0,u.Ah)((function(){Mr.off(_r.OPEN_CHART_DATA_EDITOR,B)})),function(e,n){var l=(0,u.up)("IconEdit"),o=(0,u.up)("IconCloseSmall"),i=(0,u.up)("IconPlus"),r=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",gx,[(0,u.Wm)(Gf,{class:"full-width-btn",onClick:n[0]||(n[0]=function(e){return p.value=!0})},{default:(0,u.w5)((function(){return[(0,u.Wm)(l,{class:"btn-icon"}),(0,u.Uk)(" Edit chart data ")]})),_:1}),(0,u.Wm)(Ud),"line"===(0,c.SU)(v).chartType?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[(0,u._)("div",yx,[(0,u.Wm)(hx,{"onUpdate:value":n[1]||(n[1]=function(e){return W({showArea:e})}),value:C.value,style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("Area Chart Style")]})),_:1},8,["value"]),(0,u.Wm)(hx,{"onUpdate:value":n[2]||(n[2]=function(e){return W({showLine:e})}),value:!S.value,style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("Scatter plot style")]})),_:1},8,["value"])]),(0,u._)("div",wx,[(0,u.Wm)(hx,{"onUpdate:value":n[3]||(n[3]=function(e){return W({lineSmooth:e})}),value:I.value},{default:(0,u.w5)((function(){return[(0,u.Uk)("Use smooth curves")]})),_:1},8,["value"])])],64)):(0,u.kq)("",!0),"bar"===(0,c.SU)(v).chartType?((0,u.wg)(),(0,u.iD)("div",xx,[(0,u.Wm)(hx,{"onUpdate:value":n[4]||(n[4]=function(e){return W({horizontalBars:e})}),value:L.value,style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("bar chart style")]})),_:1},8,["value"]),(0,u.Wm)(hx,{"onUpdate:value":n[5]||(n[5]=function(e){return W({stackBars:e})}),value:Z.value,style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("stacked style")]})),_:1},8,["value"])])):(0,u.kq)("",!0),"pie"===(0,c.SU)(v).chartType?((0,u.wg)(),(0,u.iD)("div",bx,[(0,u.Wm)(hx,{"onUpdate:value":n[6]||(n[6]=function(e){return W({donut:e})}),value:E.value},{default:(0,u.w5)((function(){return[(0,u.Uk)("donut chart style")]})),_:1},8,["value"])])):(0,u.kq)("",!0),(0,u.Wm)(Ud),(0,u._)("div",kx,[_x,(0,u.Wm)(ov,{style:{width:"60%"},value:_.value,"onUpdate:value":n[7]||(n[7]=function(e){return P(e)}),options:[{label:"Do not display",value:""},{label:"display above",value:"top"},{label:"Show below",value:"bottom"}]},null,8,["value"])]),(0,u.Wm)(Ud),(0,u._)("div",Ix,[Sx,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:x.value,"onUpdate:modelValue":n[8]||(n[8]=function(e){return U(e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:x.value},null,8,["color"])]})),_:1})]),(0,u._)("div",Cx,[Lx,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:k.value,"onUpdate:modelValue":n[9]||(n[9]=function(e){return O(e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:k.value},null,8,["color"])]})),_:1})]),(0,u.Wm)(Ud),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(b.value,(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"row",key:t},[(0,u._)("div",Ex,(0,pe.zw)(0===t?"Theme color: ":""),1),(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:e,"onUpdate:modelValue":function(e){return D(e,t)}},null,8,["modelValue","onUpdate:modelValue"])]})),default:(0,u.w5)((function(){return[(0,u._)("div",Zx,[(0,u.Wm)(om,{color:e},null,8,["color"]),0!==t?(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{key:0,class:"delete-color-btn",onClick:(0,a.iM)((function(e){return A(t)}),["stop"])},[(0,u.Wm)(o)],8,Tx)),[[r,"Delete"]]):(0,u.kq)("",!0)])]})),_:2},1024)])})),128)),(0,u.Wm)(Xg,{class:"row",passive:""},{default:(0,u.w5)((function(){return[(0,u.Wm)(lo,{trigger:"click",open:h.value,"onUpdate:open":n[11]||(n[11]=function(e){return h.value=e}),style:{width:"40%"}},{content:(0,u.w5)((function(){return[(0,u._)("div",Mx,[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(t,(function(e,t){return(0,u._)("div",{class:"preset-theme",key:t},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e,(function(l,a){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["preset-theme-color",{select:m.value[0]===t&&a<=m.value[1]}]),key:l,style:(0,pe.j5)({backgroundColor:l}),onClick:function(t){return F(e,a)},onMouseenter:function(e){return m.value=[t,a]},onMouseleave:n[10]||(n[10]=function(e){return m.value=[-1,-1]})},null,46,Ux)})),128))])})),64))])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{first:"",style:{width:"100%"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("Recommended topics")]})),_:1})]})),_:1},8,["open"]),(0,u.Wm)(Gf,{last:"",disabled:b.value.length>=10,style:{width:"60%"},onClick:n[12]||(n[12]=function(e){return H()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(i,{class:"btn-icon"}),(0,u.Uk)(" Add theme color ")]})),_:1},8,["disabled"])]})),_:1}),(0,u.Wm)(Ud),(0,u.Wm)(_g),(0,u.Wm)(mv,{visible:p.value,"onUpdate:visible":n[15]||(n[15]=function(e){return p.value=e}),width:640},{default:(0,u.w5)((function(){return[(0,u.Wm)(ux,{data:(0,c.SU)(v).data,onClose:n[13]||(n[13]=function(e){return p.value=!1}),onSave:n[14]||(n[14]=function(e){return M(e)})},null,8,["data"])]})),_:1},8,["visible"])])}}}),Dx=(0,ll.Z)(Wx,[["__scopeId","data-v-301c29c5"]]),Hx=Dx;var Fx=function(e){return(0,u.dD)("data-v-161b7c70"),e=e(),(0,u.Cn)(),e},Ax={class:"table-style-panel"},Ox={class:"row"},Px=Fx((function(){return(0,u._)("div",{style:{width:"40%"}},"Rows:",-1)})),Rx={class:"set-count",style:{width:"60%"}},Bx={class:"count-text"},zx={class:"row"},Nx=Fx((function(){return(0,u._)("div",{style:{width:"40%"}},"Columns:",-1)})),jx={class:"set-count",style:{width:"60%"}},Yx={class:"count-text"},Vx={class:"row theme-switch"},Jx=Fx((function(){return(0,u._)("div",{style:{width:"40%"}},"Enable topic table:",-1)})),qx={class:"switch-wrapper",style:{width:"60%"}},Xx={class:"row"},Gx={class:"row"},Kx={class:"row"},Qx=Fx((function(){return(0,u._)("div",{style:{width:"40%"}},"Theme color:",-1)}));const $x=(0,u.aZ)({__name:"TableStylePanel",setup:function(e){var t=V(),n=(0,o.Jk)(X()),l=n.handleElement,a=n.handleElementId,i=n.selectedTableCells,r=n.availableFonts,d=(0,u.Fl)((function(){return t.theme.themeColor})),f=["12px","14px","16px","18px","20px","22px","24px","28px","32px"],v=(0,c.iH)({bold:!1,em:!1,underline:!1,strikethrough:!1,color:"#000",backcolor:"",fontsize:"12px",fontname:"Microsoft Yahei",align:"left"}),p=(0,c.iH)(),h=(0,c.iH)(!1),m=(0,c.iH)(0),y=(0,c.iH)(0),w=(0,c.iH)(0),x=(0,c.iH)(0);(0,u.YP)(l,(function(){l.value&&"table"===l.value.type&&(p.value=l.value.theme,h.value=!!p.value,m.value=l.value.data.length,y.value=l.value.data[0].length,w.value=l.value.data.length,x.value=l.value.data[0].length)}),{deep:!0,immediate:!0});var b=_l(),k=b.addHistorySnapshot,_=function(){if(l.value&&"table"===l.value.type){var e=0,t=0;if(i.value.length){var n=i.value[0];e=+n.split("_")[0],t=+n.split("_")[1]}var a=l.value.data[e][t].style;v.value=a?{bold:!!a.bold,em:!!a.em,underline:!!a.underline,strikethrough:!!a.strikethrough,color:a.color||"#000",backcolor:a.backcolor||"",fontsize:a.fontsize||"12px",fontname:a.fontname||"Microsoft Yahei",align:a.align||"left"}:{bold:!1,em:!1,underline:!1,strikethrough:!1,color:"#000",backcolor:"",fontsize:"12px",fontname:"Microsoft Yahei",align:"left"}}};(0,u.bv)((function(){i.value.length&&_()})),(0,u.YP)(i,_);var I=function(e){t.updateElement({id:a.value,props:e}),k()},S=function(e){for(var t=l.value,n=JSON.parse(JSON.stringify(t.data)),a=0;a<n.length;a++)for(var o=0;o<n[a].length;o++)if(!i.value.length||i.value.includes("".concat(a,"_").concat(o))){var r=n[a][o].style||{};n[a][o].style=(0,g.Z)((0,g.Z)({},r),e)}I({data:n}),_()},C=function(e){if(p.value){var t=(0,g.Z)((0,g.Z)({},p.value),e);I({theme:t})}},L=function(e){if(e){var n={theme:{color:d.value,rowHeader:!0,rowFooter:!1,colHeader:!1,colFooter:!1}};I(n)}else t.removeElementProps({id:a.value,propName:"theme"}),k()},E=function(e){var t=l.value,n=t.data.length;if(e>n){var a=new Array(y.value).fill({id:(0,s.x0)(10),colspan:1,rowspan:1,text:""}),o=new Array(e-n).fill(a),i=JSON.parse(JSON.stringify(t.data));i.push.apply(i,(0,R.Z)(o)),I({data:i})}else{var r=t.data.slice(0,e);I({data:r})}},Z=function(e){var t=l.value,n=t.data[0].length,a=t.data,o=t.colWidths.map((function(e){return e*t.width}));if(e>n){var i;a=a.map((function(t){var l=new Array(e-n).fill({id:(0,s.x0)(10),colspan:1,rowspan:1,text:""});return t.push.apply(t,(0,R.Z)(l)),t}));var r=new Array(e-n).fill(100);(i=o).push.apply(i,(0,R.Z)(r))}else a=a.map((function(t){return t.slice(0,e)})),o=o.slice(0,e);var u=o.reduce((function(e,t){return e+t})),c=o.map((function(e){return e/u})),d={width:u,data:a,colWidths:c};I(d)};return function(e,t){var n=(0,u.up)("IconFontSize"),l=(0,u.up)("IconAddText"),a=(0,u.up)("IconText"),o=(0,u.up)("IconFill"),i=(0,u.up)("IconTextBold"),s=(0,u.up)("IconTextItalic"),d=(0,u.up)("IconTextUnderline"),g=(0,u.up)("IconStrikethrough"),w=(0,u.up)("IconAlignTextLeft"),x=(0,u.up)("IconAlignTextCenter"),b=(0,u.up)("IconAlignTextRight"),k=(0,u.up)("IconMinus"),_=(0,u.up)("IconPlus"),I=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",Ax,[(0,u.Wm)(iy,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(ov,{style:{width:"50%"},value:v.value.fontname,"onUpdate:value":t[0]||(t[0]=function(e){return S({fontname:e})}),options:[].concat((0,R.Z)((0,c.SU)(r)),(0,R.Z)((0,c.SU)(O)))},{icon:(0,u.w5)((function(){return[(0,u.Wm)(n)]})),_:1},8,["value","options"]),(0,u.Wm)(ov,{style:{width:"50%"},value:v.value.fontsize,"onUpdate:value":t[1]||(t[1]=function(e){return S({fontsize:e})}),options:f.map((function(e){return{label:e,value:e}}))},{icon:(0,u.w5)((function(){return[(0,u.Wm)(l)]})),_:1},8,["value","options"])]})),_:1}),(0,u.Wm)(Xg,{class:"row",passive:""},{default:(0,u.w5)((function(){return[(0,u.Wm)(lo,{trigger:"click",style:{width:"50%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:v.value.color,"onUpdate:modelValue":t[2]||(t[2]=function(e){return S({color:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Ng,{first:"",color:v.value.color},{default:(0,u.w5)((function(){return[(0,u.Wm)(a)]})),_:1},8,["color"])),[[I,"text color"]])]})),_:1}),(0,u.Wm)(lo,{trigger:"click",style:{width:"50%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:v.value.backcolor,"onUpdate:modelValue":t[3]||(t[3]=function(e){return S({backcolor:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Ng,{last:"",color:v.value.backcolor},{default:(0,u.w5)((function(){return[(0,u.Wm)(o)]})),_:1},8,["color"])),[[I,"cell fill"]])]})),_:1})]})),_:1}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:v.value.bold,onClick:t[4]||(t[4]=function(e){return S({bold:!v.value.bold})})},{default:(0,u.w5)((function(){return[(0,u.Wm)(i)]})),_:1},8,["checked"])),[[I,"Bold"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:v.value.em,onClick:t[5]||(t[5]=function(e){return S({em:!v.value.em})})},{default:(0,u.w5)((function(){return[(0,u.Wm)(s)]})),_:1},8,["checked"])),[[I,"italics"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:v.value.underline,onClick:t[6]||(t[6]=function(e){return S({underline:!v.value.underline})})},{default:(0,u.w5)((function(){return[(0,u.Wm)(d)]})),_:1},8,["checked"])),[[I,"Underline"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Vg,{style:{flex:"1"},checked:v.value.strikethrough,onClick:t[7]||(t[7]=function(e){return S({strikethrough:!v.value.strikethrough})})},{default:(0,u.w5)((function(){return[(0,u.Wm)(g)]})),_:1},8,["checked"])),[[I,"strikethrough"]])]})),_:1}),(0,u.Wm)(ty,{class:"row","button-style":"solid",value:v.value.align,"onUpdate:value":t[8]||(t[8]=function(e){return S({align:e})})},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"left",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(w)]})),_:1})),[[I,"Left-aligned"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"center",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(x)]})),_:1})),[[I,"center"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"right",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(b)]})),_:1})),[[I,"right-aligned"]])]})),_:1},8,["value"]),(0,u.Wm)(Ud),(0,u.Wm)(_g,{fixed:!0}),(0,u.Wm)(Ud),(0,u._)("div",Ox,[Px,(0,u._)("div",Rx,[(0,u.Wm)(Gf,{class:"btn",disabled:m.value<=1,onClick:t[9]||(t[9]=function(e){return E(m.value-1)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(k)]})),_:1},8,["disabled"]),(0,u._)("div",Bx,(0,pe.zw)(m.value),1),(0,u.Wm)(Gf,{class:"btn",disabled:m.value>=30,onClick:t[10]||(t[10]=function(e){return E(m.value+1)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(_)]})),_:1},8,["disabled"])])]),(0,u._)("div",zx,[Nx,(0,u._)("div",jx,[(0,u.Wm)(Gf,{class:"btn",disabled:y.value<=1,onClick:t[11]||(t[11]=function(e){return Z(y.value-1)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(k)]})),_:1},8,["disabled"]),(0,u._)("div",Yx,(0,pe.zw)(y.value),1),(0,u.Wm)(Gf,{class:"btn",disabled:y.value>=30,onClick:t[12]||(t[12]=function(e){return Z(y.value+1)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(_)]})),_:1},8,["disabled"])])]),(0,u.Wm)(Ud),(0,u._)("div",Vx,[Jx,(0,u._)("div",qx,[(0,u.Wm)(cg,{value:h.value,"onUpdate:value":t[13]||(t[13]=function(e){return L(e)})},null,8,["value"])])]),p.value?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[(0,u._)("div",Xx,[(0,u.Wm)(hx,{"onUpdate:value":t[14]||(t[14]=function(e){return C({rowHeader:e})}),value:p.value.rowHeader,style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("title line")]})),_:1},8,["value"]),(0,u.Wm)(hx,{"onUpdate:value":t[15]||(t[15]=function(e){return C({rowFooter:e})}),value:p.value.rowFooter,style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("summary row")]})),_:1},8,["value"])]),(0,u._)("div",Gx,[(0,u.Wm)(hx,{"onUpdate:value":t[16]||(t[16]=function(e){return C({colHeader:e})}),value:p.value.colHeader,style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("first row")]})),_:1},8,["value"]),(0,u.Wm)(hx,{"onUpdate:value":t[17]||(t[17]=function(e){return C({colFooter:e})}),value:p.value.colFooter,style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Uk)("last row")]})),_:1},8,["value"])]),(0,u._)("div",Kx,[Qx,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:p.value.color,"onUpdate:modelValue":t[18]||(t[18]=function(e){return C({color:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:p.value.color},null,8,["color"])]})),_:1})])],64)):(0,u.kq)("",!0)])}}}),eb=(0,ll.Z)($x,[["__scopeId","data-v-161b7c70"]]),tb=eb;var nb=function(e){return(0,u.dD)("data-v-4dbada7f"),e=e(),(0,u.Cn)(),e},lb={class:"latex-style-panel"},ab={class:"row"},ob={class:"row"},ib=nb((function(){return(0,u._)("div",{style:{width:"40%"}},"Color:",-1)})),rb={class:"row"},ub=nb((function(){return(0,u._)("div",{style:{width:"40%"}},"Thickness:",-1)}));const cb=(0,u.aZ)({__name:"LatexStylePanel",setup:function(e){var t=V(),n=(0,o.Jk)(X()),l=n.handleElement,a=l,i=(0,c.iH)(!1),r=_l(),s=r.addHistorySnapshot,d=function(e){l.value&&(t.updateElement({id:l.value.id,props:e}),s())},f=function(e){d({path:e.path,latex:e.latex,width:e.w,height:e.h,viewBox:[e.w,e.h]})},v=function(){return i.value=!0};return Mr.on(_r.OPEN_LATEX_EDITOR,v),(0,u.Ah)((function(){Mr.off(_r.OPEN_LATEX_EDITOR,v)})),function(e,t){return(0,u.wg)(),(0,u.iD)("div",lb,[(0,u._)("div",ab,[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[0]||(t[0]=function(e){return i.value=!0})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Edit LaTeX")]})),_:1})]),(0,u.Wm)(Ud),(0,u._)("div",ob,[ib,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(a).color,"onUpdate:modelValue":t[1]||(t[1]=function(e){return d({color:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:(0,c.SU)(a).color},null,8,["color"])]})),_:1})]),(0,u._)("div",rb,[ub,(0,u.Wm)(cp,{min:1,max:3,value:(0,c.SU)(a).strokeWidth,"onUpdate:value":t[2]||(t[2]=function(e){return d({strokeWidth:e})}),style:{width:"60%"}},null,8,["value"])]),(0,u.Wm)(mv,{visible:i.value,"onUpdate:visible":t[5]||(t[5]=function(e){return i.value=e}),width:880},{default:(0,u.w5)((function(){return[(0,u.Wm)(dh,{value:(0,c.SU)(a).latex,onClose:t[3]||(t[3]=function(e){return i.value=!1}),onUpdate:t[4]||(t[4]=function(e){f(e),i.value=!1})},null,8,["value"])]})),_:1},8,["visible"])])}}}),sb=(0,ll.Z)(cb,[["__scopeId","data-v-4dbada7f"]]),db=sb;var fb=function(e){return(0,u.dD)("data-v-7b05f38c"),e=e(),(0,u.Cn)(),e},vb={class:"video-style-panel"},pb=fb((function(){return(0,u._)("div",{class:"title"},"Video preview",-1)})),hb={class:"background-image-wrapper"},mb={class:"background-image"},gb={class:"row"},yb={class:"row switch-row"},wb=fb((function(){return(0,u._)("div",{style:{width:"40%"}},"Autoplay:",-1)})),xb={class:"switch-wrapper",style:{width:"60%"}};const bb=(0,u.aZ)({__name:"VideoStylePanel",setup:function(e){var t=V(),n=(0,o.Jk)(X()),l=n.handleElement,a=l,i=_l(),r=i.addHistorySnapshot,s=function(e){l.value&&(t.updateElement({id:l.value.id,props:e}),r())},d=function(e){var t=e[0];t&&yl(t).then((function(e){return s({poster:e})}))};return function(e,t){var n=(0,u.up)("IconPlus");return(0,u.wg)(),(0,u.iD)("div",vb,[pb,(0,u._)("div",hb,[(0,u.Wm)(hh,{onChange:t[0]||(t[0]=function(e){return d(e)})},{default:(0,u.w5)((function(){return[(0,u._)("div",mb,[(0,u._)("div",{class:"content",style:(0,pe.j5)({backgroundImage:(0,c.SU)(a).poster?"url(".concat((0,c.SU)(a).poster,")"):""})},[(0,u.Wm)(n)],4)])]})),_:1})]),(0,u._)("div",gb,[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[1]||(t[1]=function(e){return s({poster:""})})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Reset")]})),_:1})]),(0,u._)("div",yb,[wb,(0,u._)("div",xb,[(0,u.Wm)(cg,{value:(0,c.SU)(a).autoplay,"onUpdate:value":t[2]||(t[2]=function(e){return s({autoplay:e})})},null,8,["value"])])])])}}}),kb=(0,ll.Z)(bb,[["__scopeId","data-v-7b05f38c"]]),_b=kb;var Ib=function(e){return(0,u.dD)("data-v-47a2efee"),e=e(),(0,u.Cn)(),e},Sb={class:"audio-style-panel"},Cb={class:"row"},Lb=Ib((function(){return(0,u._)("div",{style:{width:"40%"}},"Icon color:",-1)})),Eb={class:"row switch-row"},Zb=Ib((function(){return(0,u._)("div",{style:{width:"40%"}},"Autoplay:",-1)})),Tb={class:"switch-wrapper",style:{width:"60%"}},Mb={class:"row switch-row"},Ub=Ib((function(){return(0,u._)("div",{style:{width:"40%"}},"Loop:",-1)})),Wb={class:"switch-wrapper",style:{width:"60%"}};const Db=(0,u.aZ)({__name:"AudioStylePanel",setup:function(e){var t=V(),n=(0,o.Jk)(X()),l=n.handleElement,a=l,i=_l(),r=i.addHistorySnapshot,s=function(e){l.value&&(t.updateElement({id:l.value.id,props:e}),r())};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Sb,[(0,u._)("div",Cb,[Lb,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(a).color,"onUpdate:modelValue":t[0]||(t[0]=function(e){return s({color:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:(0,c.SU)(a).color},null,8,["color"])]})),_:1})]),(0,u._)("div",Eb,[Zb,(0,u._)("div",Tb,[(0,u.Wm)(cg,{value:(0,c.SU)(a).autoplay,"onUpdate:value":t[1]||(t[1]=function(e){return s({autoplay:e})})},null,8,["value"])])]),(0,u._)("div",Mb,[Ub,(0,u._)("div",Wb,[(0,u.Wm)(cg,{value:(0,c.SU)(a).loop,"onUpdate:value":t[2]||(t[2]=function(e){return s({loop:e})})},null,8,["value"])])])])}}}),Hb=(0,ll.Z)(Db,[["__scopeId","data-v-47a2efee"]]),Fb=Hb;var Ab=function(e){return(0,u.dD)("data-v-0bf7a6b6"),e=e(),(0,u.Cn)(),e},Ob={class:"multi-style-panel"},Pb={class:"row"},Rb=Ab((function(){return(0,u._)("div",{style:{width:"40%"}},"Fill color:",-1)})),Bb={class:"row"},zb=Ab((function(){return(0,u._)("div",{style:{width:"40%"}},"Border style:",-1)})),Nb={class:"row"},jb=Ab((function(){return(0,u._)("div",{style:{width:"40%"}},"Border color:",-1)})),Yb={class:"row"},Vb=Ab((function(){return(0,u._)("div",{style:{width:"40%"}},"Border thickness:",-1)}));const Jb=(0,u.aZ)({__name:"MultiStylePanel",setup:function(e){var t=V(),n=(0,o.Jk)(X()),l=n.richTextAttrs,a=n.availableFonts,i=n.activeElementList,r=_l(),s=r.addHistorySnapshot,d=function(e,n){t.updateElement({id:e,props:n}),s()},f=["12px","14px","16px","18px","20px","22px","24px","28px","32px","36px","40px","44px","48px","54px","60px","66px","72px","76px","80px","88px","96px","104px","112px","120px"],v=(0,c.iH)("#fff"),p=(0,c.iH)({width:0,color:"#fff",style:"solid"}),h=function(e){var t,n=(0,y.Z)(i.value);try{for(n.s();!(t=n.n()).done;){var l=t.value;if("text"!==l.type&&"shape"!==l.type&&"chart"!==l.type||d(l.id,{fill:e}),"table"===l.type){for(var a=JSON.parse(JSON.stringify(l.data)),o=0;o<a.length;o++)for(var r=0;r<a[o].length;r++){var u=a[o][r].style||{};a[o][r].style=(0,g.Z)((0,g.Z)({},u),{},{backcolor:e})}d(l.id,{data:a})}"audio"===l.type&&d(l.id,{color:e})}}catch(c){n.e(c)}finally{n.f()}v.value=e},m=function(e){var t,n=(0,y.Z)(i.value);try{for(n.s();!(t=n.n()).done;){var l=t.value;if("text"===l.type||"image"===l.type||"shape"===l.type||"table"===l.type||"chart"===l.type){var a=l.outline||{width:2,color:"#000",style:"solid"},o={outline:(0,g.Z)((0,g.Z)({},a),e)};d(l.id,o)}"line"===l.type&&d(l.id,e)}}catch(r){n.e(r)}finally{n.f()}p.value=(0,g.Z)((0,g.Z)({},p.value),e)},w=function(e,t){var n,l=(0,y.Z)(i.value);try{for(l.s();!(n=l.n()).done;){var a,o=n.value;if(("text"===o.type||"shape"===o.type&&null!==(a=o.text)&&void 0!==a&&a.content)&&Mr.emit(_r.RICH_TEXT_COMMAND,{target:o.id,action:{command:e,value:t}}),"table"===o.type){for(var r=JSON.parse(JSON.stringify(o.data)),u=0;u<r.length;u++)for(var c=0;c<r[u].length;c++){var s=r[u][c].style||{};r[u][c].style=(0,g.Z)((0,g.Z)({},s),{},(0,te.Z)({},e,t))}d(o.id,{data:r})}"latex"===o.type&&"color"===e&&d(o.id,{color:t})}}catch(f){l.e(f)}finally{l.f()}};return function(e,t){var n=(0,u.up)("IconFontSize"),o=(0,u.up)("IconAddText"),i=(0,u.up)("IconText"),r=(0,u.up)("IconHighLight"),s=(0,u.up)("IconAlignTextLeft"),d=(0,u.up)("IconAlignTextCenter"),g=(0,u.up)("IconAlignTextRight"),y=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",Ob,[(0,u._)("div",Pb,[Rb,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:v.value,"onUpdate:modelValue":t[0]||(t[0]=function(e){return h(e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:v.value},null,8,["color"])]})),_:1})]),(0,u.Wm)(Ud),(0,u._)("div",Bb,[zb,(0,u.Wm)(ov,{style:{width:"60%"},value:p.value.style||"","onUpdate:value":t[1]||(t[1]=function(e){return m({style:e})}),options:[{label:"solid border",value:"solid"},{label:"dashed border",value:"dashed"}]},null,8,["value"])]),(0,u._)("div",Nb,[jb,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:p.value.color,"onUpdate:modelValue":t[2]||(t[2]=function(e){return m({color:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:p.value.color||"#000"},null,8,["color"])]})),_:1})]),(0,u._)("div",Yb,[Vb,(0,u.Wm)(cp,{value:p.value.width||0,"onUpdate:value":t[3]||(t[3]=function(e){return m({width:e})}),style:{width:"60%"}},null,8,["value"])]),(0,u.Wm)(Ud),(0,u.Wm)(iy,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(ov,{style:{width:"60%"},value:(0,c.SU)(l).fontname,"onUpdate:value":t[4]||(t[4]=function(e){return w("fontname",e)}),options:[].concat((0,R.Z)((0,c.SU)(a)),(0,R.Z)((0,c.SU)(O)))},{icon:(0,u.w5)((function(){return[(0,u.Wm)(n)]})),_:1},8,["value","options"]),(0,u.Wm)(ov,{style:{width:"40%"},value:(0,c.SU)(l).fontsize,"onUpdate:value":t[5]||(t[5]=function(e){return w("fontsize",e)}),options:f.map((function(e){return{label:e,value:e}}))},{icon:(0,u.w5)((function(){return[(0,u.Wm)(o)]})),_:1},8,["value","options"])]})),_:1}),(0,u.Wm)(Xg,{class:"row",passive:""},{default:(0,u.w5)((function(){return[(0,u.Wm)(lo,{trigger:"click",style:{width:"30%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(l).color,"onUpdate:modelValue":t[6]||(t[6]=function(e){return w("color",e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Ng,{first:"",color:(0,c.SU)(l).color},{default:(0,u.w5)((function(){return[(0,u.Wm)(i)]})),_:1},8,["color"])),[[y,"text color"]])]})),_:1}),(0,u.Wm)(lo,{trigger:"click",style:{width:"30%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(l).backcolor,"onUpdate:modelValue":t[7]||(t[7]=function(e){return w("backcolor",e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Ng,{color:(0,c.SU)(l).backcolor},{default:(0,u.w5)((function(){return[(0,u.Wm)(r)]})),_:1},8,["color"])),[[y,"text highlight"]])]})),_:1}),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{class:"font-size-btn",style:{width:"20%"},onClick:t[8]||(t[8]=function(e){return w("fontsize-add","2")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(n),(0,u.Uk)("+")]})),_:1})),[[y,"Increase font size"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{last:"",class:"font-size-btn",style:{width:"20%"},onClick:t[9]||(t[9]=function(e){return w("fontsize-reduce","2")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(n),(0,u.Uk)("-")]})),_:1})),[[y,"Reduce font size"]])]})),_:1}),(0,u.Wm)(ty,{class:"row","button-style":"solid",value:(0,c.SU)(l).align,"onUpdate:value":t[10]||(t[10]=function(e){return w("align",e)})},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"left",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(s)]})),_:1})),[[y,"Left-aligned"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"center",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(d)]})),_:1})),[[y,"center"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Qg,{value:"right",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(g)]})),_:1})),[[y,"right-aligned"]])]})),_:1},8,["value"])])}}}),qb=(0,ll.Z)(Jb,[["__scopeId","data-v-0bf7a6b6"]]),Xb=qb;var Gb={class:"element-style-panel"};const Kb=(0,u.aZ)({__name:"index",setup:function(e){var t=(0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)({},vl.TEXT,Hy),vl.IMAGE,mw),vl.SHAPE,Hw),vl.LINE,Gw),vl.CHART,Hx),vl.TABLE,tb),vl.LATEX,db),vl.VIDEO,_b),vl.AUDIO,Fb),n=(0,o.Jk)(X()),l=n.activeElementIdList,a=n.activeElementList,i=n.handleElement,r=n.activeGroupElementId,c=(0,u.Fl)((function(){if(l.value.length>1){if(!r.value)return Xb;var e=a.value.find((function(e){return e.id===r.value}));return e&&t[e.type]||null}return i.value&&t[i.value.type]||null}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",Gb,[((0,u.wg)(),(0,u.j4)((0,u.LL)(c.value)))])}}}),Qb=Kb,$b=Qb;var ek=function(e){return(0,u.dD)("data-v-5cb39a9e"),e=e(),(0,u.Cn)(),e},tk={class:"element-positopn-panel"},nk=ek((function(){return(0,u._)("div",{class:"title"},"Level:",-1)})),lk=ek((function(){return(0,u._)("div",{class:"title"},"Alignment:",-1)})),ak={class:"row"},ok=ek((function(){return(0,u._)("div",{style:{width:"10%"}},null,-1)})),ik={key:0,class:"row"},rk={key:1,style:{width:"10%"}},uk={class:"row"},ck=ek((function(){return(0,u._)("div",{style:{width:"7%"}},null,-1)}));const sk=(0,u.aZ)({__name:"ElementPositionPanel",setup:function(e){var t=V(),n=(0,o.Jk)(X()),l=n.handleElement,a=n.handleElementId,i=(0,c.iH)(0),r=(0,c.iH)(0),s=(0,c.iH)(0),v=(0,c.iH)(0),p=(0,c.iH)(0),h=(0,c.iH)(!1),m=(0,u.Fl)((function(){return l.value&&To[l.value.type]||20})),y=(0,u.Fl)((function(){var e;return"text"===(null===(e=l.value)||void 0===e?void 0:e.type)&&!l.value.vertical})),w=(0,u.Fl)((function(){var e;return"text"===(null===(e=l.value)||void 0===e?void 0:e.type)&&l.value.vertical}));(0,u.YP)(l,(function(){l.value&&(i.value=(0,z.round)(l.value.left,1),r.value=(0,z.round)(l.value.top,1),h.value="fixedRatio"in l.value&&!!l.value.fixedRatio,"line"!==l.value.type&&(s.value=(0,z.round)(l.value.width,1),v.value=(0,z.round)(l.value.height,1),p.value="rotate"in l.value&&void 0!==l.value.rotate?(0,z.round)(l.value.rotate,1):0))}),{deep:!0,immediate:!0});var x=Dl(),b=x.orderElement,k=Po(),_=k.alignElementToCanvas,I=_l(),S=I.addHistorySnapshot,C=function(e){var n={left:e};t.updateElement({id:a.value,props:n}),S()},L=function(e){var n={top:e};t.updateElement({id:a.value,props:n}),S()},E=function(e,t){if(l.value&&"shape"===l.value.type&&"pathFormula"in l.value&&l.value.pathFormula){var n=xl[l.value.pathFormula],a="";return a="editable"in n?n.formula(e,t,l.value.keypoint):n.formula(e,t),{viewBox:[e,t],path:a}}return null},Z=function(e){var n={width:e},l=E(e,v.value);l&&(n=(0,g.Z)((0,g.Z)({},n),l)),t.updateElement({id:a.value,props:n}),S()},T=function(e){var n={height:e},l=E(s.value,e);l&&(n=(0,g.Z)((0,g.Z)({},n),l)),t.updateElement({id:a.value,props:n}),S()},M=function(e){var n={rotate:e};t.updateElement({id:a.value,props:n}),S()},U=function(e){var n={fixedRatio:e};t.updateElement({id:a.value,props:n}),S()},W=function(e){var n=45*Math.floor(p.value/45);"+"===e?n+=45:"-"===e&&(n-=45),n<-180&&(n=-180),n>180&&(n=180);var l={rotate:n};t.updateElement({id:a.value,props:l}),S()};return function(e,t){var n=(0,u.up)("IconSendToBack"),a=(0,u.up)("IconBringToFrontOne"),o=(0,u.up)("IconBringToFront"),g=(0,u.up)("IconSentToBack"),x=(0,u.up)("IconAlignLeft"),k=(0,u.up)("IconAlignVertically"),I=(0,u.up)("IconAlignRight"),S=(0,u.up)("IconAlignTop"),E=(0,u.up)("IconAlignHorizontally"),D=(0,u.up)("IconAlignBottom"),H=(0,u.up)("IconLock"),F=(0,u.up)("IconUnlock"),A=(0,u.up)("IconRotate"),O=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",tk,[nk,(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[0]||(t[0]=function(e){return(0,c.SU)(b)((0,c.SU)(l),(0,c.SU)(d).TOP)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(n,{class:"btn-icon"}),(0,u.Uk)(" pin to top")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[1]||(t[1]=function(e){return(0,c.SU)(b)((0,c.SU)(l),(0,c.SU)(d).BOTTOM)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(a,{class:"btn-icon"}),(0,u.Uk)(" pin to bottom")]})),_:1})]})),_:1}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[2]||(t[2]=function(e){return(0,c.SU)(b)((0,c.SU)(l),(0,c.SU)(d).UP)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(o,{class:"btn-icon"}),(0,u.Uk)(" Bring to front")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[3]||(t[3]=function(e){return(0,c.SU)(b)((0,c.SU)(l),(0,c.SU)(d).DOWN)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(g,{class:"btn-icon"}),(0,u.Uk)(" Send to back")]})),_:1})]})),_:1}),(0,u.Wm)(Ud),lk,(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[4]||(t[4]=function(e){return(0,c.SU)(_)((0,c.SU)(f).LEFT)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(x)]})),_:1})),[[O,"left aligned"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[5]||(t[5]=function(e){return(0,c.SU)(_)((0,c.SU)(f).HORIZONTAL)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(k)]})),_:1})),[[O,"Center horizontally"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[6]||(t[6]=function(e){return(0,c.SU)(_)((0,c.SU)(f).RIGHT)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(I)]})),_:1})),[[O,"Align right"]])]})),_:1}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[7]||(t[7]=function(e){return(0,c.SU)(_)((0,c.SU)(f).TOP)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(S)]})),_:1})),[[O,"Align top"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[8]||(t[8]=function(e){return(0,c.SU)(_)((0,c.SU)(f).VERTICAL)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(E)]})),_:1})),[[O,"Center vertically"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[9]||(t[9]=function(e){return(0,c.SU)(_)((0,c.SU)(f).BOTTOM)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(D)]})),_:1})),[[O,"Align bottom"]])]})),_:1}),(0,u.Wm)(Ud),(0,u._)("div",ak,[(0,u.Wm)(cp,{step:5,value:i.value,"onUpdate:value":t[10]||(t[10]=function(e){return C(e)}),style:{width:"45%"}},{prefix:(0,u.w5)((function(){return[(0,u.Uk)(" level: ")]})),_:1},8,["value"]),ok,(0,u.Wm)(cp,{step:5,value:r.value,"onUpdate:value":t[11]||(t[11]=function(e){return L(e)}),style:{width:"45%"}},{prefix:(0,u.w5)((function(){return[(0,u.Uk)(" vertical: ")]})),_:1},8,["value"])]),"line"!==(0,c.SU)(l).type?((0,u.wg)(),(0,u.iD)("div",ik,[(0,u.Wm)(cp,{min:m.value,max:1500,step:5,disabled:w.value,value:s.value,"onUpdate:value":t[12]||(t[12]=function(e){return Z(e)}),style:{width:"45%"}},{prefix:(0,u.w5)((function(){return[(0,u.Uk)(" width: ")]})),_:1},8,["min","disabled","value"]),["image","shape","audio"].includes((0,c.SU)(l).type)?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[h.value?(0,u.wy)(((0,u.wg)(),(0,u.j4)(H,{key:0,style:{width:"10%"},class:"icon-btn",onClick:t[13]||(t[13]=function(e){return U(!1)})},null,512)),[[O,"Unlock aspect ratio"]]):(0,u.wy)(((0,u.wg)(),(0,u.j4)(F,{key:1,style:{width:"10%"},class:"icon-btn",onClick:t[14]||(t[14]=function(e){return U(!0)})},null,512)),[[O,"aspect ratio lock"]])],64)):((0,u.wg)(),(0,u.iD)("div",rk)),(0,u.Wm)(cp,{min:m.value,max:800,step:5,disabled:y.value||"table"===(0,c.SU)(l).type,value:v.value,"onUpdate:value":t[15]||(t[15]=function(e){return T(e)}),style:{width:"45%"}},{prefix:(0,u.w5)((function(){return[(0,u.Uk)(" high: ")]})),_:1},8,["min","disabled","value"])])):(0,u.kq)("",!0),["line","video","audio"].includes((0,c.SU)(l).type)?(0,u.kq)("",!0):((0,u.wg)(),(0,u.iD)(u.HY,{key:1},[(0,u.Wm)(Ud),(0,u._)("div",uk,[(0,u.Wm)(cp,{min:-180,max:180,step:5,value:p.value,"onUpdate:value":t[16]||(t[16]=function(e){return M(e)}),style:{width:"45%"}},{prefix:(0,u.w5)((function(){return[(0,u.Uk)(" Rotation: ")]})),_:1},8,["value"]),ck,(0,u._)("div",{class:"text-btn",onClick:t[17]||(t[17]=function(e){return W("-")}),style:{width:"24%"}},[(0,u.Wm)(A),(0,u.Uk)(" -45° ")]),(0,u._)("div",{class:"text-btn",onClick:t[18]||(t[18]=function(e){return W("+")}),style:{width:"24%"}},[(0,u.Wm)(A,{style:(0,pe.j5)({transform:"rotateY(180deg)"})},null,8,["style"]),(0,u.Uk)(" +45° ")])])],64))])}}}),dk=(0,ll.Z)(sk,[["__scopeId","data-v-5cb39a9e"]]),fk=dk;var vk=1e3,pk="click",hk="animate__",mk=[{type:"bounce",name:"Bounce",children:[{name:"bounceIn",value:"bounceIn"},{name:"bounce right",value:"bounceInLeft"},{name:"bounce to the left",value:"bounceInRight"},{name:"bounce up",value:"bounceInUp"},{name:"bounce down",value:"bounceInDown"}]},{type:"fade",name:"Emerge",children:[{name:"Float",value:"fadeIn"},{name:"Float down",value:"fadeInDown"},{name:"Fade downward long distance",value:"fadeInDownBig"},{name:"Float right",value:"fadeInLeft"},{name:"Fade long to the right",value:"fadeInLeftBig"},{name:"Float to the left",value:"fadeInRight"},{name:"Float long to the left",value:"fadeInRightBig"},{name:"Float up",value:"fadeInUp"},{name:"fadeInUpBig",value:"fadeInUpBig"},{name:"Float from top left",value:"fadeInTopLeft"},{name:"Float from top right",value:"fadeInTopRight"},{name:"Float in from bottom left",value:"fadeInBottomLeft"},{name:"Float from bottom right",value:"fadeInBottomRight"}]},{type:"rotate",name:"rotate",children:[{name:"rotateIn",value:"rotateIn"},{name:"Enter around the lower left",value:"rotateInDownLeft"},{name:"Rotate around the lower right",value:"rotateInDownRight"},{name:"Enter around the upper left",value:"rotateInUpLeft"},{name:"Enter around the upper right",value:"rotateInUpRight"}]},{type:"zoom",name:"Zoom",children:[{name:"zoom in",value:"zoomIn"},{name:"Zoom down to enter",value:"zoomInDown"},{name:"Zoom in from the left",value:"zoomInLeft"},{name:"Zoom in from the right",value:"zoomInRight"},{name:"Zoom up and enter",value:"zoomInUp"}]},{type:"slide",name:"Slide in",children:[{name:"Slide down",value:"slideInDown"},{name:"Slide in from right",value:"slideInLeft"},{name:"Slide in from left",value:"slideInRight"},{name:"Slide up",value:"slideInUp"}]},{type:"flip",name:"flip",children:[{name:"X-axis flip into",value:"flipInX"},{name:"Y-axis flip into",value:"flipInY"}]},{type:"back",name:"Magnify slide in",children:[{name:"Scroll down to zoom in",value:"backInDown"},{name:"Scale in from left",value:"backInLeft"},{name:"Scroll in from right",value:"backInRight"},{name:"Scale up to zoom in",value:"backInUp"}]},{type:"lightSpeed",name:"fly in",children:[{name:"Fly in from the right",value:"lightSpeedInRight"},{name:"Fly in from the left",value:"lightSpeedInLeft"}]}],gk=[{type:"bounce",name:"Bounce",children:[{name:"bounceOut",value:"bounceOut"},{name:"bounceOutLeft",value:"bounceOutLeft"},{name:"bounce right",value:"bounceOutRight"},{name:"bounceOutUp",value:"bounceOutUp"},{name:"Bounce Down",value:"bounceOutDown"}]},{type:"fade",name:"Emerge",children:[{name:"fadeOut",value:"fadeOut"},{name:"fade down",value:"fadeOutDown"},{name:"fadeOutDownBig",value:"fadeOutDownBig"},{name:"fade to the left",value:"fadeOutLeft"},{name:"fadeOutLeftBig",value:"fadeOutLeftBig"},{name:"fade to the right",value:"fadeOutRight"},{name:"fadeOutRightBig",value:"fadeOutRightBig"},{name:"fade up",value:"fadeOutUp"},{name:"fadeOutUpBig",value:"fadeOutUpBig"},{name:"Float from top left",value:"fadeOutTopLeft"},{name:"Fade from top right",value:"fadeOutTopRight"},{name:"Fade from bottom left",value:"fadeOutBottomLeft"},{name:"Fade from bottom right",value:"fadeOutBottomRight"}]},{type:"rotate",name:"rotate",children:[{name:"rotateOut",value:"rotateOut"},{name:"rotateOutDownLeft",value:"rotateOutDownLeft"},{name:"rotateOutDownRight",value:"rotateOutDownRight"},{name:"Exit around the upper left",value:"rotateOutUpLeft"},{name:"rotateOutUpRight",value:"rotateOutUpRight"}]},{type:"zoom",name:"Zoom",children:[{name:"zoomout",value:"zoomOut"},{name:"Zoom down and exit",value:"zoomOutDown"},{name:"Zoom out from the left to exit",value:"zoomOutLeft"},{name:"Zoom out from the right",value:"zoomOutRight"},{name:"Zoom up and exit",value:"zoomOutUp"}]},{type:"slide",name:"Slide out",children:[{name:"slide out",value:"slideOutDown"},{name:"Slide out from the left",value:"slideOutLeft"},{name:"Slide out from the right",value:"slideOutRight"},{name:"slide up",value:"slideOutUp"}]},{type:"flip",name:"flip",children:[{name:"X-axis flip out",value:"flipOutX"},{name:"Y-axis flip out",value:"flipOutY"}]},{type:"back",name:"Shrink out",children:[{name:"Scroll down and slide out",value:"backOutDown"},{name:"Scroll out from the left",value:"backOutLeft"},{name:"Scroll out from the right",value:"backOutRight"},{name:"Scroll out and shrink up",value:"backOutUp"}]},{type:"lightSpeed",name:"fly out",children:[{name:"Fly out from the right",value:"lightSpeedOutRight"},{name:"Fly out from the left",value:"lightSpeedOutLeft"}]}],yk=[{type:"shake",name:"shaking",children:[{name:"Shake left and right",value:"shakeX"},{name:"Shake up and down",value:"shakeY"},{name:"headShake",value:"headShake"},{name:"swing",value:"swing"},{name:"wobble",value:"wobble"},{name:"fright",value:"tada"},{name:"jelly",value:"jello"}]},{type:"other",name:"Other",children:[{name:"bounce",value:"bounce"},{name:"flash",value:"flash"},{name:"pulse",value:"pulse"},{name:"rubber band",value:"rubberBand"},{name:"Heartbeat (fast)",value:"heartBeat"}]}],wk=[{label:"None",value:"no"},{label:"random",value:"random"},{label:"Slide left and right",value:"slideX"},{label:"Slide up and down",value:"slideY"},{label:"Slide left and right (3D)",value:"slideX3D"},{label:"Slide up and down (3D)",value:"slideY3D"},{label:"fade",value:"fade"},{label:"rotate",value:"rotate"},{label:"Expand up and down",value:"scaleY"},{label:"Expand left and right",value:"scaleX"},{label:"zoom in",value:"scale"},{label:"scaleReverse",value:"scaleReverse"}],xk=function(e){return(0,u.dD)("data-v-4ef10c20"),e=e(),(0,u.Cn)(),e},bk={class:"element-animation-panel"},kk={key:0,class:"element-animation"},_k={class:"type-title"},Ik={class:"pool-item-wrapper"},Sk=["onMouseenter","onClick"],Ck={key:0,class:"mask"},Lk={key:1,class:"tip"},Ek={class:"sequence-content"},Zk={class:"index"},Tk={class:"text"},Mk={class:"handler"},Uk={key:0,class:"configs"},Wk={class:"config-item"},Dk=xk((function(){return(0,u._)("div",{style:{width:"35%"}},"Duration:",-1)})),Hk={class:"config-item"},Fk=xk((function(){return(0,u._)("div",{style:{width:"35%"}},"Trigger method:",-1)})),Ak={class:"config-item"};const Ok=(0,u.aZ)({__name:"ElementAnimationPanel",setup:function(e){var t,n={},l=(0,y.Z)(mk);try{for(l.s();!(t=l.n()).done;){var a,i=t.value,r=(0,y.Z)(i.children);try{for(r.s();!(a=r.n()).done;){var d=a.value;n[d.value]=d.name}}catch(le){r.e(le)}finally{r.f()}}}catch(le){l.e(le)}finally{l.f()}var f,v=(0,y.Z)(gk);try{for(v.s();!(f=v.n()).done;){var p,h=f.value,m=(0,y.Z)(h.children);try{for(m.s();!(p=m.n()).done;){var w=p.value;n[w.value]=w.name}}catch(le){m.e(le)}finally{m.f()}}}catch(le){v.e(le)}finally{v.f()}var x,b=(0,y.Z)(yk);try{for(b.s();!(x=b.n()).done;){var k,_=x.value,I=(0,y.Z)(_.children);try{for(I.s();!(k=I.n()).done;){var S=k.value;n[S.value]=S.name}}catch(le){I.e(le)}finally{I.f()}}}catch(le){b.e(le)}finally{b.f()}var C=["in","out","attention"],L=V(),E=(0,o.Jk)(X()),Z=E.handleElement,T=E.handleElementId,M=(0,o.Jk)(L),U=M.currentSlide,W=M.formatedAnimations,D=M.currentSlideAnimations,H=[{key:"in",label:"入场",color:"#68a490"},{key:"out",label:"退场",color:"#d86344"},{key:"attention",label:"强调",color:"#e8b76a"}],F=(0,c.iH)("in");(0,u.YP)((function(){return T.value}),(function(){O.value=!1}));var A=(0,c.iH)(""),O=(0,c.iH)(!1),P=_l(),R=P.addHistorySnapshot,B=(0,u.Fl)((function(){for(var e=[],t=0;t<W.value.length;t++)for(var l=W.value[t],a=function(){var a=l.animations[o],i=U.value.elements.find((function(e){return e.id===a.elId}));if(!i)return 1;var r=Zo[i.type],u=n[a.effect];e.push((0,g.Z)((0,g.Z)({},a),{},{index:0===o?t+1:"",elType:r,animationEffect:u}))},o=0;o<l.animations.length;o++)a();return e})),z=(0,u.Fl)((function(){var e=D.value,t=e.filter((function(e){return e.elId===T.value}));return t||[]})),N=function(e){var t=D.value.filter((function(t){return t.id!==e}));L.updateSlide({animations:t}),R()},j=function(e){var t=e.newIndex,n=e.oldIndex;if(void 0!==t&&void 0!==n&&t!==n){var l=JSON.parse(JSON.stringify(D.value)),a=l[n];l.splice(n,1),l.splice(t,0,a),L.updateSlide({animations:l}),R()}},Y=function(e,t,n){var l=document.querySelector("#editable-element-".concat(e," [class^=editable-element-]"));if(l){var a="".concat(hk).concat(t);document.documentElement.style.setProperty("--animate-duration","".concat(n,"ms")),l.classList.add("".concat(hk,"animated"),a);var o=function(){document.documentElement.style.removeProperty("--animate-duration"),l.classList.remove("".concat(hk,"animated"),a)};l.addEventListener("animationend",o,{once:!0})}},J=function(e,t){if(!(t<100||t>5e3)){var n=D.value.map((function(n){return n.id===e?(0,g.Z)((0,g.Z)({},n),{},{duration:t}):n}));L.updateSlide({animations:n}),R()}},q=function(e,t){var n=D.value.map((function(n){return n.id===e?(0,g.Z)((0,g.Z)({},n),{},{trigger:t}):n}));L.updateSlide({animations:n}),R()},G=function(e,t){var n=D.value.map((function(n){return n.id===K.value?(0,g.Z)((0,g.Z)({},n),{},{type:e,effect:t}):n}));L.updateSlide({animations:n}),O.value=!1,R();var l=D.value.find((function(e){return e.elId===T.value})),a=(null===l||void 0===l?void 0:l.duration)||vk;setTimeout((function(){Y(T.value,t,a)}),0)},K=(0,c.iH)(""),Q=function(e,t){if(K.value)G(e,t);else{var n=JSON.parse(JSON.stringify(D.value));n.push({id:(0,s.x0)(10),elId:T.value,type:e,effect:t,duration:vk,trigger:pk}),L.updateSlide({animations:n}),O.value=!1,R(),setTimeout((function(){Y(T.value,t,vk)}),0)}},$=(0,c.iH)(!1),ee=function(e){e?setTimeout((function(){return $.value=!0}),600):$.value=!1},te=function(e){O.value=!0,K.value=e,ee(!0)},ne={in:mk,out:gk,attention:yk};return function(e,t){var n=(0,u.up)("IconEffects"),l=(0,u.up)("IconClick"),a=(0,u.up)("IconPlayOne"),o=(0,u.up)("IconCloseSmall"),i=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",bk,[(0,c.SU)(Z)?((0,u.wg)(),(0,u.iD)("div",kk,[(0,u.Wm)(lo,{trigger:"click",value:O.value,"onUpdate:value":[t[3]||(t[3]=function(e){return O.value=e}),t[4]||(t[4]=function(e){return ee(e)})],style:{width:"100%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(Jf,{tabs:H,value:F.value,"onUpdate:value":t[0]||(t[0]=function(e){return F.value=e}),tabsStyle:{marginBottom:"20px"},tabStyle:{width:"33.333%"},spaceAround:""},null,8,["value"]),((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(C,(function(e){return(0,u.wg)(),(0,u.iD)(u.HY,null,[F.value===e?((0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["animation-pool",e]),key:e},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(ne[e],(function(n){return(0,u.wg)(),(0,u.iD)("div",{class:"pool-type",key:n.name},[(0,u._)("div",_k,(0,pe.zw)(n.name)+"：",1),(0,u._)("div",Ik,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(n.children,(function(n){return(0,u.wg)(),(0,u.iD)("div",{class:"pool-item",key:n.name,onMouseenter:function(e){return A.value=n.value},onMouseleave:t[1]||(t[1]=function(e){return A.value=""}),onClick:function(t){return Q(e,n.value)}},[(0,u._)("div",{class:(0,pe.C_)(["animation-box",["".concat((0,c.SU)(hk),"animated"),"".concat((0,c.SU)(hk),"fast"),A.value===n.value&&"".concat((0,c.SU)(hk)).concat(n.value)]])},(0,pe.zw)(n.name),3)],40,Sk)})),128))])])})),128)),$.value?(0,u.kq)("",!0):((0,u.wg)(),(0,u.iD)("div",Ck))],2)):(0,u.kq)("",!0)],64)})),64))]})),default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{class:"element-animation-btn",onClick:t[2]||(t[2]=function(e){return K.value=""})},{default:(0,u.w5)((function(){return[(0,u.Wm)(n,{style:{"margin-right":"5px"}}),(0,u.Uk)(" Add animation ")]})),_:1})]})),_:1},8,["value"])])):((0,u.wg)(),(0,u.iD)("div",Lk,[(0,u.Wm)(l,{style:{"margin-right":"5px"}}),(0,u.Uk)(" Add animation to selected elements in canvas ")])),(0,u.Wm)(Ud),(0,u.Wm)((0,c.SU)(Uh()),{class:"animation-sequence",modelValue:B.value,animation:200,scroll:!0,scrollSensitivity:50,handle:".sequence-content",itemKey:"id",onEnd:j},{item:(0,u.w5)((function(e){var t,n,l=e.element;return[(0,u._)("div",{class:(0,pe.C_)(["sequence-item",[l.type,{active:(null===(t=(0,c.SU)(Z))||void 0===t?void 0:t.id)===l.elId}]])},[(0,u._)("div",Ek,[(0,u._)("div",Zk,(0,pe.zw)(l.index),1),(0,u._)("div",Tk," 【"+(0,pe.zw)(l.elType)+"】"+(0,pe.zw)(l.animationEffect),1),(0,u._)("div",Mk,[(0,u.wy)((0,u.Wm)(a,{class:"handler-btn",onClick:function(e){return Y(l.elId,l.effect,l.duration)}},null,8,["onClick"]),[[i,"Preview"]]),(0,u.wy)((0,u.Wm)(o,{class:"handler-btn",onClick:function(e){return N(l.id)}},null,8,["onClick"]),[[i,"Delete"]])])]),(null===(n=z.value[0])||void 0===n?void 0:n.elId)===l.elId?((0,u.wg)(),(0,u.iD)("div",Uk,[(0,u.Wm)(Ud,{style:{margin:"16px 0"}}),(0,u._)("div",Wk,[Dk,(0,u.Wm)(cp,{min:500,max:3e3,step:500,value:l.duration,"onUpdate:value":function(e){return J(l.id,e)},style:{width:"65%"}},null,8,["value","onUpdate:value"])]),(0,u._)("div",Hk,[Fk,(0,u.Wm)(ov,{value:l.trigger,"onUpdate:value":function(e){return q(l.id,e)},style:{width:"65%"},options:[{label:"active trigger",value:"click"},{label:"At the same time as the previous animation",value:"meantime"},{label:"After the previous animation",value:"auto"}]},null,8,["value","onUpdate:value"])]),(0,u._)("div",Ak,[(0,u.Wm)(Gf,{style:{width:"100%"},onClick:function(e){return te(l.id)}},{default:(0,u.w5)((function(){return[(0,u.Uk)("Change animation")]})),_:2},1032,["onClick"])])])):(0,u.kq)("",!0)],2)]})),_:1},8,["modelValue"])])}}}),Pk=(0,ll.Z)(Ok,[["__scopeId","data-v-4ef10c20"]]),Rk=Pk;var Bk=[{background:"#ffffff",fontColor:"#333333",fontname:"Microsoft Yahei",colors:["#5b9bd5","#ed7d31","#a5a5a5","#ffc000","#4472c4","#70ad47"]},{background:"#ffffff",fontColor:"#333333",fontname:"Microsoft Yahei",colors:["#83992a","#3c9670","#44709d","#a23b32","#d87728","#deb340"]},{background:"#ffffff",fontColor:"#333333",fontname:"Microsoft Yahei",colors:["#e48312","#bd582c","#865640","#9b8357","#c2bc80","#94a088"]},{background:"#ffffff",fontColor:"#333333",fontname:"Microsoft Yahei",colors:["#bdc8df","#003fa9","#f5ba00","#ff7567","#7676d9","#923ffc"]},{background:"#ffffff",fontColor:"#333333",fontname:"Microsoft Yahei",colors:["#90c225","#54a121","#e6b91e","#e86618","#c42f19","#918756"]},{background:"#ffffff",fontColor:"#333333",fontname:"Microsoft Yahei",colors:["#1cade4","#2683c6","#27ced7","#42ba97","#3e8853","#62a39f"]},{background:"#e9efd6",fontColor:"#333333",fontname:"Microsoft Yahei",colors:["#a5300f","#de7e18","#9f8351","#728653","#92aa4c","#6aac91"]},{background:"#17444e",fontColor:"#ffffff",fontname:"Microsoft Yahei",colors:["#b01513","#ea6312","#e6b729","#6bab90","#55839a","#9e5d9d"]},{background:"#36234d",fontColor:"#ffffff",fontname:"Microsoft Yahei",colors:["#b31166","#e33d6f","#e45f3c","#e9943a","#9b6bf2","#d63cd0"]},{background:"#247fad",fontColor:"#ffffff",fontname:"Microsoft Yahei",colors:["#052f61","#a50e82","#14967c","#6a9e1f","#e87d37","#c62324"]},{background:"#103f55",fontColor:"#ffffff",fontname:"Microsoft Yahei",colors:["#40aebd","#97e8d5","#a1cf49","#628f3e","#f2df3a","#fcb01c"]},{background:"#242367",fontColor:"#ffffff",fontname:"Microsoft Yahei",colors:["#ac3ec1","#477bd1","#46b298","#90ba4c","#dd9d31","#e25345"]},{background:"#e4b75e",fontColor:"#333333",fontname:"Microsoft Yahei",colors:["#f0a22e","#a5644e","#b58b80","#c3986d","#a19574","#c17529"]},{background:"#333333",fontColor:"#ffffff",fontname:"Microsoft Yahei",colors:["#bdc8df","#003fa9","#f5ba00","#ff7567","#7676d9","#923ffc"]}];const zk=function(){var e=V(),t=(0,o.Jk)(e),n=t.slides,l=t.currentSlide,a=t.theme,i=_l(),r=i.addHistorySnapshot,u=function(e){var t,n=[],l=(0,y.Z)(e.elements);try{for(l.s();!(t=l.n()).done;){var a=t.value;if("shape"===a.type&&0!==(0,B.Z)(a.fill).getAlpha()){var o=(0,B.Z)(a.fill).toRgbString();n.includes(o)||n.push(o)}if("text"===a.type&&a.fill&&0!==(0,B.Z)(a.fill).getAlpha()){var i=(0,B.Z)(a.fill).toRgbString();n.includes(i)||n.push(i)}if("table"===a.type&&a.theme&&0!==(0,B.Z)(a.theme.color).getAlpha()){var r=(0,B.Z)(a.theme.color).toRgbString();n.includes(r)||n.push(r)}if("chart"===a.type&&a.fill&&0!==(0,B.Z)(a.fill).getAlpha()){var u=(0,B.Z)(a.fill).toRgbString();n.includes(u)||n.push(u)}if("line"===a.type&&0!==(0,B.Z)(a.color).getAlpha()){var c=(0,B.Z)(a.color).toRgbString();n.includes(c)||n.push(c)}if("audio"===a.type&&0!==(0,B.Z)(a.color).getAlpha()){var s=(0,B.Z)(a.color).toRgbString();n.includes(s)||n.push(s)}}}catch(d){l.e(d)}finally{l.f()}return n},c=function(e,t){var n=u(e),l={};if(n.length>t.length){var a=(0,B.Z)(t[0]).analogous(n.length-t.length+10),o=a.map((function(e){return e.toHexString()})).slice(1);t.push.apply(t,(0,R.Z)(o))}for(var i=0;i<n.length;i++)l[n[i]]=t[i];return l},s=function(e,t){var n=c(e,t.colors);e.background&&"image"===e.background.type||(e.background={type:"solid",color:t.background});var l,a=(0,y.Z)(e.elements);try{for(a.s();!(l=a.n()).done;){var o=l.value;if("shape"===o.type&&(o.fill=n[(0,B.Z)(o.fill).toRgbString()]||o.fill,o.gradient&&delete o.gradient),"text"===o.type&&(o.fill&&(o.fill=n[(0,B.Z)(o.fill).toRgbString()]||o.fill),o.defaultColor=t.fontColor,o.defaultFontName=t.fontname),"table"===o.type){o.theme&&(o.theme.color=n[(0,B.Z)(o.theme.color).toRgbString()]||o.theme.color);var i,r=(0,y.Z)(o.data);try{for(r.s();!(i=r.n()).done;){var u,s=i.value,d=(0,y.Z)(s);try{for(d.s();!(u=d.n()).done;){var f=u.value;f.style&&(f.style.color=t.fontColor,f.style.fontname=t.fontname)}}catch(v){d.e(v)}finally{d.f()}}}catch(v){r.e(v)}finally{r.f()}}"chart"===o.type&&(o.themeColor=[n[(0,B.Z)(o.themeColor[0]).toRgbString()]]||0,o.gridColor=t.fontColor),"line"===o.type&&(o.color=n[(0,B.Z)(o.color).toRgbString()]||o.color),"audio"===o.type&&(o.color=n[(0,B.Z)(o.color).toRgbString()]||o.color),"latex"===o.type&&(o.color=t.fontColor)}}catch(v){a.e(v)}finally{a.f()}},d=function(t){var n=JSON.parse(JSON.stringify(l.value));s(n,t),e.updateSlide({background:n.background,elements:n.elements}),r()},f=function(t){var l,a=JSON.parse(JSON.stringify(n.value)),o=(0,y.Z)(a);try{for(o.s();!(l=o.n()).done;){var i=l.value;s(i,t)}}catch(u){o.e(u)}finally{o.f()}e.setTheme({backgroundColor:t.background,themeColor:t.colors[0],fontColor:t.fontColor,fontName:t.fontname}),e.setSlides(a),r()},v=function(){var t,l=arguments.length>0&&void 0!==arguments[0]&&arguments[0],o=JSON.parse(JSON.stringify(n.value)),i=a.value,u=i.themeColor,c=i.backgroundColor,s=i.fontColor,d=i.fontName,f=i.outline,v=i.shadow,p=(0,y.Z)(o);try{for(p.s();!(t=p.n()).done;){var h=t.value;h.background&&"image"===h.background.type||(h.background={type:"solid",color:c});var m,g=(0,y.Z)(h.elements);try{for(g.s();!(m=g.n()).done;){var w=m.value;if(l&&("outline"in w&&w.outline&&(w.outline=f),"shadow"in w&&w.shadow&&(w.shadow=v)),"shape"===w.type)w.fill=u;else if("line"===w.type)w.color=u;else if("text"===w.type)w.defaultColor=s,w.defaultFontName=d,w.fill&&(w.fill=u);else if("table"===w.type){w.theme&&(w.theme.color=u);var x,b=(0,y.Z)(w.data);try{for(b.s();!(x=b.n()).done;){var k,_=x.value,I=(0,y.Z)(_);try{for(I.s();!(k=I.n()).done;){var S=k.value;S.style&&(S.style.color=s,S.style.fontname=d)}}catch(C){I.e(C)}finally{I.f()}}}catch(C){b.e(C)}finally{b.f()}}else"chart"===w.type?(w.themeColor=[u],w.gridColor=s):"latex"===w.type?w.color=s:"audio"===w.type&&(w.color=u)}}catch(C){g.e(C)}finally{g.f()}}}catch(C){p.e(C)}finally{p.f()}e.setSlides(o),r()};return{applyPresetThemeToSingleSlide:d,applyPresetThemeToAllSlides:f,applyThemeToAllSlides:v}};var Nk=function(e){return(0,u.dD)("data-v-a0640428"),e=e(),(0,u.Cn)(),e},jk={class:"slide-design-panel"},Yk=Nk((function(){return(0,u._)("div",{class:"title"},"background fill",-1)})),Vk={class:"row"},Jk=Nk((function(){return(0,u._)("div",{style:{width:"10px"}},null,-1)})),qk={key:0,class:"background-image-wrapper"},Xk={class:"background-image"},Gk={key:1,class:"background-gradient-wrapper"},Kk={class:"row"},Qk=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Starting point color:",-1)})),$k={class:"row"},e_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"End color:",-1)})),t_={key:0,class:"row"},n_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Gradient angle:",-1)})),l_={class:"row"},a_={class:"row"},o_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Canvas size:",-1)})),i_={class:"title"},r_=Nk((function(){return(0,u._)("span",null,"global theme",-1)})),u_=Nk((function(){return(0,u._)("span",{class:"text"},"More",-1)})),c_={class:"row"},s_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Font:",-1)})),d_={class:"row"},f_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Font color:",-1)})),v_={class:"row"},p_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Background color:",-1)})),h_={class:"row"},m_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Theme color:",-1)})),g_={class:"row"},y_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Border style:",-1)})),w_={class:"row"},x_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Border color:",-1)})),b_={class:"row"},k_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Border thickness:",-1)})),__={class:"row",style:{height:"30px"}},I_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Horizontal shadow:",-1)})),S_={class:"row",style:{height:"30px"}},C_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Vertical shadow:",-1)})),L_={class:"row",style:{height:"30px"}},E_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Blur:",-1)})),Z_={class:"row"},T_=Nk((function(){return(0,u._)("div",{style:{width:"40%"}},"Shadow color:",-1)})),M_={class:"row"},U_=Nk((function(){return(0,u._)("div",{class:"title"},"Preset themes",-1)})),W_={class:"theme-list"},D_={class:"theme-item-content"},H_={class:"colors"},F_={class:"btns"},A_=["onClick"],O_=["onClick"];const P_=(0,u.aZ)({__name:"SlideDesignPanel",setup:function(e){var t=V(),n=(0,o.Jk)(X()),l=n.availableFonts,a=(0,o.Jk)(t),i=a.slides,r=a.currentSlide,s=a.viewportRatio,d=a.theme,f=(0,c.iH)(!1),v=(0,u.Fl)((function(){return r.value.background?r.value.background:{type:"solid",value:"#fff"}})),p=_l(),h=p.addHistorySnapshot,m=zk(),y=m.applyPresetThemeToSingleSlide,w=m.applyPresetThemeToAllSlides,x=m.applyThemeToAllSlides,b=function(e){if("solid"===e){var n=(0,g.Z)((0,g.Z)({},v.value),{},{type:"solid",color:v.value.color||"#fff"});t.updateSlide({background:n})}else if("image"===e){var l=(0,g.Z)((0,g.Z)({},v.value),{},{type:"image",image:v.value.image||"",imageSize:v.value.imageSize||"cover"});t.updateSlide({background:l})}else{var a=(0,g.Z)((0,g.Z)({},v.value),{},{type:"gradient",gradientType:v.value.gradientType||"linear",gradientColor:v.value.gradientColor||["#fff","#fff"],gradientRotate:v.value.gradientRotate||0});t.updateSlide({background:a})}h()},k=function(e){t.updateSlide({background:(0,g.Z)((0,g.Z)({},v.value),e)}),h()},_=function(e){var t=e[0];t&&yl(t).then((function(e){return k({image:e})}))},I=function(){var e=i.value.map((function(e){return(0,g.Z)((0,g.Z)({},e),{},{background:r.value.background})}));t.setSlides(e),h()},S=function(e){t.setTheme(e)},C=function(e){t.setViewportRatio(e)};return function(e,t){var n=(0,u.up)("IconPlus"),a=(0,u.up)("IconDown"),o=(0,u.up)("IconRight");return(0,u.wg)(),(0,u.iD)("div",jk,[Yk,(0,u._)("div",Vk,[(0,u.Wm)(ov,{style:{flex:"1"},value:v.value.type,"onUpdate:value":t[0]||(t[0]=function(e){return b(e)}),options:[{label:"solid color fill",value:"solid"},{label:"Picture filling",value:"image"},{label:"gradient fill",value:"gradient"}]},null,8,["value"]),Jk,"solid"===v.value.type?((0,u.wg)(),(0,u.j4)(lo,{key:0,trigger:"click",style:{flex:"1"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:v.value.color,"onUpdate:modelValue":t[1]||(t[1]=function(e){return k({color:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:v.value.color||"#fff"},null,8,["color"])]})),_:1})):"image"===v.value.type?((0,u.wg)(),(0,u.j4)(ov,{key:1,style:{flex:"1"},value:v.value.imageSize||"cover","onUpdate:value":t[2]||(t[2]=function(e){return k({imageSize:e})}),options:[{label:"zoom",value:"contain"},{label:"collage",value:"repeat"},{label:"Scale to cover",value:"cover"}]},null,8,["value"])):((0,u.wg)(),(0,u.j4)(ov,{key:2,style:{flex:"1"},value:v.value.gradientType||"","onUpdate:value":t[3]||(t[3]=function(e){return k({gradientType:e})}),options:[{label:"linear gradient",value:"linear"},{label:"radial gradient",value:"radial"}]},null,8,["value"]))]),"image"===v.value.type?((0,u.wg)(),(0,u.iD)("div",qk,[(0,u.Wm)(hh,{onChange:t[4]||(t[4]=function(e){return _(e)})},{default:(0,u.w5)((function(){return[(0,u._)("div",Xk,[(0,u._)("div",{class:"content",style:(0,pe.j5)({backgroundImage:"url(".concat(v.value.image,")")})},[(0,u.Wm)(n)],4)])]})),_:1})])):(0,u.kq)("",!0),"gradient"===v.value.type?((0,u.wg)(),(0,u.iD)("div",Gk,[(0,u._)("div",Kk,[Qk,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:v.value.gradientColor[0],"onUpdate:modelValue":t[5]||(t[5]=function(e){return k({gradientColor:[e,v.value.gradientColor[1]]})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:v.value.gradientColor[0]},null,8,["color"])]})),_:1})]),(0,u._)("div",$k,[e_,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:v.value.gradientColor[1],"onUpdate:modelValue":t[6]||(t[6]=function(e){return k({gradientColor:[v.value.gradientColor[0],e]})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:v.value.gradientColor[1]},null,8,["color"])]})),_:1})]),"linear"===v.value.gradientType?((0,u.wg)(),(0,u.iD)("div",t_,[n_,(0,u.Wm)(qh,{min:0,max:360,step:15,value:v.value.gradientRotate||0,"onUpdate:value":t[7]||(t[7]=function(e){return k({gradientRotate:e})}),style:{width:"60%"}},null,8,["value"])])):(0,u.kq)("",!0)])):(0,u.kq)("",!0),(0,u._)("div",l_,[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[8]||(t[8]=function(e){return I()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Apply background to all")]})),_:1})]),(0,u.Wm)(Ud),(0,u._)("div",a_,[o_,(0,u.Wm)(ov,{style:{width:"60%"},value:(0,c.SU)(s),"onUpdate:value":t[9]||(t[9]=function(e){return C(e)}),options:[{label:"Widescreen 16 : 9",value:.5625},{label:"Widescreen 16 : 10",value:.625},{label:"Standard 4 : 3",value:.75},{label:"Paper A3 / A4",value:.70710678}]},null,8,["value"])]),(0,u.Wm)(Ud),(0,u._)("div",i_,[r_,(0,u._)("span",{class:"more",onClick:t[10]||(t[10]=function(e){return f.value=!f.value})},[u_,f.value?((0,u.wg)(),(0,u.j4)(a,{key:0})):((0,u.wg)(),(0,u.j4)(o,{key:1}))])]),(0,u._)("div",c_,[s_,(0,u.Wm)(ov,{style:{width:"60%"},value:(0,c.SU)(d).fontName,"onUpdate:value":t[11]||(t[11]=function(e){return S({fontName:e})}),options:[].concat((0,R.Z)((0,c.SU)(l)),(0,R.Z)((0,c.SU)(O)))},null,8,["value","options"])]),(0,u._)("div",d_,[f_,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(d).fontColor,"onUpdate:modelValue":t[12]||(t[12]=function(e){return S({fontColor:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:(0,c.SU)(d).fontColor},null,8,["color"])]})),_:1})]),(0,u._)("div",v_,[p_,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(d).backgroundColor,"onUpdate:modelValue":t[13]||(t[13]=function(e){return S({backgroundColor:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:(0,c.SU)(d).backgroundColor},null,8,["color"])]})),_:1})]),(0,u._)("div",h_,[m_,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(d).themeColor,"onUpdate:modelValue":t[14]||(t[14]=function(e){return S({themeColor:e})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:(0,c.SU)(d).themeColor},null,8,["color"])]})),_:1})]),f.value?((0,u.wg)(),(0,u.iD)(u.HY,{key:2},[(0,u._)("div",g_,[y_,(0,u.Wm)(ov,{style:{width:"60%"},value:(0,c.SU)(d).outline.style||"","onUpdate:value":t[15]||(t[15]=function(e){return S({outline:(0,g.Z)((0,g.Z)({},(0,c.SU)(d).outline),{},{style:e})})}),options:[{label:"solid border",value:"solid"},{label:"dashed border",value:"dashed"}]},null,8,["value"])]),(0,u._)("div",w_,[x_,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(d).outline.color,"onUpdate:modelValue":t[16]||(t[16]=function(e){return S({outline:(0,g.Z)((0,g.Z)({},(0,c.SU)(d).outline),{},{color:e})})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:(0,c.SU)(d).outline.color||"#000"},null,8,["color"])]})),_:1})]),(0,u._)("div",b_,[k_,(0,u.Wm)(cp,{value:(0,c.SU)(d).outline.width||0,"onUpdate:value":t[17]||(t[17]=function(e){return S({outline:(0,g.Z)((0,g.Z)({},(0,c.SU)(d).outline),{},{width:e})})}),style:{width:"60%"}},null,8,["value"])]),(0,u._)("div",__,[I_,(0,u.Wm)(qh,{style:{width:"60%"},min:-10,max:10,step:1,value:(0,c.SU)(d).shadow.h,"onUpdate:value":t[18]||(t[18]=function(e){return S({shadow:(0,g.Z)((0,g.Z)({},(0,c.SU)(d).shadow),{},{h:e})})})},null,8,["value"])]),(0,u._)("div",S_,[C_,(0,u.Wm)(qh,{style:{width:"60%"},min:-10,max:10,step:1,value:(0,c.SU)(d).shadow.v,"onUpdate:value":t[19]||(t[19]=function(e){return S({shadow:(0,g.Z)((0,g.Z)({},(0,c.SU)(d).shadow),{},{v:e})})})},null,8,["value"])]),(0,u._)("div",L_,[E_,(0,u.Wm)(qh,{style:{width:"60%"},min:1,max:20,step:1,value:(0,c.SU)(d).shadow.blur,"onUpdate:value":t[20]||(t[20]=function(e){return S({shadow:(0,g.Z)((0,g.Z)({},(0,c.SU)(d).shadow),{},{blur:e})})})},null,8,["value"])]),(0,u._)("div",Z_,[T_,(0,u.Wm)(lo,{trigger:"click",style:{width:"60%"}},{content:(0,u.w5)((function(){return[(0,u.Wm)(lg,{modelValue:(0,c.SU)(d).shadow.color,"onUpdate:modelValue":t[21]||(t[21]=function(e){return S({shadow:(0,g.Z)((0,g.Z)({},(0,c.SU)(d).shadow),{},{color:e})})})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u.Wm)(om,{color:(0,c.SU)(d).shadow.color},null,8,["color"])]})),_:1})])],64)):(0,u.kq)("",!0),(0,u._)("div",M_,[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[22]||(t[22]=function(e){return(0,c.SU)(x)(f.value)})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Apply theme to all")]})),_:1})]),(0,u.Wm)(Ud),U_,(0,u._)("div",W_,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(Bk),(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"theme-item",key:t,style:(0,pe.j5)({backgroundColor:e.background,fontFamily:e.fontname})},[(0,u._)("div",D_,[(0,u._)("div",{class:"text",style:(0,pe.j5)({color:e.fontColor})},"Word Aa",4),(0,u._)("div",H_,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.colors,(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"color-block",key:t,style:(0,pe.j5)({backgroundColor:e})},null,4)})),128))]),(0,u._)("div",F_,[(0,u._)("div",{class:"btn",onClick:function(t){return(0,c.SU)(y)(e)}}," Apply ",8,A_),(0,u._)("div",{class:"btn",onClick:function(t){return(0,c.SU)(w)(e)}}," Apply globally ",8,O_)])])],4)})),128))])])}}}),R_=(0,ll.Z)(P_,[["__scopeId","data-v-a0640428"]]),B_=R_;var z_={class:"slide-animation-panel"},N_={class:"animation-pool"},j_=["onClick"],Y_={class:"animation-text"};const V_=(0,u.aZ)({__name:"SlideAnimationPanel",setup:function(e){var t=V(),n=(0,o.Jk)(t),l=n.slides,a=n.currentSlide,i=(0,u.Fl)((function(){return a.value.turningMode||"slideY"})),r=wk,s=_l(),d=s.addHistorySnapshot,f=function(e){e!==i.value&&(t.updateSlide({turningMode:e}),d())},v=function(){var e=l.value.map((function(e){return(0,g.Z)((0,g.Z)({},e),{},{turningMode:a.value.turningMode})}));t.setSlides(e),dl.success("Applied to all"),d()};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",z_,[(0,u._)("div",N_,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(r),(function(e){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["animation-item",{active:i.value===e.value}]),key:e.label,onClick:function(t){return f(e.value)}},[(0,u._)("div",{class:(0,pe.C_)(["animation-block",e.value])},null,2),(0,u._)("div",Y_,(0,pe.zw)(e.label),1)],10,j_)})),128))]),(0,u.Wm)(Gf,{style:{width:"100%"},onClick:t[0]||(t[0]=function(e){return v()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Apply to all")]})),_:1})])}}}),J_=(0,ll.Z)(V_,[["__scopeId","data-v-65f3ea7e"]]),q_=J_,X_=function(){var e=V(),t=(0,o.Jk)(X()),n=t.activeElementIdList,l=t.activeElementList,a=(0,o.Jk)(e),i=a.currentSlide,r=_l(),u=r.addHistorySnapshot,c=function(t){var a,o=Te(l.value),r=o.minX,c=o.maxX,s=o.minY,d=o.maxY,v=JSON.parse(JSON.stringify(i.value.elements)),p={},h=(0,y.Z)(l.value);try{var m=function(){var e=a.value;if(e.groupId&&!p[e.groupId]){var t=l.value.filter((function(t){return t.groupId===e.groupId}));p[e.groupId]=Te(t)}};for(h.s();!(a=h.n()).done;)m()}catch(x){h.e(x)}finally{h.f()}if(t===f.LEFT)v.forEach((function(e){if(n.value.includes(e.id))if(e.groupId){var t=p[e.groupId],l=t.minX-r;e.left=e.left-l}else if("rotate"in e&&e.rotate){var a=Ee({left:e.left,top:e.top,width:e.width,height:e.height,rotate:e.rotate}),o=a.offsetX;e.left=r-o}else e.left=r}));else if(t===f.RIGHT)v.forEach((function(e){if(n.value.includes(e.id))if(e.groupId){var t=p[e.groupId],l=t.maxX-c;e.left=e.left-l}else{var a="line"===e.type?Math.max(e.start[0],e.end[0]):e.width;if("rotate"in e&&e.rotate){var o=Ee({left:e.left,top:e.top,width:e.width,height:e.height,rotate:e.rotate}),i=o.offsetX;e.left=c-a+i}else e.left=c-a}}));else if(t===f.TOP)v.forEach((function(e){if(n.value.includes(e.id))if(e.groupId){var t=p[e.groupId],l=t.minY-s;e.top=e.top-l}else if("rotate"in e&&e.rotate){var a=Ee({left:e.left,top:e.top,width:e.width,height:e.height,rotate:e.rotate}),o=a.offsetY;e.top=s-o}else e.top=s}));else if(t===f.BOTTOM)v.forEach((function(e){if(n.value.includes(e.id))if(e.groupId){var t=p[e.groupId],l=t.maxY-d;e.top=e.top-l}else{var a="line"===e.type?Math.max(e.start[1],e.end[1]):e.height;if("rotate"in e&&e.rotate){var o=Ee({left:e.left,top:e.top,width:e.width,height:e.height,rotate:e.rotate}),i=o.offsetY;e.top=d-a+i}else e.top=d-a}}));else if(t===f.HORIZONTAL){var g=(r+c)/2;v.forEach((function(e){if(n.value.includes(e.id))if(e.groupId){var t=p[e.groupId],l=(t.maxX+t.minX)/2,a=l-g;e.left=e.left-a}else{var o="line"===e.type?Math.max(e.start[0],e.end[0]):e.width;e.left=g-o/2}}))}else if(t===f.VERTICAL){var w=(s+d)/2;v.forEach((function(e){if(n.value.includes(e.id))if(e.groupId){var t=p[e.groupId],l=(t.maxY+t.minY)/2,a=l-w;e.top=e.top-a}else{var o="line"===e.type?Math.max(e.start[1],e.end[1]):e.height;e.top=w-o/2}}))}e.updateSlide({elements:v}),u()};return{alignActiveElement:c}};n(65137);const G_=function(){var e=V(),t=(0,o.Jk)(X()),n=t.activeElementIdList,l=t.activeElementList,a=(0,o.Jk)(e),i=a.currentSlide,r=_l(),c=r.addHistorySnapshot,s=(0,u.Fl)((function(){var e,t=0,n=[],a=(0,y.Z)(l.value);try{for(a.s();!(e=a.n()).done;){var o=e.value;o.groupId?n.includes(o.groupId)||(n.push(o.groupId),t+=1):t+=1}}catch(i){a.e(i)}finally{a.f()}return t})),d=function(){var t,a=Te(l.value),o=a.minX,r=a.maxX,u=JSON.parse(JSON.stringify(l.value)),s=JSON.parse(JSON.stringify(i.value.elements)),d=[],f=[],v=(0,y.Z)(u);try{var p=function(){var e=t.value;if(e.groupId){var n=f.find((function(t){return t.groupId===e.groupId}));n?f=f.map((function(t){return t.groupId===e.groupId?(0,g.Z)((0,g.Z)({},t),{},{els:[].concat((0,R.Z)(t.els),[e])}):t})):f.push({groupId:e.groupId,els:[e]})}else{var l=Ze(e),a=l.minX,o=l.maxX;d.push({min:a,max:o,el:e})}};for(v.s();!(t=v.n()).done;)p()}catch(oe){v.e(oe)}finally{v.f()}var h,m=[],w=(0,y.Z)(f);try{for(w.s();!(h=w.n()).done;){var x=h.value,b=Te(x.els),k=b.minX,_=b.maxX;m.push({min:k,max:_,els:x.els})}}catch(oe){w.e(oe)}finally{w.f()}var I=[].concat(d,m);I.sort((function(e,t){return e.min-t.min}));var S,C=0,L=(0,y.Z)(I);try{for(L.s();!(S=L.n()).done;){var E=S.value,Z=E.max-E.min;C+=Z}}catch(oe){L.e(oe)}finally{L.f()}var T=(r-o-C)/(I.length-1),M=[],U=I[0],W={min:U.min,max:U.max};if("el"in U)M.push({pos:U.min,el:U.el});else{var D,H=(0,y.Z)(U.els);try{for(H.s();!(D=H.n()).done;){var F=D.value,A=Ze(F),O=A.minX;M.push({pos:O,el:F})}}catch(oe){H.e(oe)}finally{H.f()}}for(var P=1;P<I.length;P++){var B=I[P],z=W.max-W.min,N=W.min+z+T,j=B.max-B.min;if(W={min:N,max:N+j},"el"in B)M.push({pos:N,el:B.el});else{var Y,V=(0,y.Z)(B.els);try{for(V.s();!(Y=V.n()).done;){var J=Y.value,q=Ze(J),X=q.minX,G=X-B.min;M.push({pos:N+G,el:J})}}catch(oe){V.e(oe)}finally{V.f()}}}var K,Q=(0,y.Z)(s);try{for(Q.s();!(K=Q.n()).done;){var $=K.value;if(n.value.includes($.id)){var ee,te=(0,y.Z)(M);try{for(te.s();!(ee=te.n()).done;){var ne=ee.value;if(ne.el.id===$.id)if("rotate"in $&&$.rotate){var le=Ee({left:$.left,top:$.top,width:$.width,height:$.height,rotate:$.rotate}),ae=le.offsetX;$.left=ne.pos-ae}else $.left=ne.pos}}catch(oe){te.e(oe)}finally{te.f()}}}}catch(oe){Q.e(oe)}finally{Q.f()}e.updateSlide({elements:s}),c()},f=function(){var t,a=Te(l.value),o=a.minY,r=a.maxY,u=JSON.parse(JSON.stringify(l.value)),s=JSON.parse(JSON.stringify(i.value.elements)),d=[],f=[],v=(0,y.Z)(u);try{var p=function(){var e=t.value;if(e.groupId){var n=f.find((function(t){return t.groupId===e.groupId}));n?f=f.map((function(t){return t.groupId===e.groupId?(0,g.Z)((0,g.Z)({},t),{},{els:[].concat((0,R.Z)(t.els),[e])}):t})):f.push({groupId:e.groupId,els:[e]})}else{var l=Ze(e),a=l.minY,o=l.maxY;d.push({min:a,max:o,el:e})}};for(v.s();!(t=v.n()).done;)p()}catch(oe){v.e(oe)}finally{v.f()}var h,m=[],w=(0,y.Z)(f);try{for(w.s();!(h=w.n()).done;){var x=h.value,b=Te(x.els),k=b.minY,_=b.maxY;m.push({min:k,max:_,els:x.els})}}catch(oe){w.e(oe)}finally{w.f()}var I=[].concat(d,m);I.sort((function(e,t){return e.min-t.min}));var S,C=0,L=(0,y.Z)(I);try{for(L.s();!(S=L.n()).done;){var E=S.value,Z=E.max-E.min;C+=Z}}catch(oe){L.e(oe)}finally{L.f()}var T=(r-o-C)/(I.length-1),M=[],U=I[0],W={min:U.min,max:U.max};if("el"in U)M.push({pos:U.min,el:U.el});else{var D,H=(0,y.Z)(U.els);try{for(H.s();!(D=H.n()).done;){var F=D.value,A=Ze(F),O=A.minY;M.push({pos:O,el:F})}}catch(oe){H.e(oe)}finally{H.f()}}for(var P=1;P<I.length;P++){var B=I[P],z=W.max-W.min,N=W.min+z+T,j=B.max-B.min;if(W={min:N,max:N+j},"el"in B)M.push({pos:N,el:B.el});else{var Y,V=(0,y.Z)(B.els);try{for(V.s();!(Y=V.n()).done;){var J=Y.value,q=Ze(J),X=q.minY,G=X-B.min;M.push({pos:N+G,el:J})}}catch(oe){V.e(oe)}finally{V.f()}}}var K,Q=(0,y.Z)(s);try{for(Q.s();!(K=Q.n()).done;){var $=K.value;if(n.value.includes($.id)){var ee,te=(0,y.Z)(M);try{for(te.s();!(ee=te.n()).done;){var ne=ee.value;if(ne.el.id===$.id)if("rotate"in $&&$.rotate){var le=Ee({left:$.left,top:$.top,width:$.width,height:$.height,rotate:$.rotate}),ae=le.offsetY;$.top=ne.pos-ae}else $.top=ne.pos}}catch(oe){te.e(oe)}finally{te.f()}}}}catch(oe){Q.e(oe)}finally{Q.f()}e.updateSlide({elements:s}),c()};return{displayItemCount:s,uniformHorizontalDisplay:d,uniformVerticalDisplay:f}};var K_={class:"multi-position-panel"};const Q_=(0,u.aZ)({__name:"MultiPositionPanel",setup:function(e){var t=Tl(),n=t.canCombine,l=t.combineElements,a=t.uncombineElements,o=X_(),i=o.alignActiveElement,r=Po(),s=r.alignElementToCanvas,d=G_(),v=d.displayItemCount,p=d.uniformHorizontalDisplay,h=d.uniformVerticalDisplay,m=function(e){n.value?i(e):s(e)};return function(e,t){var o=(0,u.up)("IconAlignLeft"),i=(0,u.up)("IconAlignHorizontally"),r=(0,u.up)("IconAlignRight"),s=(0,u.up)("IconAlignTop"),d=(0,u.up)("IconAlignVertically"),g=(0,u.up)("IconAlignBottom"),y=(0,u.up)("IconGroup"),w=(0,u.up)("IconUngroup"),x=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",K_,[(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[0]||(t[0]=function(e){return m((0,c.SU)(f).LEFT)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(o)]})),_:1})),[[x,"Align left"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[1]||(t[1]=function(e){return m((0,c.SU)(f).HORIZONTAL)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(i)]})),_:1})),[[x,"Horizontally centered"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[2]||(t[2]=function(e){return m((0,c.SU)(f).RIGHT)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(r)]})),_:1})),[[x,"Align right"]])]})),_:1}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[3]||(t[3]=function(e){return m((0,c.SU)(f).TOP)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(s)]})),_:1})),[[x,"Align top"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[4]||(t[4]=function(e){return m((0,c.SU)(f).VERTICAL)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(d)]})),_:1})),[[x,"Vertically centered"]]),(0,u.wy)(((0,u.wg)(),(0,u.j4)(Gf,{style:{flex:"1"},onClick:t[5]||(t[5]=function(e){return m((0,c.SU)(f).BOTTOM)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(g)]})),_:1})),[[x,"Align bottom"]])]})),_:1}),(0,c.SU)(v)>2?((0,u.wg)(),(0,u.j4)(Xg,{key:0,class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[6]||(t[6]=function(e){return(0,c.SU)(p)()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Horizontal uniform distribution")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[7]||(t[7]=function(e){return(0,c.SU)(h)()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Vertically uniform distribution")]})),_:1})]})),_:1})):(0,u.kq)("",!0),(0,u.Wm)(Ud),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{disabled:!(0,c.SU)(n),onClick:t[8]||(t[8]=function(e){return(0,c.SU)(l)()}),style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(y,{style:{"margin-right":"3px"}}),(0,u.Uk)("combination")]})),_:1},8,["disabled"]),(0,u.Wm)(Gf,{disabled:(0,c.SU)(n),onClick:t[9]||(t[9]=function(e){return(0,c.SU)(a)()}),style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(w,{style:{"margin-right":"3px"}}),(0,u.Uk)("Ungroup")]})),_:1},8,["disabled"])]})),_:1})])}}}),$_=(0,ll.Z)(Q_,[["__scopeId","data-v-0a9428b3"]]),eI=$_;var tI=[{key:"letter",label:"letter",children:["α","β","γ","δ","ϵ","ε","ζ","η","θ","ϑ","ι","κ","λ","μ","ν","ξ","π","ϖ","ρ","ϱ","σ","ς","τ","υ","ϕ","φ","χ","ψ","ω","Γ","Δ","Θ","Λ","Ξ","Π","Σ","Υ","Φ","Ψ","Ω","𝐀","𝐁","𝐂","𝐃","𝐄","𝐅","𝐆","𝐇","𝐈","𝐉","𝐊","𝐋","𝐌","𝐍","𝐎","𝐏","𝐐","𝐑","𝐒","𝐓","𝐔","𝐕","𝐖","𝐗","𝐘","𝐙","𝐚","𝐛","𝐜","𝐝","𝐞","𝐟","𝐠","𝐡","𝐢","𝐣","𝐤","𝐥","𝐦","𝐧","𝐨","𝐩","𝐪","𝐫","𝐬","𝐭","𝐮","𝐯","𝐰","𝐱","𝐲","𝐳","𝓐","𝓑","𝓒","𝓓","𝓔","𝓕","𝓖","𝓗","𝓘","𝓙","𝓚","𝓛","𝓜","𝓝","𝓞","𝓟","𝓠","𝓡","𝓢","𝓣","𝓤","𝓥","𝓦","𝓧","𝓨","𝓩","𝓪","𝓫","𝓬","𝓭","𝓮","𝓯","𝓰","𝓱","𝓲","𝓳","𝓴","𝓵","𝓶","𝓷","𝓸","𝓹","𝓺","𝓻","𝓼","𝓽","𝓾","𝓿","𝔀","𝔁","𝔂","𝔃"]},{key:"number",label:"number",children:["①","②","③","④","⑤","⑥","⑦","⑧","⑨","⑩","⑪","⑫","⑬","⑭","⑮","⑯","⑰","⑱","⑲","⑳","⑴","⑵","⑶","⑷","⑸","⑹","⑺","⑻","⑼","⑽","⑾","⑿","⒀","⒁","⒂","⒃","⒄","⒅","⒆","⒇","º","¹","²","³","⁴","⁵","⁶","⁷","⁸","⁹","₀","₁","₂","₃","₄","₅","₆","₇","₈","₉","Ⅰ","Ⅱ","Ⅲ","Ⅳ","Ⅴ","Ⅵ","Ⅶ","Ⅷ","Ⅸ","Ⅹ","Ⅺ","Ⅻ","Ⅼ","Ⅽ","Ⅾ","Ⅿ","ⅰ","ⅱ","ⅲ","ⅳ","ⅴ","ⅵ","ⅶ","ⅷ","ⅸ","ⅹ","ⅺ","ⅻ","ⅼ","ⅽ","ⅾ","ⅿ","ↀ","ↁ","ↂ","㊀","㊁","㊂","㊃","㊄","㊅","㊆","㊇","㊈","㊉","㈠","㈡","㈢","㈣","㈤","㈥","㈦","㈧","㈨","㈩","𝟘","𝟙","𝟚","𝟛","𝟜","𝟝","𝟞","𝟟","𝟠","𝟡"]},{key:"math",label:"math",children:["+","-","×","÷","=","~","¬","±","%","°","ǃ","‰","‱","½","⅓","⅔","¼","¾","<",">","l","o","g","l","g","l","n","⨂","⨁","⨄","⨃","⨅","⨆","√","∛","∜","∝","∞","∟","∠","∡","∢","∧","∨","∩","∪","∫","∬","∭","∮","∯","∰","∱","∲","∳","∴","∵","∼","∽","∾","∿","≃","≄","≅","≆","≇","≈","≊","≋","≌","≍","≎","≏","≐","≑","≒","≓","≔","≕","≤","≥","≦","≧","≨","≩","≪","≫","≺","≻","≼","≽","≾","≿","⊀","⊁","⊂","⊃","⊄","⊅","⊆","⊇","⊈","⊉","⊊","⊋","⊏","⊐","⊑","⊒","⊓","⊔","⊢","⊣","⊤","⊥","⊦","⊧","⊨","⊩","⊪","⊫","⊬","⊭","⊮","⊯","⊲","⊳","⊴","⊵","⋀","⋁","⋂","⋃","⋉","⋊","⋋","⋌","⟨","⟩","⟪","⟫","⟮","⟯","⧼","⧽","⦰"]},{key:"arrow",label:"arrow",children:["←","↑","→","↓","↔","↕","↖","↗","↘","↙","↚","↛","↜","↝","↞","↟","↠","↡","↢","↣","↤","↥","↦","↧","↨","↫","↬","↭","↮","↯","↰","↱","↲","↳","↴","↵","↶","↷","↸","↹","↺","↻","↼","↽","↾","↿","⇀","⇁","⇂","⇃","⇄","⇅","⇆","⇇","⇈","⇉","⇊","⇋","⇌","⇍","⇎","⇏","⇐","⇑","⇒","⇓","⇔","⇕","⇖","⇗","⇘","⇙","⇚","⇛","⇜","⇝","⇞","⇟","⇠","⇡","⇢","⇣","⇤","⇥","⇦","⇧","⇨","⇩","⇪","⇫","⇬","⇭","⇮","⇯","⇰","⇱","⇲","⇳","⇴","⇵","⇶","⇷","⇸","⇹","⇺","⇻","⇼","⇽","⇾","⇿"]},{key:"graph",label:"graph",children:["▢","▣","▤","▥","▦","▧","▨","▩","▭","▮","▯","▰","▱","▲","▷","▼","◁","◈","◉","◍","◐","◑","◒","◓","◔","◕","◧","◨","◩","◪","◫","◬","◭","◮"]}],nI={class:"symbol-panel"},lI={class:"pool"},aI=["onClick"],oI={class:"symbol"};const iI=(0,u.aZ)({__name:"SymbolPanel",setup:function(e){var t=(0,c.iH)(tI[0].key),n=(0,u.Fl)((function(){var e=tI.find((function(e){return e.key===t.value}));return(null===e||void 0===e?void 0:e.children)||[]})),l=tI.map((function(e){return{key:e.key,label:e.label}})),a=function(e){Mr.emit(_r.RICH_TEXT_COMMAND,{action:{command:"insert",value:e}})};return function(e,o){return(0,u.wg)(),(0,u.iD)("div",nI,[(0,u.Wm)(Jf,{tabs:(0,c.SU)(l),value:t.value,"onUpdate:value":o[0]||(o[0]=function(e){return t.value=e}),tabsStyle:{marginBottom:"8px"},spaceBetween:""},null,8,["tabs","value"]),(0,u._)("div",lI,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(n.value,(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"symbol-item",key:t,onClick:function(t){return a(e)}},[(0,u._)("div",oI,(0,pe.zw)(e),1)],8,aI)})),128))])])}}}),rI=(0,ll.Z)(iI,[["__scopeId","data-v-2bb5f257"]]),uI=rI;var cI={class:"toolbar"},sI={class:"content"};const dI=(0,u.aZ)({__name:"index",setup:function(e){var t=X(),n=(0,o.Jk)(t),a=n.activeElementIdList,i=n.handleElement,r=n.toolbarState,s=(0,u.Fl)((function(){var e;return"text"===(null===(e=i.value)||void 0===e?void 0:e.type)?[{label:"Style",key:l.EL_STYLE},{label:"symbol",key:l.SYMBOL},{label:"Position",key:l.EL_POSITION},{label:"animation",key:l.EL_ANIMATION}]:[{label:"Style",key:l.EL_STYLE},{label:"Position",key:l.EL_POSITION},{label:"animation",key:l.EL_ANIMATION}]})),d=[{label:"Design",key:l.SLIDE_DESIGN},{label:"Switch",key:l.SLIDE_ANIMATION},{label:"animation",key:l.EL_ANIMATION}],f=[{label:"Style",key:l.EL_STYLE},{label:"Position",key:l.MULTI_POSITION}],v=function(e){t.setToolbarState(e)},p=(0,u.Fl)((function(){return a.value.length?a.value.length>1?f:s.value:d}));(0,u.YP)(p,(function(){var e=p.value.map((function(e){return e.key}));e.includes(r.value)||t.setToolbarState(e[0])}));var h=(0,u.Fl)((function(){var e=(0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)({},l.EL_STYLE,$b),l.EL_POSITION,fk),l.EL_ANIMATION,Rk),l.SLIDE_DESIGN,B_),l.SLIDE_ANIMATION,q_),l.MULTI_POSITION,eI),l.SYMBOL,uI);return e[r.value]||null}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",cI,[(0,u.Wm)(Jf,{tabs:p.value,value:(0,c.SU)(r),card:"","onUpdate:value":t[0]||(t[0]=function(e){return v(e)})},null,8,["tabs","value"]),(0,u._)("div",sI,[((0,u.wg)(),(0,u.j4)((0,u.LL)(h.value)))])])}}}),fI=(0,ll.Z)(dI,[["__scopeId","data-v-460bd42d"]]),vI=fI;var pI={class:"editor"};const hI=(0,u.aZ)({__name:"Editor",props:{value:{}},emits:["update"],setup:function(e,t){var n,l=t.expose,a=t.emit,o=e,i=a,r=X(),s=(0,c.iH)(),d=(0,c.iH)(),f=(0,c.iH)(),v=(0,c.iH)(),p=function(){f.value&&f.value.hide()},h=(0,z.debounce)((function(){i("update",n.dom.innerHTML)}),300,{trailing:!0}),m=function(){r.setDisableHotkeysState(!0)},g=function(){r.setDisableHotkeysState(!1)},y=function(){if(n){var e=n.state,t=e.doc,l=e.tr;n.dispatch(l.replaceRangeWith(0,t.content.size,Lr(o.value)))}};l({updateTextContent:y});var k=function(){var e=window.getSelection();if(e&&e.anchorNode&&e.focusNode&&!e.isCollapsed&&"Caret"!==e.type&&"None"!==e.type){var t=e.getRangeAt(0);if(f.value){d.value=D(n);var l=t.getBoundingClientRect(),a=l.x,o=l.y,i=l.left,r=l.top;f.value.setProps({getReferenceClientRect:function(){return{x:a,y:o,left:i,top:r,height:0,width:0,right:i,bottom:r}}}),f.value.show()}}},_=function(e,t){if("color"===e&&t){var l=n.state.schema.marks.forecolor.create({color:t});x(n),b(n,l)}else if("backcolor"===e&&t){var a=n.state.schema.marks.backcolor.create({backcolor:t});x(n),b(n,a)}else if("bold"===e)x(n),(0,w.w9)(n.state.schema.marks.strong)(n.state,n.dispatch);else if("em"===e)x(n),(0,w.w9)(n.state.schema.marks.em)(n.state,n.dispatch);else if("underline"===e)x(n),(0,w.w9)(n.state.schema.marks.underline)(n.state,n.dispatch);else if("strikethrough"===e)x(n),(0,w.w9)(n.state.schema.marks.strikethrough)(n.state,n.dispatch);else if("bulletList"===e){var o=n.state.schema.nodes,i=o.bullet_list,r=o.list_item;Hr(i,r)(n.state,n.dispatch)}else if("orderedList"===e){var u=n.state.schema.nodes,c=u.ordered_list,s=u.list_item;Hr(c,s)(n.state,n.dispatch)}else if("clear"===e){x(n);var f=n.state.selection,v=f.$from,p=f.$to;n.dispatch(n.state.tr.removeMark(v.pos,p.pos))}n.focus(),h(),d.value=D(n)};return(0,u.bv)((function(){n=Er(s.value,o.value,{handleDOMEvents:{focus:m,blur:g,mouseup:k,mousedown:function(){var e;null===(e=window.getSelection())||void 0===e||e.removeAllRanges(),p()},keydown:p,input:h}},{placeholder:"点击输入演讲者备注"}),f.value=(0,eo.ZP)(s.value,{duration:0,content:v.value,interactive:!0,trigger:"manual",placement:"top-start",hideOnClick:"toggle",offset:[0,6]})})),(0,u.Ah)((function(){n&&n.destroy()})),function(e,t){var n,l,a,o,i,r,c=(0,u.up)("IconTextBold"),f=(0,u.up)("IconTextItalic"),h=(0,u.up)("IconTextUnderline"),m=(0,u.up)("IconStrikethrough"),g=(0,u.up)("IconText"),y=(0,u.up)("IconHighLight"),w=(0,u.up)("IconList"),x=(0,u.up)("IconOrderedList"),b=(0,u.up)("IconFormat"),k=(0,u.Q2)("click-outside");return(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",pI,[(0,u._)("div",{class:"prosemirror-editor",ref_key:"editorViewRef",ref:s},null,512),(0,u._)("div",{class:"menu",ref_key:"menuRef",ref:v},[(0,u._)("button",{class:(0,pe.C_)({active:null===(n=d.value)||void 0===n?void 0:n.bold}),onClick:t[0]||(t[0]=function(e){return _("bold")})},[(0,u.Wm)(c)],2),(0,u._)("button",{class:(0,pe.C_)({active:null===(l=d.value)||void 0===l?void 0:l.em}),onClick:t[1]||(t[1]=function(e){return _("em")})},[(0,u.Wm)(f)],2),(0,u._)("button",{class:(0,pe.C_)({active:null===(a=d.value)||void 0===a?void 0:a.underline}),onClick:t[2]||(t[2]=function(e){return _("underline")})},[(0,u.Wm)(h)],2),(0,u._)("button",{class:(0,pe.C_)({active:null===(o=d.value)||void 0===o?void 0:o.strikethrough}),onClick:t[3]||(t[3]=function(e){return _("strikethrough")})},[(0,u.Wm)(m)],2),(0,u.Wm)(lo,{trigger:"click",style:{width:"30%"}},{content:(0,u.w5)((function(){var e;return[(0,u.Wm)(lg,{modelValue:null===(e=d.value)||void 0===e?void 0:e.color,"onUpdate:modelValue":t[4]||(t[4]=function(e){return _("color",e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u._)("button",null,[(0,u.Wm)(g)])]})),_:1}),(0,u.Wm)(lo,{trigger:"click",style:{width:"30%"}},{content:(0,u.w5)((function(){var e;return[(0,u.Wm)(lg,{modelValue:null===(e=d.value)||void 0===e?void 0:e.backcolor,"onUpdate:modelValue":t[5]||(t[5]=function(e){return _("backcolor",e)})},null,8,["modelValue"])]})),default:(0,u.w5)((function(){return[(0,u._)("button",null,[(0,u.Wm)(y)])]})),_:1}),(0,u._)("button",{class:(0,pe.C_)({active:null===(i=d.value)||void 0===i?void 0:i.bulletList}),onClick:t[6]||(t[6]=function(e){return _("bulletList")})},[(0,u.Wm)(w)],2),(0,u._)("button",{class:(0,pe.C_)({active:null===(r=d.value)||void 0===r?void 0:r.orderedList}),onClick:t[7]||(t[7]=function(e){return _("orderedList")})},[(0,u.Wm)(x)],2),(0,u._)("button",{onClick:t[8]||(t[8]=function(e){return _("clear")})},[(0,u.Wm)(b)])],512)])),[[k,p]])}}}),mI=(0,ll.Z)(hI,[["__scopeId","data-v-0ebc507c"]]),gI=mI;var yI={class:"remark"};const wI=(0,u.aZ)({__name:"index",props:{height:{}},emits:["update:height"],setup:function(e,t){var n=t.emit,l=e,a=n,i=V(),r=(0,o.Jk)(i),s=r.currentSlide,d=(0,c.iH)();(0,u.YP)((function(){return s.value.id}),(function(){(0,u.Y3)((function(){d.value.updateTextContent()}))}),{immediate:!0});var f=(0,u.Fl)((function(){var e;return(null===(e=s.value)||void 0===e?void 0:e.remark)||""})),v=function(e){i.updateSlide({remark:e})},p=function(e){var t=!0,n=e.pageY,o=l.height;document.onmousemove=function(e){if(t){var l=e.pageY,i=l-n,r=-i+o;r<40&&(r=40),r>360&&(r=360),a("update:height",r)}},document.onmouseup=function(){t=!1,document.onmousemove=null,document.onmouseup=null}};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",yI,[(0,u._)("div",{class:"resize-handler",onMousedown:t[0]||(t[0]=function(e){return p(e)})},null,32),(0,u.Wm)(gI,{value:f.value,ref_key:"editorRef",ref:d,onUpdate:t[1]||(t[1]=function(e){return v(e)})},null,8,["value"])])}}}),xI=(0,ll.Z)(wI,[["__scopeId","data-v-458a41b9"]]),bI=xI;var kI=function(e){return(0,u.dD)("data-v-b20615f0"),e=e(),(0,u.Cn)(),e},_I={class:"export-img-dialog"},II={class:"thumbnails-view"},SI={class:"configs"},CI={class:"row"},LI=kI((function(){return(0,u._)("div",{class:"title"},"Export format:",-1)})),EI={class:"row"},ZI=kI((function(){return(0,u._)("div",{class:"title"},"Export range:",-1)})),TI={key:0,class:"row"},MI=["data-range"],UI={class:"row"},WI=kI((function(){return(0,u._)("div",{class:"title"},"Picture quality:",-1)})),DI={class:"row"},HI=kI((function(){return(0,u._)("div",{class:"title"},"Ignore online fonts:",-1)})),FI={class:"config-item"},AI={class:"btns"};const OI=(0,u.aZ)({__name:"ExportImage",emits:["close"],setup:function(e,t){var n=t.emit,l=n,a=(0,o.Jk)(V()),i=a.slides,r=a.currentSlide,s=(0,c.iH)(),d=(0,c.iH)("all"),f=(0,c.iH)([1,i.value.length]),v=(0,c.iH)("jpeg"),p=(0,c.iH)(1),h=(0,c.iH)(!0),m=(0,u.Fl)((function(){return"all"===d.value?i.value:"current"===d.value?[r.value]:i.value.filter((function(e,t){var n=(0,ne.Z)(f.value,2),l=n[0],a=n[1];return t>=l-1&&t<=a-1}))})),g=Ea(),y=g.exportImage,w=g.exporting,x=function(){s.value&&y(s.value,v.value,p.value,h.value)};return function(e,t){var n=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",_I,[(0,u._)("div",II,[(0,u._)("div",{class:"thumbnails",ref_key:"imageThumbnailsRef",ref:s},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(m.value,(function(e){return(0,u.wg)(),(0,u.j4)(Nf,{class:"thumbnail",key:e.id,slide:e,size:1600},null,8,["slide"])})),128))],512)]),(0,u._)("div",SI,[(0,u._)("div",CI,[LI,(0,u.Wm)(ty,{class:"config-item",value:v.value,"onUpdate:value":t[0]||(t[0]=function(e){return v.value=e})},{default:(0,u.w5)((function(){return[(0,u.Wm)(Qg,{style:{width:"50%"},value:"jpeg"},{default:(0,u.w5)((function(){return[(0,u.Uk)("JPEG")]})),_:1}),(0,u.Wm)(Qg,{style:{width:"50%"},value:"png"},{default:(0,u.w5)((function(){return[(0,u.Uk)("PNG")]})),_:1})]})),_:1},8,["value"])]),(0,u._)("div",EI,[ZI,(0,u.Wm)(ty,{class:"config-item",value:d.value,"onUpdate:value":t[1]||(t[1]=function(e){return d.value=e})},{default:(0,u.w5)((function(){return[(0,u.Wm)(Qg,{style:{width:"33.33%"},value:"all"},{default:(0,u.w5)((function(){return[(0,u.Uk)("All")]})),_:1}),(0,u.Wm)(Qg,{style:{width:"33.33%"},value:"current"},{default:(0,u.w5)((function(){return[(0,u.Uk)("Current page")]})),_:1}),(0,u.Wm)(Qg,{style:{width:"33.33%"},value:"custom"},{default:(0,u.w5)((function(){return[(0,u.Uk)("Custom")]})),_:1})]})),_:1},8,["value"])]),"custom"===d.value?((0,u.wg)(),(0,u.iD)("div",TI,[(0,u._)("div",{class:"title","data-range":"（".concat(f.value[0]," ~ ").concat(f.value[1],"）")}," Custom scope: ",8,MI),(0,u.Wm)(qh,{class:"config-item",range:"",min:1,max:(0,c.SU)(i).length,step:1,value:f.value,"onUpdate:value":t[2]||(t[2]=function(e){return f.value=e})},null,8,["max","value"])])):(0,u.kq)("",!0),(0,u._)("div",UI,[WI,(0,u.Wm)(qh,{class:"config-item",min:0,max:1,step:.1,value:p.value,"onUpdate:value":t[3]||(t[3]=function(e){return p.value=e})},null,8,["value"])]),(0,u._)("div",DI,[HI,(0,u._)("div",FI,[(0,u.wy)((0,u.Wm)(cg,{value:h.value,"onUpdate:value":t[4]||(t[4]=function(e){return h.value=e})},null,8,["value"]),[[n,"Online fonts are ignored by default when exporting. If you use online fonts in your slides and want to retain related styles after exporting, you can choose to turn off the [Ignore online fonts] option, but be aware that this will increase the export time."]])])])]),(0,u._)("div",AI,[(0,u.Wm)(Gf,{class:"btn export",type:"primary",onClick:t[5]||(t[5]=function(e){return x()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Export pictures")]})),_:1}),(0,u.Wm)(Gf,{class:"btn close",onClick:t[6]||(t[6]=function(e){return l("close")})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Close")]})),_:1})]),(0,u.Wm)(Na,{loading:(0,c.SU)(w),tip:"Exporting..."},null,8,["loading"])])}}}),PI=(0,ll.Z)(OI,[["__scopeId","data-v-b20615f0"]]),RI=PI;var BI={class:"export-json-dialog"},zI={class:"preview"},NI={class:"btns"};const jI=(0,u.aZ)({__name:"ExportJSON",emits:["close"],setup:function(e,t){var n=t.emit,l=n,a=(0,o.Jk)(V()),i=a.slides,r=Ea(),s=r.exportJSON;return function(e,t){return(0,u.wg)(),(0,u.iD)("div",BI,[(0,u._)("div",zI,[(0,u._)("pre",null,(0,pe.zw)((0,c.SU)(i)),1)]),(0,u._)("div",NI,[(0,u.Wm)(Gf,{class:"btn export",type:"primary",onClick:t[0]||(t[0]=function(e){return(0,c.SU)(s)()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Export JSON")]})),_:1}),(0,u.Wm)(Gf,{class:"btn close",onClick:t[1]||(t[1]=function(e){return l("close")})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Close")]})),_:1})])])}}}),YI=(0,ll.Z)(jI,[["__scopeId","data-v-54468b83"]]),VI=YI;var JI=function(){var e=document.createElement("iframe");return e.style.width="0",e.style.height="0",e.style.position="absolute",e.style.right="0",e.style.top="0",e.style.border="0",document.body.appendChild(e),e},qI=function(e,t,n){var l="<!DOCTYPE html>",a="",o=document.styleSheets;if(o){var i,r=(0,y.Z)(o);try{for(r.s();!(i=r.n()).done;){var u=i.value;if(u.cssRules){var c,s=(0,y.Z)(u.cssRules);try{for(s.s();!(c=s.n()).done;){var d=c.value;a+=d.cssText}}catch(g){s.e(g)}finally{s.f()}}}}catch(g){r.e(g)}finally{r.f()}}var f=n.width,v=n.height,p=n.margin,h='\n    <head>\n      <style type="text/css">\n        '.concat(a," \n        html, body {\n          height: auto;\n          overflow: auto;\n        }\n        @media print {\n          @page {\n            size: ").concat(f+2*p,"px ").concat(v+2*p,"px;\n            margin: ").concat(p,"px;\n          }\n        }\n      </style>\n    </head>\n  "),m="<body>"+t.innerHTML+"</body>";e.open(),e.write("\n    ".concat(l,"\n    <html>\n      ").concat(h,"\n      ").concat(m,"\n    </html>\n  ")),e.close()},XI=function(e,t){var n=JI(),l=n.contentWindow;if(n.contentDocument&&l){qI(n.contentDocument,e,t);var a=function(){l.focus(),l.print()},o=function e(){n.removeEventListener("load",a),l.removeEventListener("afterprint",e),document.body.removeChild(n)};n.addEventListener("load",a),l.addEventListener("afterprint",o)}},GI=function(e){return(0,u.dD)("data-v-0bfd703e"),e=e(),(0,u.Cn)(),e},KI={class:"export-pdf-dialog"},QI={class:"thumbnails-view"},$I={class:"configs"},eS={class:"row"},tS=GI((function(){return(0,u._)("div",{class:"title"},"Export range:",-1)})),nS={class:"row"},lS=GI((function(){return(0,u._)("div",{class:"title"},"Quantity per page:",-1)})),aS={class:"row"},oS=GI((function(){return(0,u._)("div",{class:"title"},"Leave the edges blank:",-1)})),iS={class:"config-item"},rS=GI((function(){return(0,u._)("div",{class:"tip"}," Tip: If the print preview is inconsistent with the actual style, please check the [Background Graphics] option in the pop-up print window. ",-1)})),uS={class:"btns"};const cS=(0,u.aZ)({__name:"ExportPDF",emits:["close"],setup:function(e,t){var n=t.emit,l=n,a=(0,o.Jk)(V()),i=a.slides,r=a.currentSlide,s=a.viewportRatio,d=(0,c.iH)(),f=(0,c.iH)("all"),v=(0,c.iH)(1),p=(0,c.iH)(!0),h=function(){if(d.value){var e={width:1600,height:"all"===f.value?1600*s.value*v.value:1600*s.value,margin:p.value?50:0};XI(d.value,e)}};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",KI,[(0,u._)("div",QI,[(0,u._)("div",{class:"thumbnails",ref_key:"pdfThumbnailsRef",ref:d},["current"===f.value?((0,u.wg)(),(0,u.j4)(Nf,{key:0,class:"thumbnail",slide:(0,c.SU)(r),size:1600},null,8,["slide"])):((0,u.wg)(!0),(0,u.iD)(u.HY,{key:1},(0,u.Ko)((0,c.SU)(i),(function(e,t){return(0,u.wg)(),(0,u.j4)(Nf,{class:(0,pe.C_)(["thumbnail",{"break-page":(t+1)%v.value===0}]),key:e.id,slide:e,size:1600},null,8,["class","slide"])})),128))],512)]),(0,u._)("div",$I,[(0,u._)("div",eS,[tS,(0,u.Wm)(ty,{class:"config-item",value:f.value,"onUpdate:value":t[0]||(t[0]=function(e){return f.value=e})},{default:(0,u.w5)((function(){return[(0,u.Wm)(Qg,{style:{width:"50%"},value:"all"},{default:(0,u.w5)((function(){return[(0,u.Uk)("All")]})),_:1}),(0,u.Wm)(Qg,{style:{width:"50%"},value:"current"},{default:(0,u.w5)((function(){return[(0,u.Uk)("Current")]})),_:1})]})),_:1},8,["value"])]),(0,u._)("div",nS,[lS,(0,u.Wm)(ov,{class:"config-item",value:v.value,"onUpdate:value":t[1]||(t[1]=function(e){return v.value=e}),options:[{label:"1",value:1},{label:"2",value:2},{label:"3",value:3}]},null,8,["value"])]),(0,u._)("div",aS,[oS,(0,u._)("div",iS,[(0,u.Wm)(cg,{value:p.value,"onUpdate:value":t[2]||(t[2]=function(e){return p.value=e})},null,8,["value"])])]),rS]),(0,u._)("div",uS,[(0,u.Wm)(Gf,{class:"btn export",type:"primary",onClick:t[3]||(t[3]=function(e){return h()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Print/Export PDF")]})),_:1}),(0,u.Wm)(Gf,{class:"btn close",onClick:t[4]||(t[4]=function(e){return l("close")})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Close")]})),_:1})])])}}}),sS=(0,ll.Z)(cS,[["__scopeId","data-v-0bfd703e"]]),dS=sS;var fS=function(e){return(0,u.dD)("data-v-23847792"),e=e(),(0,u.Cn)(),e},vS={class:"export-pptx-dialog"},pS={class:"configs"},hS={class:"row"},mS=fS((function(){return(0,u._)("div",{class:"title"},"Export range:",-1)})),gS={key:0,class:"row"},yS=["data-range"],wS={class:"row"},xS=fS((function(){return(0,u._)("div",{class:"title"},"Ignore audio/video：",-1)})),bS={class:"config-item"},kS={class:"row"},_S=fS((function(){return(0,u._)("div",{class:"title"},"Override the default master:",-1)})),IS={class:"config-item"},SS={key:1,class:"tip"},CS={class:"btns"};const LS=(0,u.aZ)({__name:"ExportPPTX",emits:["close"],setup:function(e,t){var n=t.emit,l=n,a=(0,o.Jk)(V()),i=a.slides,r=a.currentSlide,s=Ea(),d=s.exportPPTX,f=s.exporting,v=(0,c.iH)("all"),p=(0,c.iH)([1,i.value.length]),h=(0,c.iH)(!0),m=(0,c.iH)(!0),g=(0,u.Fl)((function(){return"all"===v.value?i.value:"current"===v.value?[r.value]:i.value.filter((function(e,t){var n=(0,ne.Z)(p.value,2),l=n[0],a=n[1];return t>=l-1&&t<=a-1}))}));return function(e,t){var n=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",vS,[(0,u._)("div",pS,[(0,u._)("div",hS,[mS,(0,u.Wm)(ty,{class:"config-item",value:v.value,"onUpdate:value":t[0]||(t[0]=function(e){return v.value=e})},{default:(0,u.w5)((function(){return[(0,u.Wm)(Qg,{style:{width:"33.33%"},value:"all"},{default:(0,u.w5)((function(){return[(0,u.Uk)("All")]})),_:1}),(0,u.Wm)(Qg,{style:{width:"33.33%"},value:"current"},{default:(0,u.w5)((function(){return[(0,u.Uk)("Current page")]})),_:1}),(0,u.Wm)(Qg,{style:{width:"33.33%"},value:"custom"},{default:(0,u.w5)((function(){return[(0,u.Uk)("Custom")]})),_:1})]})),_:1},8,["value"])]),"custom"===v.value?((0,u.wg)(),(0,u.iD)("div",gS,[(0,u._)("div",{class:"title","data-range":"（".concat(p.value[0]," ~ ").concat(p.value[1],"）")}," Custom scope: ",8,yS),(0,u.Wm)(qh,{class:"config-item",range:"",min:1,max:(0,c.SU)(i).length,step:1,value:p.value,"onUpdate:value":t[1]||(t[1]=function(e){return p.value=e})},null,8,["max","value"])])):(0,u.kq)("",!0),(0,u._)("div",wS,[xS,(0,u._)("div",bS,[(0,u.wy)((0,u.Wm)(cg,{value:m.value,"onUpdate:value":t[2]||(t[2]=function(e){return m.value=e})},null,8,["value"]),[[n,"Audio and video are ignored by default when exporting. If there are audio and video elements in your slide and you want to export them to a PPTX file, you can choose to turn off the [Ignore audio and video] option, but be aware that this will significantly increase the export time."]])])]),(0,u._)("div",kS,[_S,(0,u._)("div",IS,[(0,u.Wm)(cg,{value:h.value,"onUpdate:value":t[3]||(t[3]=function(e){return h.value=e})},null,8,["value"])])]),m.value?(0,u.kq)("",!0):((0,u.wg)(),(0,u.iD)("div",SS," Tips: 1. Supported export formats: avi, mp4, mov, wmv, mp3, wav; 2. Cross-domain resources cannot be exported. "))]),(0,u._)("div",CS,[(0,u.Wm)(Gf,{class:"btn export",type:"primary",onClick:t[4]||(t[4]=function(e){return(0,c.SU)(d)(g.value,h.value,m.value)})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Export PPTX")]})),_:1}),(0,u.Wm)(Gf,{class:"btn close",onClick:t[5]||(t[5]=function(e){return l("close")})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Close")]})),_:1})]),(0,u.Wm)(Na,{loading:(0,c.SU)(f),tip:"Exporting..."},null,8,["loading"])])}}}),ES=(0,ll.Z)(LS,[["__scopeId","data-v-23847792"]]),ZS=ES;var TS=function(e){return(0,u.dD)("data-v-521ab74f"),e=e(),(0,u.Cn)(),e},MS={class:"export-ppt-dialog"},US={class:"configs"},WS={class:"row"},DS=TS((function(){return(0,u._)("div",{class:"title"},"Export range: ",-1)})),HS={key:0,class:"row"},FS=["data-range"],AS=TS((function(){return(0,u._)("div",{class:"tip"}," Tip: .ppt is the unique file suffix of this application, and supports importing files of this type back into the application. ",-1)})),OS={class:"btns"};const PS=(0,u.aZ)({__name:"ExportSpecificFile",emits:["close"],setup:function(e,t){var n=t.emit,l=n,a=(0,o.Jk)(V()),i=a.slides,r=a.currentSlide,s=Ea(),d=s.exportSpecificFile,f=(0,c.iH)("all"),v=(0,c.iH)([1,i.value.length]),p=(0,u.Fl)((function(){return"all"===f.value?i.value:"current"===f.value?[r.value]:i.value.filter((function(e,t){var n=(0,ne.Z)(v.value,2),l=n[0],a=n[1];return t>=l-1&&t<=a-1}))}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",MS,[(0,u._)("div",US,[(0,u._)("div",WS,[DS,(0,u.Wm)(ty,{class:"config-item",value:f.value,"onUpdate:value":t[0]||(t[0]=function(e){return f.value=e})},{default:(0,u.w5)((function(){return[(0,u.Wm)(Qg,{style:{width:"33.33%"},value:"all"},{default:(0,u.w5)((function(){return[(0,u.Uk)("all")]})),_:1}),(0,u.Wm)(Qg,{style:{width:"33.33%"},value:"current"},{default:(0,u.w5)((function(){return[(0,u.Uk)("current")]})),_:1}),(0,u.Wm)(Qg,{style:{width:"33.33%"},value:"custom"},{default:(0,u.w5)((function(){return[(0,u.Uk)("custom")]})),_:1})]})),_:1},8,["value"])]),"custom"===f.value?((0,u.wg)(),(0,u.iD)("div",HS,[(0,u._)("div",{class:"title","data-range":"（".concat(v.value[0]," ~ ").concat(v.value[1],"）")},"Custom scope: ",8,FS),(0,u.Wm)(qh,{class:"config-item",range:"",min:1,max:(0,c.SU)(i).length,step:1,value:v.value,"onUpdate:value":t[1]||(t[1]=function(e){return v.value=e})},null,8,["max","value"])])):(0,u.kq)("",!0),AS]),(0,u._)("div",OS,[(0,u.Wm)(Gf,{class:"btn export",type:"primary",onClick:t[2]||(t[2]=function(e){return(0,c.SU)(d)(p.value)})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Export ppt file")]})),_:1}),(0,u.Wm)(Gf,{class:"btn close",onClick:t[3]||(t[3]=function(e){return l("close")})},{default:(0,u.w5)((function(){return[(0,u.Uk)("close")]})),_:1})])])}}}),RS=(0,ll.Z)(PS,[["__scopeId","data-v-521ab74f"]]),BS=RS;var zS={class:"export-dialog"},NS={class:"content"};const jS=(0,u.aZ)({__name:"index",setup:function(e){var t=X(),n=(0,o.Jk)(t),l=n.dialogForExport,a=t.setDialogForExport,i=[{key:"ppt",label:"Export ppt file"},{key:"pptx",label:"Export PPTX"},{key:"image",label:"Export image"},{key:"json",label:"Export JSON"},{key:"pdf",label:"Print/Export PDF"}],r=(0,u.Fl)((function(){var e={image:RI,json:VI,pdf:dS,pptx:ZS,ppt:BS};return l.value&&e[l.value]||null}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",zS,[(0,u.Wm)(Jf,{tabs:i,value:(0,c.SU)(l),card:"","onUpdate:value":t[0]||(t[0]=function(e){return(0,c.SU)(a)(e)})},null,8,["value"]),(0,u._)("div",NS,[((0,u.wg)(),(0,u.j4)((0,u.LL)(r.value),{onClose:t[1]||(t[1]=function(e){return(0,c.SU)(a)("")})},null,32))])])}}}),YS=(0,ll.Z)(jS,[["__scopeId","data-v-32369776"]]),VS=YS;var JS={class:"title"},qS={class:"content"};const XS=(0,u.aZ)({__name:"MoveablePanel",props:{width:{},height:{},left:{default:10},top:{default:10},title:{default:""},moveable:{type:Boolean,default:!0}},emits:["close"],setup:function(e,t){var n=t.emit,l=e,a=n,o=(0,c.iH)(0),i=(0,c.iH)(0),r=(0,c.iH)(),s=(0,u.Fl)((function(){var e;return l.height?l.height:(null===(e=r.value)||void 0===e?void 0:e.clientHeight)||0}));(0,u.bv)((function(){l.left>=0?o.value=l.left:o.value=document.body.clientWidth+l.left-l.width,l.top>=0?i.value=l.top:i.value=document.body.clientHeight+l.top-s.value}));var d=function(e){if(l.moveable){var t=!0,n=document.body.clientWidth,a=document.body.clientHeight,r=e.pageX,u=e.pageY,c=o.value,d=i.value;document.onmousemove=function(e){if(t){var f=e.pageX-r,v=e.pageY-u,p=c+f,h=d+v;p<0&&(p=0),h<0&&(h=0),p+l.width>n&&(p=n-l.width),h+s.value>a&&(h=a-s.value),o.value=p,i.value=h}},document.onmouseup=function(){t=!1,document.onmousemove=null,document.onmouseup=null}}};return function(e,t){var n=(0,u.up)("IconClose");return(0,u.wg)(),(0,u.iD)("div",{class:"moveable-panel",ref_key:"moveablePanelRef",ref:r,style:(0,pe.j5)({width:e.width+"px",height:e.height?e.height+"px":"auto",left:o.value+"px",top:i.value+"px"})},[e.title?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[(0,u._)("div",{class:"header",onMousedown:t[1]||(t[1]=function(e){return d(e)})},[(0,u._)("div",JS,(0,pe.zw)(e.title),1),(0,u._)("div",{class:"close-btn",onClick:t[0]||(t[0]=function(e){return a("close")})},[(0,u.Wm)(n)])],32),(0,u._)("div",qS,[(0,u.WI)(e.$slots,"default")])],64)):((0,u.wg)(),(0,u.iD)("div",{key:1,class:"content",onMousedown:t[2]||(t[2]=function(e){return d(e)})},[(0,u.WI)(e.$slots,"default")],32))],4)}}}),GS=(0,ll.Z)(XS,[["__scopeId","data-v-fc791e00"]]),KS=GS;var QS=function(e){return(0,u.dD)("data-v-0dabd0f4"),e=e(),(0,u.Cn)(),e},$S={key:0,class:"handler"},eC={class:"btns"},tC={key:0,class:"icon-btns"},nC={class:"element-list"},lC={key:0,class:"group-els"},aC=QS((function(){return(0,u._)("div",{class:"group-title"},"combination",-1)})),oC=["onClick","onDblclick"],iC=["id","value","onBlur","onKeydown"],rC={key:1,class:"name"},uC={class:"icons"},cC=["onClick","onDblclick"],sC=["id","value","onBlur","onKeydown"],dC={key:1,class:"name"},fC={class:"icons"};const vC=(0,u.aZ)({__name:"SelectPanel",setup:function(e){var t=V(),n=X(),l=(0,o.Jk)(t),i=l.currentSlide,r=(0,o.Jk)(n),s=r.handleElement,f=r.handleElementId,v=r.activeElementIdList,p=r.activeGroupElementId,h=r.hiddenElementIdList,m=Dl(),g=m.orderElement,w=(0,u.Fl)((function(){var e,t=[],n=(0,y.Z)(i.value.elements);try{for(n.s();!(e=n.n()).done;){var l=e.value;if(l.groupId){var a=t[t.length-1];a&&"group"===a.type&&a.id&&a.id===l.groupId?a.elements.push(l):t.push({type:"group",id:l.groupId,elements:[l]})}else t.push(l)}}catch(o){n.e(o)}finally{n.f()}return t})),x=function(e,t){if(f.value!==t&&!h.value.includes(t)){var l=e.elements.map((function(e){return e.id}));n.setActiveElementIdList(l),n.setHandleElementId(t),(0,u.Y3)((function(){return n.setActiveGroupElementId(t)}))}},b=function(e){f.value!==e&&(h.value.includes(e)||n.setActiveElementIdList([e]))},k=function(e){h.value.includes(e)?n.setHiddenElementIdList(h.value.filter((function(t){return t!==e}))):n.setHiddenElementIdList([].concat((0,R.Z)(h.value),[e])),v.value.includes(e)&&n.setActiveElementIdList([])},_=function(){var e=i.value.elements.map((function(e){return e.id})),t=h.value.filter((function(t){return!e.includes(t)}));n.setHiddenElementIdList(t)},I=function(){var e=i.value.elements.map((function(e){return e.id}));n.setHiddenElementIdList([].concat((0,R.Z)(h.value),(0,R.Z)(e))),v.value.length&&n.setActiveElementIdList([])},S=(0,c.iH)(""),C=function(e,n){var l=e.target.value;t.updateElement({id:n,props:{name:l}}),S.value=""},L=function(e){S.value=e,(0,u.Y3)((function(){var t=document.querySelector("#input-".concat(e));t.focus()}))},E=function(){n.setSelectPanelState(!1)};return function(e,t){var n=(0,u.up)("IconDown"),l=(0,u.up)("IconUp"),o=(0,u.up)("IconPreviewClose"),r=(0,u.up)("IconPreviewOpen");return(0,u.wg)(),(0,u.j4)(KS,{class:"select-panel",width:200,height:360,title:"choose (".concat((0,c.SU)(v).length,"/").concat((0,c.SU)(i).elements.length,"）"),left:-270,top:90,onClose:t[4]||(t[4]=function(e){return E()})},{default:(0,u.w5)((function(){return[w.value.length?((0,u.wg)(),(0,u.iD)("div",$S,[(0,u._)("div",eC,[(0,u.Wm)(Gf,{size:"small",style:{"margin-right":"5px"},onClick:t[0]||(t[0]=function(e){return _()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Show All")]})),_:1}),(0,u.Wm)(Gf,{size:"small",onClick:t[1]||(t[1]=function(e){return I()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Hide All")]})),_:1})]),(0,c.SU)(s)?((0,u.wg)(),(0,u.iD)("div",tC,[(0,u.Wm)(n,{class:"icon-btn",onClick:t[2]||(t[2]=function(e){return(0,c.SU)(g)((0,c.SU)(s),(0,c.SU)(d).UP)})}),(0,u.Wm)(l,{class:"icon-btn",onClick:t[3]||(t[3]=function(e){return(0,c.SU)(g)((0,c.SU)(s),(0,c.SU)(d).DOWN)})})])):(0,u.kq)("",!0)])):(0,u.kq)("",!0),(0,u._)("div",nC,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(w.value,(function(e){return(0,u.wg)(),(0,u.iD)(u.HY,{key:e.id},["group"===e.type?((0,u.wg)(),(0,u.iD)("div",lC,[aC,((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.elements,(function(t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["item",{active:(0,c.SU)(v).includes(t.id),"group-active":(0,c.SU)(p).includes(t.id)}]),key:t.id,onClick:function(n){return x(e,t.id)},onDblclick:function(e){return L(t.id)}},[S.value===t.id?((0,u.wg)(),(0,u.iD)("input",{key:0,id:"input-".concat(t.id),value:t.name||(0,c.SU)(Zo)[t.type],class:"input",type:"text",onBlur:function(e){return C(e,t.id)},onKeydown:(0,a.D2)((function(e){return C(e,t.id)}),["enter"])},null,40,iC)):((0,u.wg)(),(0,u.iD)("div",rC,(0,pe.zw)(t.name||(0,c.SU)(Zo)[t.type]),1)),(0,u._)("div",uC,[(0,c.SU)(h).includes(t.id)?((0,u.wg)(),(0,u.j4)(o,{key:0,style:{"font-size":"17px"},onClick:(0,a.iM)((function(e){return k(t.id)}),["stop"])},null,8,["onClick"])):((0,u.wg)(),(0,u.j4)(r,{key:1,style:{"font-size":"17px"},onClick:(0,a.iM)((function(e){return k(t.id)}),["stop"])},null,8,["onClick"]))])],42,oC)})),128))])):((0,u.wg)(),(0,u.iD)("div",{key:1,class:(0,pe.C_)(["item",{active:(0,c.SU)(v).includes(e.id)}]),onClick:function(t){return b(e.id)},onDblclick:function(t){return L(e.id)}},[S.value===e.id?((0,u.wg)(),(0,u.iD)("input",{key:0,id:"input-".concat(e.id),value:e.name||(0,c.SU)(Zo)[e.type],class:"input",type:"text",onBlur:function(t){return C(t,e.id)},onKeydown:(0,a.D2)((function(t){return C(t,e.id)}),["enter"])},null,40,sC)):((0,u.wg)(),(0,u.iD)("div",dC,(0,pe.zw)(e.name||(0,c.SU)(Zo)[e.type]),1)),(0,u._)("div",fC,[(0,c.SU)(h).includes(e.id)?((0,u.wg)(),(0,u.j4)(o,{key:0,style:{"font-size":"17px"},onClick:(0,a.iM)((function(t){return k(e.id)}),["stop"])},null,8,["onClick"])):((0,u.wg)(),(0,u.j4)(r,{key:1,style:{"font-size":"17px"},onClick:(0,a.iM)((function(t){return k(e.id)}),["stop"])},null,8,["onClick"]))])],42,cC))],64)})),128))])]})),_:1},8,["title"])}}}),pC=(0,ll.Z)(vC,[["__scopeId","data-v-0dabd0f4"]]),hC=pC;n(52003),n(68518),n(13440);const mC=function(){var e=X(),t=V(),n=(0,o.Jk)(e),l=n.handleElement,a=(0,o.Jk)(t),i=a.slides,r=a.slideIndex,s=a.currentSlide,d=(0,c.iH)(""),f=(0,c.iH)(""),v=(0,c.iH)([]),p=(0,c.iH)(-1),h=(0,c.iH)("g"),m=function(){var e,t=[],n=new RegExp(d.value,h.value),l=/(<([^>]+)>)/g,a=(0,y.Z)(i.value);try{for(a.s();!(e=a.n()).done;){var o,r=e.value,u=(0,y.Z)(r.elements);try{for(u.s();!(o=u.n()).done;){var c=o.value;if("text"===c.type){var s=c.content.replace(l,""),f=s.match(n);f&&t.push.apply(t,(0,R.Z)(new Array(f.length).fill({slideId:r.id,elId:c.id,elType:c.type})))}else if("shape"===c.type&&c.text&&c.text.content){var m=c.text.content.replace(l,""),g=m.match(n);g&&t.push.apply(t,(0,R.Z)(new Array(g.length).fill({slideId:r.id,elId:c.id,elType:c.type})))}else if("table"===c.type)for(var w=0;w<c.data.length;w++)for(var x=c.data[w],b=0;b<x.length;b++){var k=x[b];if(k.text){var _=k.text.replace(l,""),C=_.match(n);C&&t.push.apply(t,(0,R.Z)(new Array(C.length).fill({slideId:r.id,elId:c.id,elType:c.type,cellIndex:[w,b]})))}}}}catch(L){u.e(L)}finally{u.f()}}}catch(L){a.e(L)}finally{a.f()}t.length?(v.value=t,p.value=0,S()):(dl.warning("未查找到匹配项"),I())},w=function(e){var t=(0,R.Z)(e.childNodes),n=[];while(t.length){var l=t.shift();l.nodeType===l.TEXT_NODE?l.wholeText&&n.push(l):t.unshift.apply(t,(0,R.Z)(l.childNodes))}return n},x=function(e){var t=0,n=e.map((function(e){var n=t,l=t+e.wholeText.length;return t=l,{text:e.wholeText,startIdx:n,endIdx:l}}));return n},b=function(e,t){var n=new RegExp(t,h.value),l=[],a=n.exec(e);while(a)l.push(a),a=n.exec(e);return l},k=function(e,t,n,l){for(var a=n.length-1;a>=0;a--)for(var o=n[a],i=o.index,r=i+o[0].length,u=0;u<t.length;u++){var c=t[u],s=c.text,d=c.startIdx,f=c.endIdx;if(!(f<i)){if(d>=r)break;var v=e[u],p=Math.max(0,i-d),h=Math.min(f,r)-d-p;p>0&&(v=v.splitText(p)),h<v.wholeText.length&&v.splitText(h);var m=document.createElement("mark");m.dataset.index=l+a+"",m.innerText=s.substring(p,p+h),v.parentNode.replaceChild(m,v)}}},_=function(e,t){var n,l=(0,y.Z)(e);try{for(l.s();!(n=l.n()).done;){var a=n.value;a.innerHTML=a.innerHTML.replace(new RegExp(d.value,h.value),(function(){return"<mark data-index=".concat(t++,">").concat(d.value,"</mark>")}))}}catch(o){l.e(o)}finally{l.f()}},I=function(){var e,t=document.querySelectorAll(".editable-element mark"),n=(0,y.Z)(t);try{var l=function(){var t=e.value;setTimeout((function(){var e=t.parentNode,n=t.textContent;e.replaceChild(document.createTextNode(n),t)}),0)};for(n.s();!(e=n.n()).done;)l()}catch(a){n.e(a)}finally{n.f()}},S=function(){I(),setTimeout((function(){for(var e=0;e<v.value.length;e++){var t=v.value[e-1],n=v.value[e];if(n.slideId===s.value.id&&(!t||t.elId!==n.elId)){var l=document.querySelector("#editable-element-".concat(n.elId));if(l)if("table"===n.elType){var a=l.querySelectorAll(".cell-text");_(a,e)}else{var o=w(l),i=x(o),r=i.map((function(e){var t=e.text;return t})).join(""),u=b(r,d.value);k(o,i,u,e)}}}}),0)},C=function(){var e,t=document.querySelectorAll("mark[data-index]"),n=(0,y.Z)(t);try{var l=function(){var t=e.value;setTimeout((function(){var e=t.dataset.index;void 0!==e&&+e===p.value?t.classList.add("active"):t.classList.remove("active")}),0)};for(n.s();!(e=n.n()).done;)l()}catch(a){n.e(a)}finally{n.f()}},L=function(){if(-1!==p.value){var e=v.value[p.value];if(e.slideId===s.value.id)setTimeout(C,0);else{var n=i.value.findIndex((function(t){return t.id===e.slideId}));-1!==n&&t.updateSlideIndex(n)}}},E=function(){if(!d.value)return dl.warning("请先输入查找内容");e.setActiveElementIdList([]),-1===p.value?m():p.value<v.value.length-1?p.value+=1:p.value=0,L()},Z=function(){if(!d.value)return dl.warning("请先输入查找内容");e.setActiveElementIdList([]),-1===p.value?m():p.value>0?p.value-=1:p.value=v.value.length-1,L()},T=function(){if(d.value)if(-1!==p.value){var e=v.value[p.value],n=null;if("table"===e.elType){var l=(0,ne.Z)(e.cellIndex,2),a=l[0],o=l[1];n=document.querySelector("#editable-element-".concat(e.elId,' .cell[data-cell-index="').concat(a,"_").concat(o,'"] .cell-text'))}else n=document.querySelector("#editable-element-".concat(e.elId," .ProseMirror"));if(n){var i=document.createElement("div");i.innerHTML=n.innerHTML;var r,c=!1,h=i.querySelectorAll("mark[data-index]"),m=(0,y.Z)(h);try{for(m.s();!(r=m.n()).done;){var w=r.value,x=w.parentNode;if(w.classList.contains("active"))c?x.removeChild(w):(x.replaceChild(document.createTextNode(f.value),w),c=!0);else{var b=w.textContent;x.replaceChild(document.createTextNode(b),w)}}}catch(M){m.e(M)}finally{m.f()}if("text"===e.elType){var k={content:i.innerHTML};t.updateElement({id:e.elId,props:k})}else if("shape"===e.elType){var _=s.value.elements.find((function(t){return t.id===e.elId}));if(_&&"shape"===_.type&&_.text){var I={text:(0,g.Z)((0,g.Z)({},_.text),{},{content:i.innerHTML})};t.updateElement({id:e.elId,props:I})}}else if("table"===e.elType){var C=s.value.elements.find((function(t){return t.id===e.elId}));if(C&&"table"===C.type){var Z=C.data.map((function(t,n){return n===e.cellIndex[0]?t.map((function(t,n){return n===e.cellIndex[1]?(0,g.Z)((0,g.Z)({},t),{},{text:i.innerHTML}):t})):t})),T={data:Z};t.updateElement({id:e.elId,props:T})}}v.value.splice(p.value,1),v.value.length?(p.value>v.value.length-1&&(p.value=0),(0,u.Y3)((function(){S(),L()}))):p.value=-1}}else E()},M=function(){if(d.value)if(-1!==p.value){for(var e=function(){var e,l=v.value[n-1],a=v.value[n];if(l&&l.elId===a.elId)return 0;var o=i.value.find((function(e){return e.id===a.slideId}));if(!o)return 0;var r=o.elements.find((function(e){return e.id===a.elId}));if(!r)return 0;var u=document.createElement("div");if("text"===r.type?u.innerHTML=r.content:"shape"===r.type&&(u.innerHTML=(null===(e=r.text)||void 0===e?void 0:e.content)||""),"table"===a.elType){var c=r.data.map((function(e){return e.map((function(e){return e.text?(0,g.Z)((0,g.Z)({},e),{},{text:e.text.replaceAll(d.value,f.value)}):e}))})),p={data:c};t.updateElement({id:a.elId,slideId:a.slideId,props:p})}else{var h=w(u),m=x(h),_=m.map((function(e){var t=e.text;return t})).join(""),I=b(_,d.value);k(h,m,I,n);var S,C=u.querySelectorAll("mark[data-index]"),L=-1,E=(0,y.Z)(C);try{for(E.s();!(S=E.n()).done;){var Z=S.value,T=+Z.dataset.index,M=Z.parentNode;T===L?M.removeChild(Z):(M.replaceChild(document.createTextNode(f.value),Z),L=T)}}catch(H){E.e(H)}finally{E.f()}if("text"===a.elType){var U={content:u.innerHTML};t.updateElement({id:a.elId,slideId:a.slideId,props:U})}else if("shape"===a.elType){var W=s.value.elements.find((function(e){return e.id===a.elId}));if(W&&"shape"===W.type&&W.text){var D={text:(0,g.Z)((0,g.Z)({},W.text),{},{content:u.innerHTML})};t.updateElement({id:a.elId,slideId:a.slideId,props:D})}}}},n=0;n<v.value.length;n++)e();v.value=[],p.value=-1}else E()},U=function(){p.value=-1,v.value=[],d.value||I()};(0,u.YP)(d,U),(0,u.YP)(r,(function(){(0,u.Y3)((function(){S(),setTimeout(C,0)}))})),(0,u.YP)(l,(function(){l.value&&(p.value=-1,v.value=[],I())})),(0,u.Jd)(I);var W=function(){h.value="g"===h.value?"gi":"g",U()};return{searchWord:d,replaceWord:f,searchResults:v,searchIndex:p,modifiers:h,searchNext:E,searchPrev:Z,replace:T,replaceAll:M,toggleModifiers:W}};var gC={class:"count"},yC={key:1,class:"footer"};const wC=(0,u.aZ)({__name:"SearchPanel",setup:function(e){var t=X(),n=mC(),l=n.searchWord,o=n.replaceWord,i=n.searchResults,r=n.searchIndex,s=n.modifiers,d=n.searchNext,f=n.searchPrev,v=n.replace,p=n.replaceAll,h=n.toggleModifiers,m=(0,c.iH)("search"),g=[{key:"search",label:"search"},{key:"replace",label:"replace"}],y=function(){t.setSearchPanelState(!1)},w=(0,c.iH)();return(0,u.bv)((function(){w.value.focus()})),(0,u.YP)(m,(function(){(0,u.Y3)((function(){w.value.focus()}))})),function(e,t){var n=(0,u.up)("IconClose"),x=(0,u.up)("IconLeft"),b=(0,u.up)("IconRight"),k=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.j4)(KS,{class:"search-panel",width:330,height:0,left:-270,top:90},{default:(0,u.w5)((function(){return[(0,u._)("div",{class:"close-btn",onClick:t[0]||(t[0]=function(e){return y()}),onMousedown:t[1]||(t[1]=(0,a.iM)((function(){}),["stop"]))},[(0,u.Wm)(n)],32),(0,u.Wm)(Jf,{tabs:g,value:m.value,"onUpdate:value":t[2]||(t[2]=function(e){return m.value=e})},null,8,["value"]),(0,u._)("div",{class:(0,pe.C_)(["content",m.value]),onMousedown:t[12]||(t[12]=(0,a.iM)((function(){}),["stop"]))},[(0,u.Wm)($a,{class:"input",value:(0,c.SU)(l),"onUpdate:value":t[6]||(t[6]=function(e){return(0,c.dq)(l)?l.value=e:null}),placeholder:"Enter search content",onEnter:t[7]||(t[7]=function(e){return(0,c.SU)(d)()}),ref_key:"searchInpRef",ref:w},{suffix:(0,u.w5)((function(){return[(0,u._)("span",gC,(0,pe.zw)((0,c.SU)(r)+1)+"/"+(0,pe.zw)((0,c.SU)(i).length),1),(0,u.Wm)(Ud,{type:"vertical"}),(0,u.wy)(((0,u.wg)(),(0,u.iD)("span",{class:(0,pe.C_)(["ignore-case",{active:"g"===(0,c.SU)(s)}]),onClick:t[3]||(t[3]=function(e){return(0,c.SU)(h)()})},[(0,u.Uk)("Aa")],2)),[[k,"Ignore case"]]),(0,u.Wm)(Ud,{type:"vertical"}),(0,u.wy)((0,u.Wm)(x,{class:"next-btn left",onClick:t[4]||(t[4]=function(e){return(0,c.SU)(f)()})},null,512),[[k,"Previous"]]),(0,u.wy)((0,u.Wm)(b,{class:"next-btn right",onClick:t[5]||(t[5]=function(e){return(0,c.SU)(d)()})},null,512),[[k,"Next"]])]})),_:1},8,["value"]),"replace"===m.value?((0,u.wg)(),(0,u.j4)($a,{key:0,class:"input",value:(0,c.SU)(o),"onUpdate:value":t[8]||(t[8]=function(e){return(0,c.dq)(o)?o.value=e:null}),placeholder:"Enter replacement content",onEnter:t[9]||(t[9]=function(e){return(0,c.SU)(v)()})},null,8,["value"])):(0,u.kq)("",!0),"replace"===m.value?((0,u.wg)(),(0,u.iD)("div",yC,[(0,u.Wm)(Gf,{disabled:!(0,c.SU)(l),style:{"margin-left":"5px"},onClick:t[10]||(t[10]=function(e){return(0,c.SU)(v)()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Replace")]})),_:1},8,["disabled"]),(0,u.Wm)(Gf,{disabled:!(0,c.SU)(l),type:"primary",style:{"margin-left":"5px"},onClick:t[11]||(t[11]=function(e){return(0,c.SU)(p)()})},{default:(0,u.w5)((function(){return[(0,u.Uk)("Replace all")]})),_:1},8,["disabled"])])):(0,u.kq)("",!0)],34)]})),_:1})}}}),xC=(0,ll.Z)(wC,[["__scopeId","data-v-002cdd29"]]),bC=xC;var kC={class:"ppt-editor"},_C={class:"layout-content"},IC={class:"layout-content-center"};const SC=(0,u.aZ)({__name:"index",props:{url:String,pk:Number},setup:function(e){var t=X(),n=(0,o.Jk)(t),l=n.dialogForExport,a=n.showSelectPanel,i=n.showSearchPanel,r=function(){return t.setDialogForExport("")},s=(0,c.iH)(40);return Rl(),Bl(),function(t,n){return(0,u.wg)(),(0,u.iD)(u.HY,null,[(0,u._)("div",kC,[(0,u.Wm)(wo,{ppt_url:e.url,pk:e.pk,class:"layout-header"},null,8,["ppt_url","pk"]),(0,u._)("div",_C,[(0,u.Wm)(Ph,{class:"layout-content-left"}),(0,u._)("div",IC,[(0,u.Wm)(Ih,{class:"center-top"}),(0,u.Wm)(bv,{class:"center-body",style:(0,pe.j5)({height:"calc(100% - ".concat(s.value+40,"px)")})},null,8,["style"]),(0,u.Wm)(bI,{class:"center-bottom",height:s.value,"onUpdate:height":n[0]||(n[0]=function(e){return s.value=e}),style:(0,pe.j5)({height:"".concat(s.value,"px")})},null,8,["height","style"])]),(0,u.Wm)(vI,{class:"layout-content-right"})])]),(0,c.SU)(a)?((0,u.wg)(),(0,u.j4)(hC,{key:0})):(0,u.kq)("",!0),(0,c.SU)(i)?((0,u.wg)(),(0,u.j4)(bC,{key:1})):(0,u.kq)("",!0),(0,u.Wm)(mv,{visible:!!(0,c.SU)(l),width:680,onClosed:n[1]||(n[1]=function(e){return r()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(VS)]})),_:1},8,["visible"])],64)}}}),CC=(0,ll.Z)(SC,[["__scopeId","data-v-7a7f5e02"]]),LC=CC,EC=function(){var e=V(),t=(0,o.Jk)(e),n=t.slides,l=t.slideIndex,a=t.formatedAnimations,i=(0,c.iH)(0),r=(0,c.iH)(!1),s=(0,c.iH)(l.value),d=function e(){if(!r.value){var t=a.value[i.value],n=t.animations,l=t.autoNext;i.value+=1,r.value=!0;var o,u=0,c=(0,y.Z)(n);try{var s=function(){var t=o.value,a=document.querySelector("#screen-element-".concat(t.elId," [class^=base-element-]"));if(!a)return u+=1,1;var i="".concat(hk).concat(t.effect);a.style.removeProperty("--animate-duration");var c,s=(0,y.Z)(a.classList);try{for(s.s();!(c=s.n()).done;){var d=c.value;-1!==d.indexOf(hk)&&a.classList.remove(d,"".concat(hk,"animated"))}}catch(v){s.e(v)}finally{s.f()}a.style.setProperty("--animate-duration","".concat(t.duration,"ms")),a.classList.add(i,"".concat(hk,"animated"));var f=function(){"out"!==t.type&&(a.style.removeProperty("--animate-duration"),a.classList.remove(i,"".concat(hk,"animated"))),u+=1,u===n.length&&(r.value=!1,l&&e())};a.addEventListener("animationend",f,{once:!0})};for(c.s();!(o=c.n()).done;)s()}catch(d){c.e(d)}finally{c.f()}}},f=function(){i.value-=1;var e,t=a.value[i.value].animations,n=(0,y.Z)(t);try{for(n.s();!(e=n.n()).done;){var l=e.value,o=document.querySelector("#screen-element-".concat(l.elId," [class^=base-element-]"));if(o){o.style.removeProperty("--animate-duration");var r,u=(0,y.Z)(o.classList);try{for(u.s();!(r=u.n()).done;){var c=r.value;-1!==c.indexOf(hk)&&o.classList.remove(c,"".concat(hk,"animated"))}}catch(s){u.e(s)}finally{u.f()}}}}catch(s){n.e(s)}finally{n.f()}t.every((function(e){return"attention"===e.type}))&&x()},v=(0,c.iH)(0),p=function(){v.value&&(clearInterval(v.value),v.value=0)};(0,u.Ah)(p);var h=(0,c.iH)(!1),g=function(e){h.value=e},w=(0,z.throttle)((function(e){dl.success(e)}),1e3,{leading:!0,trailing:!1}),x=function(){a.value.length&&i.value>0?f():l.value>0?(e.updateSlideIndex(l.value-1),l.value<s.value?(i.value=0,s.value=l.value):i.value=a.value.length):h.value?U(n.value.length-1):w("已经是第一页了"),r.value=!1},b=function(){a.value.length&&i.value<a.value.length?d():l.value<n.value.length-1?(e.updateSlideIndex(l.value+1),i.value=0,r.value=!1):(h.value?U(0):(w("已经是最后一页了"),p()),r.value=!1)},k=(0,c.iH)(2500),_=function(){p(),dl.success("Start automatic show"),v.value=setInterval(b,k.value)},I=function(e){p(),k.value=e,_()},S=(0,z.throttle)((function(e){e.deltaY<0?x():e.deltaY>0&&b()}),500,{leading:!0,trailing:!1}),C=(0,c.iH)(null),L=function(e){C.value={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}},E=function(e){if(C.value){var t=Math.abs(C.value.x-e.changedTouches[0].pageX),n=e.changedTouches[0].pageY-C.value.y;Math.abs(n)>t&&Math.abs(n)>50&&(C.value=null,n>0?x():b())}},Z=function(e){var t=e.key.toUpperCase();t===m.UP||t===m.LEFT||t===m.PAGEUP?x():t!==m.DOWN&&t!==m.RIGHT&&t!==m.SPACE&&t!==m.ENTER&&t!==m.PAGEDOWN||b()};(0,u.bv)((function(){return document.addEventListener("keydown",Z)})),(0,u.Ah)((function(){return document.removeEventListener("keydown",Z)}));var T=function(){e.updateSlideIndex(l.value-1),i.value=0},M=function(){e.updateSlideIndex(l.value+1),i.value=0},U=function(t){e.updateSlideIndex(t),i.value=0},W=function(t){var l=n.value.findIndex((function(e){return e.id===t}));-1!==l&&(e.updateSlideIndex(l),i.value=0)};return{autoPlayTimer:v,autoPlayInterval:k,setAutoPlayInterval:I,autoPlay:_,closeAutoPlay:p,loopPlay:h,setLoopPlay:g,mousewheelListener:S,touchStartListener:L,touchEndListener:E,turnPrevSlide:T,turnNextSlide:M,turnSlideToIndex:U,turnSlideToId:W,execPrev:x,execNext:b,animationIndex:i}},ZC=function(e){var t=V(),n=(0,o.Jk)(t),l=n.viewportRatio,a=(0,c.iH)(0),i=(0,c.iH)(0),r=function(){var t,n,o=(null===e||void 0===e?void 0:e.value)||document.body,r=o.clientWidth,u=o.clientHeight;u/r===l.value?(t=r,n=u):u/r>l.value?(t=r,n=r*l.value):(t=u/l.value,n=u),a.value=t,i.value=n};return(0,u.bv)((function(){r(),window.addEventListener("resize",r)})),(0,u.Ah)((function(){window.removeEventListener("resize",r)})),{slideWidth:a,slideHeight:i}},TC=function(){var e=(0,c.iH)(!0),t=(0,c.iH)(!0),n=Ol(),l=n.exitScreening,a=function(){e.value=Al(),!e.value&&t.value&&l(),t.value=!0};(0,u.bv)((function(){e.value=Al(),document.addEventListener("fullscreenchange",a),document.addEventListener("webkitfullscreenchange",a)})),(0,u.Ah)((function(){document.removeEventListener("fullscreenchange",a),document.removeEventListener("webkitfullscreenchange",a)}));var o=function(){e.value&&(t.value=!1,Fl())};return{fullscreenState:e,manualExitFullscreen:o}};var MC={class:"element-content"};const UC=(0,u.aZ)({__name:"ScreenVideoElement",props:{elementInfo:{}},setup:function(e){var t=(0,o.Jk)(V()),n=t.currentSlide,l=(0,u.f3)(xo)||(0,c.iH)(1),a=(0,u.f3)(bo)||(0,c.iH)(""),i=(0,u.Fl)((function(){return n.value.id===a.value}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"base-element-video screen-element-video",style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u._)("div",MC,[i.value?((0,u.wg)(),(0,u.j4)(Zc,{key:0,width:e.elementInfo.width,height:e.elementInfo.height,src:e.elementInfo.src,poster:e.elementInfo.poster,autoplay:e.elementInfo.autoplay,scale:(0,c.SU)(l)},null,8,["width","height","src","poster","autoplay","scale"])):(0,u.kq)("",!0)])],4)],4)}}}),WC=(0,ll.Z)(UC,[["__scopeId","data-v-76bf5b3f"]]),DC=WC;var HC={class:"element-content"};const FC=(0,u.aZ)({__name:"ScreenAudioElement",props:{elementInfo:{}},setup:function(e){var t=e,n=(0,o.Jk)(V()),l=n.viewportRatio,a=n.currentSlide,i=(0,u.f3)(xo)||(0,c.iH)(1),r=(0,u.f3)(bo)||(0,c.iH)(""),s=(0,u.Fl)((function(){return a.value.id===r.value})),d=(0,u.Fl)((function(){return Math.min(t.elementInfo.width,t.elementInfo.height)+"px"})),f=(0,u.Fl)((function(){var e=wl,n=wl*l.value,a=280/i.value,o=50/i.value,r=t.elementInfo.width,u=t.elementInfo.height,c=t.elementInfo.left,s=t.elementInfo.top,d=0,f=u;return c+a>=e&&(d=r-a),s+u+o>=n&&(f=-o),{left:d+"px",top:f+"px"}})),v=(0,c.iH)(),p=function(){v.value&&v.value.toggle()};return function(e,t){var n=(0,u.up)("IconVolumeNotice");return(0,u.wg)(),(0,u.iD)("div",{class:"base-element-audio screen-element-audio",style:(0,pe.j5)({top:e.elementInfo.top+"px",left:e.elementInfo.left+"px",width:e.elementInfo.width+"px",height:e.elementInfo.height+"px"})},[(0,u._)("div",{class:"rotate-wrapper",style:(0,pe.j5)({transform:"rotate(".concat(e.elementInfo.rotate,"deg)")})},[(0,u._)("div",HC,[(0,u.Wm)(n,{class:"audio-icon",style:(0,pe.j5)({fontSize:d.value,color:e.elementInfo.color}),onClick:t[0]||(t[0]=function(e){return p()})},null,8,["style"]),s.value?((0,u.wg)(),(0,u.j4)(Gc,{key:0,class:"audio-player",ref_key:"audioPlayerRef",ref:v,style:(0,pe.j5)((0,g.Z)({},f.value)),src:e.elementInfo.src,loop:e.elementInfo.loop,autoplay:e.elementInfo.autoplay,scale:(0,c.SU)(i)},null,8,["style","src","loop","autoplay","scale"])):(0,u.kq)("",!0)])],4)],4)}}}),AC=(0,ll.Z)(FC,[["__scopeId","data-v-adf39436"]]),OC=AC;var PC=["id","title"];const RC=(0,u.aZ)({__name:"ScreenElement",props:{elementInfo:{},elementIndex:{},animationIndex:{},turnSlideToId:{type:Function},manualExitFullscreen:{type:Function}},setup:function(e){var t=e,n=(0,u.Fl)((function(){var e=(0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)({},vl.IMAGE,Yd),vl.TEXT,Xd),vl.SHAPE,lf),vl.LINE,cf),vl.CHART,ff),vl.TABLE,kf),vl.LATEX,Zf),vl.VIDEO,DC),vl.AUDIO,OC);return e[t.elementInfo.type]||null})),l=(0,o.Jk)(V()),a=l.formatedAnimations,i=l.theme,r=(0,u.Fl)((function(){var e=a.value.findIndex((function(e){var n=e.animations.map((function(e){return e.elId}));return n.includes(t.elementInfo.id)}));if(-1===e)return!1;if(e<t.animationIndex)return!1;var n=a.value[e].animations.find((function(e){return e.elId===t.elementInfo.id}));return"in"===(null===n||void 0===n?void 0:n.type)})),s=function(){var e=t.elementInfo.link;e&&("web"===e.type?(t.manualExitFullscreen(),window.open(e.target)):"slide"===e.type&&t.turnSlideToId(e.target))};return function(e,t){var l;return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["screen-element",{link:e.elementInfo.link}]),id:"screen-element-".concat(e.elementInfo.id),style:(0,pe.j5)({zIndex:e.elementIndex,color:(0,c.SU)(i).fontColor,fontFamily:(0,c.SU)(i).fontName,visibility:r.value?"hidden":"visible"}),title:(null===(l=e.elementInfo.link)||void 0===l?void 0:l.target)||"",onClick:t[0]||(t[0]=function(e){return s()})},[((0,u.wg)(),(0,u.j4)((0,u.LL)(n.value),{elementInfo:e.elementInfo},null,8,["elementInfo"]))],14,PC)}}}),BC=(0,ll.Z)(RC,[["__scopeId","data-v-2139723a"]]),zC=BC,NC=(0,u.aZ)({__name:"ScreenSlide",props:{slide:{},scale:{},animationIndex:{},turnSlideToId:{type:Function},manualExitFullscreen:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(V()),l=n.viewportRatio,a=(0,u.Fl)((function(){return t.slide.background})),i=fs(a),r=i.backgroundStyle,s=(0,u.Fl)((function(){return t.slide.id}));return(0,u.JJ)(bo,s),function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"screen-slide",style:(0,pe.j5)({width:(0,c.SU)(wl)+"px",height:(0,c.SU)(wl)*(0,c.SU)(l)+"px",transform:"scale(".concat(e.scale,")")})},[(0,u._)("div",{class:"background",style:(0,pe.j5)((0,g.Z)({},(0,c.SU)(r)))},null,4),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.slide.elements,(function(t,n){return(0,u.wg)(),(0,u.j4)(zC,{key:t.id,elementInfo:t,elementIndex:n+1,animationIndex:e.animationIndex,turnSlideToId:e.turnSlideToId,manualExitFullscreen:e.manualExitFullscreen},null,8,["elementInfo","elementIndex","animationIndex","turnSlideToId","manualExitFullscreen"])})),128))],4)}}}),jC=(0,ll.Z)(NC,[["__scopeId","data-v-016af5da"]]),YC=jC;var VC={class:"screen-slide-list"};const JC=(0,u.aZ)({__name:"ScreenSlideList",props:{slideWidth:{},slideHeight:{},animationIndex:{},turnSlideToId:{type:Function},manualExitFullscreen:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(V()),l=n.slides,a=n.slideIndex,i=(0,u.Fl)((function(){return l.value.map((function(e){var t=e.turningMode;if(t||(t="slideY"),"random"===t){var n=wk.filter((function(e){return!["random","no"].includes(e.value)})).map((function(e){return e.value}));t=n[Math.floor(Math.random()*n.length)]}return(0,g.Z)((0,g.Z)({},e),{},{turningMode:t})}))})),r=(0,u.Fl)((function(){return t.slideWidth/wl}));return(0,u.JJ)(xo,r),function(e,t){return(0,u.wg)(),(0,u.iD)("div",VC,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(i.value,(function(t,n){var l;return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["slide-item","turning-mode-".concat(t.turningMode),{current:n===(0,c.SU)(a),before:n<(0,c.SU)(a),after:n>(0,c.SU)(a),hide:(n===(0,c.SU)(a)-1||n===(0,c.SU)(a)+1)&&t.turningMode!==i.value[(0,c.SU)(a)].turningMode}]),key:t.id},[Math.abs((0,c.SU)(a)-n)<2||null!==(l=t.animations)&&void 0!==l&&l.length?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"slide-content",style:(0,pe.j5)({width:e.slideWidth+"px",height:e.slideHeight+"px"})},[(0,u.Wm)(YC,{slide:t,scale:r.value,animationIndex:e.animationIndex,turnSlideToId:e.turnSlideToId,manualExitFullscreen:e.manualExitFullscreen},null,8,["slide","scale","animationIndex","turnSlideToId","manualExitFullscreen"])],4)):(0,u.kq)("",!0)],2)})),128))])}}}),qC=(0,ll.Z)(JC,[["__scopeId","data-v-552b63d2"]]),XC=qC;var GC={class:"slide-thumbnails"},KC={class:"return-button"},QC={class:"slide-thumbnails-content"},$C=["onClick"];const eL=(0,u.aZ)({__name:"SlideThumbnails",props:{turnSlideToIndex:{type:Function}},emits:["close"],setup:function(e,t){var n=t.emit,l=e,a=n,i=(0,o.Jk)(V()),r=i.slides,s=i.slideIndex,d=Sh(),f=d.slidesLoadLimit,v=function(e){l.turnSlideToIndex(e),a("close")};return function(e,t){var n=(0,u.up)("IconArrowCircleLeft");return(0,u.wg)(),(0,u.iD)("div",GC,[(0,u._)("div",KC,[(0,u.Wm)(n,{class:"icon",onClick:t[0]||(t[0]=function(e){return a("close")})})]),(0,u._)("div",QC,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(r),(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["thumbnail",{active:t===(0,c.SU)(s)}]),key:e.id,onClick:function(e){return v(t)}},[(0,u.Wm)(Nf,{slide:e,size:150,visible:t<(0,c.SU)(f)},null,8,["slide","visible"])],10,$C)})),128))])])}}}),tL=(0,ll.Z)(eL,[["__scopeId","data-v-15912b32"]]),nL=tL;var lL={key:0,class:"blackboard"};const aL=(0,u.aZ)({__name:"WritingBoard",props:{color:{default:"#ffcc00"},model:{default:"pen"},blackboard:{type:Boolean,default:!1},penSize:{default:6},markSize:{default:24},rubberSize:{default:80}},emits:["end"],setup:function(e,t){var n=t.expose,l=t.emit,a=e,o=l,i=null,r=(0,c.iH)(),s=(0,c.iH)(),d={x:0,y:0},f=!1,v=0,p=-1,h=(0,c.iH)({x:0,y:0}),m=(0,c.iH)(!1),g=(0,c.iH)(0),y=(0,c.iH)(0),w=(0,u.Fl)((function(){return s.value?g.value/s.value.width:1})),x=(0,u.Fl)((function(){return s.value?y.value/s.value.height:1})),b=function(){r.value&&(g.value=r.value.clientWidth,y.value=r.value.clientHeight)},k=new ResizeObserver(b);(0,u.bv)((function(){r.value&&k.observe(r.value)})),(0,u.Ah)((function(){r.value&&k.unobserve(r.value)}));var _=function(){s.value&&r.value&&(i=s.value.getContext("2d"),i&&(s.value.width=r.value.clientWidth,s.value.height=r.value.clientHeight,i.lineCap="round",i.lineJoin="round"))};(0,u.bv)(_);var I=function(){i&&("mark"===a.model?(i.globalCompositeOperation="xor",i.globalAlpha=.5):"pen"===a.model&&(i.globalCompositeOperation="source-over",i.globalAlpha=1))};(0,u.YP)((function(){return a.model}),I);var S=function(e,t,n){if(i){var l=d.x,o=d.y;i.lineWidth=n,i.strokeStyle=a.color,i.beginPath(),i.moveTo(l,o),i.lineTo(e,t),i.stroke(),i.closePath()}},C=function(e,t){var n,l,o,r;if(i&&s.value){var u=d.x,c=d.y,f=a.rubberSize/2,v=f*Math.sin(Math.atan((t-c)/(e-u))),p=f*Math.cos(Math.atan((t-c)/(e-u))),h=[u+v,c-p],m=[u-v,c+p],g=[e+v,t-p],y=[e-v,t+p];i.save(),i.beginPath(),i.arc(e,t,f,0,2*Math.PI),i.clip(),i.clearRect(0,0,s.value.width,s.value.height),i.restore(),i.save(),i.beginPath(),(n=i).moveTo.apply(n,h),(l=i).lineTo.apply(l,g),(o=i).lineTo.apply(o,y),(r=i).lineTo.apply(r,m),i.closePath(),i.clip(),i.clearRect(0,0,s.value.width,s.value.height),i.restore()}},L=function(e,t){var n=d.x,l=d.y;return Math.sqrt((e-n)*(e-n)+(t-l)*(t-l))},E=function(e,t){var n,l=10,o=.1,i=a.penSize,r=3,u=e/t;return n=u<=o?i:u>=l?r:i-u/l*i,-1===p?n:1*n/3+2*p/3},Z=function(e,t){var n=(new Date).getTime();if("pen"===a.model){var l=L(e,t),o=n-v,i=E(l,o);S(e,t,i),p=i}else"mark"===a.model?S(e,t,a.markSize):C(e,t);d={x:e,y:t},v=(new Date).getTime()},T=function(e){if(!s.value)return[0,0];var t=e instanceof MouseEvent?e:e.changedTouches[0],n=s.value.getBoundingClientRect(),l=t.pageX-n.x,a=t.pageY-n.y;return[l,a]},M=function(e){var t=T(e),n=(0,ne.Z)(t,2),l=n[0],a=n[1],o=l/w.value,i=a/x.value;f=!0,d={x:o,y:i},v=(new Date).getTime(),e instanceof MouseEvent||(h.value={x:l,y:a},m.value=!0)},U=function(e){var t=T(e),n=(0,ne.Z)(t,2),l=n[0],a=n[1],o=l/w.value,i=a/x.value;h.value={x:l,y:a},f&&Z(o,i)},W=function(){f&&(f=!1,o("end"))},D=function(){i&&s.value&&(i.clearRect(0,0,s.value.width,s.value.height),o("end"))},H=function(){var e;return null===(e=s.value)||void 0===e?void 0:e.toDataURL()},F=function(e){if(i&&s.value&&(i.clearRect(0,0,s.value.width,s.value.height),e)){i.globalCompositeOperation="source-over",i.globalAlpha=1;var t=new Image;t.src=e,t.onload=function(){i.drawImage(t,0,0),I()}}};return n({clearCanvas:D,getImageDataURL:H,setImageDataURL:F}),function(e,t){var n=(0,u.up)("IconWrite"),l=(0,u.up)("IconHighLight");return(0,u.wg)(),(0,u.iD)("div",{class:"writing-board",ref_key:"writingBoardRef",ref:r},[e.blackboard?((0,u.wg)(),(0,u.iD)("div",lL)):(0,u.kq)("",!0),(0,u._)("canvas",{class:"canvas",ref_key:"canvasRef",ref:s,style:(0,pe.j5)({width:g.value+"px",height:y.value+"px"}),onMousedown:t[0]||(t[0]=function(e){return M(e)}),onMousemove:t[1]||(t[1]=function(e){return U(e)}),onMouseup:t[2]||(t[2]=function(e){return W()}),onTouchstart:t[3]||(t[3]=function(e){return M(e)}),onTouchmove:t[4]||(t[4]=function(e){return U(e)}),onTouchend:t[5]||(t[5]=function(e){W(),m.value=!1}),onMouseleave:t[6]||(t[6]=function(e){W(),m.value=!1}),onMouseenter:t[7]||(t[7]=function(e){return m.value=!0})},null,36),m.value?((0,u.wg)(),(0,u.iD)(u.HY,{key:1},["eraser"===e.model?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"eraser",style:(0,pe.j5)({left:h.value.x-e.rubberSize/2+"px",top:h.value.y-e.rubberSize/2+"px",width:e.rubberSize+"px",height:e.rubberSize+"px"})},null,4)):(0,u.kq)("",!0),"pen"===e.model?((0,u.wg)(),(0,u.iD)("div",{key:1,class:"pen",style:(0,pe.j5)({left:h.value.x-e.penSize/2+"px",top:h.value.y-6*e.penSize+e.penSize/2+"px",color:e.color})},["pen"===e.model?((0,u.wg)(),(0,u.j4)(n,{key:0,class:"icon",size:6*e.penSize},null,8,["size"])):(0,u.kq)("",!0)],4)):(0,u.kq)("",!0),"mark"===e.model?((0,u.wg)(),(0,u.iD)("div",{key:2,class:"pen",style:(0,pe.j5)({left:h.value.x-e.markSize/2+"px",top:h.value.y+"px",color:e.color})},["mark"===e.model?((0,u.wg)(),(0,u.j4)(l,{key:0,class:"icon",size:1.5*e.markSize},null,8,["size"])):(0,u.kq)("",!0)],4)):(0,u.kq)("",!0)],64)):(0,u.kq)("",!0)],512)}}}),oL=(0,ll.Z)(aL,[["__scopeId","data-v-d8027742"]]),iL=oL;var rL=function(e){return(0,u.dD)("data-v-62f7df80"),e=e(),(0,u.Cn)(),e},uL={class:"writing-board-tool"},cL={class:"tool-content"},sL={class:"size"},dL=rL((function(){return(0,u._)("div",{class:"label"},"Ink thickness:",-1)})),fL={class:"size"},vL=rL((function(){return(0,u._)("div",{class:"label"},"Ink thickness:",-1)})),pL={class:"size"},hL=rL((function(){return(0,u._)("div",{class:"label"},"Eraser size:",-1)})),mL={class:"colors"},gL=["onClick"];const yL=(0,u.aZ)({__name:"WritingBoardTool",props:{slideWidth:{},slideHeight:{},left:{default:-5},top:{default:-5}},emits:["close"],setup:function(e,t){var n=t.emit,l=["#000000","#ffffff","#1e497b","#4e81bb","#e2534d","#9aba60","#8165a0","#47acc5","#f9974c","#ffff3a"],i=n,r=(0,o.Jk)(V()),s=r.currentSlide,d=(0,c.iH)(),f=(0,c.iH)("#e2534d"),v=(0,c.iH)("pen"),p=(0,c.iH)(!1),h=(0,c.iH)(""),m=(0,c.iH)(6),g=(0,c.iH)(24),y=(0,c.iH)(80),w=function(e){v.value===e?h.value=h.value===e?"":e:(h.value&&(h.value=""),v.value=e)},x=function(){d.value.clearCanvas()},b=function(e){"eraser"===v.value&&(v.value="pen"),f.value=e},k=function(){i("close")};(0,u.YP)(s,(function(){ue.writingBoardImgs.where("id").equals(s.value.id).toArray().then((function(e){var t=e[0];d.value.setImageDataURL((null===t||void 0===t?void 0:t.dataURL)||"")}))}),{immediate:!0});var _=function(){var e=d.value.getImageDataURL();e&&ue.writingBoardImgs.where("id").equals(s.value.id).toArray().then((function(t){var n=t[0];n?ue.writingBoardImgs.update(n,{dataURL:e}):ue.writingBoardImgs.add({id:s.value.id,dataURL:e})}))};return function(e,t){var n=(0,u.up)("IconWrite"),o=(0,u.up)("IconHighLight"),i=(0,u.up)("IconErase"),r=(0,u.up)("IconClear"),c=(0,u.up)("IconFill"),s=(0,u.up)("IconClose"),I=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",uL,[(0,u._)("div",{class:"writing-board-wrap",style:(0,pe.j5)({width:e.slideWidth+"px",height:e.slideHeight+"px"})},[(0,u.Wm)(iL,{ref_key:"writingBoardRef",ref:d,color:f.value,blackboard:p.value,model:v.value,penSize:m.value,markSize:g.value,rubberSize:y.value,onEnd:t[0]||(t[0]=function(e){return _()})},null,8,["color","blackboard","model","penSize","markSize","rubberSize"])],4),(0,u.Wm)(KS,{class:"tools-panel",width:520,height:50,left:e.left,top:e.top,moveable:""===h.value},{default:(0,u.w5)((function(){return[(0,u._)("div",{class:"tools",onMousedown:t[10]||(t[10]=(0,a.iM)((function(){}),["stop"]))},[(0,u._)("div",cL,[(0,u.Wm)(lo,{trigger:"manual",value:"pen"===h.value},{content:(0,u.w5)((function(){return[(0,u._)("div",sL,[dL,(0,u.Wm)(qh,{class:"size-slider",min:4,max:10,step:2,value:m.value,"onUpdate:value":t[1]||(t[1]=function(e){return m.value=e})},null,8,["value"])])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["btn",{active:"pen"===v.value}]),onClick:t[2]||(t[2]=function(e){return w("pen")})},[(0,u.Wm)(n,{class:"icon"})],2)),[[I,"画笔"]])]})),_:1},8,["value"]),(0,u.Wm)(lo,{trigger:"manual",value:"mark"===h.value},{content:(0,u.w5)((function(){return[(0,u._)("div",fL,[vL,(0,u.Wm)(qh,{class:"size-slider",min:16,max:40,step:4,value:g.value,"onUpdate:value":t[3]||(t[3]=function(e){return g.value=e})},null,8,["value"])])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["btn",{active:"mark"===v.value}]),onClick:t[4]||(t[4]=function(e){return w("mark")})},[(0,u.Wm)(o,{class:"icon"})],2)),[[I,"荧光笔"]])]})),_:1},8,["value"]),(0,u.Wm)(lo,{trigger:"manual",value:"eraser"===h.value},{content:(0,u.w5)((function(){return[(0,u._)("div",pL,[hL,(0,u.Wm)(qh,{class:"size-slider",min:20,max:200,step:20,value:y.value,"onUpdate:value":t[5]||(t[5]=function(e){return y.value=e})},null,8,["value"])])]})),default:(0,u.w5)((function(){return[(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["btn",{active:"eraser"===v.value}]),onClick:t[6]||(t[6]=function(e){return w("eraser")})},[(0,u.Wm)(i,{class:"icon"})],2)),[[I,"橡皮擦"]])]})),_:1},8,["value"]),(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"btn",onClick:t[7]||(t[7]=function(e){return x()})},[(0,u.Wm)(r,{class:"icon"})])),[[I,"clear ink"]]),(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["btn",{active:p.value}]),onClick:t[8]||(t[8]=function(e){return p.value=!p.value})},[(0,u.Wm)(c,{class:"icon"})],2)),[[I,"blackboard"]]),(0,u._)("div",mL,[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(l,(function(e){return(0,u._)("div",{class:(0,pe.C_)(["color",{active:e===f.value}]),key:e,style:(0,pe.j5)({backgroundColor:e}),onClick:function(t){return b(e)}},null,14,gL)})),64))])]),(0,u.wy)(((0,u.wg)(),(0,u.iD)("div",{class:"btn",onClick:t[9]||(t[9]=function(e){return k()})},[(0,u.Wm)(s,{class:"icon"})])),[[I,"Close brush"]])],32)]})),_:1},8,["left","top","moveable"])])}}}),wL=(0,ll.Z)(yL,[["__scopeId","data-v-62f7df80"]]),xL=wL;var bL=function(e){return(0,u.dD)("data-v-668b597b"),e=e(),(0,u.Cn)(),e},kL={class:"header"},_L={class:"content"},IL={class:"timer"},SL=["value","disabled"],CL=bL((function(){return(0,u._)("div",{class:"colon"},":",-1)})),LL={class:"timer"},EL=["value","disabled"];const ZL=(0,u.aZ)({__name:"CountdownTimer",props:{left:{default:5},top:{default:5}},emits:["close"],setup:function(e,t){var n=t.emit,l=n,o=(0,c.iH)(null),i=(0,c.iH)(!1),r=(0,c.iH)(!1),s=(0,c.iH)(0),d=(0,u.Fl)((function(){return Math.floor(s.value/60)})),f=(0,u.Fl)((function(){return s.value%60})),v=(0,u.Fl)((function(){return!r.value||i.value})),p=function(){o.value&&clearInterval(o.value)};(0,u.Ah)(p);var h=function(){p(),i.value=!1},m=function(){p(),i.value=!1,r.value?s.value=600:s.value=0},g=function(){p(),r.value?o.value=setInterval((function(){s.value=s.value-1,s.value<=0&&m()}),1e3):o.value=setInterval((function(){s.value=s.value+1,s.value>36e3&&h()}),1e3),i.value=!0},y=function(){i.value?h():g()},w=function(){r.value=!r.value,m()},x=function(e,t){var n=e.target,l=n.value,a=/^(\d)+$/.test(l);a?("second"===t&&+l>=60&&(l="59"),s.value="minute"===t?60*+l+f.value:+l+60*d.value):n.value=fe("minute"===t?d.value:f.value,2)};return function(e,t){var n=(0,u.up)("IconClose");return(0,u.wg)(),(0,u.j4)(KS,{class:"countdown-timer",width:180,height:110,left:e.left,top:e.top},{default:(0,u.w5)((function(){return[(0,u._)("div",kL,[(0,u._)("span",{class:"text-btn",onClick:t[0]||(t[0]=function(e){return y()})},(0,pe.zw)(i.value?"Pause":"Start"),1),(0,u._)("span",{class:"text-btn",onClick:t[1]||(t[1]=function(e){return m()})},"Reset"),(0,u._)("span",{class:(0,pe.C_)(["text-btn",{active:r.value}]),onClick:t[2]||(t[2]=function(e){return w()})},"Countdown",2)]),(0,u._)("div",_L,[(0,u._)("div",IL,[(0,u._)("input",{type:"text",value:(0,c.SU)(fe)(d.value,2),maxlength:3,disabled:v.value,onMousedown:t[3]||(t[3]=(0,a.iM)((function(){}),["stop"])),onBlur:t[4]||(t[4]=function(e){return x(e,"minute")}),onKeydown:[t[5]||(t[5]=(0,a.iM)((function(){}),["stop"])),t[6]||(t[6]=(0,a.D2)((0,a.iM)((function(e){return x(e,"minute")}),["stop"]),["enter"]))]},null,40,SL)]),CL,(0,u._)("div",LL,[(0,u._)("input",{type:"text",value:(0,c.SU)(fe)(f.value,2),maxlength:3,disabled:v.value,onMousedown:t[7]||(t[7]=(0,a.iM)((function(){}),["stop"])),onBlur:t[8]||(t[8]=function(e){return x(e,"second")}),onKeydown:[t[9]||(t[9]=(0,a.iM)((function(){}),["stop"])),t[10]||(t[10]=(0,a.D2)((0,a.iM)((function(e){return x(e,"second")}),["stop"]),["enter"]))]},null,40,EL)])]),(0,u._)("div",{class:"close-btn",onClick:t[11]||(t[11]=function(e){return l("close")})},[(0,u.Wm)(n,{class:"icon"})])]})),_:1},8,["left","top"])}}}),TL=(0,ll.Z)(ZL,[["__scopeId","data-v-668b597b"]]),ML=TL;var UL={class:"tools-left"},WL={class:"content"};const DL=(0,u.aZ)({__name:"BaseView",props:{changeViewMode:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(V()),l=n.slides,a=n.slideIndex,i=EC(),r=i.autoPlayTimer,s=i.autoPlay,d=i.closeAutoPlay,f=i.autoPlayInterval,v=i.setAutoPlayInterval,p=i.loopPlay,h=i.setLoopPlay,m=i.mousewheelListener,g=i.touchStartListener,y=i.touchEndListener,w=i.turnPrevSlide,x=i.turnNextSlide,b=i.turnSlideToIndex,k=i.turnSlideToId,_=i.execPrev,I=i.execNext,S=i.animationIndex,C=ZC(),L=C.slideWidth,E=C.slideHeight,Z=Ol(),T=Z.exitScreening,M=TC(),U=M.fullscreenState,W=M.manualExitFullscreen,D=(0,c.iH)(!1),H=(0,c.iH)(!1),F=(0,c.iH)(!1),A=(0,c.iH)(!1),O=(0,c.iH)(!1),P=function(){return[{text:"Previous page",subText:"↑ ←",disable:a.value<=0,handler:function(){return w()}},{text:"Next page",subText:"↓ →",disable:a.value>=l.value.length-1,handler:function(){return x()}},{text:"First page",disable:0===a.value,handler:function(){return b(0)}},{text:"Last page",disable:a.value===l.value.length-1,handler:function(){return b(l.value.length-1)}},{divider:!0},{text:r.value?"Cancel automatic show":"automatic show",handler:r.value?d:s,children:[{text:"2.5 seconds",subText:2500===f.value?"√":"",handler:function(){return v(2500)}},{text:"5 seconds",subText:5e3===f.value?"√":"",handler:function(){return v(5e3)}},{text:"7.5 seconds",subText:7500===f.value?"√":"",handler:function(){return v(7500)}},{text:"10 seconds",subText:1e4===f.value?"√":"",handler:function(){return v(1e4)}}]},{text:"Loop show",subText:p.value?"√":"",handler:function(){return h(!p.value)}},{divider:!0},{text:"Show toolbar",handler:function(){return D.value=!0}},{text:"View all slides",handler:function(){return A.value=!0}},{text:"Brush tool",handler:function(){return H.value=!0}},{text:"Speaker view",handler:function(){return t.changeViewMode("presenter")}},{divider:!0},{text:"End show",subText:"ESC",handler:T}]};return function(e,t){var n=(0,u.up)("IconLeftTwo"),o=(0,u.up)("IconRightTwo"),i=(0,u.up)("IconWrite"),r=(0,u.up)("IconMagic"),s=(0,u.up)("IconStopwatchStart"),d=(0,u.up)("IconListView"),f=(0,u.up)("IconOffScreenOne"),v=(0,u.up)("IconFullScreenOne"),p=(0,u.up)("IconPower"),h=(0,u.Q2)("contextmenu"),w=(0,u.Q2)("tooltip");return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["base-view",{"laser-pen":O.value}])},[(0,u.wy)((0,u.Wm)(XC,{slideWidth:(0,c.SU)(L),slideHeight:(0,c.SU)(E),animationIndex:(0,c.SU)(S),turnSlideToId:(0,c.SU)(k),manualExitFullscreen:(0,c.SU)(W),onWheel:t[0]||(t[0]=function(e){return(0,c.SU)(m)(e)}),onTouchstart:t[1]||(t[1]=function(e){return(0,c.SU)(g)(e)}),onTouchend:t[2]||(t[2]=function(e){return(0,c.SU)(y)(e)})},null,8,["slideWidth","slideHeight","animationIndex","turnSlideToId","manualExitFullscreen"]),[[h,P]]),A.value?((0,u.wg)(),(0,u.j4)(nL,{key:0,turnSlideToIndex:(0,c.SU)(b),onClose:t[3]||(t[3]=function(e){return A.value=!1})},null,8,["turnSlideToIndex"])):(0,u.kq)("",!0),H.value?((0,u.wg)(),(0,u.j4)(xL,{key:1,slideWidth:(0,c.SU)(L),slideHeight:(0,c.SU)(E),onClose:t[4]||(t[4]=function(e){return H.value=!1})},null,8,["slideWidth","slideHeight"])):(0,u.kq)("",!0),F.value?((0,u.wg)(),(0,u.j4)(ML,{key:2,onClose:t[5]||(t[5]=function(e){return F.value=!1})})):(0,u.kq)("",!0),(0,u._)("div",UL,[(0,u.Wm)(n,{class:"tool-btn",theme:"two-tone",fill:["#111","#fff"],onClick:t[6]||(t[6]=function(e){return(0,c.SU)(_)()})}),(0,u.Wm)(o,{class:"tool-btn",theme:"two-tone",fill:["#111","#fff"],onClick:t[7]||(t[7]=function(e){return(0,c.SU)(I)()})})]),(0,u._)("div",{class:(0,pe.C_)(["tools-right",{visible:D.value}]),onMouseleave:t[16]||(t[16]=function(e){return D.value=!1}),onMouseenter:t[17]||(t[17]=function(e){return D.value=!0})},[(0,u._)("div",WL,[(0,u._)("div",{class:"tool-btn page-number",onClick:t[8]||(t[8]=function(e){return A.value=!0})}," slideshow "+(0,pe.zw)((0,c.SU)(a)+1)+" / "+(0,pe.zw)((0,c.SU)(l).length),1),(0,u.wy)((0,u.Wm)(i,{class:"tool-btn",onClick:t[9]||(t[9]=function(e){return H.value=!0})},null,512),[[w,"Brush tool"]]),(0,u.wy)((0,u.Wm)(r,{class:(0,pe.C_)(["tool-btn",{active:O.value}]),onClick:t[10]||(t[10]=function(e){return O.value=!O.value})},null,8,["class"]),[[w,"laser pointer"]]),(0,u.wy)((0,u.Wm)(s,{class:(0,pe.C_)(["tool-btn",{active:F.value}]),onClick:t[11]||(t[11]=function(e){return F.value=!F.value})},null,8,["class"]),[[w,"timer"]]),(0,u.wy)((0,u.Wm)(d,{class:"tool-btn",onClick:t[12]||(t[12]=function(t){return e.changeViewMode("presenter")})},null,512),[[w,"Speaker view"]]),(0,c.SU)(U)?(0,u.wy)(((0,u.wg)(),(0,u.j4)(f,{key:0,class:"tool-btn",onClick:t[13]||(t[13]=function(e){return(0,c.SU)(W)()})},null,512)),[[w,"Exit Full Screen"]]):(0,u.wy)(((0,u.wg)(),(0,u.j4)(v,{key:1,class:"tool-btn",onClick:t[14]||(t[14]=function(e){return(0,c.SU)(Hl)()})},null,512)),[[w,"full screen"]]),(0,u.wy)((0,u.Wm)(p,{class:"tool-btn",onClick:t[15]||(t[15]=function(e){return(0,c.SU)(T)()})},null,512),[[w,"end show"]])])],34)],2)}}}),HL=(0,ll.Z)(DL,[["__scopeId","data-v-ec11fcb6"]]),FL=HL;var AL=function(e){return(0,u.dD)("data-v-79965aa0"),e=e(),(0,u.Cn)(),e},OL={class:"presenter-view"},PL={class:"toolbar"},RL=AL((function(){return(0,u._)("span",null,"normal view",-1)})),BL=AL((function(){return(0,u._)("span",null,"brush",-1)})),zL=AL((function(){return(0,u._)("span",null,"laser pointer",-1)})),NL=AL((function(){return(0,u._)("span",null,"timer",-1)})),jL=AL((function(){return(0,u._)("span",null,"end show",-1)})),YL={class:"content"},VL=["onClick"],JL={class:"remark"},qL={class:"header"},XL=AL((function(){return(0,u._)("span",null,"Speaker Notes",-1)})),GL=["innerHTML"],KL={class:"remark-scale"};const QL=(0,u.aZ)({__name:"PresenterView",props:{changeViewMode:{type:Function}},setup:function(e){var t=e,n=(0,o.Jk)(V()),l=n.slides,i=n.slideIndex,r=n.viewportRatio,s=n.currentSlide,d=(0,c.iH)(),f=(0,c.iH)(),v=(0,c.iH)(!1),p=(0,c.iH)(!1),h=(0,c.iH)(!1),m=EC(),g=m.mousewheelListener,y=m.touchStartListener,w=m.touchEndListener,x=m.turnPrevSlide,b=m.turnNextSlide,k=m.turnSlideToIndex,_=m.turnSlideToId,I=m.animationIndex,S=ZC(d),C=S.slideWidth,L=S.slideHeight,E=Ol(),Z=E.exitScreening,T=Sh(),M=T.slidesLoadLimit,U=TC(),W=U.fullscreenState,D=U.manualExitFullscreen,H=(0,c.iH)(16),F=(0,u.Fl)((function(){return ml(s.value.remark||"No remarks")})),A=function(e){f.value&&f.value.scrollBy(e.deltaY,0)},O=function(e){e<12||e>40||(H.value=e)};(0,u.YP)(i,(function(){(0,u.Y3)((function(){if(f.value){var e=f.value.querySelector(".thumbnail.active");if(e){var t=f.value.offsetWidth,n=e.offsetLeft;f.value.scrollTo({left:n-t/2,behavior:"smooth"})}}}))}));var P=function(){return[{text:"Previous page",subText:"↑ ←",disable:i.value<=0,handler:function(){return x()}},{text:"Next page",subText:"↓ →",disable:i.value>=l.value.length-1,handler:function(){return b()}},{text:"First page",disable:0===i.value,handler:function(){return k(0)}},{text:"Last page",disable:i.value===l.value.length-1,handler:function(){return k(l.value.length-1)}},{divider:!0},{text:"Brush tool",handler:function(){return v.value=!0}},{text:"normal view",handler:function(){return t.changeViewMode("base")}},{divider:!0},{text:"end show",subText:"ESC",handler:Z}]};return function(e,t){var n=(0,u.up)("IconListView"),o=(0,u.up)("IconWrite"),s=(0,u.up)("IconMagic"),m=(0,u.up)("IconStopwatchStart"),x=(0,u.up)("IconOffScreenOne"),b=(0,u.up)("IconPower"),S=(0,u.up)("IconMinus"),E=(0,u.up)("IconPlus"),T=(0,u.Q2)("contextmenu");return(0,u.wg)(),(0,u.iD)("div",OL,[(0,u._)("div",PL,[(0,u._)("div",{class:"tool-btn",onClick:t[0]||(t[0]=function(t){return e.changeViewMode("base")})},[(0,u.Wm)(n,{class:"tool-icon"}),RL]),(0,u._)("div",{class:(0,pe.C_)(["tool-btn",{active:v.value}]),onClick:t[1]||(t[1]=function(e){return v.value=!v.value})},[(0,u.Wm)(o,{class:"tool-icon"}),BL],2),(0,u._)("div",{class:(0,pe.C_)(["tool-btn",{active:h.value}]),onClick:t[2]||(t[2]=function(e){return h.value=!h.value})},[(0,u.Wm)(s,{class:"tool-icon"}),zL],2),(0,u._)("div",{class:(0,pe.C_)(["tool-btn",{active:p.value}]),onClick:t[3]||(t[3]=function(e){return p.value=!p.value})},[(0,u.Wm)(m,{class:"tool-icon"}),NL],2),(0,u._)("div",{class:"tool-btn",onClick:t[4]||(t[4]=function(){return(0,c.SU)(W)?(0,c.SU)(D)():(0,c.SU)(Hl)()})},[(0,c.SU)(W)?((0,u.wg)(),(0,u.j4)(x,{key:0,class:"tool-icon"})):((0,u.wg)(),(0,u.j4)(x,{key:1,class:"tool-icon"})),(0,u._)("span",null,(0,pe.zw)((0,c.SU)(W)?"Exit Full Screen":"full screen"),1)]),(0,u.Wm)(Ud,{class:"divider"}),(0,u._)("div",{class:"tool-btn",onClick:t[5]||(t[5]=function(e){return(0,c.SU)(Z)()})},[(0,u.Wm)(b,{class:"tool-icon"}),jL])]),(0,u._)("div",YL,[(0,u._)("div",{class:(0,pe.C_)(["slide-list-wrap",{"laser-pen":h.value}]),ref_key:"slideListWrapRef",ref:d},[(0,u.wy)((0,u.Wm)(XC,{slideWidth:(0,c.SU)(C),slideHeight:(0,c.SU)(L),animationIndex:(0,c.SU)(I),turnSlideToId:(0,c.SU)(_),manualExitFullscreen:(0,c.SU)(D),onWheel:t[6]||(t[6]=function(e){return(0,c.SU)(g)(e)}),onTouchstart:t[7]||(t[7]=function(e){return(0,c.SU)(y)(e)}),onTouchend:t[8]||(t[8]=function(e){return(0,c.SU)(w)(e)})},null,8,["slideWidth","slideHeight","animationIndex","turnSlideToId","manualExitFullscreen"]),[[T,P]]),v.value?((0,u.wg)(),(0,u.j4)(xL,{key:0,slideWidth:(0,c.SU)(C),slideHeight:(0,c.SU)(L),left:-365,top:-155,onClose:t[9]||(t[9]=function(e){return v.value=!1})},null,8,["slideWidth","slideHeight"])):(0,u.kq)("",!0),p.value?((0,u.wg)(),(0,u.j4)(ML,{key:1,left:75,onClose:t[10]||(t[10]=function(e){return p.value=!1})})):(0,u.kq)("",!0)],2),(0,u._)("div",{class:"thumbnails",ref_key:"thumbnailsRef",ref:f,onWheel:t[11]||(t[11]=(0,a.iM)((function(e){return A(e)}),["prevent"]))},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(l),(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["thumbnail",{active:t===(0,c.SU)(i)}]),key:e.id,onClick:function(e){return(0,c.SU)(k)(t)}},[(0,u.Wm)(Nf,{slide:e,size:120/(0,c.SU)(r),visible:t<(0,c.SU)(M)},null,8,["slide","size","visible"])],10,VL)})),128))],544)]),(0,u._)("div",JL,[(0,u._)("div",qL,[XL,(0,u._)("span",null,"P "+(0,pe.zw)((0,c.SU)(i)+1)+" / "+(0,pe.zw)((0,c.SU)(l).length),1)]),(0,u._)("div",{class:"remark-content ProseMirror-static",style:(0,pe.j5)({fontSize:H.value+"px"}),innerHTML:F.value},null,12,GL),(0,u._)("div",KL,[(0,u._)("div",{class:(0,pe.C_)(["scale-btn",{disable:12===H.value}]),onClick:t[12]||(t[12]=function(e){return O(H.value-2)})},[(0,u.Wm)(S)],2),(0,u._)("div",{class:(0,pe.C_)(["scale-btn",{disable:40===H.value}]),onClick:t[13]||(t[13]=function(e){return O(H.value+2)})},[(0,u.Wm)(E)],2)])])])}}}),$L=(0,ll.Z)(QL,[["__scopeId","data-v-79965aa0"]]),eE=$L;var tE={class:"ppt-screen"};const nE=(0,u.aZ)({__name:"index",setup:function(e){var t=(0,c.iH)("base"),n=function(e){t.value=e},l=Ol(),a=l.exitScreening,o=function(e){var t=e.key.toUpperCase();t===m.ESC&&a()};return(0,u.bv)((function(){return document.addEventListener("keydown",o)})),(0,u.Ah)((function(){return document.removeEventListener("keydown",o)})),function(e,l){return(0,u.wg)(),(0,u.iD)("div",tE,["base"===t.value?((0,u.wg)(),(0,u.j4)(FL,{key:0,changeViewMode:n})):"presenter"===t.value?((0,u.wg)(),(0,u.j4)(eE,{key:1,changeViewMode:n})):(0,u.kq)("",!0)])}}}),lE=(0,ll.Z)(nE,[["__scopeId","data-v-cfe7e0ac"]]),aE=lE,oE=(0,u.aZ)({__name:"MobileEditableElement",props:{elementInfo:{},elementIndex:{},selectElement:{type:Function}},setup:function(e){var t=e,n=(0,u.Fl)((function(){var e=(0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)((0,te.Z)({},vl.IMAGE,Ei),vl.TEXT,Xr),vl.SHAPE,fu),vl.LINE,_u),vl.CHART,Tu),vl.TABLE,Gu),vl.LATEX,nc),vl.VIDEO,Uc),vl.AUDIO,$c);return e[t.elementInfo.type]||null}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"mobile-editable-element",style:(0,pe.j5)({zIndex:e.elementIndex})},[((0,u.wg)(),(0,u.j4)((0,u.LL)(n.value),{elementInfo:e.elementInfo,selectElement:e.selectElement,contextmenus:function(){return null}},null,8,["elementInfo","selectElement"]))],4)}}}),iE=oE,rE=iE,uE=(0,u.aZ)({__name:"MobileOperate",props:{elementInfo:{},isSelected:{type:Boolean},canvasScale:{},scaleElement:{type:Function},rotateElement:{type:Function}},setup:function(e){var t=e,n=(0,u.Fl)((function(){return"rotate"in t.elementInfo?t.elementInfo.rotate:0})),l=(0,u.Fl)((function(){return t.elementInfo.width*t.canvasScale})),o=(0,u.Fl)((function(){return t.elementInfo.height*t.canvasScale})),i=Ws(l,o),r=i.borderLines,s=i.resizeHandlers,d=i.textElementResizeHandlers,f="text"===t.elementInfo.type||"table"===t.elementInfo.type?d:s,v=(0,u.Fl)((function(){return["chart","video","audio"].includes(t.elementInfo.type)}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"mobile-operate",style:(0,pe.j5)({top:e.elementInfo.top*e.canvasScale+"px",left:e.elementInfo.left*e.canvasScale+"px",transform:"rotate(".concat(n.value,"deg)"),transformOrigin:"".concat(e.elementInfo.width*e.canvasScale/2,"px ").concat(e.elementInfo.height*e.canvasScale/2,"px")})},[e.isSelected?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(r),(function(e){return(0,u.wg)(),(0,u.j4)(Ps,{class:"operate-border-line",key:e.type,type:e.type,style:(0,pe.j5)(e.style)},null,8,["type","style"])})),128)),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(f),(function(t){return(0,u.wg)(),(0,u.j4)(Fs,{class:"operate-resize-handler",key:t.direction,type:t.direction,rotate:e.elementInfo.rotate,style:(0,pe.j5)(t.style),onTouchstart:(0,a.iM)((function(n){return e.scaleElement(n,e.elementInfo,t.direction)}),["stop"])},null,8,["type","rotate","style","onTouchstart"])})),128)),v.value?(0,u.kq)("",!0):((0,u.wg)(),(0,u.j4)(Js,{key:0,class:"operate-rotate-handler",style:(0,pe.j5)({left:l.value/2+"px"}),onTouchstart:t[0]||(t[0]=(0,a.iM)((function(t){return e.rotateElement(t,e.elementInfo)}),["stop"]))},null,8,["style"]))],64)):(0,u.kq)("",!0)],4)}}}),cE=(0,ll.Z)(uE,[["__scopeId","data-v-fd451ff6"]]),sE=cE;var dE={class:"mobile-thumbnails"},fE=["onClick"],vE={class:"label"};const pE=(0,u.aZ)({__name:"MobileThumbnails",setup:function(e){var t=V(),n=(0,o.Jk)(t),l=n.slides,a=n.slideIndex,i=Ll(),r=i.sortSlides,s=Sh(),d=s.slidesLoadLimit,f=function(e){t.updateSlideIndex(e)},v=function(e){var t=e.newIndex,n=e.oldIndex;void 0!==t&&void 0!==n&&t!==n&&r(t,n)};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",dE,[(0,u.Wm)((0,c.SU)(Uh()),{class:"thumbnail-list",modelValue:(0,c.SU)(l),animation:200,scroll:!0,scrollSensitivity:50,delayOnTouchOnly:!0,delay:800,itemKey:"id",onEnd:v},{item:(0,u.w5)((function(e){var t=e.element,n=e.index;return[(0,u._)("div",{class:(0,pe.C_)(["thumbnail-item",{active:(0,c.SU)(a)===n}]),onClick:function(e){return f(n)}},[(0,u._)("div",vE,(0,pe.zw)(n+1),1),(0,u.Wm)(Nf,{class:"thumbnail",slide:t,size:120,visible:n<(0,c.SU)(d)},null,8,["slide","visible"])],10,fE)]})),_:1},8,["modelValue"])])}}}),hE=(0,ll.Z)(pE,[["__scopeId","data-v-2c80920e"]]),mE=hE;var gE={class:"slide-toolbar"},yE={class:"remark"},wE=["value"],xE={class:"toolbar"};const bE=(0,u.aZ)({__name:"SlideToolbar",setup:function(e){var t=V(),n=(0,o.Jk)(t),l=n.viewportRatio,a=n.currentSlide,i=Ll(),r=i.createSlide,s=i.copyAndPasteSlide,d=i.deleteSlide,f=Il(),v=f.createTextElement,p=f.createImageElement,h=f.createShapeElement,m=function(){var e=400,t=56;v({left:(wl-e)/2,top:(wl*l.value-t)/2,width:e,height:t},{content:"<p>Newly added text</p>"})},g=function(e){e&&e[0]&&yl(e[0]).then((function(e){return p(e)}))},y=function(e){var t={viewBox:[200,200],path:"M 0 0 L 200 0 L 200 200 L 0 200 Z"},n={viewBox:[200,200],path:"M 100 0 A 50 50 0 1 1 100 200 A 50 50 0 1 1 100 0 Z"},a={square:t,round:n},o=200;h({left:(wl-o)/2,top:(wl*l.value-o)/2,width:o,height:o},a[e])},w=(0,u.Fl)((function(){var e;return(null===(e=a.value)||void 0===e?void 0:e.remark)||""})),x=function(e){var n=e.target.value;t.updateSlide({remark:n})};return function(e,t){var n=(0,u.up)("IconPlus"),l=(0,u.up)("IconCopy"),a=(0,u.up)("IconDelete"),o=(0,u.up)("IconFontSize"),i=(0,u.up)("IconPicture"),f=(0,u.up)("IconSquare"),v=(0,u.up)("IconRound");return(0,u.wg)(),(0,u.iD)("div",gE,[(0,u._)("div",yE,[(0,u._)("textarea",{value:w.value,placeholder:"Click to enter speaker notes",onInput:t[0]||(t[0]=function(e){return x(e)})},null,40,wE)]),(0,u._)("div",xE,[(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[1]||(t[1]=function(e){return(0,c.SU)(r)()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(n,{class:"icon"}),(0,u.Uk)("New slide")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[2]||(t[2]=function(e){return(0,c.SU)(s)()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(l,{class:"icon"}),(0,u.Uk)("Copy")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[3]||(t[3]=function(e){return(0,c.SU)(d)()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(a,{class:"icon"}),(0,u.Uk)("Delete")]})),_:1})]})),_:1}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[4]||(t[4]=function(e){return m()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(o,{class:"icon"}),(0,u.Uk)("Text")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(hh,{onChange:t[5]||(t[5]=function(e){return g(e)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(i,{class:"icon"}),(0,u.Uk)("Picture ")]})),_:1})]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[6]||(t[6]=function(e){return y("square")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(f,{class:"icon"}),(0,u.Uk)("Rectangle")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:t[7]||(t[7]=function(e){return y("round")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(v,{class:"icon"}),(0,u.Uk)("Round")]})),_:1})]})),_:1})]),(0,u.Wm)(mE)])}}}),kE=(0,ll.Z)(bE,[["__scopeId","data-v-5f288024"]]),_E=kE;var IE=function(e){return(0,u.dD)("data-v-53685f84"),e=e(),(0,u.Cn)(),e},SE={class:"element-toolbar"},CE={class:"content"},LE={key:0,class:"style"},EE={class:"row-block"},ZE=IE((function(){return(0,u._)("div",{class:"label"},"Text color:",-1)})),TE={class:"colors"},ME=["onClick"],UE={class:"row-block"},WE=IE((function(){return(0,u._)("div",{class:"label"},"Fill color:",-1)})),DE={class:"colors"},HE=["onClick"],FE={key:1,class:"common"};const AE=(0,u.aZ)({__name:"ElementToolbar",setup:function(e){var t=["#000000","#ffffff","#eeece1","#1e497b","#4e81bb","#e2534d","#9aba60","#8165a0","#47acc5","#f9974c","#c21401","#ff1e02","#ffc12a","#ffff3a","#90cf5b","#00af57"],n=X(),l=V(),a=(0,o.Jk)(n),i=a.handleElement,r=a.handleElementId,s=a.richTextAttrs,v=_l(),p=v.addHistorySnapshot,h=function(e,t){l.updateElement({id:e,props:t}),p()},m=[{key:"style",label:"style"},{key:"common",label:"layout"}],y=(0,c.iH)("common"),w=Dl(),x=w.orderElement,b=Po(),k=b.alignElementToCanvas,_=Sl(),I=_.addElementsFromData,S=Zl(),C=S.deleteElement,L=function(){var e=JSON.parse(JSON.stringify(i.value));I([e])},E=function(e,t){Mr.emit(_r.RICH_TEXT_COMMAND,{action:{command:e,value:t}})},Z=function(e){var t;if(i.value){if(("text"===i.value.type||"shape"===i.value.type&&null!==(t=i.value.text)&&void 0!==t&&t.content)&&Mr.emit(_r.RICH_TEXT_COMMAND,{action:{command:"color",value:e}}),"table"===i.value.type){for(var n=JSON.parse(JSON.stringify(i.value.data)),l=0;l<n.length;l++)for(var a=0;a<n[l].length;a++){var o=n[l][a].style||{};n[l][a].style=(0,g.Z)((0,g.Z)({},o),{},{color:e})}h(r.value,{data:n})}"latex"===i.value.type&&h(r.value,{color:e})}},T=function(e){if(i.value){if("text"!==i.value.type&&"shape"!==i.value.type&&"chart"!==i.value.type||h(r.value,{fill:e}),"table"===i.value.type){for(var t=JSON.parse(JSON.stringify(i.value.data)),n=0;n<t.length;n++)for(var l=0;l<t[n].length;l++){var a=t[n][l].style||{};t[n][l].style=(0,g.Z)((0,g.Z)({},a),{},{backcolor:e})}h(r.value,{data:t})}"audio"===i.value.type&&h(r.value,{color:e})}};return function(e,n){var l=(0,u.up)("IconTextBold"),a=(0,u.up)("IconTextItalic"),o=(0,u.up)("IconTextUnderline"),r=(0,u.up)("IconStrikethrough"),v=(0,u.up)("IconFontSize"),p=(0,u.up)("IconAlignTextLeft"),h=(0,u.up)("IconAlignTextCenter"),g=(0,u.up)("IconAlignTextRight"),w=(0,u.up)("IconCopy"),b=(0,u.up)("IconDelete"),_=(0,u.up)("IconSendToBack"),I=(0,u.up)("IconBringToFrontOne"),S=(0,u.up)("IconBringToFront"),M=(0,u.up)("IconSentToBack"),U=(0,u.up)("IconAlignLeft"),W=(0,u.up)("IconAlignVertically"),D=(0,u.up)("IconAlignRight"),H=(0,u.up)("IconAlignTop"),F=(0,u.up)("IconAlignHorizontally"),A=(0,u.up)("IconAlignBottom");return(0,u.wg)(),(0,u.iD)("div",SE,[(0,u.Wm)(Jf,{tabs:m,value:y.value,"onUpdate:value":n[0]||(n[0]=function(e){return y.value=e}),tabsStyle:{marginBottom:"8px"},tabStyle:{width:"30%",margin:"0 10%"}},null,8,["value"]),(0,u._)("div",CE,["style"===y.value?((0,u.wg)(),(0,u.iD)("div",LE,[(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).bold,onClick:n[1]||(n[1]=function(e){return E("bold")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(l)]})),_:1},8,["checked"]),(0,u.Wm)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).em,onClick:n[2]||(n[2]=function(e){return E("em")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(a)]})),_:1},8,["checked"]),(0,u.Wm)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).underline,onClick:n[3]||(n[3]=function(e){return E("underline")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(o)]})),_:1},8,["checked"]),(0,u.Wm)(Vg,{style:{flex:"1"},checked:(0,c.SU)(s).strikethrough,onClick:n[4]||(n[4]=function(e){return E("strikethrough")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(r)]})),_:1},8,["checked"])]})),_:1}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[5]||(n[5]=function(e){return E("fontsize-add")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(v),(0,u.Uk)("+")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[6]||(n[6]=function(e){return E("fontsize-reduce")})},{default:(0,u.w5)((function(){return[(0,u.Wm)(v),(0,u.Uk)("-")]})),_:1})]})),_:1}),(0,u.Wm)(Ud,{style:{margin:"20px 0"}}),(0,u.Wm)(ty,{class:"row","button-style":"solid",value:(0,c.SU)(s).align,"onUpdate:value":n[7]||(n[7]=function(e){return E("align",e)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(Qg,{value:"left",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(p)]})),_:1}),(0,u.Wm)(Qg,{value:"center",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(h)]})),_:1}),(0,u.Wm)(Qg,{value:"right",style:{flex:"1"}},{default:(0,u.w5)((function(){return[(0,u.Wm)(g)]})),_:1})]})),_:1},8,["value"]),(0,u.Wm)(Ud,{style:{margin:"20px 0"}}),(0,u._)("div",EE,[ZE,(0,u._)("div",TE,[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(t,(function(e){return(0,u._)("div",{class:"color",key:e,onClick:function(t){return Z(e)}},[(0,u._)("div",{class:"color-block",style:(0,pe.j5)({backgroundColor:e})},null,4)],8,ME)})),64))])]),(0,u._)("div",UE,[WE,(0,u._)("div",DE,[((0,u.wg)(),(0,u.iD)(u.HY,null,(0,u.Ko)(t,(function(e){return(0,u._)("div",{class:"color",key:e,onClick:function(t){return T(e)}},[(0,u._)("div",{class:"color-block",style:(0,pe.j5)({backgroundColor:e})},null,4)],8,HE)})),64))])])])):(0,u.kq)("",!0),"common"===y.value?((0,u.wg)(),(0,u.iD)("div",FE,[(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[8]||(n[8]=function(e){return L()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(w,{class:"icon"}),(0,u.Uk)(" Copy")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[9]||(n[9]=function(e){return(0,c.SU)(C)()})},{default:(0,u.w5)((function(){return[(0,u.Wm)(b,{class:"icon"}),(0,u.Uk)(" Delete")]})),_:1})]})),_:1}),(0,u.Wm)(Ud,{style:{margin:"20px 0"}}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[10]||(n[10]=function(e){return(0,c.SU)(x)((0,c.SU)(i),(0,c.SU)(d).TOP)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(_,{class:"icon"}),(0,u.Uk)(" Pin to top")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[11]||(n[11]=function(e){return(0,c.SU)(x)((0,c.SU)(i),(0,c.SU)(d).BOTTOM)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(I,{class:"icon"}),(0,u.Uk)(" Bottom")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[12]||(n[12]=function(e){return(0,c.SU)(x)((0,c.SU)(i),(0,c.SU)(d).UP)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(S,{class:"icon"}),(0,u.Uk)("Move up")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[13]||(n[13]=function(e){return(0,c.SU)(x)((0,c.SU)(i),(0,c.SU)(d).DOWN)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(M,{class:"icon"}),(0,u.Uk)("Move down")]})),_:1})]})),_:1}),(0,u.Wm)(Ud,{style:{margin:"20px 0"}}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[14]||(n[14]=function(e){return(0,c.SU)(k)((0,c.SU)(f).LEFT)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(U,{class:"icon"}),(0,u.Uk)("Align left")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[15]||(n[15]=function(e){return(0,c.SU)(k)((0,c.SU)(f).HORIZONTAL)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(W,{class:"icon"}),(0,u.Uk)(" Horizontally centered")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[16]||(n[16]=function(e){return(0,c.SU)(k)((0,c.SU)(f).RIGHT)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(D,{class:"icon"}),(0,u.Uk)("Align right")]})),_:1})]})),_:1}),(0,u.Wm)(Xg,{class:"row"},{default:(0,u.w5)((function(){return[(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[17]||(n[17]=function(e){return(0,c.SU)(k)((0,c.SU)(f).TOP)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(H,{class:"icon"}),(0,u.Uk)("Align top")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[18]||(n[18]=function(e){return(0,c.SU)(k)((0,c.SU)(f).VERTICAL)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(F,{class:"icon"}),(0,u.Uk)(" Vertically centered")]})),_:1}),(0,u.Wm)(Gf,{style:{flex:"1"},onClick:n[19]||(n[19]=function(e){return(0,c.SU)(k)((0,c.SU)(f).BOTTOM)})},{default:(0,u.w5)((function(){return[(0,u.Wm)(A,{class:"icon"}),(0,u.Uk)("Align bottom")]})),_:1})]})),_:1})])):(0,u.kq)("",!0)])])}}}),OE=(0,ll.Z)(AE,[["__scopeId","data-v-53685f84"]]),PE=OE;var RE={class:"mobile-editor-header"},BE={class:"history"};const zE=(0,u.aZ)({__name:"Header",props:{changeMode:{type:Function}},setup:function(e){var t=(0,o.Jk)(ce()),n=t.canUndo,l=t.canRedo,i=_l(),r=i.redo,s=i.undo;return function(e,t){var o=(0,u.up)("IconBack"),i=(0,u.up)("IconNext"),d=(0,u.up)("IconLogout");return(0,u.wg)(),(0,u.iD)("div",RE,[(0,u._)("div",BE,[(0,u._)("div",{class:(0,pe.C_)(["history-item",{disable:!(0,c.SU)(n)}]),onClick:t[0]||(t[0]=(0,a.iM)((function(e){return(0,c.SU)(s)()}),["stop"]))},[(0,u.Wm)(o),(0,u.Uk)(" Cancel ")],2),(0,u._)("div",{class:(0,pe.C_)(["history-item",{disable:!(0,c.SU)(l)}]),onClick:t[1]||(t[1]=(0,a.iM)((function(e){return(0,c.SU)(r)()}),["stop"]))},[(0,u.Wm)(i),(0,u.Uk)(" Redo ")],2)]),(0,u._)("div",{class:"back",onClick:t[2]||(t[2]=function(t){return e.changeMode("preview")})},[(0,u.Wm)(d),(0,u.Uk)(" Exit editing ")])])}}}),NE=(0,ll.Z)(zE,[["__scopeId","data-v-2ac952a9"]]),jE=NE;var YE={class:"mobile-editor"};const VE=(0,u.aZ)({__name:"index",props:{changeMode:{type:Function}},setup:function(e){var t=V(),n=X(),l=(0,o.Jk)(t),a=l.slideIndex,i=l.currentSlide,r=l.viewportRatio,s=(0,o.Jk)(n),d=s.activeElementIdList,f=s.handleElement,v=(0,c.iH)(),p=(0,c.iH)(),h=(0,c.iH)([]),m=(0,u.Fl)((function(){return i.value.background})),g=fs(m),y=g.backgroundStyle,w=(0,u.Fl)((function(){if(!v.value)return 1;var e=v.value.clientWidth,t=v.value.clientHeight,n=t/e;return n>=r.value?(e-20)/wl:(t-20)/r.value/wl}));(0,u.bv)((function(){d.value.length&&n.setActiveElementIdList([]),0!==a.value&&t.updateSlideIndex(0)}));var x=(0,u.Fl)((function(){return{width:wl*w.value+"px",height:wl*r.value*w.value+"px"}})),b=(0,c.iH)([]),k=function(){b.value=i.value?JSON.parse(JSON.stringify(i.value.elements)):[]};(0,u.m0)(k);var _=Ho(b,h,w),I=_.dragElement,S=Wo(b,h,w),C=S.scaleElement,L=Eo(b,p,w),E=L.rotateElement,Z=function(e,t){var l=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];d.value.includes(t.id)||(n.setActiveElementIdList([t.id]),n.setHandleElementId(t.id)),l&&I(e,t)},T=function(){n.setActiveElementIdList([])};return function(e,t){return(0,u.wg)(),(0,u.iD)("div",YE,[(0,u.Wm)(jE,{changeMode:e.changeMode},null,8,["changeMode"]),(0,u._)("div",{class:"content",ref_key:"contentRef",ref:v,onTouchstart:t[0]||(t[0]=function(e){return T()})},[(0,u._)("div",{class:"viewport-wrapper",style:(0,pe.j5)(x.value)},[(0,u._)("div",{class:"background",style:(0,pe.j5)((0,c.SU)(y))},null,4),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(h.value,(function(e,t){return(0,u.wg)(),(0,u.j4)(ys,{key:t,type:e.type,axis:e.axis,length:e.length,canvasScale:w.value},null,8,["type","axis","length","canvasScale"])})),128)),((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(b.value,(function(e){return(0,u.wg)(),(0,u.iD)(u.HY,{key:e.id},["line"!==e.type?((0,u.wg)(),(0,u.j4)(sE,{key:0,elementInfo:e,isSelected:(0,c.SU)(d).includes(e.id),canvasScale:w.value,scaleElement:(0,c.SU)(C),rotateElement:(0,c.SU)(E)},null,8,["elementInfo","isSelected","canvasScale","scaleElement","rotateElement"])):(0,u.kq)("",!0)],64)})),128)),(0,u._)("div",{class:"viewport",ref_key:"viewportRef",ref:p,style:(0,pe.j5)({transform:"scale(".concat(w.value,")")})},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(b.value,(function(e,t){return(0,u.wg)(),(0,u.j4)(rE,{key:e.id,elementInfo:e,elementIndex:t+1,selectElement:Z},null,8,["elementInfo","elementIndex"])})),128))],4)],4)],544),(0,u.Wm)(_E),(0,c.SU)(f)?((0,u.wg)(),(0,u.j4)(PE,{key:0})):(0,u.kq)("",!0)])}}}),JE=(0,ll.Z)(VE,[["__scopeId","data-v-3756d058"]]),qE=JE;var XE={class:"header"};const GE=(0,u.aZ)({__name:"MobilePlayer",props:{changeMode:{type:Function}},setup:function(e){var t=V(),n=(0,o.Jk)(t),l=n.slides,a=n.slideIndex,i=n.currentSlide,r=n.viewportRatio,s=(0,c.iH)(!1),d=(0,c.iH)({width:0,height:0});(0,u.bv)((function(){0!==a.value&&t.updateSlideIndex(0),d.value={width:document.body.clientHeight,height:document.body.clientWidth}}));var f=(0,u.Fl)((function(){var e=d.value.height/d.value.width,t=0,n=0;return e>=r.value?(t=d.value.width,n=t*r.value):(n=d.value.height,t=n/r.value),{width:t,height:n}})),v=(0,c.iH)(null),p=function(e){v.value={x:e.changedTouches[0].pageX,y:e.changedTouches[0].pageY}},h=function(e){if(v.value){var n=Math.abs(v.value.y-e.changedTouches[0].pageY),o=e.changedTouches[0].pageX-v.value.x;Math.abs(o)>n&&Math.abs(o)>50&&(v.value=null,o<0&&a.value>0&&t.updateSlideIndex(a.value-1),o>0&&a.value<l.value.length-1&&t.updateSlideIndex(a.value+1))}};return function(e,t){var n=(0,u.up)("IconLogout");return(0,u.wg)(),(0,u.iD)("div",{class:"mobile-player",style:(0,pe.j5)({width:d.value.width+"px",height:d.value.height+"px",transform:"rotate(90deg) translateY(-".concat(d.value.height,"px)")})},[(0,u._)("div",{class:"screen-slide-list",onClick:t[0]||(t[0]=function(e){return s.value=!s.value}),onTouchstart:t[1]||(t[1]=function(e){return p(e)}),onTouchend:t[2]||(t[2]=function(e){return h(e)})},[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(l),(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:(0,pe.C_)(["slide-item","turning-mode-".concat(e.turningMode||"slideY"),{current:t===(0,c.SU)(a),before:t<(0,c.SU)(a),after:t>(0,c.SU)(a),hide:(t===(0,c.SU)(a)-1||t===(0,c.SU)(a)+1)&&e.turningMode!==(0,c.SU)(i).turningMode}]),key:e.id},[Math.abs((0,c.SU)(a)-t)<2?((0,u.wg)(),(0,u.iD)("div",{key:0,class:"slide-content",style:(0,pe.j5)({width:f.value.width+"px",height:f.value.height+"px"})},[(0,u.Wm)(Nf,{slide:e,size:f.value.width},null,8,["slide","size"])],4)):(0,u.kq)("",!0)],2)})),128))],32),s.value?((0,u.wg)(),(0,u.iD)(u.HY,{key:0},[(0,u._)("div",XE,[(0,u._)("div",{class:"back",onClick:t[3]||(t[3]=function(t){return e.changeMode("preview")})},[(0,u.Wm)(n),(0,u.Uk)(" 退出播放")])]),(0,u.Wm)(mE,{class:"thumbnails"})],64)):(0,u.kq)("",!0)],4)}}}),KE=(0,ll.Z)(GE,[["__scopeId","data-v-62f26eba"]]),QE=KE;var $E={class:"thumbnail-list"},eZ={class:"menu"};const tZ=(0,u.aZ)({__name:"MobilePreview",props:{changeMode:{type:Function}},setup:function(e){var t=(0,o.Jk)(V()),n=t.slides,l=Sh(),a=l.slidesLoadLimit,i=(0,c.iH)(),r=(0,c.iH)(0);return(0,u.bv)((function(){i.value&&(r.value=i.value.clientWidth)})),function(e,t){var l=(0,u.up)("IconEdit"),o=(0,u.up)("IconFullScreenPlay");return(0,u.wg)(),(0,u.iD)("div",{class:"mobile-preview",ref_key:"mobileRef",ref:i},[(0,u._)("div",$E,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)((0,c.SU)(n),(function(e,t){return(0,u.wg)(),(0,u.iD)("div",{class:"thumbnail-item",key:e.id},[(0,u.Wm)(Nf,{slide:e,size:r.value-20,visible:t<(0,c.SU)(a)},null,8,["slide","size","visible"])])})),128))]),(0,u._)("div",eZ,[(0,u._)("div",{class:"menu-item",onClick:t[0]||(t[0]=function(t){return e.changeMode("editor")})},[(0,u.Wm)(l,{class:"icon"}),(0,u.Uk)(" Edit ")]),(0,u.Wm)(Ud,{type:"vertical",style:{height:"30px"}}),(0,u._)("div",{class:"menu-item",onClick:t[1]||(t[1]=function(t){return e.changeMode("player")})},[(0,u.Wm)(o,{class:"icon"}),(0,u.Uk)(" Play ")])])],512)}}}),nZ=(0,ll.Z)(tZ,[["__scopeId","data-v-17bc115e"]]),lZ=nZ;var aZ={class:"mobile"};const oZ=(0,u.aZ)({__name:"index",setup:function(e){var t=(0,c.iH)("preview"),n=function(e){return t.value=e},l=(0,u.Fl)((function(){var e={editor:qE,player:QE,preview:lZ};return e[t.value]||null}));return function(e,t){return(0,u.wg)(),(0,u.iD)("div",aZ,[((0,u.wg)(),(0,u.j4)((0,u.LL)(l.value),{changeMode:n}))])}}}),iZ=(0,ll.Z)(oZ,[["__scopeId","data-v-9826ff08"]]),rZ=iZ,uZ=(0,u.aZ)({__name:"App",setup:function(e){var t=ve(),n=X(),l=ce(),a=(0,o.Jk)(n),s=a.databaseId,d=(0,o.Jk)(de()),f=d.screening;window.onbeforeunload=function(){return!1},(0,u.bv)((0,r.Z)((0,i.Z)().mark((function e(){return(0,i.Z)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,ie();case 2:l.initSnapshotDatabase(),n.setAvailableFonts();case 4:case"end":return e.stop()}}),e)})))),window.addEventListener("unload",(function(){var e=localStorage.getItem(ae),t=e?JSON.parse(e):[];t.push(s.value);var n=JSON.stringify(t);localStorage.setItem(ae,n)}));var v=document.getElementById("app").getAttribute("obj")||"",p=document.getElementById("app").getAttribute("pk")||"";return function(e,n){return(0,c.SU)(f)?((0,u.wg)(),(0,u.j4)(aE,{key:0})):(0,c.SU)(t)?((0,u.wg)(),(0,u.j4)(LC,{key:1,url:(0,c.SU)(v),pk:(0,c.SU)(p)},null,8,["url","pk"])):((0,u.wg)(),(0,u.j4)(rZ,{key:2}))}}}),cZ=uZ,sZ=cZ;var dZ=n(95205);(0,dZ.z)("".concat("","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}});n(59744),n(79091);var fZ={class:"menu-content"},vZ=["onClick"],pZ={class:"text"},hZ={key:0,class:"sub-text"};const mZ=(0,u.aZ)({__name:"MenuContent",props:{menus:{},handleClickMenuItem:{type:Function}},setup:function(e){return function(e,t){var n=(0,u.up)("menu-content",!0);return(0,u.wg)(),(0,u.iD)("ul",fZ,[((0,u.wg)(!0),(0,u.iD)(u.HY,null,(0,u.Ko)(e.menus,(function(t,l){return(0,u.wg)(),(0,u.iD)(u.HY,{key:t.text||l},[t.hide?(0,u.kq)("",!0):((0,u.wg)(),(0,u.iD)("li",{key:0,class:(0,pe.C_)(["menu-item",{divider:t.divider,disable:t.disable}]),onClick:(0,a.iM)((function(n){return e.handleClickMenuItem(t)}),["stop"])},[t.divider?(0,u.kq)("",!0):((0,u.wg)(),(0,u.iD)("div",{key:0,class:(0,pe.C_)(["menu-item-content",{"has-children":t.children,"has-handler":t.handler}])},[(0,u._)("span",pZ,(0,pe.zw)(t.text),1),t.subText&&!t.children?((0,u.wg)(),(0,u.iD)("span",hZ,(0,pe.zw)(t.subText),1)):(0,u.kq)("",!0),t.children&&t.children.length?((0,u.wg)(),(0,u.j4)(n,{key:1,class:"sub-menu",menus:t.children,handleClickMenuItem:e.handleClickMenuItem},null,8,["menus","handleClickMenuItem"])):(0,u.kq)("",!0)],2))],10,vZ))],64)})),128))])}}}),gZ=(0,ll.Z)(mZ,[["__scopeId","data-v-77e74b43"]]),yZ=gZ,wZ=(0,u.aZ)({__name:"index",props:{axis:{},el:{},menus:{},removeContextmenu:{type:Function}},setup:function(e){var t=e,n=(0,u.Fl)((function(){var e=170,n=30,l=11,a=5,o=t.axis,i=o.x,r=o.y,u=t.menus.filter((function(e){return!(e.divider||e.hide)})).length,c=t.menus.filter((function(e){return e.divider})).length,s=e,d=u*n+c*l+2*a,f=document.body.clientWidth,v=document.body.clientHeight;return{left:f<=i+s?i-s:i,top:v<=r+d?r-d:r}})),l=function(e){e.disable||e.children&&!e.handler||(e.handler&&e.handler(t.el),t.removeContextmenu())};return function(e,t){return(0,u.wg)(),(0,u.iD)(u.HY,null,[(0,u._)("div",{class:"mask",onContextmenu:t[0]||(t[0]=(0,a.iM)((function(t){return e.removeContextmenu()}),["prevent"])),onMousedown:t[1]||(t[1]=function(t){return e.removeContextmenu()})},null,32),(0,u._)("div",{class:"contextmenu",style:(0,pe.j5)({left:n.value.left+"px",top:n.value.top+"px"}),onContextmenu:t[2]||(t[2]=(0,a.iM)((function(){}),["prevent"]))},[(0,u.Wm)(yZ,{menus:e.menus,handleClickMenuItem:l},null,8,["menus"])],36)],64)}}}),xZ=wZ,bZ=xZ;var kZ="CTX_CONTEXTMENU_HANDLER",_Z=function(e,t,n){t.stopPropagation(),t.preventDefault();var l=n.value(e);if(l){var o=null,i=function t(){o&&(document.body.removeChild(o),o=null),e.classList.remove("contextmenu-active"),document.body.removeEventListener("scroll",t),window.removeEventListener("resize",t)},r={axis:{x:t.x,y:t.y},el:e,menus:l,removeContextmenu:i};o=document.createElement("div");var c=(0,u.Wm)(bZ,r,null);(0,a.sY)(c,o),document.body.appendChild(o),e.classList.add("contextmenu-active"),document.body.addEventListener("scroll",i),window.addEventListener("resize",i)}},IZ={mounted:function(e,t){e[kZ]=function(n){return _Z(e,n,t)},e.addEventListener("contextmenu",e[kZ])},unmounted:function(e){e&&e[kZ]&&(e.removeEventListener("contextmenu",e[kZ]),delete e[kZ])}};const SZ=IZ;var CZ="CTX_CLICK_OUTSIDE_HANDLER",LZ=function(e,t,n){var l=n.value,a=t.composedPath(),o=a?a.indexOf(e)<0:!e.contains(t.target);o&&l(t)},EZ={mounted:function(e,t){e[CZ]=function(n){return LZ(e,n,t)},setTimeout((function(){document.addEventListener("click",e[CZ])}),0)},unmounted:function(e){e[CZ]&&(document.removeEventListener("click",e[CZ]),delete e[CZ])}};const ZZ=EZ;var TZ="TOOLTIP_INSTANCE",MZ={mounted:function(e,t){var n="",l="top",a=[300,0];"string"===typeof t.value?n=t.value:(n=t.value.content,void 0!==t.value.placement&&(l=t.value.placement),void 0!==t.value.delay&&(a=t.value.delay)),e[TZ]=(0,eo.ZP)(e,{content:n,theme:"tooltip",duration:100,animation:"scale",allowHTML:!0,placement:l,delay:a})},updated:function(e,t){var n="";n="string"===typeof t.value?t.value:t.value.content,e[TZ]&&e[TZ].setContent(n)},unmounted:function(e){e[TZ]&&e[TZ].destroy()}};const UZ=MZ,WZ={install:function(e){e.directive("contextmenu",SZ),e.directive("click-outside",ZZ),e.directive("tooltip",UZ)}};var DZ=(0,a.ri)(sZ);DZ.use(Xn),DZ.use(WZ),DZ.use((0,o.WB)()),DZ.mount("#app")},42480:()=>{},93180:()=>{},47687:()=>{}},t={};function n(l){var a=t[l];if(void 0!==a)return a.exports;var o=t[l]={id:l,loaded:!1,exports:{}};return e[l].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}n.m=e,(()=>{var e=[];n.O=(t,l,a,o)=>{if(!l){var i=1/0;for(s=0;s<e.length;s++){for(var[l,a,o]=e[s],r=!0,u=0;u<l.length;u++)(!1&o||i>=o)&&Object.keys(n.O).every((e=>n.O[e](l[u])))?l.splice(u--,1):(r=!1,o<i&&(i=o));if(r){e.splice(s--,1);var c=a();void 0!==c&&(t=c)}}return t}o=o||0;for(var s=e.length;s>0&&e[s-1][2]>o;s--)e[s]=e[s-1];e[s]=[l,a,o]}})(),(()=>{n.n=e=>{var t=e&&e.__esModule?()=>e["default"]:()=>e;return n.d(t,{a:t}),t}})(),(()=>{n.d=(e,t)=>{for(var l in t)n.o(t,l)&&!n.o(e,l)&&Object.defineProperty(e,l,{enumerable:!0,get:t[l]})}})(),(()=>{n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()})(),(()=>{n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t)})(),(()=>{n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}})(),(()=>{n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e)})(),(()=>{var e={143:0};n.O.j=t=>0===e[t];var t=(t,l)=>{var a,o,[i,r,u]=l,c=0;if(i.some((t=>0!==e[t]))){for(a in r)n.o(r,a)&&(n.m[a]=r[a]);if(u)var s=u(n)}for(t&&t(l);c<i.length;c++)o=i[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(s)},l=self["webpackChunkpaperport"]=self["webpackChunkpaperport"]||[];l.forEach(t.bind(null,0)),l.push=t.bind(null,l.push.bind(l))})();var l=n.O(void 0,[998],(()=>n(95482)));l=n.O(l)})();
//# sourceMappingURL=app.a1fa4556.js.map